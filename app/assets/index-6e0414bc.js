var jR=Object.defineProperty;var JR=(n,e,s)=>e in n?jR(n,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[e]=s;var ee=(n,e,s)=>(JR(n,typeof e!="symbol"?e+"":e,s),s);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))o(l);new MutationObserver(l=>{for(const a of l)if(a.type==="childList")for(const h of a.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&o(h)}).observe(document,{childList:!0,subtree:!0});function s(l){const a={};return l.integrity&&(a.integrity=l.integrity),l.referrerPolicy&&(a.referrerPolicy=l.referrerPolicy),l.crossOrigin==="use-credentials"?a.credentials="include":l.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function o(l){if(l.ep)return;l.ep=!0;const a=s(l);fetch(l.href,a)}})();/**
* @vue/shared v3.4.15
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function lb(n,e){const s=new Set(n.split(","));return e?o=>s.has(o.toLowerCase()):o=>s.has(o)}const Pe={},sc=[],is=()=>{},qR=()=>!1,Ap=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&(n.charCodeAt(2)>122||n.charCodeAt(2)<97),cb=n=>n.startsWith("onUpdate:"),Ti=Object.assign,ab=(n,e)=>{const s=n.indexOf(e);s>-1&&n.splice(s,1)},ZR=Object.prototype.hasOwnProperty,he=(n,e)=>ZR.call(n,e),zt=Array.isArray,oc=n=>Rp(n)==="[object Map]",$k=n=>Rp(n)==="[object Set]",Jt=n=>typeof n=="function",Ye=n=>typeof n=="string",kc=n=>typeof n=="symbol",He=n=>n!==null&&typeof n=="object",_k=n=>(He(n)||Jt(n))&&Jt(n.then)&&Jt(n.catch),Tk=Object.prototype.toString,Rp=n=>Tk.call(n),QR=n=>Rp(n).slice(8,-1),bk=n=>Rp(n)==="[object Object]",hb=n=>Ye(n)&&n!=="NaN"&&n[0]!=="-"&&""+parseInt(n,10)===n,Gd=lb(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Np=n=>{const e=Object.create(null);return s=>e[s]||(e[s]=n(s))},tN=/-(\w)/g,To=Np(n=>n.replace(tN,(e,s)=>s?s.toUpperCase():"")),eN=/\B([A-Z])/g,Oc=Np(n=>n.replace(eN,"-$1").toLowerCase()),Lp=Np(n=>n.charAt(0).toUpperCase()+n.slice(1)),B$=Np(n=>n?`on${Lp(n)}`:""),Bn=(n,e)=>!Object.is(n,e),F$=(n,e)=>{for(let s=0;s<n.length;s++)n[s](e)},ap=(n,e,s)=>{Object.defineProperty(n,e,{configurable:!0,enumerable:!1,value:s})},iN=n=>{const e=parseFloat(n);return isNaN(e)?n:e};let kS;const Ek=()=>kS||(kS=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function ub(n){if(zt(n)){const e={};for(let s=0;s<n.length;s++){const o=n[s],l=Ye(o)?rN(o):ub(o);if(l)for(const a in l)e[a]=l[a]}return e}else if(Ye(n)||He(n))return n}const sN=/;(?![^(]*\))/g,oN=/:([^]+)/,nN=/\/\*[^]*?\*\//g;function rN(n){const e={};return n.replace(nN,"").split(sN).forEach(s=>{if(s){const o=s.split(oN);o.length>1&&(e[o[0].trim()]=o[1].trim())}}),e}function db(n){let e="";if(Ye(n))e=n;else if(zt(n))for(let s=0;s<n.length;s++){const o=db(n[s]);o&&(e+=o+" ")}else if(He(n))for(const s in n)n[s]&&(e+=s+" ");return e.trim()}const lN="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",cN=lb(lN);function vk(n){return!!n||n===""}const ds=n=>Ye(n)?n:n==null?"":zt(n)||He(n)&&(n.toString===Tk||!Jt(n.toString))?JSON.stringify(n,yk,2):String(n),yk=(n,e)=>e&&e.__v_isRef?yk(n,e.value):oc(e)?{[`Map(${e.size})`]:[...e.entries()].reduce((s,[o,l],a)=>(s[U$(o,a)+" =>"]=l,s),{})}:$k(e)?{[`Set(${e.size})`]:[...e.values()].map(s=>U$(s))}:kc(e)?U$(e):He(e)&&!zt(e)&&!bk(e)?String(e):e,U$=(n,e="")=>{var s;return kc(n)?`Symbol(${(s=n.description)!=null?s:e})`:n};/**
* @vue/reactivity v3.4.15
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/let Os;class aN{constructor(e=!1){this.detached=e,this._active=!0,this.effects=[],this.cleanups=[],this.parent=Os,!e&&Os&&(this.index=(Os.scopes||(Os.scopes=[])).push(this)-1)}get active(){return this._active}run(e){if(this._active){const s=Os;try{return Os=this,e()}finally{Os=s}}}on(){Os=this}off(){Os=this.parent}stop(e){if(this._active){let s,o;for(s=0,o=this.effects.length;s<o;s++)this.effects[s].stop();for(s=0,o=this.cleanups.length;s<o;s++)this.cleanups[s]();if(this.scopes)for(s=0,o=this.scopes.length;s<o;s++)this.scopes[s].stop(!0);if(!this.detached&&this.parent&&!e){const l=this.parent.scopes.pop();l&&l!==this&&(this.parent.scopes[this.index]=l,l.index=this.index)}this.parent=void 0,this._active=!1}}}function hN(n,e=Os){e&&e.active&&e.effects.push(n)}function uN(){return Os}let Pr;class pb{constructor(e,s,o,l){this.fn=e,this.trigger=s,this.scheduler=o,this.active=!0,this.deps=[],this._dirtyLevel=2,this._trackId=0,this._runnings=0,this._shouldSchedule=!1,this._depsLength=0,hN(this,l)}get dirty(){if(this._dirtyLevel===1){Xr();for(let e=0;e<this._depsLength;e++){const s=this.deps[e];if(s.computed&&(dN(s.computed),this._dirtyLevel>=2))break}this._dirtyLevel<2&&(this._dirtyLevel=0),Yr()}return this._dirtyLevel>=2}set dirty(e){this._dirtyLevel=e?2:0}run(){if(this._dirtyLevel=0,!this.active)return this.fn();let e=Ln,s=Pr;try{return Ln=!0,Pr=this,this._runnings++,OS(this),this.fn()}finally{AS(this),this._runnings--,Pr=s,Ln=e}}stop(){var e;this.active&&(OS(this),AS(this),(e=this.onStop)==null||e.call(this),this.active=!1)}}function dN(n){return n.value}function OS(n){n._trackId++,n._depsLength=0}function AS(n){if(n.deps&&n.deps.length>n._depsLength){for(let e=n._depsLength;e<n.deps.length;e++)Ik(n.deps[e],n);n.deps.length=n._depsLength}}function Ik(n,e){const s=n.get(e);s!==void 0&&e._trackId!==s&&(n.delete(e),n.size===0&&n.cleanup())}let Ln=!0,x_=0;const Sk=[];function Xr(){Sk.push(Ln),Ln=!1}function Yr(){const n=Sk.pop();Ln=n===void 0?!0:n}function fb(){x_++}function gb(){for(x_--;!x_&&D_.length;)D_.shift()()}function Ck(n,e,s){if(e.get(n)!==n._trackId){e.set(n,n._trackId);const o=n.deps[n._depsLength];o!==e?(o&&Ik(o,n),n.deps[n._depsLength++]=e):n._depsLength++}}const D_=[];function wk(n,e,s){fb();for(const o of n.keys())if(o._dirtyLevel<e&&n.get(o)===o._trackId){const l=o._dirtyLevel;o._dirtyLevel=e,l===0&&(o._shouldSchedule=!0,o.trigger())}kk(n),gb()}function kk(n){for(const e of n.keys())e.scheduler&&e._shouldSchedule&&(!e._runnings||e.allowRecurse)&&n.get(e)===e._trackId&&(e._shouldSchedule=!1,D_.push(e.scheduler))}const Ok=(n,e)=>{const s=new Map;return s.cleanup=n,s.computed=e,s},P_=new WeakMap,Br=Symbol(""),B_=Symbol("");function Hi(n,e,s){if(Ln&&Pr){let o=P_.get(n);o||P_.set(n,o=new Map);let l=o.get(s);l||o.set(s,l=Ok(()=>o.delete(s))),Ck(Pr,l)}}function Vo(n,e,s,o,l,a){const h=P_.get(n);if(!h)return;let d=[];if(e==="clear")d=[...h.values()];else if(s==="length"&&zt(n)){const p=Number(o);h.forEach((g,m)=>{(m==="length"||!kc(m)&&m>=p)&&d.push(g)})}else switch(s!==void 0&&d.push(h.get(s)),e){case"add":zt(n)?hb(s)&&d.push(h.get("length")):(d.push(h.get(Br)),oc(n)&&d.push(h.get(B_)));break;case"delete":zt(n)||(d.push(h.get(Br)),oc(n)&&d.push(h.get(B_)));break;case"set":oc(n)&&d.push(h.get(Br));break}fb();for(const p of d)p&&wk(p,2);gb()}const pN=lb("__proto__,__v_isRef,__isVue"),Ak=new Set(Object.getOwnPropertyNames(Symbol).filter(n=>n!=="arguments"&&n!=="caller").map(n=>Symbol[n]).filter(kc)),RS=fN();function fN(){const n={};return["includes","indexOf","lastIndexOf"].forEach(e=>{n[e]=function(...s){const o=ge(this);for(let a=0,h=this.length;a<h;a++)Hi(o,"get",a+"");const l=o[e](...s);return l===-1||l===!1?o[e](...s.map(ge)):l}}),["push","pop","shift","unshift","splice"].forEach(e=>{n[e]=function(...s){Xr(),fb();const o=ge(this)[e].apply(this,s);return gb(),Yr(),o}}),n}function gN(n){const e=ge(this);return Hi(e,"has",n),e.hasOwnProperty(n)}class Rk{constructor(e=!1,s=!1){this._isReadonly=e,this._shallow=s}get(e,s,o){const l=this._isReadonly,a=this._shallow;if(s==="__v_isReactive")return!l;if(s==="__v_isReadonly")return l;if(s==="__v_isShallow")return a;if(s==="__v_raw")return o===(l?a?kN:xk:a?Mk:Lk).get(e)||Object.getPrototypeOf(e)===Object.getPrototypeOf(o)?e:void 0;const h=zt(e);if(!l){if(h&&he(RS,s))return Reflect.get(RS,s,o);if(s==="hasOwnProperty")return gN}const d=Reflect.get(e,s,o);return(kc(s)?Ak.has(s):pN(s))||(l||Hi(e,"get",s),a)?d:Vi(d)?h&&hb(s)?d:d.value:He(d)?l?Dk(d):bo(d):d}}class Nk extends Rk{constructor(e=!1){super(!1,e)}set(e,s,o,l){let a=e[s];if(!this._shallow){const p=uc(a);if(!hp(o)&&!uc(o)&&(a=ge(a),o=ge(o)),!zt(e)&&Vi(a)&&!Vi(o))return p?!1:(a.value=o,!0)}const h=zt(e)&&hb(s)?Number(s)<e.length:he(e,s),d=Reflect.set(e,s,o,l);return e===ge(l)&&(h?Bn(o,a)&&Vo(e,"set",s,o):Vo(e,"add",s,o)),d}deleteProperty(e,s){const o=he(e,s);e[s];const l=Reflect.deleteProperty(e,s);return l&&o&&Vo(e,"delete",s,void 0),l}has(e,s){const o=Reflect.has(e,s);return(!kc(s)||!Ak.has(s))&&Hi(e,"has",s),o}ownKeys(e){return Hi(e,"iterate",zt(e)?"length":Br),Reflect.ownKeys(e)}}class mN extends Rk{constructor(e=!1){super(!0,e)}set(e,s){return!0}deleteProperty(e,s){return!0}}const $N=new Nk,_N=new mN,TN=new Nk(!0),mb=n=>n,Mp=n=>Reflect.getPrototypeOf(n);function fd(n,e,s=!1,o=!1){n=n.__v_raw;const l=ge(n),a=ge(e);s||(Bn(e,a)&&Hi(l,"get",e),Hi(l,"get",a));const{has:h}=Mp(l),d=o?mb:s?Tb:mh;if(h.call(l,e))return d(n.get(e));if(h.call(l,a))return d(n.get(a));n!==l&&n.get(e)}function gd(n,e=!1){const s=this.__v_raw,o=ge(s),l=ge(n);return e||(Bn(n,l)&&Hi(o,"has",n),Hi(o,"has",l)),n===l?s.has(n):s.has(n)||s.has(l)}function md(n,e=!1){return n=n.__v_raw,!e&&Hi(ge(n),"iterate",Br),Reflect.get(n,"size",n)}function NS(n){n=ge(n);const e=ge(this);return Mp(e).has.call(e,n)||(e.add(n),Vo(e,"add",n,n)),this}function LS(n,e){e=ge(e);const s=ge(this),{has:o,get:l}=Mp(s);let a=o.call(s,n);a||(n=ge(n),a=o.call(s,n));const h=l.call(s,n);return s.set(n,e),a?Bn(e,h)&&Vo(s,"set",n,e):Vo(s,"add",n,e),this}function MS(n){const e=ge(this),{has:s,get:o}=Mp(e);let l=s.call(e,n);l||(n=ge(n),l=s.call(e,n)),o&&o.call(e,n);const a=e.delete(n);return l&&Vo(e,"delete",n,void 0),a}function xS(){const n=ge(this),e=n.size!==0,s=n.clear();return e&&Vo(n,"clear",void 0,void 0),s}function $d(n,e){return function(o,l){const a=this,h=a.__v_raw,d=ge(h),p=e?mb:n?Tb:mh;return!n&&Hi(d,"iterate",Br),h.forEach((g,m)=>o.call(l,p(g),p(m),a))}}function _d(n,e,s){return function(...o){const l=this.__v_raw,a=ge(l),h=oc(a),d=n==="entries"||n===Symbol.iterator&&h,p=n==="keys"&&h,g=l[n](...o),m=s?mb:e?Tb:mh;return!e&&Hi(a,"iterate",p?B_:Br),{next(){const{value:T,done:b}=g.next();return b?{value:T,done:b}:{value:d?[m(T[0]),m(T[1])]:m(T),done:b}},[Symbol.iterator](){return this}}}}function yn(n){return function(...e){return n==="delete"?!1:n==="clear"?void 0:this}}function bN(){const n={get(a){return fd(this,a)},get size(){return md(this)},has:gd,add:NS,set:LS,delete:MS,clear:xS,forEach:$d(!1,!1)},e={get(a){return fd(this,a,!1,!0)},get size(){return md(this)},has:gd,add:NS,set:LS,delete:MS,clear:xS,forEach:$d(!1,!0)},s={get(a){return fd(this,a,!0)},get size(){return md(this,!0)},has(a){return gd.call(this,a,!0)},add:yn("add"),set:yn("set"),delete:yn("delete"),clear:yn("clear"),forEach:$d(!0,!1)},o={get(a){return fd(this,a,!0,!0)},get size(){return md(this,!0)},has(a){return gd.call(this,a,!0)},add:yn("add"),set:yn("set"),delete:yn("delete"),clear:yn("clear"),forEach:$d(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(a=>{n[a]=_d(a,!1,!1),s[a]=_d(a,!0,!1),e[a]=_d(a,!1,!0),o[a]=_d(a,!0,!0)}),[n,s,e,o]}const[EN,vN,yN,IN]=bN();function $b(n,e){const s=e?n?IN:yN:n?vN:EN;return(o,l,a)=>l==="__v_isReactive"?!n:l==="__v_isReadonly"?n:l==="__v_raw"?o:Reflect.get(he(s,l)&&l in o?s:o,l,a)}const SN={get:$b(!1,!1)},CN={get:$b(!1,!0)},wN={get:$b(!0,!1)},Lk=new WeakMap,Mk=new WeakMap,xk=new WeakMap,kN=new WeakMap;function ON(n){switch(n){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function AN(n){return n.__v_skip||!Object.isExtensible(n)?0:ON(QR(n))}function bo(n){return uc(n)?n:_b(n,!1,$N,SN,Lk)}function RN(n){return _b(n,!1,TN,CN,Mk)}function Dk(n){return _b(n,!0,_N,wN,xk)}function _b(n,e,s,o,l){if(!He(n)||n.__v_raw&&!(e&&n.__v_isReactive))return n;const a=l.get(n);if(a)return a;const h=AN(n);if(h===0)return n;const d=new Proxy(n,h===2?o:s);return l.set(n,d),d}function nc(n){return uc(n)?nc(n.__v_raw):!!(n&&n.__v_isReactive)}function uc(n){return!!(n&&n.__v_isReadonly)}function hp(n){return!!(n&&n.__v_isShallow)}function Pk(n){return nc(n)||uc(n)}function ge(n){const e=n&&n.__v_raw;return e?ge(e):n}function Bk(n){return ap(n,"__v_skip",!0),n}const mh=n=>He(n)?bo(n):n,Tb=n=>He(n)?Dk(n):n;class Fk{constructor(e,s,o,l){this._setter=s,this.dep=void 0,this.__v_isRef=!0,this.__v_isReadonly=!1,this.effect=new pb(()=>e(this._value),()=>Wd(this,1),()=>this.dep&&kk(this.dep)),this.effect.computed=this,this.effect.active=this._cacheable=!l,this.__v_isReadonly=o}get value(){const e=ge(this);return(!e._cacheable||e.effect.dirty)&&Bn(e._value,e._value=e.effect.run())&&Wd(e,2),Uk(e),e.effect._dirtyLevel>=1&&Wd(e,1),e._value}set value(e){this._setter(e)}get _dirty(){return this.effect.dirty}set _dirty(e){this.effect.dirty=e}}function NN(n,e,s=!1){let o,l;const a=Jt(n);return a?(o=n,l=is):(o=n.get,l=n.set),new Fk(o,l,a||!l,s)}function Uk(n){Ln&&Pr&&(n=ge(n),Ck(Pr,n.dep||(n.dep=Ok(()=>n.dep=void 0,n instanceof Fk?n:void 0))))}function Wd(n,e=2,s){n=ge(n);const o=n.dep;o&&wk(o,e)}function Vi(n){return!!(n&&n.__v_isRef===!0)}function Ls(n){return Hk(n,!1)}function LN(n){return Hk(n,!0)}function Hk(n,e){return Vi(n)?n:new MN(n,e)}class MN{constructor(e,s){this.__v_isShallow=s,this.dep=void 0,this.__v_isRef=!0,this._rawValue=s?e:ge(e),this._value=s?e:mh(e)}get value(){return Uk(this),this._value}set value(e){const s=this.__v_isShallow||hp(e)||uc(e);e=s?e:ge(e),Bn(e,this._rawValue)&&(this._rawValue=e,this._value=s?e:mh(e),Wd(this,2))}}function Xo(n){return Vi(n)?n.value:n}const xN={get:(n,e,s)=>Xo(Reflect.get(n,e,s)),set:(n,e,s,o)=>{const l=n[e];return Vi(l)&&!Vi(s)?(l.value=s,!0):Reflect.set(n,e,s,o)}};function Vk(n){return nc(n)?n:new Proxy(n,xN)}/**
* @vue/runtime-core v3.4.15
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/function Mn(n,e,s,o){let l;try{l=o?n(...o):n()}catch(a){xp(a,e,s)}return l}function Rs(n,e,s,o){if(Jt(n)){const a=Mn(n,e,s,o);return a&&_k(a)&&a.catch(h=>{xp(h,e,s)}),a}const l=[];for(let a=0;a<n.length;a++)l.push(Rs(n[a],e,s,o));return l}function xp(n,e,s,o=!0){const l=e?e.vnode:null;if(e){let a=e.parent;const h=e.proxy,d=`https://vuejs.org/error-reference/#runtime-${s}`;for(;a;){const g=a.ec;if(g){for(let m=0;m<g.length;m++)if(g[m](n,h,d)===!1)return}a=a.parent}const p=e.appContext.config.errorHandler;if(p){Mn(p,null,10,[n,h,d]);return}}DN(n,s,l,o)}function DN(n,e,s,o=!0){console.error(n)}let $h=!1,F_=!1;const fi=[];let uo=0;const rc=[];let Sn=null,Rr=0;const Gk=Promise.resolve();let bb=null;function PN(n){const e=bb||Gk;return n?e.then(this?n.bind(this):n):e}function BN(n){let e=uo+1,s=fi.length;for(;e<s;){const o=e+s>>>1,l=fi[o],a=_h(l);a<n||a===n&&l.pre?e=o+1:s=o}return e}function Eb(n){(!fi.length||!fi.includes(n,$h&&n.allowRecurse?uo+1:uo))&&(n.id==null?fi.push(n):fi.splice(BN(n.id),0,n),Wk())}function Wk(){!$h&&!F_&&(F_=!0,bb=Gk.then(Xk))}function FN(n){const e=fi.indexOf(n);e>uo&&fi.splice(e,1)}function UN(n){zt(n)?rc.push(...n):(!Sn||!Sn.includes(n,n.allowRecurse?Rr+1:Rr))&&rc.push(n),Wk()}function DS(n,e,s=$h?uo+1:0){for(;s<fi.length;s++){const o=fi[s];if(o&&o.pre){if(n&&o.id!==n.uid)continue;fi.splice(s,1),s--,o()}}}function zk(n){if(rc.length){const e=[...new Set(rc)].sort((s,o)=>_h(s)-_h(o));if(rc.length=0,Sn){Sn.push(...e);return}for(Sn=e,Rr=0;Rr<Sn.length;Rr++)Sn[Rr]();Sn=null,Rr=0}}const _h=n=>n.id==null?1/0:n.id,HN=(n,e)=>{const s=_h(n)-_h(e);if(s===0){if(n.pre&&!e.pre)return-1;if(e.pre&&!n.pre)return 1}return s};function Xk(n){F_=!1,$h=!0,fi.sort(HN);const e=is;try{for(uo=0;uo<fi.length;uo++){const s=fi[uo];s&&s.active!==!1&&Mn(s,null,14)}}finally{uo=0,fi.length=0,zk(),$h=!1,bb=null,(fi.length||rc.length)&&Xk()}}function VN(n,e,...s){if(n.isUnmounted)return;const o=n.vnode.props||Pe;let l=s;const a=e.startsWith("update:"),h=a&&e.slice(7);if(h&&h in o){const m=`${h==="modelValue"?"model":h}Modifiers`,{number:T,trim:b}=o[m]||Pe;b&&(l=s.map(y=>Ye(y)?y.trim():y)),T&&(l=s.map(iN))}let d,p=o[d=B$(e)]||o[d=B$(To(e))];!p&&a&&(p=o[d=B$(Oc(e))]),p&&Rs(p,n,6,l);const g=o[d+"Once"];if(g){if(!n.emitted)n.emitted={};else if(n.emitted[d])return;n.emitted[d]=!0,Rs(g,n,6,l)}}function Yk(n,e,s=!1){const o=e.emitsCache,l=o.get(n);if(l!==void 0)return l;const a=n.emits;let h={},d=!1;if(!Jt(n)){const p=g=>{const m=Yk(g,e,!0);m&&(d=!0,Ti(h,m))};!s&&e.mixins.length&&e.mixins.forEach(p),n.extends&&p(n.extends),n.mixins&&n.mixins.forEach(p)}return!a&&!d?(He(n)&&o.set(n,null),null):(zt(a)?a.forEach(p=>h[p]=null):Ti(h,a),He(n)&&o.set(n,h),h)}function Dp(n,e){return!n||!Ap(e)?!1:(e=e.slice(2).replace(/Once$/,""),he(n,e[0].toLowerCase()+e.slice(1))||he(n,Oc(e))||he(n,e))}let Oi=null,Pp=null;function up(n){const e=Oi;return Oi=n,Pp=n&&n.type.__scopeId||null,e}function Kk(n){Pp=n}function jk(){Pp=null}function La(n,e=Oi,s){if(!e||n._n)return n;const o=(...l)=>{o._d&&YS(-1);const a=up(e);let h;try{h=n(...l)}finally{up(a),o._d&&YS(1)}return h};return o._n=!0,o._c=!0,o._d=!0,o}function H$(n){const{type:e,vnode:s,proxy:o,withProxy:l,props:a,propsOptions:[h],slots:d,attrs:p,emit:g,render:m,renderCache:T,data:b,setupState:y,ctx:C,inheritAttrs:L}=n;let A,F;const z=up(n);try{if(s.shapeFlag&4){const K=l||o,Y=K;A=ao(m.call(Y,K,T,a,y,b,C)),F=p}else{const K=e;A=ao(K.length>1?K(a,{attrs:p,slots:d,emit:g}):K(a,null)),F=e.props?p:GN(p)}}catch(K){Wa.length=0,xp(K,n,1),A=Ae(Fn)}let X=A;if(F&&L!==!1){const K=Object.keys(F),{shapeFlag:Y}=X;K.length&&Y&7&&(h&&K.some(cb)&&(F=WN(F,h)),X=dc(X,F))}return s.dirs&&(X=dc(X),X.dirs=X.dirs?X.dirs.concat(s.dirs):s.dirs),s.transition&&(X.transition=s.transition),A=X,up(z),A}const GN=n=>{let e;for(const s in n)(s==="class"||s==="style"||Ap(s))&&((e||(e={}))[s]=n[s]);return e},WN=(n,e)=>{const s={};for(const o in n)(!cb(o)||!(o.slice(9)in e))&&(s[o]=n[o]);return s};function zN(n,e,s){const{props:o,children:l,component:a}=n,{props:h,children:d,patchFlag:p}=e,g=a.emitsOptions;if(e.dirs||e.transition)return!0;if(s&&p>=0){if(p&1024)return!0;if(p&16)return o?PS(o,h,g):!!h;if(p&8){const m=e.dynamicProps;for(let T=0;T<m.length;T++){const b=m[T];if(h[b]!==o[b]&&!Dp(g,b))return!0}}}else return(l||d)&&(!d||!d.$stable)?!0:o===h?!1:o?h?PS(o,h,g):!0:!!h;return!1}function PS(n,e,s){const o=Object.keys(e);if(o.length!==Object.keys(n).length)return!0;for(let l=0;l<o.length;l++){const a=o[l];if(e[a]!==n[a]&&!Dp(s,a))return!0}return!1}function XN({vnode:n,parent:e},s){for(;e;){const o=e.subTree;if(o.suspense&&o.suspense.activeBranch===n&&(o.el=n.el),o===n)(n=e.vnode).el=s,e=e.parent;else break}}const Jk="components",qk=Symbol.for("v-ndc");function YN(n){return Ye(n)?KN(Jk,n,!1)||n:n||qk}function KN(n,e,s=!0,o=!1){const l=Oi||gi;if(l){const a=l.type;if(n===Jk){const d=GL(a,!1);if(d&&(d===e||d===To(e)||d===Lp(To(e))))return a}const h=BS(l[n]||a[n],e)||BS(l.appContext[n],e);return!h&&o?a:h}}function BS(n,e){return n&&(n[e]||n[To(e)]||n[Lp(To(e))])}const jN=n=>n.__isSuspense;function JN(n,e){e&&e.pendingBranch?zt(n)?e.effects.push(...n):e.effects.push(n):UN(n)}const qN=Symbol.for("v-scx"),ZN=()=>zd(qN),Td={};function Ha(n,e,s){return Zk(n,e,s)}function Zk(n,e,{immediate:s,deep:o,flush:l,once:a,onTrack:h,onTrigger:d}=Pe){if(e&&a){const V=e;e=(...H)=>{V(...H),Y()}}const p=gi,g=V=>o===!0?V:Ql(V,o===!1?1:void 0);let m,T=!1,b=!1;if(Vi(n)?(m=()=>n.value,T=hp(n)):nc(n)?(m=()=>g(n),T=!0):zt(n)?(b=!0,T=n.some(V=>nc(V)||hp(V)),m=()=>n.map(V=>{if(Vi(V))return V.value;if(nc(V))return g(V);if(Jt(V))return Mn(V,p,2)})):Jt(n)?e?m=()=>Mn(n,p,2):m=()=>(y&&y(),Rs(n,p,3,[C])):m=is,e&&o){const V=m;m=()=>Ql(V())}let y,C=V=>{y=X.onStop=()=>{Mn(V,p,4),y=X.onStop=void 0}},L;if(Vp)if(C=is,e?s&&Rs(e,p,3,[m(),b?[]:void 0,C]):m(),l==="sync"){const V=ZN();L=V.__watcherHandles||(V.__watcherHandles=[])}else return is;let A=b?new Array(n.length).fill(Td):Td;const F=()=>{if(!(!X.active||!X.dirty))if(e){const V=X.run();(o||T||(b?V.some((H,Tt)=>Bn(H,A[Tt])):Bn(V,A)))&&(y&&y(),Rs(e,p,3,[V,A===Td?void 0:b&&A[0]===Td?[]:A,C]),A=V)}else X.run()};F.allowRecurse=!!e;let z;l==="sync"?z=F:l==="post"?z=()=>Fi(F,p&&p.suspense):(F.pre=!0,p&&(F.id=p.uid),z=()=>Eb(F));const X=new pb(m,is,z),K=uN(),Y=()=>{X.stop(),K&&ab(K.effects,X)};return e?s?F():A=X.run():l==="post"?Fi(X.run.bind(X),p&&p.suspense):X.run(),L&&L.push(Y),Y}function QN(n,e,s){const o=this.proxy,l=Ye(n)?n.includes(".")?Qk(o,n):()=>o[n]:n.bind(o,o);let a;Jt(e)?a=e:(a=e.handler,s=e);const h=Rh(this),d=Zk(l,a.bind(o),s);return h(),d}function Qk(n,e){const s=e.split(".");return()=>{let o=n;for(let l=0;l<s.length&&o;l++)o=o[s[l]];return o}}function Ql(n,e,s=0,o){if(!He(n)||n.__v_skip)return n;if(e&&e>0){if(s>=e)return n;s++}if(o=o||new Set,o.has(n))return n;if(o.add(n),Vi(n))Ql(n.value,e,s,o);else if(zt(n))for(let l=0;l<n.length;l++)Ql(n[l],e,s,o);else if($k(n)||oc(n))n.forEach(l=>{Ql(l,e,s,o)});else if(bk(n))for(const l in n)Ql(n[l],e,s,o);return n}function kr(n,e,s,o){const l=n.dirs,a=e&&e.dirs;for(let h=0;h<l.length;h++){const d=l[h];a&&(d.oldValue=a[h].value);let p=d.dir[o];p&&(Xr(),Rs(p,s,8,[n.el,d,n,e]),Yr())}}const Va=n=>!!n.type.__asyncLoader,t0=n=>n.type.__isKeepAlive;function tL(n,e){e0(n,"a",e)}function eL(n,e){e0(n,"da",e)}function e0(n,e,s=gi){const o=n.__wdc||(n.__wdc=()=>{let l=s;for(;l;){if(l.isDeactivated)return;l=l.parent}return n()});if(Bp(e,o,s),s){let l=s.parent;for(;l&&l.parent;)t0(l.parent.vnode)&&iL(o,e,s,l),l=l.parent}}function iL(n,e,s,o){const l=Bp(e,n,o,!0);i0(()=>{ab(o[e],l)},s)}function Bp(n,e,s=gi,o=!1){if(s){const l=s[n]||(s[n]=[]),a=e.__weh||(e.__weh=(...h)=>{if(s.isUnmounted)return;Xr();const d=Rh(s),p=Rs(e,s,n,h);return d(),Yr(),p});return o?l.unshift(a):l.push(a),a}}const Qo=n=>(e,s=gi)=>(!Vp||n==="sp")&&Bp(n,(...o)=>e(...o),s),sL=Qo("bm"),vb=Qo("m"),oL=Qo("bu"),nL=Qo("u"),rL=Qo("bum"),i0=Qo("um"),lL=Qo("sp"),cL=Qo("rtg"),aL=Qo("rtc");function hL(n,e=gi){Bp("ec",n,e)}function Fp(n,e,s,o){let l;const a=s&&s[o];if(zt(n)||Ye(n)){l=new Array(n.length);for(let h=0,d=n.length;h<d;h++)l[h]=e(n[h],h,void 0,a&&a[h])}else if(typeof n=="number"){l=new Array(n);for(let h=0;h<n;h++)l[h]=e(h+1,h,void 0,a&&a[h])}else if(He(n))if(n[Symbol.iterator])l=Array.from(n,(h,d)=>e(h,d,void 0,a&&a[d]));else{const h=Object.keys(n);l=new Array(h.length);for(let d=0,p=h.length;d<p;d++){const g=h[d];l[d]=e(n[g],g,d,a&&a[d])}}else l=[];return s&&(s[o]=l),l}function uL(n,e,s={},o,l){if(Oi.isCE||Oi.parent&&Va(Oi.parent)&&Oi.parent.isCE)return e!=="default"&&(s.name=e),Ae("slot",s,o&&o());let a=n[e];a&&a._c&&(a._d=!1),Zt();const h=a&&s0(a(s)),d=Sb(ri,{key:s.key||h&&h.key||`_${e}`},h||(o?o():[]),h&&n._===1?64:-2);return!l&&d.scopeId&&(d.slotScopeIds=[d.scopeId+"-s"]),a&&a._c&&(a._d=!0),d}function s0(n){return n.some(e=>f0(e)?!(e.type===Fn||e.type===ri&&!s0(e.children)):!0)?n:null}const U_=n=>n?m0(n)?wb(n)||n.proxy:U_(n.parent):null,Ga=Ti(Object.create(null),{$:n=>n,$el:n=>n.vnode.el,$data:n=>n.data,$props:n=>n.props,$attrs:n=>n.attrs,$slots:n=>n.slots,$refs:n=>n.refs,$parent:n=>U_(n.parent),$root:n=>U_(n.root),$emit:n=>n.emit,$options:n=>yb(n),$forceUpdate:n=>n.f||(n.f=()=>{n.effect.dirty=!0,Eb(n.update)}),$nextTick:n=>n.n||(n.n=PN.bind(n.proxy)),$watch:n=>QN.bind(n)}),V$=(n,e)=>n!==Pe&&!n.__isScriptSetup&&he(n,e),dL={get({_:n},e){const{ctx:s,setupState:o,data:l,props:a,accessCache:h,type:d,appContext:p}=n;let g;if(e[0]!=="$"){const y=h[e];if(y!==void 0)switch(y){case 1:return o[e];case 2:return l[e];case 4:return s[e];case 3:return a[e]}else{if(V$(o,e))return h[e]=1,o[e];if(l!==Pe&&he(l,e))return h[e]=2,l[e];if((g=n.propsOptions[0])&&he(g,e))return h[e]=3,a[e];if(s!==Pe&&he(s,e))return h[e]=4,s[e];H_&&(h[e]=0)}}const m=Ga[e];let T,b;if(m)return e==="$attrs"&&Hi(n,"get",e),m(n);if((T=d.__cssModules)&&(T=T[e]))return T;if(s!==Pe&&he(s,e))return h[e]=4,s[e];if(b=p.config.globalProperties,he(b,e))return b[e]},set({_:n},e,s){const{data:o,setupState:l,ctx:a}=n;return V$(l,e)?(l[e]=s,!0):o!==Pe&&he(o,e)?(o[e]=s,!0):he(n.props,e)||e[0]==="$"&&e.slice(1)in n?!1:(a[e]=s,!0)},has({_:{data:n,setupState:e,accessCache:s,ctx:o,appContext:l,propsOptions:a}},h){let d;return!!s[h]||n!==Pe&&he(n,h)||V$(e,h)||(d=a[0])&&he(d,h)||he(o,h)||he(Ga,h)||he(l.config.globalProperties,h)},defineProperty(n,e,s){return s.get!=null?n._.accessCache[e]=0:he(s,"value")&&this.set(n,e,s.value,null),Reflect.defineProperty(n,e,s)}};function FS(n){return zt(n)?n.reduce((e,s)=>(e[s]=null,e),{}):n}let H_=!0;function pL(n){const e=yb(n),s=n.proxy,o=n.ctx;H_=!1,e.beforeCreate&&US(e.beforeCreate,n,"bc");const{data:l,computed:a,methods:h,watch:d,provide:p,inject:g,created:m,beforeMount:T,mounted:b,beforeUpdate:y,updated:C,activated:L,deactivated:A,beforeDestroy:F,beforeUnmount:z,destroyed:X,unmounted:K,render:Y,renderTracked:V,renderTriggered:H,errorCaptured:Tt,serverPrefetch:$t,expose:lt,inheritAttrs:ot,components:ct,directives:gt,filters:vt}=e;if(g&&fL(g,o,null),h)for(const Rt in h){const Nt=h[Rt];Jt(Nt)&&(o[Rt]=Nt.bind(s))}if(l){const Rt=l.call(s,s);He(Rt)&&(n.data=bo(Rt))}if(H_=!0,a)for(const Rt in a){const Nt=a[Rt],me=Jt(Nt)?Nt.bind(s,s):Jt(Nt.get)?Nt.get.bind(s,s):is,Lt=!Jt(Nt)&&Jt(Nt.set)?Nt.set.bind(s):is,Gt=Nh({get:me,set:Lt});Object.defineProperty(o,Rt,{enumerable:!0,configurable:!0,get:()=>Gt.value,set:Ht=>Gt.value=Ht})}if(d)for(const Rt in d)o0(d[Rt],o,s,Rt);if(p){const Rt=Jt(p)?p.call(s):p;Reflect.ownKeys(Rt).forEach(Nt=>{bL(Nt,Rt[Nt])})}m&&US(m,n,"c");function Ft(Rt,Nt){zt(Nt)?Nt.forEach(me=>Rt(me.bind(s))):Nt&&Rt(Nt.bind(s))}if(Ft(sL,T),Ft(vb,b),Ft(oL,y),Ft(nL,C),Ft(tL,L),Ft(eL,A),Ft(hL,Tt),Ft(aL,V),Ft(cL,H),Ft(rL,z),Ft(i0,K),Ft(lL,$t),zt(lt))if(lt.length){const Rt=n.exposed||(n.exposed={});lt.forEach(Nt=>{Object.defineProperty(Rt,Nt,{get:()=>s[Nt],set:me=>s[Nt]=me})})}else n.exposed||(n.exposed={});Y&&n.render===is&&(n.render=Y),ot!=null&&(n.inheritAttrs=ot),ct&&(n.components=ct),gt&&(n.directives=gt)}function fL(n,e,s=is){zt(n)&&(n=V_(n));for(const o in n){const l=n[o];let a;He(l)?"default"in l?a=zd(l.from||o,l.default,!0):a=zd(l.from||o):a=zd(l),Vi(a)?Object.defineProperty(e,o,{enumerable:!0,configurable:!0,get:()=>a.value,set:h=>a.value=h}):e[o]=a}}function US(n,e,s){Rs(zt(n)?n.map(o=>o.bind(e.proxy)):n.bind(e.proxy),e,s)}function o0(n,e,s,o){const l=o.includes(".")?Qk(s,o):()=>s[o];if(Ye(n)){const a=e[n];Jt(a)&&Ha(l,a)}else if(Jt(n))Ha(l,n.bind(s));else if(He(n))if(zt(n))n.forEach(a=>o0(a,e,s,o));else{const a=Jt(n.handler)?n.handler.bind(s):e[n.handler];Jt(a)&&Ha(l,a,n)}}function yb(n){const e=n.type,{mixins:s,extends:o}=e,{mixins:l,optionsCache:a,config:{optionMergeStrategies:h}}=n.appContext,d=a.get(e);let p;return d?p=d:!l.length&&!s&&!o?p=e:(p={},l.length&&l.forEach(g=>dp(p,g,h,!0)),dp(p,e,h)),He(e)&&a.set(e,p),p}function dp(n,e,s,o=!1){const{mixins:l,extends:a}=e;a&&dp(n,a,s,!0),l&&l.forEach(h=>dp(n,h,s,!0));for(const h in e)if(!(o&&h==="expose")){const d=gL[h]||s&&s[h];n[h]=d?d(n[h],e[h]):e[h]}return n}const gL={data:HS,props:VS,emits:VS,methods:Ma,computed:Ma,beforeCreate:wi,created:wi,beforeMount:wi,mounted:wi,beforeUpdate:wi,updated:wi,beforeDestroy:wi,beforeUnmount:wi,destroyed:wi,unmounted:wi,activated:wi,deactivated:wi,errorCaptured:wi,serverPrefetch:wi,components:Ma,directives:Ma,watch:$L,provide:HS,inject:mL};function HS(n,e){return e?n?function(){return Ti(Jt(n)?n.call(this,this):n,Jt(e)?e.call(this,this):e)}:e:n}function mL(n,e){return Ma(V_(n),V_(e))}function V_(n){if(zt(n)){const e={};for(let s=0;s<n.length;s++)e[n[s]]=n[s];return e}return n}function wi(n,e){return n?[...new Set([].concat(n,e))]:e}function Ma(n,e){return n?Ti(Object.create(null),n,e):e}function VS(n,e){return n?zt(n)&&zt(e)?[...new Set([...n,...e])]:Ti(Object.create(null),FS(n),FS(e??{})):e}function $L(n,e){if(!n)return e;if(!e)return n;const s=Ti(Object.create(null),n);for(const o in e)s[o]=wi(n[o],e[o]);return s}function n0(){return{app:null,config:{isNativeTag:qR,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let _L=0;function TL(n,e){return function(o,l=null){Jt(o)||(o=Ti({},o)),l!=null&&!He(l)&&(l=null);const a=n0(),h=new WeakSet;let d=!1;const p=a.app={_uid:_L++,_component:o,_props:l,_container:null,_context:a,_instance:null,version:zL,get config(){return a.config},set config(g){},use(g,...m){return h.has(g)||(g&&Jt(g.install)?(h.add(g),g.install(p,...m)):Jt(g)&&(h.add(g),g(p,...m))),p},mixin(g){return a.mixins.includes(g)||a.mixins.push(g),p},component(g,m){return m?(a.components[g]=m,p):a.components[g]},directive(g,m){return m?(a.directives[g]=m,p):a.directives[g]},mount(g,m,T){if(!d){const b=Ae(o,l);return b.appContext=a,T===!0?T="svg":T===!1&&(T=void 0),m&&e?e(b,g):n(b,g,T),d=!0,p._container=g,g.__vue_app__=p,wb(b.component)||b.component.proxy}},unmount(){d&&(n(null,p._container),delete p._container.__vue_app__)},provide(g,m){return a.provides[g]=m,p},runWithContext(g){pp=p;try{return g()}finally{pp=null}}};return p}}let pp=null;function bL(n,e){if(gi){let s=gi.provides;const o=gi.parent&&gi.parent.provides;o===s&&(s=gi.provides=Object.create(o)),s[n]=e}}function zd(n,e,s=!1){const o=gi||Oi;if(o||pp){const l=o?o.parent==null?o.vnode.appContext&&o.vnode.appContext.provides:o.parent.provides:pp._context.provides;if(l&&n in l)return l[n];if(arguments.length>1)return s&&Jt(e)?e.call(o&&o.proxy):e}}function EL(n,e,s,o=!1){const l={},a={};ap(a,Hp,1),n.propsDefaults=Object.create(null),r0(n,e,l,a);for(const h in n.propsOptions[0])h in l||(l[h]=void 0);s?n.props=o?l:RN(l):n.type.props?n.props=l:n.props=a,n.attrs=a}function vL(n,e,s,o){const{props:l,attrs:a,vnode:{patchFlag:h}}=n,d=ge(l),[p]=n.propsOptions;let g=!1;if((o||h>0)&&!(h&16)){if(h&8){const m=n.vnode.dynamicProps;for(let T=0;T<m.length;T++){let b=m[T];if(Dp(n.emitsOptions,b))continue;const y=e[b];if(p)if(he(a,b))y!==a[b]&&(a[b]=y,g=!0);else{const C=To(b);l[C]=G_(p,d,C,y,n,!1)}else y!==a[b]&&(a[b]=y,g=!0)}}}else{r0(n,e,l,a)&&(g=!0);let m;for(const T in d)(!e||!he(e,T)&&((m=Oc(T))===T||!he(e,m)))&&(p?s&&(s[T]!==void 0||s[m]!==void 0)&&(l[T]=G_(p,d,T,void 0,n,!0)):delete l[T]);if(a!==d)for(const T in a)(!e||!he(e,T))&&(delete a[T],g=!0)}g&&Vo(n,"set","$attrs")}function r0(n,e,s,o){const[l,a]=n.propsOptions;let h=!1,d;if(e)for(let p in e){if(Gd(p))continue;const g=e[p];let m;l&&he(l,m=To(p))?!a||!a.includes(m)?s[m]=g:(d||(d={}))[m]=g:Dp(n.emitsOptions,p)||(!(p in o)||g!==o[p])&&(o[p]=g,h=!0)}if(a){const p=ge(s),g=d||Pe;for(let m=0;m<a.length;m++){const T=a[m];s[T]=G_(l,p,T,g[T],n,!he(g,T))}}return h}function G_(n,e,s,o,l,a){const h=n[s];if(h!=null){const d=he(h,"default");if(d&&o===void 0){const p=h.default;if(h.type!==Function&&!h.skipFactory&&Jt(p)){const{propsDefaults:g}=l;if(s in g)o=g[s];else{const m=Rh(l);o=g[s]=p.call(null,e),m()}}else o=p}h[0]&&(a&&!d?o=!1:h[1]&&(o===""||o===Oc(s))&&(o=!0))}return o}function l0(n,e,s=!1){const o=e.propsCache,l=o.get(n);if(l)return l;const a=n.props,h={},d=[];let p=!1;if(!Jt(n)){const m=T=>{p=!0;const[b,y]=l0(T,e,!0);Ti(h,b),y&&d.push(...y)};!s&&e.mixins.length&&e.mixins.forEach(m),n.extends&&m(n.extends),n.mixins&&n.mixins.forEach(m)}if(!a&&!p)return He(n)&&o.set(n,sc),sc;if(zt(a))for(let m=0;m<a.length;m++){const T=To(a[m]);GS(T)&&(h[T]=Pe)}else if(a)for(const m in a){const T=To(m);if(GS(T)){const b=a[m],y=h[T]=zt(b)||Jt(b)?{type:b}:Ti({},b);if(y){const C=XS(Boolean,y.type),L=XS(String,y.type);y[0]=C>-1,y[1]=L<0||C<L,(C>-1||he(y,"default"))&&d.push(T)}}}const g=[h,d];return He(n)&&o.set(n,g),g}function GS(n){return n[0]!=="$"}function WS(n){const e=n&&n.toString().match(/^\s*(function|class) (\w+)/);return e?e[2]:n===null?"null":""}function zS(n,e){return WS(n)===WS(e)}function XS(n,e){return zt(e)?e.findIndex(s=>zS(s,n)):Jt(e)&&zS(e,n)?0:-1}const c0=n=>n[0]==="_"||n==="$stable",Ib=n=>zt(n)?n.map(ao):[ao(n)],yL=(n,e,s)=>{if(e._n)return e;const o=La((...l)=>Ib(e(...l)),s);return o._c=!1,o},a0=(n,e,s)=>{const o=n._ctx;for(const l in n){if(c0(l))continue;const a=n[l];if(Jt(a))e[l]=yL(l,a,o);else if(a!=null){const h=Ib(a);e[l]=()=>h}}},h0=(n,e)=>{const s=Ib(e);n.slots.default=()=>s},IL=(n,e)=>{if(n.vnode.shapeFlag&32){const s=e._;s?(n.slots=ge(e),ap(e,"_",s)):a0(e,n.slots={})}else n.slots={},e&&h0(n,e);ap(n.slots,Hp,1)},SL=(n,e,s)=>{const{vnode:o,slots:l}=n;let a=!0,h=Pe;if(o.shapeFlag&32){const d=e._;d?s&&d===1?a=!1:(Ti(l,e),!s&&d===1&&delete l._):(a=!e.$stable,a0(e,l)),h=e}else e&&(h0(n,e),h={default:1});if(a)for(const d in l)!c0(d)&&h[d]==null&&delete l[d]};function W_(n,e,s,o,l=!1){if(zt(n)){n.forEach((b,y)=>W_(b,e&&(zt(e)?e[y]:e),s,o,l));return}if(Va(o)&&!l)return;const a=o.shapeFlag&4?wb(o.component)||o.component.proxy:o.el,h=l?null:a,{i:d,r:p}=n,g=e&&e.r,m=d.refs===Pe?d.refs={}:d.refs,T=d.setupState;if(g!=null&&g!==p&&(Ye(g)?(m[g]=null,he(T,g)&&(T[g]=null)):Vi(g)&&(g.value=null)),Jt(p))Mn(p,d,12,[h,m]);else{const b=Ye(p),y=Vi(p),C=n.f;if(b||y){const L=()=>{if(C){const A=b?he(T,p)?T[p]:m[p]:p.value;l?zt(A)&&ab(A,a):zt(A)?A.includes(a)||A.push(a):b?(m[p]=[a],he(T,p)&&(T[p]=m[p])):(p.value=[a],n.k&&(m[n.k]=p.value))}else b?(m[p]=h,he(T,p)&&(T[p]=h)):y&&(p.value=h,n.k&&(m[n.k]=h))};l||C?L():(L.id=-1,Fi(L,s))}}}const Fi=JN;function CL(n){return wL(n)}function wL(n,e){const s=Ek();s.__VUE__=!0;const{insert:o,remove:l,patchProp:a,createElement:h,createText:d,createComment:p,setText:g,setElementText:m,parentNode:T,nextSibling:b,setScopeId:y=is,insertStaticContent:C}=n,L=(w,N,G,q=null,Z=null,st=null,ht=void 0,et=null,dt=!!N.dynamicChildren)=>{if(w===N)return;w&&!Ca(w,N)&&(q=xe(w),Ht(w,Z,st,!0),w=null),N.patchFlag===-2&&(dt=!1,N.dynamicChildren=null);const{type:j,ref:R,shapeFlag:J}=N;switch(j){case Up:A(w,N,G,q);break;case Fn:F(w,N,G,q);break;case Xd:w==null&&z(N,G,q,ht);break;case ri:ct(w,N,G,q,Z,st,ht,et,dt);break;default:J&1?Y(w,N,G,q,Z,st,ht,et,dt):J&6?gt(w,N,G,q,Z,st,ht,et,dt):(J&64||J&128)&&j.process(w,N,G,q,Z,st,ht,et,dt,Ke)}R!=null&&Z&&W_(R,w&&w.ref,st,N||w,!N)},A=(w,N,G,q)=>{if(w==null)o(N.el=d(N.children),G,q);else{const Z=N.el=w.el;N.children!==w.children&&g(Z,N.children)}},F=(w,N,G,q)=>{w==null?o(N.el=p(N.children||""),G,q):N.el=w.el},z=(w,N,G,q)=>{[w.el,w.anchor]=C(w.children,N,G,q,w.el,w.anchor)},X=({el:w,anchor:N},G,q)=>{let Z;for(;w&&w!==N;)Z=b(w),o(w,G,q),w=Z;o(N,G,q)},K=({el:w,anchor:N})=>{let G;for(;w&&w!==N;)G=b(w),l(w),w=G;l(N)},Y=(w,N,G,q,Z,st,ht,et,dt)=>{N.type==="svg"?ht="svg":N.type==="math"&&(ht="mathml"),w==null?V(N,G,q,Z,st,ht,et,dt):$t(w,N,Z,st,ht,et,dt)},V=(w,N,G,q,Z,st,ht,et)=>{let dt,j;const{props:R,shapeFlag:J,transition:kt,dirs:mt}=w;if(dt=w.el=h(w.type,st,R&&R.is,R),J&8?m(dt,w.children):J&16&&Tt(w.children,dt,null,q,Z,G$(w,st),ht,et),mt&&kr(w,null,q,"created"),H(dt,w,w.scopeId,ht,q),R){for(const Ct in R)Ct!=="value"&&!Gd(Ct)&&a(dt,Ct,null,R[Ct],st,w.children,q,Z,_e);"value"in R&&a(dt,"value",null,R.value,st),(j=R.onVnodeBeforeMount)&&oo(j,q,w)}mt&&kr(w,null,q,"beforeMount");const Vt=kL(Z,kt);Vt&&kt.beforeEnter(dt),o(dt,N,G),((j=R&&R.onVnodeMounted)||Vt||mt)&&Fi(()=>{j&&oo(j,q,w),Vt&&kt.enter(dt),mt&&kr(w,null,q,"mounted")},Z)},H=(w,N,G,q,Z)=>{if(G&&y(w,G),q)for(let st=0;st<q.length;st++)y(w,q[st]);if(Z){let st=Z.subTree;if(N===st){const ht=Z.vnode;H(w,ht,ht.scopeId,ht.slotScopeIds,Z.parent)}}},Tt=(w,N,G,q,Z,st,ht,et,dt=0)=>{for(let j=dt;j<w.length;j++){const R=w[j]=et?Cn(w[j]):ao(w[j]);L(null,R,N,G,q,Z,st,ht,et)}},$t=(w,N,G,q,Z,st,ht)=>{const et=N.el=w.el;let{patchFlag:dt,dynamicChildren:j,dirs:R}=N;dt|=w.patchFlag&16;const J=w.props||Pe,kt=N.props||Pe;let mt;if(G&&Or(G,!1),(mt=kt.onVnodeBeforeUpdate)&&oo(mt,G,N,w),R&&kr(N,w,G,"beforeUpdate"),G&&Or(G,!0),j?lt(w.dynamicChildren,j,et,G,q,G$(N,Z),st):ht||Nt(w,N,et,null,G,q,G$(N,Z),st,!1),dt>0){if(dt&16)ot(et,N,J,kt,G,q,Z);else if(dt&2&&J.class!==kt.class&&a(et,"class",null,kt.class,Z),dt&4&&a(et,"style",J.style,kt.style,Z),dt&8){const Vt=N.dynamicProps;for(let Ct=0;Ct<Vt.length;Ct++){const Qt=Vt[Ct],k=J[Qt],_=kt[Qt];(_!==k||Qt==="value")&&a(et,Qt,k,_,Z,w.children,G,q,_e)}}dt&1&&w.children!==N.children&&m(et,N.children)}else!ht&&j==null&&ot(et,N,J,kt,G,q,Z);((mt=kt.onVnodeUpdated)||R)&&Fi(()=>{mt&&oo(mt,G,N,w),R&&kr(N,w,G,"updated")},q)},lt=(w,N,G,q,Z,st,ht)=>{for(let et=0;et<N.length;et++){const dt=w[et],j=N[et],R=dt.el&&(dt.type===ri||!Ca(dt,j)||dt.shapeFlag&70)?T(dt.el):G;L(dt,j,R,null,q,Z,st,ht,!0)}},ot=(w,N,G,q,Z,st,ht)=>{if(G!==q){if(G!==Pe)for(const et in G)!Gd(et)&&!(et in q)&&a(w,et,G[et],null,ht,N.children,Z,st,_e);for(const et in q){if(Gd(et))continue;const dt=q[et],j=G[et];dt!==j&&et!=="value"&&a(w,et,j,dt,ht,N.children,Z,st,_e)}"value"in q&&a(w,"value",G.value,q.value,ht)}},ct=(w,N,G,q,Z,st,ht,et,dt)=>{const j=N.el=w?w.el:d(""),R=N.anchor=w?w.anchor:d("");let{patchFlag:J,dynamicChildren:kt,slotScopeIds:mt}=N;mt&&(et=et?et.concat(mt):mt),w==null?(o(j,G,q),o(R,G,q),Tt(N.children||[],G,R,Z,st,ht,et,dt)):J>0&&J&64&&kt&&w.dynamicChildren?(lt(w.dynamicChildren,kt,G,Z,st,ht,et),(N.key!=null||Z&&N===Z.subTree)&&u0(w,N,!0)):Nt(w,N,G,R,Z,st,ht,et,dt)},gt=(w,N,G,q,Z,st,ht,et,dt)=>{N.slotScopeIds=et,w==null?N.shapeFlag&512?Z.ctx.activate(N,G,q,ht,dt):vt(N,G,q,Z,st,ht,dt):it(w,N,dt)},vt=(w,N,G,q,Z,st,ht)=>{const et=w.component=BL(w,q,Z);if(t0(w)&&(et.ctx.renderer=Ke),FL(et),et.asyncDep){if(Z&&Z.registerDep(et,Ft),!w.el){const dt=et.subTree=Ae(Fn);F(null,dt,N,G)}}else Ft(et,w,N,G,Z,st,ht)},it=(w,N,G)=>{const q=N.component=w.component;if(zN(w,N,G))if(q.asyncDep&&!q.asyncResolved){Rt(q,N,G);return}else q.next=N,FN(q.update),q.effect.dirty=!0,q.update();else N.el=w.el,q.vnode=N},Ft=(w,N,G,q,Z,st,ht)=>{const et=()=>{if(w.isMounted){let{next:R,bu:J,u:kt,parent:mt,vnode:Vt}=w;{const I=d0(w);if(I){R&&(R.el=Vt.el,Rt(w,R,ht)),I.asyncDep.then(()=>{w.isUnmounted||et()});return}}let Ct=R,Qt;Or(w,!1),R?(R.el=Vt.el,Rt(w,R,ht)):R=Vt,J&&F$(J),(Qt=R.props&&R.props.onVnodeBeforeUpdate)&&oo(Qt,mt,R,Vt),Or(w,!0);const k=H$(w),_=w.subTree;w.subTree=k,L(_,k,T(_.el),xe(_),w,Z,st),R.el=k.el,Ct===null&&XN(w,k.el),kt&&Fi(kt,Z),(Qt=R.props&&R.props.onVnodeUpdated)&&Fi(()=>oo(Qt,mt,R,Vt),Z)}else{let R;const{el:J,props:kt}=N,{bm:mt,m:Vt,parent:Ct}=w,Qt=Va(N);if(Or(w,!1),mt&&F$(mt),!Qt&&(R=kt&&kt.onVnodeBeforeMount)&&oo(R,Ct,N),Or(w,!0),J&&yt){const k=()=>{w.subTree=H$(w),yt(J,w.subTree,w,Z,null)};Qt?N.type.__asyncLoader().then(()=>!w.isUnmounted&&k()):k()}else{const k=w.subTree=H$(w);L(null,k,G,q,w,Z,st),N.el=k.el}if(Vt&&Fi(Vt,Z),!Qt&&(R=kt&&kt.onVnodeMounted)){const k=N;Fi(()=>oo(R,Ct,k),Z)}(N.shapeFlag&256||Ct&&Va(Ct.vnode)&&Ct.vnode.shapeFlag&256)&&w.a&&Fi(w.a,Z),w.isMounted=!0,N=G=q=null}},dt=w.effect=new pb(et,is,()=>Eb(j),w.scope),j=w.update=()=>{dt.dirty&&dt.run()};j.id=w.uid,Or(w,!0),j()},Rt=(w,N,G)=>{N.component=w;const q=w.vnode.props;w.vnode=N,w.next=null,vL(w,N.props,q,G),SL(w,N.children,G),Xr(),DS(w),Yr()},Nt=(w,N,G,q,Z,st,ht,et,dt=!1)=>{const j=w&&w.children,R=w?w.shapeFlag:0,J=N.children,{patchFlag:kt,shapeFlag:mt}=N;if(kt>0){if(kt&128){Lt(j,J,G,q,Z,st,ht,et,dt);return}else if(kt&256){me(j,J,G,q,Z,st,ht,et,dt);return}}mt&8?(R&16&&_e(j,Z,st),J!==j&&m(G,J)):R&16?mt&16?Lt(j,J,G,q,Z,st,ht,et,dt):_e(j,Z,st,!0):(R&8&&m(G,""),mt&16&&Tt(J,G,q,Z,st,ht,et,dt))},me=(w,N,G,q,Z,st,ht,et,dt)=>{w=w||sc,N=N||sc;const j=w.length,R=N.length,J=Math.min(j,R);let kt;for(kt=0;kt<J;kt++){const mt=N[kt]=dt?Cn(N[kt]):ao(N[kt]);L(w[kt],mt,G,null,Z,st,ht,et,dt)}j>R?_e(w,Z,st,!0,!1,J):Tt(N,G,q,Z,st,ht,et,dt,J)},Lt=(w,N,G,q,Z,st,ht,et,dt)=>{let j=0;const R=N.length;let J=w.length-1,kt=R-1;for(;j<=J&&j<=kt;){const mt=w[j],Vt=N[j]=dt?Cn(N[j]):ao(N[j]);if(Ca(mt,Vt))L(mt,Vt,G,null,Z,st,ht,et,dt);else break;j++}for(;j<=J&&j<=kt;){const mt=w[J],Vt=N[kt]=dt?Cn(N[kt]):ao(N[kt]);if(Ca(mt,Vt))L(mt,Vt,G,null,Z,st,ht,et,dt);else break;J--,kt--}if(j>J){if(j<=kt){const mt=kt+1,Vt=mt<R?N[mt].el:q;for(;j<=kt;)L(null,N[j]=dt?Cn(N[j]):ao(N[j]),G,Vt,Z,st,ht,et,dt),j++}}else if(j>kt)for(;j<=J;)Ht(w[j],Z,st,!0),j++;else{const mt=j,Vt=j,Ct=new Map;for(j=Vt;j<=kt;j++){const Pt=N[j]=dt?Cn(N[j]):ao(N[j]);Pt.key!=null&&Ct.set(Pt.key,j)}let Qt,k=0;const _=kt-Vt+1;let I=!1,M=0;const P=new Array(_);for(j=0;j<_;j++)P[j]=0;for(j=mt;j<=J;j++){const Pt=w[j];if(k>=_){Ht(Pt,Z,st,!0);continue}let te;if(Pt.key!=null)te=Ct.get(Pt.key);else for(Qt=Vt;Qt<=kt;Qt++)if(P[Qt-Vt]===0&&Ca(Pt,N[Qt])){te=Qt;break}te===void 0?Ht(Pt,Z,st,!0):(P[te-Vt]=j+1,te>=M?M=te:I=!0,L(Pt,N[te],G,null,Z,st,ht,et,dt),k++)}const nt=I?OL(P):sc;for(Qt=nt.length-1,j=_-1;j>=0;j--){const Pt=Vt+j,te=N[Pt],bi=Pt+1<R?N[Pt+1].el:q;P[j]===0?L(null,te,G,bi,Z,st,ht,et,dt):I&&(Qt<0||j!==nt[Qt]?Gt(te,G,bi,2):Qt--)}}},Gt=(w,N,G,q,Z=null)=>{const{el:st,type:ht,transition:et,children:dt,shapeFlag:j}=w;if(j&6){Gt(w.component.subTree,N,G,q);return}if(j&128){w.suspense.move(N,G,q);return}if(j&64){ht.move(w,N,G,Ke);return}if(ht===ri){o(st,N,G);for(let J=0;J<dt.length;J++)Gt(dt[J],N,G,q);o(w.anchor,N,G);return}if(ht===Xd){X(w,N,G);return}if(q!==2&&j&1&&et)if(q===0)et.beforeEnter(st),o(st,N,G),Fi(()=>et.enter(st),Z);else{const{leave:J,delayLeave:kt,afterLeave:mt}=et,Vt=()=>o(st,N,G),Ct=()=>{J(st,()=>{Vt(),mt&&mt()})};kt?kt(st,Vt,Ct):Ct()}else o(st,N,G)},Ht=(w,N,G,q=!1,Z=!1)=>{const{type:st,props:ht,ref:et,children:dt,dynamicChildren:j,shapeFlag:R,patchFlag:J,dirs:kt}=w;if(et!=null&&W_(et,null,G,w,!0),R&256){N.ctx.deactivate(w);return}const mt=R&1&&kt,Vt=!Va(w);let Ct;if(Vt&&(Ct=ht&&ht.onVnodeBeforeUnmount)&&oo(Ct,N,w),R&6)be(w.component,G,q);else{if(R&128){w.suspense.unmount(G,q);return}mt&&kr(w,null,N,"beforeUnmount"),R&64?w.type.remove(w,N,G,Z,Ke,q):j&&(st!==ri||J>0&&J&64)?_e(j,N,G,!1,!0):(st===ri&&J&384||!Z&&R&16)&&_e(dt,N,G),q&&fe(w)}(Vt&&(Ct=ht&&ht.onVnodeUnmounted)||mt)&&Fi(()=>{Ct&&oo(Ct,N,w),mt&&kr(w,null,N,"unmounted")},G)},fe=w=>{const{type:N,el:G,anchor:q,transition:Z}=w;if(N===ri){ut(G,q);return}if(N===Xd){K(w);return}const st=()=>{l(G),Z&&!Z.persisted&&Z.afterLeave&&Z.afterLeave()};if(w.shapeFlag&1&&Z&&!Z.persisted){const{leave:ht,delayLeave:et}=Z,dt=()=>ht(G,st);et?et(w.el,st,dt):dt()}else st()},ut=(w,N)=>{let G;for(;w!==N;)G=b(w),l(w),w=G;l(N)},be=(w,N,G)=>{const{bum:q,scope:Z,update:st,subTree:ht,um:et}=w;q&&F$(q),Z.stop(),st&&(st.active=!1,Ht(ht,w,N,G)),et&&Fi(et,N),Fi(()=>{w.isUnmounted=!0},N),N&&N.pendingBranch&&!N.isUnmounted&&w.asyncDep&&!w.asyncResolved&&w.suspenseId===N.pendingId&&(N.deps--,N.deps===0&&N.resolve())},_e=(w,N,G,q=!1,Z=!1,st=0)=>{for(let ht=st;ht<w.length;ht++)Ht(w[ht],N,G,q,Z)},xe=w=>w.shapeFlag&6?xe(w.component.subTree):w.shapeFlag&128?w.suspense.next():b(w.anchor||w.el);let Ee=!1;const ai=(w,N,G)=>{w==null?N._vnode&&Ht(N._vnode,null,null,!0):L(N._vnode||null,w,N,null,null,null,G),Ee||(Ee=!0,DS(),zk(),Ee=!1),N._vnode=w},Ke={p:L,um:Ht,m:Gt,r:fe,mt:vt,mc:Tt,pc:Nt,pbc:lt,n:xe,o:n};let hi,yt;return e&&([hi,yt]=e(Ke)),{render:ai,hydrate:hi,createApp:TL(ai,hi)}}function G$({type:n,props:e},s){return s==="svg"&&n==="foreignObject"||s==="mathml"&&n==="annotation-xml"&&e&&e.encoding&&e.encoding.includes("html")?void 0:s}function Or({effect:n,update:e},s){n.allowRecurse=e.allowRecurse=s}function kL(n,e){return(!n||n&&!n.pendingBranch)&&e&&!e.persisted}function u0(n,e,s=!1){const o=n.children,l=e.children;if(zt(o)&&zt(l))for(let a=0;a<o.length;a++){const h=o[a];let d=l[a];d.shapeFlag&1&&!d.dynamicChildren&&((d.patchFlag<=0||d.patchFlag===32)&&(d=l[a]=Cn(l[a]),d.el=h.el),s||u0(h,d)),d.type===Up&&(d.el=h.el)}}function OL(n){const e=n.slice(),s=[0];let o,l,a,h,d;const p=n.length;for(o=0;o<p;o++){const g=n[o];if(g!==0){if(l=s[s.length-1],n[l]<g){e[o]=l,s.push(o);continue}for(a=0,h=s.length-1;a<h;)d=a+h>>1,n[s[d]]<g?a=d+1:h=d;g<n[s[a]]&&(a>0&&(e[o]=s[a-1]),s[a]=o)}}for(a=s.length,h=s[a-1];a-- >0;)s[a]=h,h=e[h];return s}function d0(n){const e=n.subTree.component;if(e)return e.asyncDep&&!e.asyncResolved?e:d0(e)}const AL=n=>n.__isTeleport,ri=Symbol.for("v-fgt"),Up=Symbol.for("v-txt"),Fn=Symbol.for("v-cmt"),Xd=Symbol.for("v-stc"),Wa=[];let As=null;function Zt(n=!1){Wa.push(As=n?null:[])}function RL(){Wa.pop(),As=Wa[Wa.length-1]||null}let Th=1;function YS(n){Th+=n}function p0(n){return n.dynamicChildren=Th>0?As||sc:null,RL(),Th>0&&As&&As.push(n),n}function se(n,e,s,o,l,a){return p0(_t(n,e,s,o,l,a,!0))}function Sb(n,e,s,o,l){return p0(Ae(n,e,s,o,l,!0))}function f0(n){return n?n.__v_isVNode===!0:!1}function Ca(n,e){return n.type===e.type&&n.key===e.key}const Hp="__vInternal",g0=({key:n})=>n??null,Yd=({ref:n,ref_key:e,ref_for:s})=>(typeof n=="number"&&(n=""+n),n!=null?Ye(n)||Vi(n)||Jt(n)?{i:Oi,r:n,k:e,f:!!s}:n:null);function _t(n,e=null,s=null,o=0,l=null,a=n===ri?0:1,h=!1,d=!1){const p={__v_isVNode:!0,__v_skip:!0,type:n,props:e,key:e&&g0(e),ref:e&&Yd(e),scopeId:Pp,slotScopeIds:null,children:s,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:a,patchFlag:o,dynamicProps:l,dynamicChildren:null,appContext:null,ctx:Oi};return d?(Cb(p,s),a&128&&n.normalize(p)):s&&(p.shapeFlag|=Ye(s)?8:16),Th>0&&!h&&As&&(p.patchFlag>0||a&6)&&p.patchFlag!==32&&As.push(p),p}const Ae=NL;function NL(n,e=null,s=null,o=0,l=null,a=!1){if((!n||n===qk)&&(n=Fn),f0(n)){const d=dc(n,e,!0);return s&&Cb(d,s),Th>0&&!a&&As&&(d.shapeFlag&6?As[As.indexOf(n)]=d:As.push(d)),d.patchFlag|=-2,d}if(WL(n)&&(n=n.__vccOpts),e){e=LL(e);let{class:d,style:p}=e;d&&!Ye(d)&&(e.class=db(d)),He(p)&&(Pk(p)&&!zt(p)&&(p=Ti({},p)),e.style=ub(p))}const h=Ye(n)?1:jN(n)?128:AL(n)?64:He(n)?4:Jt(n)?2:0;return _t(n,e,s,o,l,h,a,!0)}function LL(n){return n?Pk(n)||Hp in n?Ti({},n):n:null}function dc(n,e,s=!1){const{props:o,ref:l,patchFlag:a,children:h}=n,d=e?xL(o||{},e):o;return{__v_isVNode:!0,__v_skip:!0,type:n.type,props:d,key:d&&g0(d),ref:e&&e.ref?s&&l?zt(l)?l.concat(Yd(e)):[l,Yd(e)]:Yd(e):l,scopeId:n.scopeId,slotScopeIds:n.slotScopeIds,children:h,target:n.target,targetAnchor:n.targetAnchor,staticCount:n.staticCount,shapeFlag:n.shapeFlag,patchFlag:e&&n.type!==ri?a===-1?16:a|16:a,dynamicProps:n.dynamicProps,dynamicChildren:n.dynamicChildren,appContext:n.appContext,dirs:n.dirs,transition:n.transition,component:n.component,suspense:n.suspense,ssContent:n.ssContent&&dc(n.ssContent),ssFallback:n.ssFallback&&dc(n.ssFallback),el:n.el,anchor:n.anchor,ctx:n.ctx,ce:n.ce}}function tc(n=" ",e=0){return Ae(Up,null,n,e)}function ML(n,e){const s=Ae(Xd,null,n);return s.staticCount=e,s}function za(n="",e=!1){return e?(Zt(),Sb(Fn,null,n)):Ae(Fn,null,n)}function ao(n){return n==null||typeof n=="boolean"?Ae(Fn):zt(n)?Ae(ri,null,n.slice()):typeof n=="object"?Cn(n):Ae(Up,null,String(n))}function Cn(n){return n.el===null&&n.patchFlag!==-1||n.memo?n:dc(n)}function Cb(n,e){let s=0;const{shapeFlag:o}=n;if(e==null)e=null;else if(zt(e))s=16;else if(typeof e=="object")if(o&65){const l=e.default;l&&(l._c&&(l._d=!1),Cb(n,l()),l._c&&(l._d=!0));return}else{s=32;const l=e._;!l&&!(Hp in e)?e._ctx=Oi:l===3&&Oi&&(Oi.slots._===1?e._=1:(e._=2,n.patchFlag|=1024))}else Jt(e)?(e={default:e,_ctx:Oi},s=32):(e=String(e),o&64?(s=16,e=[tc(e)]):s=8);n.children=e,n.shapeFlag|=s}function xL(...n){const e={};for(let s=0;s<n.length;s++){const o=n[s];for(const l in o)if(l==="class")e.class!==o.class&&(e.class=db([e.class,o.class]));else if(l==="style")e.style=ub([e.style,o.style]);else if(Ap(l)){const a=e[l],h=o[l];h&&a!==h&&!(zt(a)&&a.includes(h))&&(e[l]=a?[].concat(a,h):h)}else l!==""&&(e[l]=o[l])}return e}function oo(n,e,s,o=null){Rs(n,e,7,[s,o])}const DL=n0();let PL=0;function BL(n,e,s){const o=n.type,l=(e?e.appContext:n.appContext)||DL,a={uid:PL++,vnode:n,type:o,parent:e,appContext:l,root:null,next:null,subTree:null,effect:null,update:null,scope:new aN(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:e?e.provides:Object.create(l.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:l0(o,l),emitsOptions:Yk(o,l),emit:null,emitted:null,propsDefaults:Pe,inheritAttrs:o.inheritAttrs,ctx:Pe,data:Pe,props:Pe,attrs:Pe,slots:Pe,refs:Pe,setupState:Pe,setupContext:null,attrsProxy:null,slotsProxy:null,suspense:s,suspenseId:s?s.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return a.ctx={_:a},a.root=e?e.root:a,a.emit=VN.bind(null,a),n.ce&&n.ce(a),a}let gi=null,fp,z_;{const n=Ek(),e=(s,o)=>{let l;return(l=n[s])||(l=n[s]=[]),l.push(o),a=>{l.length>1?l.forEach(h=>h(a)):l[0](a)}};fp=e("__VUE_INSTANCE_SETTERS__",s=>gi=s),z_=e("__VUE_SSR_SETTERS__",s=>Vp=s)}const Rh=n=>{const e=gi;return fp(n),n.scope.on(),()=>{n.scope.off(),fp(e)}},KS=()=>{gi&&gi.scope.off(),fp(null)};function m0(n){return n.vnode.shapeFlag&4}let Vp=!1;function FL(n,e=!1){e&&z_(e);const{props:s,children:o}=n.vnode,l=m0(n);EL(n,s,l,e),IL(n,o);const a=l?UL(n,e):void 0;return e&&z_(!1),a}function UL(n,e){const s=n.type;n.accessCache=Object.create(null),n.proxy=Bk(new Proxy(n.ctx,dL));const{setup:o}=s;if(o){const l=n.setupContext=o.length>1?VL(n):null,a=Rh(n);Xr();const h=Mn(o,n,0,[n.props,l]);if(Yr(),a(),_k(h)){if(h.then(KS,KS),e)return h.then(d=>{jS(n,d,e)}).catch(d=>{xp(d,n,0)});n.asyncDep=h}else jS(n,h,e)}else $0(n,e)}function jS(n,e,s){Jt(e)?n.type.__ssrInlineRender?n.ssrRender=e:n.render=e:He(e)&&(n.setupState=Vk(e)),$0(n,s)}let JS;function $0(n,e,s){const o=n.type;if(!n.render){if(!e&&JS&&!o.render){const l=o.template||yb(n).template;if(l){const{isCustomElement:a,compilerOptions:h}=n.appContext.config,{delimiters:d,compilerOptions:p}=o,g=Ti(Ti({isCustomElement:a,delimiters:d},h),p);o.render=JS(l,g)}}n.render=o.render||is}{const l=Rh(n);Xr();try{pL(n)}finally{Yr(),l()}}}function HL(n){return n.attrsProxy||(n.attrsProxy=new Proxy(n.attrs,{get(e,s){return Hi(n,"get","$attrs"),e[s]}}))}function VL(n){const e=s=>{n.exposed=s||{}};return{get attrs(){return HL(n)},slots:n.slots,emit:n.emit,expose:e}}function wb(n){if(n.exposed)return n.exposeProxy||(n.exposeProxy=new Proxy(Vk(Bk(n.exposed)),{get(e,s){if(s in e)return e[s];if(s in Ga)return Ga[s](n)},has(e,s){return s in e||s in Ga}}))}function GL(n,e=!0){return Jt(n)?n.displayName||n.name:n.name||e&&n.__name}function WL(n){return Jt(n)&&"__vccOpts"in n}const Nh=(n,e)=>NN(n,e,Vp),zL="3.4.15";/**
* @vue/runtime-dom v3.4.15
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/const XL="http://www.w3.org/2000/svg",YL="http://www.w3.org/1998/Math/MathML",wn=typeof document<"u"?document:null,qS=wn&&wn.createElement("template"),KL={insert:(n,e,s)=>{e.insertBefore(n,s||null)},remove:n=>{const e=n.parentNode;e&&e.removeChild(n)},createElement:(n,e,s,o)=>{const l=e==="svg"?wn.createElementNS(XL,n):e==="mathml"?wn.createElementNS(YL,n):wn.createElement(n,s?{is:s}:void 0);return n==="select"&&o&&o.multiple!=null&&l.setAttribute("multiple",o.multiple),l},createText:n=>wn.createTextNode(n),createComment:n=>wn.createComment(n),setText:(n,e)=>{n.nodeValue=e},setElementText:(n,e)=>{n.textContent=e},parentNode:n=>n.parentNode,nextSibling:n=>n.nextSibling,querySelector:n=>wn.querySelector(n),setScopeId(n,e){n.setAttribute(e,"")},insertStaticContent(n,e,s,o,l,a){const h=s?s.previousSibling:e.lastChild;if(l&&(l===a||l.nextSibling))for(;e.insertBefore(l.cloneNode(!0),s),!(l===a||!(l=l.nextSibling)););else{qS.innerHTML=o==="svg"?`<svg>${n}</svg>`:o==="mathml"?`<math>${n}</math>`:n;const d=qS.content;if(o==="svg"||o==="mathml"){const p=d.firstChild;for(;p.firstChild;)d.appendChild(p.firstChild);d.removeChild(p)}e.insertBefore(d,s)}return[h?h.nextSibling:e.firstChild,s?s.previousSibling:e.lastChild]}},jL=Symbol("_vtc");function JL(n,e,s){const o=n[jL];o&&(e=(e?[e,...o]:[...o]).join(" ")),e==null?n.removeAttribute("class"):s?n.setAttribute("class",e):n.className=e}const qL=Symbol("_vod"),ZL=Symbol("");function QL(n,e,s){const o=n.style,l=o.display,a=Ye(s);if(s&&!a){if(e&&!Ye(e))for(const h in e)s[h]==null&&X_(o,h,"");for(const h in s)X_(o,h,s[h])}else if(a){if(e!==s){const h=o[ZL];h&&(s+=";"+h),o.cssText=s}}else e&&n.removeAttribute("style");qL in n&&(o.display=l)}const ZS=/\s*!important$/;function X_(n,e,s){if(zt(s))s.forEach(o=>X_(n,e,o));else if(s==null&&(s=""),e.startsWith("--"))n.setProperty(e,s);else{const o=tM(n,e);ZS.test(s)?n.setProperty(Oc(o),s.replace(ZS,""),"important"):n[o]=s}}const QS=["Webkit","Moz","ms"],W$={};function tM(n,e){const s=W$[e];if(s)return s;let o=To(e);if(o!=="filter"&&o in n)return W$[e]=o;o=Lp(o);for(let l=0;l<QS.length;l++){const a=QS[l]+o;if(a in n)return W$[e]=a}return e}const tC="http://www.w3.org/1999/xlink";function eM(n,e,s,o,l){if(o&&e.startsWith("xlink:"))s==null?n.removeAttributeNS(tC,e.slice(6,e.length)):n.setAttributeNS(tC,e,s);else{const a=cN(e);s==null||a&&!vk(s)?n.removeAttribute(e):n.setAttribute(e,a?"":s)}}function iM(n,e,s,o,l,a,h){if(e==="innerHTML"||e==="textContent"){o&&h(o,l,a),n[e]=s??"";return}const d=n.tagName;if(e==="value"&&d!=="PROGRESS"&&!d.includes("-")){n._value=s;const g=d==="OPTION"?n.getAttribute("value"):n.value,m=s??"";g!==m&&(n.value=m),s==null&&n.removeAttribute(e);return}let p=!1;if(s===""||s==null){const g=typeof n[e];g==="boolean"?s=vk(s):s==null&&g==="string"?(s="",p=!0):g==="number"&&(s=0,p=!0)}try{n[e]=s}catch{}p&&n.removeAttribute(e)}function sM(n,e,s,o){n.addEventListener(e,s,o)}function oM(n,e,s,o){n.removeEventListener(e,s,o)}const eC=Symbol("_vei");function nM(n,e,s,o,l=null){const a=n[eC]||(n[eC]={}),h=a[e];if(o&&h)h.value=o;else{const[d,p]=rM(e);if(o){const g=a[e]=aM(o,l);sM(n,d,g,p)}else h&&(oM(n,d,h,p),a[e]=void 0)}}const iC=/(?:Once|Passive|Capture)$/;function rM(n){let e;if(iC.test(n)){e={};let o;for(;o=n.match(iC);)n=n.slice(0,n.length-o[0].length),e[o[0].toLowerCase()]=!0}return[n[2]===":"?n.slice(3):Oc(n.slice(2)),e]}let z$=0;const lM=Promise.resolve(),cM=()=>z$||(lM.then(()=>z$=0),z$=Date.now());function aM(n,e){const s=o=>{if(!o._vts)o._vts=Date.now();else if(o._vts<=s.attached)return;Rs(hM(o,s.value),e,5,[o])};return s.value=n,s.attached=cM(),s}function hM(n,e){if(zt(e)){const s=n.stopImmediatePropagation;return n.stopImmediatePropagation=()=>{s.call(n),n._stopped=!0},e.map(o=>l=>!l._stopped&&o&&o(l))}else return e}const sC=n=>n.charCodeAt(0)===111&&n.charCodeAt(1)===110&&n.charCodeAt(2)>96&&n.charCodeAt(2)<123,uM=(n,e,s,o,l,a,h,d,p)=>{const g=l==="svg";e==="class"?JL(n,o,g):e==="style"?QL(n,s,o):Ap(e)?cb(e)||nM(n,e,s,o,h):(e[0]==="."?(e=e.slice(1),!0):e[0]==="^"?(e=e.slice(1),!1):dM(n,e,o,g))?iM(n,e,o,a,h,d,p):(e==="true-value"?n._trueValue=o:e==="false-value"&&(n._falseValue=o),eM(n,e,o,g))};function dM(n,e,s,o){if(o)return!!(e==="innerHTML"||e==="textContent"||e in n&&sC(e)&&Jt(s));if(e==="spellcheck"||e==="draggable"||e==="translate"||e==="form"||e==="list"&&n.tagName==="INPUT"||e==="type"&&n.tagName==="TEXTAREA")return!1;if(e==="width"||e==="height"){const l=n.tagName;if(l==="IMG"||l==="VIDEO"||l==="CANVAS"||l==="SOURCE")return!1}return sC(e)&&Ye(s)?!1:e in n}const pM=Ti({patchProp:uM},KL);let oC;function fM(){return oC||(oC=CL(pM))}const gM=(...n)=>{const e=fM().createApp(...n),{mount:s}=e;return e.mount=o=>{const l=$M(o);if(!l)return;const a=e._component;!Jt(a)&&!a.render&&!a.template&&(a.template=l.innerHTML),l.innerHTML="";const h=s(l,!1,mM(l));return l instanceof Element&&(l.removeAttribute("v-cloak"),l.setAttribute("data-v-app","")),h},e};function mM(n){if(n instanceof SVGElement)return"svg";if(typeof MathMLElement=="function"&&n instanceof MathMLElement)return"mathml"}function $M(n){return Ye(n)?document.querySelector(n):n}const _M={key:0,xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-pencil d-block mx-auto mb-1",viewBox:"0 0 16 16"},TM=_t("path",{d:"M12.146.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1 0 .708l-10 10a.5.5 0 0 1-.168.11l-5 2a.5.5 0 0 1-.65-.65l2-5a.5.5 0 0 1 .11-.168l10-10zM11.207 2.5 13.5 4.793 14.793 3.5 12.5 1.207 11.207 2.5zm1.586 3L10.5 3.207 4 9.707V10h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.293l6.5-6.5zm-9.761 5.175-.106.106-1.528 3.821 3.821-1.528.106-.106A.5.5 0 0 1 5 12.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.468-.325z"},null,-1),bM=[TM],EM={key:1,xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-bug d-block mx-auto mb-1",viewBox:"0 0 16 16"},vM=_t("path",{d:"M4.355.522a.5.5 0 0 1 .623.333l.291.956A4.979 4.979 0 0 1 8 1c1.007 0 1.946.298 2.731.811l.29-.956a.5.5 0 1 1 .957.29l-.41 1.352A4.985 4.985 0 0 1 13 6h.5a.5.5 0 0 0 .5-.5V5a.5.5 0 0 1 1 0v.5A1.5 1.5 0 0 1 13.5 7H13v1h1.5a.5.5 0 0 1 0 1H13v1h.5a1.5 1.5 0 0 1 1.5 1.5v.5a.5.5 0 1 1-1 0v-.5a.5.5 0 0 0-.5-.5H13a5 5 0 0 1-10 0h-.5a.5.5 0 0 0-.5.5v.5a.5.5 0 1 1-1 0v-.5A1.5 1.5 0 0 1 2.5 10H3V9H1.5a.5.5 0 0 1 0-1H3V7h-.5A1.5 1.5 0 0 1 1 5.5V5a.5.5 0 0 1 1 0v.5a.5.5 0 0 0 .5.5H3c0-1.364.547-2.601 1.432-3.503l-.41-1.352a.5.5 0 0 1 .333-.623zM4 7v4a4 4 0 0 0 3.5 3.97V7H4zm4.5 0v7.97A4 4 0 0 0 12 11V7H8.5zM12 6a3.989 3.989 0 0 0-1.334-2.982A3.983 3.983 0 0 0 8 2a3.983 3.983 0 0 0-2.667 1.018A3.989 3.989 0 0 0 4 6h8z"},null,-1),yM=[vM],IM={key:2,xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-cloud-download d-block mx-auto mb-1",viewBox:"0 0 16 16"},SM=_t("path",{d:"M4.406 1.342A5.53 5.53 0 0 1 8 0c2.69 0 4.923 2 5.166 4.579C14.758 4.804 16 6.137 16 7.773 16 9.569 14.502 11 12.687 11H10a.5.5 0 0 1 0-1h2.688C13.979 10 15 8.988 15 7.773c0-1.216-1.02-2.228-2.313-2.228h-.5v-.5C12.188 2.825 10.328 1 8 1a4.53 4.53 0 0 0-2.941 1.1c-.757.652-1.153 1.438-1.153 2.055v.448l-.445.049C2.064 4.805 1 5.952 1 7.318 1 8.785 2.23 10 3.781 10H6a.5.5 0 0 1 0 1H3.781C1.708 11 0 9.366 0 7.318c0-1.763 1.266-3.223 2.942-3.593.143-.863.698-1.723 1.464-2.383z"},null,-1),CM=_t("path",{d:"M7.646 15.854a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 14.293V5.5a.5.5 0 0 0-1 0v8.793l-2.146-2.147a.5.5 0 0 0-.708.708l3 3z"},null,-1),wM=[SM,CM],kM={key:3,xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-gear d-block mx-auto mb-1",viewBox:"0 0 16 16"},OM=_t("path",{d:"M8 4.754a3.246 3.246 0 1 0 0 6.492 3.246 3.246 0 0 0 0-6.492zM5.754 8a2.246 2.246 0 1 1 4.492 0 2.246 2.246 0 0 1-4.492 0z"},null,-1),AM=_t("path",{d:"M9.796 1.343c-.527-1.79-3.065-1.79-3.592 0l-.094.319a.873.873 0 0 1-1.255.52l-.292-.16c-1.64-.892-3.433.902-2.54 2.541l.159.292a.873.873 0 0 1-.52 1.255l-.319.094c-1.79.527-1.79 3.065 0 3.592l.319.094a.873.873 0 0 1 .52 1.255l-.16.292c-.892 1.64.901 3.434 2.541 2.54l.292-.159a.873.873 0 0 1 1.255.52l.094.319c.527 1.79 3.065 1.79 3.592 0l.094-.319a.873.873 0 0 1 1.255-.52l.292.16c1.64.893 3.434-.902 2.54-2.541l-.159-.292a.873.873 0 0 1 .52-1.255l.319-.094c1.79-.527 1.79-3.065 0-3.592l-.319-.094a.873.873 0 0 1-.52-1.255l.16-.292c.893-1.64-.902-3.433-2.541-2.54l-.292.159a.873.873 0 0 1-1.255-.52l-.094-.319zm-2.633.283c.246-.835 1.428-.835 1.674 0l.094.319a1.873 1.873 0 0 0 2.693 1.115l.291-.16c.764-.415 1.6.42 1.184 1.185l-.159.292a1.873 1.873 0 0 0 1.116 2.692l.318.094c.835.246.835 1.428 0 1.674l-.319.094a1.873 1.873 0 0 0-1.115 2.693l.16.291c.415.764-.42 1.6-1.185 1.184l-.291-.159a1.873 1.873 0 0 0-2.693 1.116l-.094.318c-.246.835-1.428.835-1.674 0l-.094-.319a1.873 1.873 0 0 0-2.692-1.115l-.292.16c-.764.415-1.6-.42-1.184-1.185l.159-.291A1.873 1.873 0 0 0 1.945 8.93l-.319-.094c-.835-.246-.835-1.428 0-1.674l.319-.094A1.873 1.873 0 0 0 3.06 4.377l-.16-.292c-.415-.764.42-1.6 1.185-1.184l.292.159a1.873 1.873 0 0 0 2.692-1.115l.094-.319z"},null,-1),RM=[OM,AM],NM={key:4,xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-play-circle",viewBox:"0 0 16 16"},LM=_t("path",{d:"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"},null,-1),MM=_t("path",{d:"M6.271 5.055a.5.5 0 0 1 .52.038l3.5 2.5a.5.5 0 0 1 0 .814l-3.5 2.5A.5.5 0 0 1 6 10.5v-5a.5.5 0 0 1 .271-.445z"},null,-1),xM=[LM,MM],DM={key:5,xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-arrow-right-square",viewBox:"0 0 16 16"},PM=_t("path",{"fill-rule":"evenodd",d:"M15 2a1 1 0 0 0-1-1H2a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V2zM0 2a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2zm4.5 5.5a.5.5 0 0 0 0 1h5.793l-2.147 2.146a.5.5 0 0 0 .708.708l3-3a.5.5 0 0 0 0-.708l-3-3a.5.5 0 1 0-.708.708L10.293 7.5H4.5z"},null,-1),BM=[PM],FM={key:6,xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-reply",viewBox:"0 0 16 16"},UM=_t("path",{d:"M6.598 5.013a.144.144 0 0 1 .202.134V6.3a.5.5 0 0 0 .5.5c.667 0 2.013.005 3.3.822.984.624 1.99 1.76 2.595 3.876-1.02-.983-2.185-1.516-3.205-1.799a8.74 8.74 0 0 0-1.921-.306 7.404 7.404 0 0 0-.798.008h-.013l-.005.001h-.001L7.3 9.9l-.05-.498a.5.5 0 0 0-.45.498v1.153c0 .108-.11.176-.202.134L2.614 8.254a.503.503 0 0 0-.042-.028.147.147 0 0 1 0-.252.499.499 0 0 0 .042-.028l3.984-2.933zM7.8 10.386c.068 0 .143.003.223.006.434.02 1.034.086 1.7.271 1.326.368 2.896 1.202 3.94 3.08a.5.5 0 0 0 .933-.305c-.464-3.71-1.886-5.662-3.46-6.66-1.245-.79-2.527-.942-3.336-.971v-.66a1.144 1.144 0 0 0-1.767-.96l-3.994 2.94a1.147 1.147 0 0 0 0 1.946l3.994 2.94a1.144 1.144 0 0 0 1.767-.96v-.667z"},null,-1),HM=[UM],VM={key:7,xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-terminal",viewBox:"0 0 16 16"},GM=_t("path",{d:"M6 9a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 0 1h-3A.5.5 0 0 1 6 9zM3.854 4.146a.5.5 0 1 0-.708.708L4.793 6.5 3.146 8.146a.5.5 0 1 0 .708.708l2-2a.5.5 0 0 0 0-.708l-2-2z"},null,-1),WM=_t("path",{d:"M2 1a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2H2zm12 1a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V3a1 1 0 0 1 1-1h12z"},null,-1),zM=[GM,WM],_0={__name:"BaseIcon",props:{name:String},setup(n){return(e,s)=>n.name==="pencil"?(Zt(),se("svg",_M,bM)):n.name==="bug"?(Zt(),se("svg",EM,yM)):n.name==="cloud-download"?(Zt(),se("svg",IM,wM)):n.name==="gear"?(Zt(),se("svg",kM,RM)):n.name==="play-circle"?(Zt(),se("svg",NM,xM)):n.name==="arrow-right-square"?(Zt(),se("svg",DM,BM)):n.name==="reply"?(Zt(),se("svg",FM,HM)):n.name==="terminal"?(Zt(),se("svg",VM,zM)):za("",!0)}};const Lh=(n,e)=>{const s=n.__vccOpts||n;for(const[o,l]of e)s[o]=l;return s},XM=n=>(Kk("data-v-d2c8bb39"),n=n(),jk(),n),YM={class:"px-3 text-bg-dark"},KM={class:"container-fluid"},jM={class:"d-flex flex-wrap align-items-center justify-content-center"},JM=XM(()=>_t("h1",{href:"/#",class:"d-flex align-items-center my-2 my-lg-0 me-lg-auto"}," Blocksembler ",-1)),qM={class:"nav col-12 col-lg-auto my-2 my-md-0"},ZM=["href"],QM={__name:"BlocksamblerNavigation",setup(n){let e=bo([{label:"Editor",href:"/app/#/editor",icon:"pencil"},{label:"Debugger",href:"/app/#/debugger",icon:"bug"}]);return bo([{name:"ANNA"},{name:"ARM (64-bit)"}]),(s,o)=>(Zt(),se("header",null,[_t("div",YM,[_t("div",KM,[_t("div",jM,[JM,_t("ul",qM,[(Zt(!0),se(ri,null,Fp(Xo(e),l=>(Zt(),se("li",null,[_t("a",{href:l.href,class:"nav-link text-white"},[Ae(_0,{name:l.icon},null,8,["name"]),tc(" "+ds(l.label),1)],8,ZM)]))),256))])])])])]))}},tx=Lh(QM,[["__scopeId","data-v-d2c8bb39"]]),ex={kind:"categoryToolbox",contents:[{kind:"category",name:"Registers",colour:"240",contents:[{kind:"block",type:"r0"},{kind:"block",type:"r1"},{kind:"block",type:"r2"},{kind:"block",type:"r3"},{kind:"block",type:"r4"},{kind:"block",type:"r5"},{kind:"block",type:"r6"},{kind:"block",type:"r7"}]},{kind:"category",name:"Control Flow",colour:"240",contents:[{kind:"block",type:"start"},{kind:"block",type:"halt"},{kind:"block",type:"bez"},{kind:"block",type:"bgz"},{kind:"block",type:"jalr"},{kind:"block",type:"labelsection"},{kind:"block",type:"labeldescriptor"}]},{kind:"category",name:"Arithmetic Instructions",colour:"240",contents:[{kind:"block",type:"add"},{kind:"block",type:"addi"},{kind:"block",type:"sub"},{kind:"block",type:"and"},{kind:"block",type:"or"},{kind:"block",type:"not"},{kind:"block",type:"shf"},{kind:"block",type:"lli"},{kind:"block",type:"lui"}]},{kind:"category",name:"Input/Output",colour:"240",contents:[{kind:"block",type:"in"},{kind:"block",type:"out"}]},{kind:"category",name:"Memory Access",colour:"240",contents:[{kind:"block",type:"lw"},{kind:"block",type:"sw"}]}]};var ps=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ix(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var T0={exports:{}},X$={exports:{}},Y$={exports:{}},K$={exports:{}},j$={exports:{}},nC;function kb(){return nC||(nC=1,function(n,e){(function(s,o){n.exports=o()})(ps,function(){var s={},o,l,a,h,d,p,g,m,T,b,y,C,L,A,F,z,X,K,Y,V,H,Tt,$t,lt,ot,ct,gt,vt,it,Ft,Rt,Nt,me,Lt,Gt,Ht,fe,ut,be,_e,xe,Ee,ai,Ke,hi,yt,w,N,G,q,Z,st,ht,et,dt,j,R,J,kt,mt,Vt,Ct,Qt,k,_,I,M,P,nt,Pt,te,bi,Hh,sn,Gi,Se,qn,Zn,Qn,Jr,ls,$,v,O,B,tt,At,Ut,Wi,yo,xc,Ps,Vh,uE,Gh,dE,Wh,sf,of,zh,Xh,Yh,Dc,pE,Kh,fE,gE,jh,mE,nf,qr,$E,Jh,rf,lf,_E,qh,Zr,Zh,TE,cf,af,bE,EE,tr,vE,Qh,tu,yE,hf,Pc,Bs,IE,uf,eu,df,SE,pf,CE,ff,Bc,wE,kE,on,gf,Fs,OE,AE,RE,nn,mf,NE,LE,ME,xE,DE,$f,PE,BE,iu,FE,UE,_f,su,ou,HE,Us,VE,GE,WE,zE,XE,YE,KE,Tf,rn,Qr,bf,jE,JE,qE,ZE,QE,tv,ev,iv,Ef,sv,ov,nv,rv,lv,cv,tl,vf,av,hv,bs,Re,er,uv,yf,nu,cs,If,ru,Sf,Cf,dv,pv,fv,wf,gv,kf,Fc,mv,$v,_v,Tv,Uc,Of,Af,Rf,bv,el,Nf,il,Lf,Mf,xf,sl,lu,cu,Ev,Hc,Df,Pf,Bf,Ff,Uf,Hf,vv,Vc,Vf,ol,au,Es,Gf,Wf,zf,Xf,Yf,Kf,jf,nl,yv,Gc,Jf,qf,Iv,hu,Zf,Sv,Cv,wv,kv,Ov,rl,Qf,tg,ll,uu,Av,Rv,eg,ig,Io,sg,og,Nv,Lv,Mv,xv,So,ln,du,ng,pu,rg,cn,Wc,fu,gu,ir,lg,mu,cg,Fe,Dv,cl,an,$u,zi,Pv,Bv,Fv,Uv,ag,Hv,hg,_u,Vv,Gv,Wv,ug,Tu,dg,bu,zv,Xv,Yv,Kv,Ot,Li,ei,Ne,Hs,al,It,Ve,pg,jv,Eu,fg,Jv,gg,vu,mg,$g,qv,_g,Zv,Tg,zc,Qv,ty,ey,hl,iy,bg,Eg,vg,yg,yu,Ig,Xc,Sg,Cg,wg,kg,Og,Ag,Rg,Ng,Lg,Mg,xg,Dg,sy,oy,ul,Pg,ny,Iu,Bg,Fg,Ug,Hg,Vg,Gg,Wg,zg,Su,Yc,Xg,ry,Yg,Kg,jg,Jg,qg,Zg,Qg,ly,tm,cy,ay,hy,uy,dy,py,fy,gy,my,$y,_y,Mt;o=function(t,i,r,c){if(!(t instanceof rt)&&typeof t!="string"||`${t}`.trim()==="")throw Error('Invalid type "'+t+'". The type must be a non-empty string or a Blockly.registry.Type.');if(t=`${t}`.toLowerCase(),typeof i!="string"||i.trim()==="")throw Error('Invalid name "'+i+'". The name must be a non-empty string.');const u=i.toLowerCase();if(!r)throw Error("Can not register a null value");let f=hn[t],E=Cu[t];if(f||(f=hn[t]=Object.create(null),E=Cu[t]=Object.create(null)),l(t,r),!c&&f[u])throw Error('Name "'+u+'" with type "'+t+'" already registered.');f[u]=r,E[u]=i},l=function(t,i){switch(t){case String(rt.FIELD):if(typeof i.fromJson!="function")throw Error('Type "'+t+'" must have a fromJson function')}},a=function(t,i){t=`${t}`.toLowerCase(),i=i.toLowerCase();const r=hn[t];r&&r[i]?(delete hn[t][i],delete Cu[t][i]):console.warn("Unable to unregister ["+i+"]["+t+"] from the registry.")},h=function(t,i,r){t=`${t}`.toLowerCase(),i=i.toLowerCase();const c=hn[t];if(!c||!c[i]){if(i="Unable to find ["+i+"]["+t+"] in the registry.",r)throw Error(i+" You must require or register a "+t+" plugin.");return console.warn(i),null}return c[i]},d=function(t,i){return t=`${t}`.toLowerCase(),i=i.toLowerCase(),(t=hn[t])?!!t[i]:!1},p=function(t,i,r){return h(t,i,r)},g=function(t,i,r){return h(t,i,r)},m=function(t,i,r){t=`${t}`.toLowerCase();var c=hn[t];if(!c){if(c=`Unable to find [${t}] in the registry.`,r)throw Error(`${c} You must require or register a ${t} plugin.`);return console.warn(c),null}if(!i)return c;t=Cu[t],r=Object.create(null);for(const u of Object.keys(c))r[t[u]]=c[u];return r},T=function(t,i,r){return i=i.plugins[String(t)]||Co,typeof i=="function"?i:p(t,i,r)},b=function(t){return Kc[t]||null},y=function(){const t=[];for(const i in Kc)t.push(Kc[i]);return t},C=function(t){Kc[t.id]=t},L=function(t){delete Kc[t.id]},A=function(){return Ty},F=function(t){Ty=t},z=function(){return by},X=function(t){by=t},K=function(){return Ey},Y=function(t){Ey=t},V=function(t){for(;t.options.parentWorkspace;)t=t.options.parentWorkspace;const i=t.getParentSvg(),r=t.getCachedParentSvgSize();var c=i.parentElement;if(c instanceof HTMLElement){var u=c.offsetWidth;c=c.offsetHeight,r.width!==u&&(i.setAttribute("width",u+"px"),t.setCachedParentSvgSize(u,null)),r.height!==c&&(i.setAttribute("height",c+"px"),t.setCachedParentSvgSize(null,c)),t.resize()}},H=function(t,i){const r=Object.create(null),c=t.getDescendants(!0);i&&(t=t.getNextBlock())&&(t=c.indexOf(t),c.splice(t,c.length-t));for(let u=0,f;f=c[u];u++)r[f.type]?r[f.type]++:r[f.type]=1;return r},Tt=function(t){return function(){this.jsonInit(t)}},$t=function(t){vy.defineBlocksWithJsonArrayInternal(t)},lt=function(t){s.defineBlocks$$module$build$src$core$common(s.createBlockDefinitionsFromJsonArray$$module$build$src$core$common(t))},s.createBlockDefinitionsFromJsonArray$$module$build$src$core$common=function(t){const i={};for(let r=0;r<t.length;r++){const c=t[r];if(!c){console.warn(`Block definition #${r} in JSON array is ${c}. Skipping`);continue}const u=c.type;u?i[u]={init:Tt(c)}:console.warn(`Block definition #${r} in JSON array is missing a type attribute. Skipping.`)}return i},s.defineBlocks$$module$build$src$core$common=function(t){for(const i of Object.keys(t)){const r=t[i];i in Mi&&console.warn(`Block definiton "${i}" overwrites previous definition.`),Mi[i]=r}},ot=function(){return"blockly-"+(JA++).toString(36)},ct=function(){return Iy.genUid()},gt=function(t){pl=t},vt=function(){return pl},it=function(t){Au.fireInternal(t)},Ft=function(t){if(Lt()){if(!lr.length)try{requestAnimationFrame(()=>{setTimeout(Rt,0)})}catch{setTimeout(Rt,0)}lr.push(t)}},Rt=function(){var t=Nt(lr,!0);lr.length=0;for(let r=0,c;c=t[r];r++)if(c.workspaceId){var i=b(c.workspaceId);i&&i.fireChangeListener(c)}t=new Set(t.map(r=>r.workspaceId));for(const r of t){if(!r||(t=b(r),!t))continue;t=t.getUndoStack();let c;for(i=t.length;0<i;i--){const u=t[i-1];if(u.group==="")break;if(c===void 0)c=u.group;else if(u.group!==c)break}c&&i!=t.length-1&&(i=t.splice(i,t.length-i),i=Nt(i,!0),t.push(...i))}},Nt=function(t,i){t=t.slice(),i||t.reverse();const r=[],c=Object.create(null);for(let E=0,S;S=t[E];E++)if(!S.isNull()){var u=[S.isUiEvent?ku:S.type,S.blockId,S.workspaceId].join(" "),f=c[u];const W=f?f.event:null;f?S.type===s.MOVE$$module$build$src$core$events$utils&&f.index===E-1?(u=S,W.newParentId=u.newParentId,W.newInputName=u.newInputName,W.newCoordinate=u.newCoordinate,u.reason&&(W.reason?(u=new Set(u.reason.concat(W.reason)),W.reason=Array.from(u)):W.reason=u.reason),f.index=E):S.type===s.CHANGE$$module$build$src$core$events$utils&&S.element===W.element&&S.name===W.name?W.newValue=S.newValue:S.type===pn?(f=S,W.viewTop=f.viewTop,W.viewLeft=f.viewLeft,W.scale=f.scale,W.oldScale=f.oldScale):(S.type!==Oo||W.type!==Vs)&&(c[u]={event:S,index:E},r.push(S)):(c[u]={event:S,index:E},r.push(S))}t=r.filter(function(E){return!E.isNull()}),i||t.reverse();for(let E=1,S;S=t[E];E++)S.type===s.CHANGE$$module$build$src$core$events$utils&&S.element==="mutation"&&t.unshift(t.splice(E,1)[0]);return t},me=function(){for(let t=0,i;i=lr[t];t++)i.recordUndo=!1},s.disable$$module$build$src$core$events$utils=function(){wu++},s.enable$$module$build$src$core$events$utils=function(){wu--},Lt=function(){return wu===0},s.getGroup$$module$build$src$core$events$utils=function(){return im},s.setGroup$$module$build$src$core$events$utils=function(t){Au.setGroupInternal(t)},Gt=function(t){im=typeof t=="boolean"?t?ct():"":t},Ht=function(t){const i=[];t=t.getDescendants(!1);for(let r=0,c;c=t[r];r++)i[r]=c.id;return i},fe=function(t,i){const r=ut(t.type);if(!r)throw Error("Unknown event type.");return r.fromJson(t,i)},ut=function(t){const i=p(rt.EVENT,t);if(!i)throw Error(`Event type ${t} not found in registry.`);return i},be=function(t){if((t.type===s.MOVE$$module$build$src$core$events$utils||t.type===s.CREATE$$module$build$src$core$events$utils)&&t.workspaceId){var i=b(t.workspaceId);if(!t.blockId)throw Error("Encountered a blockEvent without a proper blockId");if(t=i.getBlockById(t.blockId)){const r=pl;try{pl=!1;const c=t.getParent();if(c&&c.isEnabled()){const u=t.getDescendants(!1);for(let f=0,E;E=u[f];f++)E.setEnabled(!0)}else if((t.outputConnection||t.previousConnection)&&!i.isDragging())do t.setEnabled(!1),t=t.getNextBlock();while(t)}finally{pl=r}}}},_e=function(t,i){xe(),Nu=setTimeout(function(){i&&i.handleRightClick(t)},qA)},xe=function(){Nu&&(clearTimeout(Nu),Nu=0)},Ee=function(){Ru=null},ai=function(t){return!t.type.startsWith("pointer")||t instanceof PointerEvent&&hi(t)},Ke=function(t){return`${t.pointerId}`},hi=function(t){const i=Ke(t);return Ru?Ru===i:t.type==="pointerdown"?(Ru=i,!0):!1},yt=function(t,i,r,c,u){function f(S){(u||ai(S))&&(r?c.call(r,S):c(S))}const E=[];if(i in cr)for(let S=0;S<cr[i].length;S++){const W=cr[i][S];t.addEventListener(W,f,!1),E.push([t,W,f])}else t.addEventListener(i,f,!1),E.push([t,i,f]);return E},w=function(t,i,r,c){function u(E){r?c.call(r,E):c(E)}const f=[];if(i in cr)for(let E=0;E<cr[i].length;E++){const S=cr[i][E];t.addEventListener(S,u,!1),f.push([t,S,u])}else t.addEventListener(i,u,!1),f.push([t,i,u]);return f},N=function(t){const i=t[t.length-1][2];for(;t.length;){const[r,c,u]=t.pop();r.removeEventListener(c,u,!1)}return i},G=function(t){if(t.target instanceof HTMLElement){if(t.target.isContentEditable||t.target.getAttribute("data-is-text-input")==="true")return!0;if(t.target instanceof HTMLInputElement)return t=t.target,t.type==="text"||t.type==="number"||t.type==="email"||t.type==="password"||t.type==="search"||t.type==="tel"||t.type==="url";if(t.target instanceof HTMLTextAreaElement)return!0}return!1},q=function(t){return t.ctrlKey&&cm?!0:t.button===2},Z=function(t,i,r){const c=i.createSVGPoint();return c.x=t.clientX,c.y=t.clientY,r||(r=i.getScreenCTM().inverse()),c.matrixTransform(r)},st=function(t){switch(t.deltaMode){default:return{x:t.deltaX,y:t.deltaY};case 1:return{x:t.deltaX*My,y:t.deltaY*My};case 2:return{x:t.deltaX*xy,y:t.deltaY*xy}}},ht=function(t,i){return i=t.indexOf(i),i===-1?!1:(t.splice(i,1),!0)},et=function(t){if(hm)throw Error("CSS already injected");um+=`
`+t},dt=function(t,i){hm||(hm=!0,t&&(t=i.replace(/[\\/]$/,""),i=um.replace(/<<<PATH>>>/g,t),um="",t=document.createElement("style"),t.id="blockly-common-style",i=document.createTextNode(i),t.appendChild(i),document.head.insertBefore(t,document.head.firstChild)))},j=function(t,i,r,c){t=t+" was deprecated in "+i+" and will be deleted in "+r+".",c&&(t+=`
Use `+c+" instead."),console.warn(t)},R=function(t,i,r){t=document.createElementNS(jc,`${t}`);for(const c in i)t.setAttribute(c,`${i[c]}`);return r&&r.appendChild(t),t},J=function(t,i){return i=i.split(" "),i.every(r=>t.classList.contains(r))?!1:(t.classList.add(...i),!0)},kt=function(t,i){t.classList.remove(...i.split(" "))},mt=function(t,i){return i=i.split(" "),i.every(r=>!t.classList.contains(r))?!1:(t.classList.remove(...i),!0)},Vt=function(t,i){return t.classList.contains(i)},Ct=function(t){return t&&t.parentNode?t.parentNode.removeChild(t):null},Qt=function(t,i){const r=i.nextSibling;if(i=i.parentNode,!i)throw Error("Reference node has no parent.");r?i.insertBefore(t,r):i.appendChild(t)},k=function(t,i){return j("Blockly.utils.dom.containsNode","version 10","version 11",'Use native "contains" DOM method'),t.contains(i)},_=function(t,i){t.style.transform=i,t.style["-webkit-transform"]=i},I=function(){pm++,vs||(vs=Object.create(null))},M=function(){pm--,pm||(vs=null)},P=function(t){const i=t.textContent+`
`+t.className.baseVal;let r;if(vs&&(r=vs[i]))return r;try{r=t.getComputedTextLength()}catch{return 8*t.textContent.length}return vs&&(vs[i]=r),r},nt=function(t,i,r,c){return Pt(t,i+"pt",r,c)},Pt=function(t,i,r,c){const u=t.textContent;t=u+`
`+t.className.baseVal;var f;return vs&&(f=vs[t])||(Du||(f=document.createElement("canvas"),f.className="blocklyComputeCanvas",document.body.appendChild(f),Du=f.getContext("2d")),Du.font=r+" "+i+" "+c,f=u?Du.measureText(u).width:0,vs&&(vs[t]=f)),f},te=function(t,i,r,c){const u=document.createElement("span");u.style.font=r+" "+i+" "+c,u.textContent=t,t=document.createElement("div"),t.style.width="1px",t.style.height="0",i=document.createElement("div"),i.style.display="flex",i.style.position="fixed",i.style.top="0",i.style.left="0",i.appendChild(u),i.appendChild(t),document.body.appendChild(i),r={height:0,baseline:0};try{i.style.alignItems="baseline",r.baseline=t.offsetTop-u.offsetTop,i.style.alignItems="flex-end",r.height=t.offsetTop-u.offsetTop}finally{document.body.removeChild(i)}return r},bi=function(t){return By.getSizeInternal(t)},Hh=function(t){if(Gi(t,"display")!=="none")return sn(t);const i=t.style,r=i.display,c=i.visibility,u=i.position;i.visibility="hidden",i.position="absolute",i.display="inline";const f=t.offsetWidth;return t=t.offsetHeight,i.display=r,i.position=u,i.visibility=c,new Ce(f,t)},sn=function(t){return new Ce(t.offsetWidth,t.offsetHeight)},Gi=function(t,i){return t=window.getComputedStyle(t),t[i]||t.getPropertyValue(i)},Se=function(t){const i=new pt(0,0);t=t.getBoundingClientRect();var r=document.documentElement;return r=new pt(window.pageXOffset||r.scrollLeft,window.pageYOffset||r.scrollTop),i.x=t.left+r.x,i.y=t.top+r.y,i},qn=function(){const t=document.body,i=document.documentElement;return new pt(t.scrollLeft||i.scrollLeft,t.scrollTop||i.scrollTop)},Zn=function(t){const i=parseFloat(Gi(t,"borderLeftWidth")),r=parseFloat(Gi(t,"borderRightWidth")),c=parseFloat(Gi(t,"borderTopWidth"));return t=parseFloat(Gi(t,"borderBottomWidth")),new ve(c,t,i,r)},Qn=function(t,i,r){t=Jr(t,i,r),i.scrollLeft=t.x,i.scrollTop=t.y},Jr=function(t,i,r){var c=Se(t),u=Se(i),f=Zn(i);const E=c.x-u.x-f.left;return c=c.y-u.y-f.top,u=sn(t),t=i.clientWidth-u.width,u=i.clientHeight-u.height,f=i.scrollLeft,i=i.scrollTop,r?(f+=E-t/2,i+=c-u/2):(f+=Math.min(E,Math.max(E-t,0)),i+=Math.min(c,Math.max(c-u,0))),new pt(f,i)},ls=function(t){const i=new pt(0,0);var r=t.x&&t.getAttribute("x");const c=t.y&&t.getAttribute("y");return r&&(i.x=parseInt(r)),c&&(i.y=parseInt(c)),(r=(r=t.getAttribute("transform"))&&r.match(Fy))&&(i.x+=Number(r[1]),r[3]&&(i.y+=Number(r[3]))),(t=t.getAttribute("style"))&&-1<t.indexOf("translate")&&(t=t.match(Uy))&&(i.x+=Number(t[1]),t[3]&&(i.y+=Number(t[3]))),i},$=function(t){let i=0,r=0;for(;t;){const c=ls(t);if(i+=c.x,r+=c.y,(" "+(t.getAttribute("class")||"")+" ").indexOf(" injectionDiv ")!==-1)break;t=t.parentNode}return new pt(i,r)},v=function(){const t=qn();return new ve(t.y,document.documentElement.clientHeight+t.y,t.x,document.documentElement.clientWidth+t.x)},O=function(){const t=document.documentElement,i=window;return new pt(i.pageXOffset||t.scrollLeft,i.pageYOffset||t.scrollTop)},B=function(t,i){var r=i.x;i=i.y;const c=t.getInjectionDiv().getBoundingClientRect();return r=new pt(r-c.left,i-c.top),i=t.getOriginOffsetInPixels(),pt.difference(r,i).scale(1/t.scale)},tt=function(t,i){var r=i.scale(t.scale);i=r.x,r=r.y;const c=t.getInjectionDiv().getBoundingClientRect();return t=t.getOriginOffsetInPixels(),new pt(i+c.left+t.x,r+c.top+t.y)},At=function(t){({document:Bu=Bu,DOMParser:Jc=Jc,XMLSerializer:qc=qc}=t),Pu=new Jc,fm=new qc},s.createElement$$module$build$src$core$utils$xml=function(t){return Bu.createElementNS(Hy,t)},s.createTextNode$$module$build$src$core$utils$xml=function(t){return Bu.createTextNode(t)},s.textToDom$$module$build$src$core$utils$xml=function(t){let i=Pu.parseFromString(t,"text/xml");if(i&&i.documentElement&&!i.getElementsByTagName("parsererror").length)return i.documentElement;if((i=Pu.parseFromString(t,"text/html"))&&i.body.firstChild&&i.body.firstChild.nodeName.toLowerCase()==="xml")return i.body.firstChild;throw Error(`DOMParser was unable to parse: ${t}`)},Ut=function(t){return Wi(fm.serializeToString(t))},Wi=function(t){return t.replace(eR,i=>`&#${i.charCodeAt(0)};`)},yo=function(t){return t?((t instanceof Element||typeof t=="string")&&(t=of(t),t=dE(t)),xc(t),t):null},xc=function(t){const i=t.kind;if(t=t.contents,i&&i!==Vy&&i!==gm)throw Error("Invalid toolbox kind "+i+". Please supply either "+Vy+" or "+gm);if(!t)throw Error("Toolbox must have a contents attribute.")},Ps=function(t){return t?t.contents?t.contents:Array.isArray(t)&&0<t.length&&!t[0].nodeType?t:Wh(t):[]},Vh=function(t){return Gy.hasCategoriesInternal(t)},uE=function(t){if(!t)return!1;const i=t.kind;return i?i===gm:!!t.contents.filter(function(r){return r.kind.toUpperCase()==="CATEGORY"}).length},Gh=function(t){return t&&t.contents?!!t.contents.filter(function(i){return i.kind.toUpperCase()==="CATEGORY"}).length:!1},dE=function(t){const i={contents:Wh(t)};return t instanceof Node&&sf(t,i),i},Wh=function(t){const i=[];let r=t.childNodes;r||(r=t);for(let c=0,u;u=r[c];c++){if(!u.tagName)continue;t={};const f=u.tagName.toUpperCase();t.kind=f,f==="BLOCK"?t.blockxml=u:u.childNodes&&0<u.childNodes.length&&(t.contents=Wh(u)),sf(u,t),i.push(t)}return i},sf=function(t,i){for(let r=0;r<t.attributes.length;r++){const c=t.attributes[r];-1<c.nodeName.indexOf("css-")?(i.cssconfig=i.cssconfig||{},i.cssconfig[c.nodeName.replace("css-","")]=c.value):i[c.nodeName]=c.value}},of=function(t){let i=null;if(t)if(typeof t=="string"){if(i=s.textToDom$$module$build$src$core$utils$xml(t),i.nodeName.toLowerCase()!=="xml")throw TypeError("Toolbox should be an <xml> document.")}else t instanceof Element&&(i=t);return i},zh=function(t,i,r,c,u,f){const E=f.scrollbar&&f.scrollbar.canScrollVertically();return t.horizontal===yl.LEFT?(r=u.absoluteMetrics.left+r,E&&f.RTL&&(r+=Ge.scrollbarThickness)):(r=u.absoluteMetrics.left+u.viewMetrics.width-i.width-r,E&&!f.RTL&&(r-=Ge.scrollbarThickness)),t.vertical===Lo.TOP?t=u.absoluteMetrics.top+c:(t=u.absoluteMetrics.top+u.viewMetrics.height-i.height-c,f.scrollbar&&f.scrollbar.canScrollHorizontally()&&(t-=Ge.scrollbarThickness)),new ve(t,t+i.height,r,r+i.width)},Xh=function(t,i){return{horizontal:i.toolboxMetrics.position===Wt.LEFT||t.horizontalLayout&&!t.RTL?yl.RIGHT:yl.LEFT,vertical:i.toolboxMetrics.position===Wt.BOTTOM?Lo.TOP:Lo.BOTTOM}},Yh=function(t,i,r,c){const u=t.left,f=t.right-t.left,E=t.bottom-t.top;for(let S=0;S<c.length;S++){const W=c[S];t.intersects(W)&&(t=r===$n.UP?W.top-E-i:W.bottom+i,t=new ve(t,t+E,u,u+f),S=-1)}return t},Dc=function(t,i){zy(t,i)},pE=function(t){zy=t},Kh=function(t,i){Ky.confirmInternal(t,i)},fE=function(t,i){Xy(t,i)},gE=function(t){Xy=t},jh=function(t,i,r){Yy(t,i,r)},mE=function(t){Yy=t},nf=function(t){return t.getVariableModel!==void 0},qr=function(t){return t.getProcedureDef!==void 0},$E=function(t){return t.getProcedureCall!==void 0&&t.renameProcedure!==void 0},s.allUsedVarModels$$module$build$src$core$variables=function(t){t=t.getAllBlocks(!1);const i=new Set;for(let r=0;r<t.length;r++){const c=t[r].getVarModels();if(c)for(let u=0;u<c.length;u++){const f=c[u];f.getId()&&i.add(f)}}return Array.from(i.values())},s.allDeveloperVariables$$module$build$src$core$variables=function(t){t=t.getAllBlocks(!1);const i=new Set;for(let c=0,u;u=t[c];c++){var r=u.getDeveloperVariables;if(r){r=r();for(let f=0;f<r.length;f++)i.add(r[f])}}return Array.from(i.values())},Jh=function(t){let i=[];const r=document.createElement("button");return r.setAttribute("text","%{BKY_NEW_VARIABLE}"),r.setAttribute("callbackKey","CREATE_VARIABLE"),t.registerButtonCallback("CREATE_VARIABLE",function(c){Zr(c.getTargetWorkspace())}),i.push(r),t=rf(t),i=i.concat(t)},rf=function(t){t=t.getVariablesOfType("");const i=[];if(0<t.length){var r=t[t.length-1];if(Mi.variables_set){var c=s.createElement$$module$build$src$core$utils$xml("block");c.setAttribute("type","variables_set"),c.setAttribute("gap",Mi.math_change?"8":"24"),c.appendChild(tr(r)),i.push(c)}if(Mi.math_change&&(c=s.createElement$$module$build$src$core$utils$xml("block"),c.setAttribute("type","math_change"),c.setAttribute("gap",Mi.variables_get?"20":"8"),c.appendChild(tr(r)),r=s.textToDom$$module$build$src$core$utils$xml('<value name="DELTA"><shadow type="math_number"><field name="NUM">1</field></shadow></value>'),c.appendChild(r),i.push(c)),Mi.variables_get){t.sort(Qc.compareByName);for(let u=0,f;f=t[u];u++)r=s.createElement$$module$build$src$core$utils$xml("block"),r.setAttribute("type","variables_get"),r.setAttribute("gap","8"),r.appendChild(tr(f)),i.push(r)}}return i},lf=function(t){return Jy.generateUniqueNameInternal(t)},_E=function(t){return qh(Tm.charAt(0),t.getAllVariableNames())},qh=function(t,i){if(!i.length)return t;const r=Tm;let c="",u=r.indexOf(t);for(;;){let f=!1;for(let E=0;E<i.length;E++)if(i[E].toLowerCase()===t){f=!0;break}if(!f)break;u++,u===r.length&&(u=0,c=`${Number(c)+1}`),t=r.charAt(u)+c}return t},Zr=function(t,i,r){function c(f){Zh(s.Msg$$module$build$src$core$msg.NEW_VARIABLE_TITLE,f,function(E){if(E){var S=cf(E,t);if(S){if(S.type===u)var W=s.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS.replace("%1",S.name);else W=s.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE,W=W.replace("%1",S.name).replace("%2",S.type);Dc(W,function(){c(E)})}else t.createVariable(E,u),i&&i(E)}else i&&i(null)})}const u=r||"";c("")},s.renameVariable$$module$build$src$core$variables=function(t,i,r){function c(u){const f=s.Msg$$module$build$src$core$msg.RENAME_VARIABLE_TITLE.replace("%1",i.name);Zh(f,u,function(E){if(E){var S=TE(E,i.type,t),W=af(i.name,E,t);if(S||W){var bt="";S?bt=s.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE.replace("%1",S.name).replace("%2",S.type):W&&(bt=s.Msg$$module$build$src$core$msg.VARIABLE_ALREADY_EXISTS_FOR_A_PARAMETER.replace("%1",E).replace("%2",W)),Dc(bt,function(){c(E)})}else t.renameVariableById(i.getId(),E),r&&r(E)}else r&&r(null)})}c("")},Zh=function(t,i,r){jh(t,i,function(c){c&&(c=c.replace(/[\s\xa0]+/g," ").trim(),c===s.Msg$$module$build$src$core$msg.RENAME_VARIABLE||c===s.Msg$$module$build$src$core$msg.NEW_VARIABLE)&&(c=null),r(c)})},TE=function(t,i,r){r=r.getVariableMap().getAllVariables(),t=t.toLowerCase();for(let c=0,u;u=r[c];c++)if(u.name.toLowerCase()===t&&u.type!==i)return u;return null},cf=function(t,i){i=i.getVariableMap().getAllVariables(),t=t.toLowerCase();for(let r=0,c;c=i[r];r++)if(c.name.toLowerCase()===t)return c;return null},af=function(t,i,r){return r.getProcedureMap().getProcedures().length?bE(t,i,r):EE(t,i,r)},bE=function(t,i,r){t=t.toLowerCase(),i=i.toLowerCase(),r=r.getProcedureMap().getProcedures();for(const u of r){var c=u.getParameters().filter(nf).map(f=>f.getVariableModel().name);if(c&&(r=c.some(f=>f.toLowerCase()===t),c=c.some(f=>f.toLowerCase()===i),r&&c))return u.getName()}return null},EE=function(t,i,r){t=t.toLowerCase(),i=i.toLowerCase(),r=r.getAllBlocks(!1);for(const u of r){if(!qr(u))continue;r=u.getProcedureDef();var c=r[1];const f=c.some(E=>E.toLowerCase()===t);if(c=c.some(E=>E.toLowerCase()===i),f&&c)return r[0]}return null},tr=function(t){const i=s.createElement$$module$build$src$core$utils$xml("field");return i.setAttribute("name","VAR"),i.setAttribute("id",t.getId()),i.setAttribute("variabletype",t.type),t=s.createTextNode$$module$build$src$core$utils$xml(t.name),i.appendChild(t),i},s.getOrCreateVariablePackage$$module$build$src$core$variables=function(t,i,r,c){let u=s.getVariable$$module$build$src$core$variables(t,i,r,c);return u||(u=vE(t,i,r,c)),u},s.getVariable$$module$build$src$core$variables=function(t,i,r,c){const u=t.getPotentialVariableMap();let f=null;if(i&&(f=t.getVariableById(i),!f&&u&&(f=u.getVariableById(i)),f))return f;if(r){if(c===void 0)throw Error("Tried to look up a variable by name without a type");f=t.getVariable(r,c),!f&&u&&(f=u.getVariable(r,c))}return f},vE=function(t,i,r,c){const u=t.getPotentialVariableMap();return r||(r=lf(t.isFlyout?t.targetWorkspace:t)),u?u.createVariable(r,c,i):t.createVariable(r,c,i)},Qh=function(t,i){t=t.getAllVariables();const r=[];if(i.length!==t.length)for(let c=0;c<t.length;c++){const u=t[c];i.indexOf(u)===-1&&r.push(u)}return r},tu=function(t,i){o(rt.PASTER,t,i)},yE=function(t){a(rt.PASTER,t)},hf=function(t){return uf(t),IE()?(eu(),Promise.resolve()):(Il||(Il=new Promise(i=>{ym=i,qy=window.requestAnimationFrame(()=>{eu(),i()})})),Il)},Pc=function(){return Il||Promise.resolve()},Bs=function(t){t||window.cancelAnimationFrame(qy),eu(t),!t&&ym&&ym()},IE=function(){return Ny},uf=function(t){vm.add(t);const i=t.getParent();i?uf(i):Hu.add(t)},eu=function(t){const i=t?new Set([t]):new Set([...Hu].map(u=>u.workspace)),r=[...Hu].filter(SE).filter(u=>i.has(u.workspace));for(var c of r)pf(c);for(const u of i)u.resizeContents();for(const u of r)c=u.getRelativeToSurfaceXY(),u.updateComponentLocations(c);for(const u of r)df(u);t||(Il=null)},df=function(t){Hu.delete(t),vm.delete(t);for(const i of t.getChildren(!1))df(i)},SE=function(t){return!t.isDisposed()&&!t.getParent()},pf=function(t){if(vm.has(t)){for(const i of t.getChildren(!1))pf(i);t.renderEfficiently()}},CE=function(t,i){const r=s.createElement$$module$build$src$core$utils$xml("xml");var c=ff(s.allUsedVarModels$$module$build$src$core$variables(t));c.hasChildNodes()&&r.appendChild(c),c=t.getTopComments(!0);for(let u=0;u<c.length;u++)r.appendChild(c[u].toXmlWithXY(i));for(t=t.getTopBlocks(!0),c=0;c<t.length;c++)r.appendChild(Bc(t[c],i));return r},ff=function(t){const i=s.createElement$$module$build$src$core$utils$xml("variables");for(let r=0;r<t.length;r++){const c=t[r],u=s.createElement$$module$build$src$core$utils$xml("variable");u.appendChild(s.createTextNode$$module$build$src$core$utils$xml(c.name)),c.type&&u.setAttribute("type",c.type),u.id=c.getId(),i.appendChild(u)}return i},Bc=function(t,i){if(t.isInsertionMarker()&&(t=t.getChildren(!1)[0],!t))return new DocumentFragment;let r=0;if(t.workspace.RTL&&(r=t.workspace.getWidth()),i=on(t,i),_f(i)){const c=t.getRelativeToSurfaceXY();i.setAttribute("x",String(Math.round(t.workspace.RTL?r-c.x:c.x))),i.setAttribute("y",String(Math.round(c.y)))}return i},wE=function(t){if(t.isSerializable()){const i=s.createElement$$module$build$src$core$utils$xml("field");return i.setAttribute("name",t.name||""),t.toXml(i)}return null},kE=function(t,i){for(let r=0;r<t.inputList.length;r++){const c=t.inputList[r];for(let u=0;u<c.fieldRow.length;u++){const f=wE(c.fieldRow[u]);f&&i.appendChild(f)}}},on=function(t,i){if(t.isInsertionMarker())return(i=t.getChildren(!1)[0])?on(i):new DocumentFragment;const r=s.createElement$$module$build$src$core$utils$xml(t.isShadow()?"shadow":"block");if(r.setAttribute("type",t.type),i||(r.id=t.id),t.mutationToDom){var c=t.mutationToDom();c&&(c.hasChildNodes()||c.hasAttributes())&&r.appendChild(c)}if(kE(t,r),c=t.getCommentText()){var u=t.getIcon(xi.COMMENT),f=u.getBubbleSize();u=u.bubbleIsVisible();var E=s.createElement$$module$build$src$core$utils$xml("comment");E.appendChild(s.createTextNode$$module$build$src$core$utils$xml(c)),E.setAttribute("pinned",`${u}`),E.setAttribute("h",String(f.height)),E.setAttribute("w",String(f.width)),r.appendChild(E)}for(t.data&&(c=s.createElement$$module$build$src$core$utils$xml("data"),c.appendChild(s.createTextNode$$module$build$src$core$utils$xml(t.data)),r.appendChild(c)),c=0;c<t.inputList.length;c++){f=t.inputList[c];var S=void 0;if(u=!0,f.type!==s.inputTypes$$module$build$src$core$inputs$input_types.DUMMY&&f.type!==s.inputTypes$$module$build$src$core$inputs$input_types.END_ROW){E=f.connection.targetBlock(),f.type===s.inputTypes$$module$build$src$core$inputs$input_types.VALUE?S=s.createElement$$module$build$src$core$utils$xml("value"):f.type===s.inputTypes$$module$build$src$core$inputs$input_types.STATEMENT&&(S=s.createElement$$module$build$src$core$utils$xml("statement"));const bt=f.connection.getShadowDom();!bt||E&&E.isShadow()||S.appendChild(gf(bt,i)),E&&(E=on(E,i),E.nodeType===No.ELEMENT_NODE&&(S.appendChild(E),u=!1)),S.setAttribute("name",f.name),u||r.appendChild(S)}}t.inputsInline!==void 0&&t.inputsInline!==t.inputsInlineDefault&&r.setAttribute("inline",String(t.inputsInline)),t.isCollapsed()&&r.setAttribute("collapsed","true"),t.isEnabled()||r.setAttribute("disabled","true"),t.isDeletable()||t.isShadow()||r.setAttribute("deletable","false"),t.isMovable()||t.isShadow()||r.setAttribute("movable","false"),t.isEditable()||r.setAttribute("editable","false"),S=t.getNextBlock();let W;return S&&(c=on(S,i),c.nodeType===No.ELEMENT_NODE&&(W=s.createElement$$module$build$src$core$utils$xml("next"),W.appendChild(c),r.appendChild(W))),t=t.nextConnection&&t.nextConnection.getShadowDom(),!t||S&&S.isShadow()||W.appendChild(gf(t,i)),r},gf=function(t,i){let r=t=t.cloneNode(!0),c;for(;r;)if(i&&r.nodeName==="shadow"&&r.removeAttribute("id"),r.firstChild)r=r.firstChild;else{for(;r&&!r.nextSibling;){c=r,r=r.parentNode;let u;c.nodeType===No.TEXT_NODE&&c.data.trim()===""&&((u=r)==null?void 0:u.firstChild)!==c&&Ct(c)}r&&(c=r,r=r.nextSibling,c.nodeType===No.TEXT_NODE&&c.data.trim()===""&&Ct(c))}return t},Fs=function(t){return Ut(t).replace(/<(\w+)([^<]*)\/>/g,"<$1$2></$1>")},OE=function(t){t=Fs(t).split("<");let i="";for(let r=1;r<t.length;r++){const c=t[r];c[0]==="/"&&(i=i.substring(2)),t[r]=i+"<"+c,c[0]!=="/"&&c.slice(-2)!=="/>"&&(i+="  ")}return t=t.join(`
`),t=t.replace(/(<(\w+)\b[^>]*>[^\n]*)\n *<\/\2>/g,"$1</$2>"),t.replace(/^\n/,"")},AE=function(t,i){return i.setResizesEnabled(!1),i.clear(),t=s.domToWorkspace$$module$build$src$core$xml(t,i),i.setResizesEnabled(!0),t},s.domToWorkspace$$module$build$src$core$xml=function(t,i){let r=0;i.RTL&&(r=i.getWidth());const c=[];I();const u=s.getGroup$$module$build$src$core$events$utils();u||s.setGroup$$module$build$src$core$events$utils(!0),i.setResizesEnabled&&i.setResizesEnabled(!1);let f=!0;try{for(let E=0,S;S=t.childNodes[E];E++){const W=S.nodeName.toLowerCase(),bt=S;if(W==="block"||W==="shadow"&&!vt()){const ke=nn(bt,i);c.push(ke.id);let Ie;const Bi=parseInt((Ie=bt.getAttribute("x"))!=null?Ie:"10",10);let zl;const Xl=parseInt((zl=bt.getAttribute("y"))!=null?zl:"10",10);isNaN(Bi)||isNaN(Xl)||ke.moveBy(i.RTL?r-Bi:Bi,Xl,["create"]),f=!1}else{if(W==="shadow")throw TypeError("Shadow block cannot be a top-level block.");if(W==="comment")i.rendered?oi.fromXmlRendered(bt,i,r):Xs.fromXml(bt,i);else if(W==="variables"){if(f)mf(bt,i);else throw Error("'variables' tag must exist once before block and shadow tag elements in the workspace XML, but it was found in another location.");f=!1}}}}finally{s.setGroup$$module$build$src$core$events$utils(u),i.setResizesEnabled&&i.setResizesEnabled(!0),i.rendered&&Bs(),M()}return it(new(ut(rr))(i)),c},RE=function(t,i){if(!i.getBlocksBoundingBox)return s.domToWorkspace$$module$build$src$core$xml(t,i);var r=i.getBlocksBoundingBox();if(t=s.domToWorkspace$$module$build$src$core$xml(t,i),r&&r.top!==r.bottom){var c=r.bottom;r=i.RTL?r.right:r.left;var u=1/0;let f=-1/0,E=1/0;for(let S=0;S<t.length;S++){const W=i.getBlockById(t[S]).getRelativeToSurfaceXY();W.y<E&&(E=W.y),W.x<u&&(u=W.x),W.x>f&&(f=W.x)}for(c=c-E+10,r=i.RTL?r-f:r-u,u=0;u<t.length;u++)i.getBlockById(t[u]).moveBy(r,c,["create"])}return t},s.domToBlock$$module$build$src$core$xml=function(t,i){return t=nn(t,i),i.rendered&&Bs(),t},nn=function(t,i){s.disable$$module$build$src$core$events$utils();var r=i.getAllVariables();let c;try{if(c=iu(t,i),i.rendered){const u=c,f=c.getDescendants(!1);u.setConnectionTracking(!1);for(let E=f.length-1;0<=E;E--)f[E].initSvg();for(let E=f.length-1;0<=E;E--)f[E].queueRender();setTimeout(function(){u.disposed||u.setConnectionTracking(!0)},1),i.resizeContents()}else{const u=c.getDescendants(!1);for(let f=u.length-1;0<=f;f--)u[f].initModel()}}finally{s.enable$$module$build$src$core$events$utils()}if(Lt()){for(t=Qh(i,r),i=0;i<t.length;i++)r=t[i],it(new(ut(dn))(r));it(new(ut(s.CREATE$$module$build$src$core$events$utils))(c))}return c},mf=function(t,i){for(let c=0;c<t.children.length;c++){var r=t.children[c];const u=r.getAttribute("type"),f=r.getAttribute("id");if(r=r.textContent,!r)break;i.createVariable(r,u,f)}},NE=function(t){const i={mutation:[],comment:[],data:[],field:[],input:[],next:[]};for(let r=0;r<t.children.length;r++){const c=t.children[r];if(c.nodeType!==No.TEXT_NODE)switch(c.nodeName.toLowerCase()){case"mutation":i.mutation.push(c);break;case"comment":i.comment.push(c);break;case"data":i.data.push(c);break;case"title":case"field":i.field.push(c);break;case"value":case"statement":i.input.push(c);break;case"next":i.next.push(c);break;default:console.warn("Ignoring unknown tag: "+c.nodeName)}}return i},LE=function(t,i){let r=!1;for(let c=0;c<t.length;c++){const u=t[c];i.domToMutation&&(i.domToMutation(u),i.initSvg&&(r=!0))}return r},ME=function(t,i){for(let c=0;c<t.length;c++){var r=t[c];const u=r.textContent,f=r.getAttribute("pinned")==="true";let E;const S=parseInt((E=r.getAttribute("w"))!=null?E:"50",10);let W;r=parseInt((W=r.getAttribute("h"))!=null?W:"50",10),i.setCommentText(u);const bt=i.getIcon(xi.COMMENT);isNaN(S)||isNaN(r)||bt.setBubbleSize(new Ce(S,r)),bt.setBubbleVisible(f),setTimeout(()=>bt.setBubbleVisible(f),1)}},xE=function(t,i){for(let r=0;r<t.length;r++)i.data=t[r].textContent},DE=function(t,i){for(let r=0;r<t.length;r++){const c=t[r],u=c.getAttribute("name");u?FE(i,u,c):console.warn(`Ignoring unnamed field in block ${i.type}`)}},$f=function(t){let i=null,r=null;for(let c=0;c<t.childNodes.length;c++){const u=t.childNodes[c];_f(u)&&(u.nodeName.toLowerCase()==="block"?i=u:u.nodeName.toLowerCase()==="shadow"&&(r=u))}return{childBlockElement:i,childShadowElement:r}},PE=function(t,i,r,c){for(let f=0;f<t.length;f++){var u=t[f];const E=u.getAttribute("name"),S=E?r.getInput(E):null;if(!S){console.warn("Ignoring non-existent input "+E+" in block "+c);break}if(u=$f(u),u.childBlockElement){if(!S.connection)throw TypeError("Input connection does not exist.");iu(u.childBlockElement,i,S.connection,!1)}if(u.childShadowElement){let W;(W=S.connection)==null||W.setShadowDom(u.childShadowElement)}}},BE=function(t,i,r){for(let c=0;c<t.length;c++){const u=$f(t[c]);if(u.childBlockElement){if(!r.nextConnection)throw TypeError("Next statement does not exist.");if(r.nextConnection.isConnected())throw TypeError("Next statement is already connected.");iu(u.childBlockElement,i,r.nextConnection,!0)}u.childShadowElement&&r.nextConnection&&r.nextConnection.setShadowDom(u.childShadowElement)}},iu=function(t,i,r,c){var u;const f=t.getAttribute("type");if(!f)throw TypeError("Block type unspecified: "+t.outerHTML);var E=(u=t.getAttribute("id"))!=null?u:void 0;u=i.newBlock(f,E),E=NE(t);const S=LE(E.mutation,u);if(ME(E.comment,u),xE(E.data,u),r)if(c)if(u.previousConnection)r.connect(u.previousConnection);else throw TypeError("Next block does not have previous statement.");else if(u.outputConnection)r.connect(u.outputConnection);else if(u.previousConnection)r.connect(u.previousConnection);else throw TypeError("Child block does not have output or previous statement.");if(DE(E.field,u),PE(E.input,i,u,f),BE(E.next,i,u),S&&u.initSvg(),(i=t.getAttribute("inline"))&&u.setInputsInline(i==="true"),(i=t.getAttribute("disabled"))&&u.setEnabled(i!=="true"&&i!=="disabled"),(i=t.getAttribute("deletable"))&&u.setDeletable(i==="true"),(i=t.getAttribute("movable"))&&u.setMovable(i==="true"),(i=t.getAttribute("editable"))&&u.setEditable(i==="true"),(i=t.getAttribute("collapsed"))&&u.setCollapsed(i==="true"),t.nodeName.toLowerCase()==="shadow"){for(t=u.getChildren(!1),i=0;i<t.length;i++)if(!t[i].isShadow())throw TypeError("Shadow block not allowed non-shadow child.");if(u.getVarModels().length)throw TypeError("Shadow blocks cannot have variable references.");u.setShadow(!0)}return u},FE=function(t,i,r){const c=t.getField(i);c?c.fromXml(r):console.warn("Ignoring non-existent field "+i+" in block "+t.type)},UE=function(t){for(let i=0;i<t.childNodes.length;i++){const r=t.childNodes[i];if(r.nodeName.toLowerCase()==="next"){t.removeChild(r);break}}},_f=function(t){return t.nodeType===No.ELEMENT_NODE},su=function(t){return t.saveState!==void 0&&t.loadState!==void 0},ou=function(t,i){o(rt.SERIALIZER,t,i)},HE=function(t){a(rt.SERIALIZER,t)},Us=function(t,{addCoordinates:i=!1,addInputBlocks:r=!0,addNextBlocks:c=!0,doFullSerialization:u=!0,saveIds:f=!0}={}){if(t.isInsertionMarker())return null;const E={type:t.type,id:f?t.id:void 0};return i&&GE(t,E),VE(t,E),WE(t,E,u),zE(t,E,u),XE(t,E,u),r&&YE(t,E,u,f),c&&KE(t,E,u,f),E},VE=function(t,i){t.isCollapsed()&&(i.collapsed=!0),t.isEnabled()||(i.enabled=!1),t.isOwnDeletable()||(i.deletable=!1),t.isOwnMovable()||(i.movable=!1),t.isOwnEditable()||(i.editable=!1),t.inputsInline!==void 0&&t.inputsInline!==t.inputsInlineDefault&&(i.inline=t.inputsInline),t.data&&(i.data=t.data)},GE=function(t,i){const r=t.workspace;t=t.getRelativeToSurfaceXY(),i.x=Math.round(r.RTL?r.getWidth()-t.x:t.x),i.y=Math.round(t.y)},WE=function(t,i,r){t.saveExtraState?(t=t.saveExtraState(r),t!==null&&(i.extraState=t)):t.mutationToDom&&(t=t.mutationToDom(),t!==null&&(i.extraState=Fs(t).replace(' xmlns="https://developers.google.com/blockly/xml"',"")))},zE=function(t,i,r){const c=Object.create(null);for(const u of t.getIcons())su(u)&&(t=u.saveState(r))&&(c[u.getType().toString()]=t);Object.keys(c).length&&(i.icons=c)},XE=function(t,i,r){const c=Object.create(null);for(let u=0;u<t.inputList.length;u++){const f=t.inputList[u];for(let E=0;E<f.fieldRow.length;E++){const S=f.fieldRow[E];S.isSerializable()&&(c[S.name]=S.saveState(r))}}Object.keys(c).length&&(i.fields=c)},YE=function(t,i,r,c){const u=Object.create(null);for(let f=0;f<t.inputList.length;f++){const E=t.inputList[f];if(!E.connection)continue;const S=Tf(E.connection,r,c);S&&(u[E.name]=S)}Object.keys(u).length&&(i.inputs=u)},KE=function(t,i,r,c){t.nextConnection&&(t=Tf(t.nextConnection,r,c))&&(i.next=t)},Tf=function(t,i,r){const c=t.getShadowState(!0);if(t=t.targetBlock(),!c&&!t)return null;const u=Object.create(null);return c&&(u.shadow=c),t&&!t.isShadow()&&(u.block=Us(t,{doFullSerialization:i,saveIds:r})),u},rn=function(t,i,{recordUndo:r=!1}={}){return t=Qr(t,i,{recordUndo:r}),i.rendered&&Bs(),t},Qr=function(t,i,{parentConnection:r,isShadow:c=!1,recordUndo:u=!1}={}){const f=vt();gt(u),(u=s.getGroup$$module$build$src$core$events$utils())||s.setGroup$$module$build$src$core$events$utils(!0),s.disable$$module$build$src$core$events$utils();let E;try{E=bf(t,i,{parentConnection:r,isShadow:c})}finally{s.enable$$module$build$src$core$events$utils()}if(Lt()&&it(new(ut(s.CREATE$$module$build$src$core$events$utils))(E)),s.setGroup$$module$build$src$core$events$utils(u),gt(f),i.rendered){const S=E;setTimeout(()=>{S.disposed||S.setConnectionTracking(!0)},1)}return E},bf=function(t,i,{parentConnection:r,isShadow:c=!1}={}){if(!t.type)throw new Zy(t);const u=i.newBlock(t.type,t.id);return u.setShadow(c),jE(u,t),JE(u,t),qE(u,t),ZE(r,u,t),QE(u,t),tv(u,t),ev(u,t),iv(u,t),sv(u,i.rendered),u},jE=function(t,i){let r=i.x===void 0?0:i.x;i=i.y===void 0?0:i.y;const c=t.workspace;r=c.RTL?c.getWidth()-r:r,t.moveBy(r,i)},JE=function(t,i){i.collapsed&&t.setCollapsed(!0),i.deletable===!1&&t.setDeletable(!1),i.movable===!1&&t.setMovable(!1),i.editable===!1&&t.setEditable(!1),i.enabled===!1&&t.setEnabled(!1),i.inline!==void 0&&t.setInputsInline(i.inline),i.data!==void 0&&(t.data=i.data)},qE=function(t,i){i.extraState&&(t.loadExtraState?t.loadExtraState(i.extraState):t.domToMutation&&t.domToMutation(s.textToDom$$module$build$src$core$utils$xml(i.extraState)))},ZE=function(t,i,r){if(t){if(t.getSourceBlock().isShadow()&&!i.isShadow())throw new tI(r);if(t.type===s.inputTypes$$module$build$src$core$inputs$input_types.VALUE){var c=i.outputConnection;if(!c)throw new ta("output",i,r)}else if(c=i.previousConnection,!c)throw new ta("previous",i,r);if(!t.connect(c)){const u=i.workspace.connectionChecker;throw new Qy(u.getErrorMessage(u.canConnectWithReason(c,t,!1),c,t),t.type===s.inputTypes$$module$build$src$core$inputs$input_types.VALUE?"output connection":"previous connection",i,r)}}},QE=function(t,i){if(i.icons){var r=Object.keys(i.icons);for(const u of r){r=i.icons[u];var c=t.getIcon(u);if(!c){if(c=p(rt.ICON,u,!1),!c)throw new eI(u,t,i);c=new c(t),t.addIcon(c)}su(c)&&c.loadState(r)}}},tv=function(t,i){if(i.fields){var r=Object.keys(i.fields);for(let c=0;c<r.length;c++){const u=r[c],f=i.fields[u],E=t.getField(u);E?E.loadState(f):console.warn(`Ignoring non-existant field ${u} in block ${t.type}`)}}},ev=function(t,i){if(i.inputs){var r=Object.keys(i.inputs);for(let c=0;c<r.length;c++){const u=r[c],f=t.getInput(u);if(!f||!f.connection)throw new ta(u,t,i);Ef(f.connection,i.inputs[u])}}},iv=function(t,i){if(i.next){if(!t.nextConnection)throw new ta("next",t,i);Ef(t.nextConnection,i.next)}},Ef=function(t,i){i.shadow&&t.setShadowState(i.shadow),i.block&&bf(i.block,t.getSourceBlock().workspace,{parentConnection:t})},sv=function(t,i){if(i){t.setConnectionTracking(!1),t.initSvg(),t.queueRender();for(const r of t.getIcons())r.onLocationChange(t.getRelativeToSurfaceXY())}else t.initModel()},ov=function(t){const i=t.workspace,r=s.config$$module$build$src$core$config.snapRadius,c=t.getRelativeToSurfaceXY(),u=new pt(0,0),f=i.getAllBlocks(!1).filter(E=>E.id!=t.id).map(E=>E.getRelativeToSurfaceXY());for(;nv(pt.sum(c,u),f)||rv(t,u,r);)i.RTL?u.translate(-r,2*r):u.translate(r,2*r);t.moveTo(pt.sum(c,u))},nv=function(t,i){return i.some(r=>1>=Math.abs(r.x-t.x)&&1>=Math.abs(r.y-t.y))},rv=function(t,i,r){return t.getConnections_(!1).some(c=>!!c.closest(r,i).connection)},lv=function(t){return j("Blockly.clipboard.copy","v11","v12","myCopyable.toCopyData()"),Rm.copyInternal(t)},cv=function(t){const i=t.toCopyData();Om=i;let r;return Am=(r=t.workspace)!=null?r:null,i},tl=function(t,i,r){return t&&i?vf(t,i,r):Om&&Am?vf(Om,Am):null},vf=function(t,i,r){let c;i=(c=i.getRootWorkspace())!=null?c:i;let u,f;return(f=(u=g(rt.PASTER,t.paster,!1))==null?void 0:u.paste(t,i,r))!=null?f:null},av=function(t){return j("Blockly.clipboard.duplicate","v11","v12","Blockly.clipboard.paste(myCopyable.toCopyData(), myWorkspace)"),Rm.duplicateInternal(t)},hv=function(t){const i=t.toCopyData();return i?tl(i,t.workspace):null},bs=function(t,i){t.setAttribute(rR,i)},Re=function(t,i,r){Array.isArray(r)&&(r=r.join(" ")),t.setAttribute(nR+i,`${r}`)},er=function(){return Ys},uv=function(t){if(Ys=t,t===null){let i;(i=document.querySelector("."+Mm))==null||i.remove()}},yf=function(){document.querySelector("."+Mm)||(Ys=document.createElement("div"),Ys.className=Mm,(K()||document.body).appendChild(Ys))},nu=function(t,i,r){cs(),wl=t,Gu=r,(t=Ys)&&(t.style.direction=i?"rtl":"ltr",t.style.display="block",i=A(),kl=i.getRenderer().getClassName(),Ol=i.getTheme().getClassName(),kl&&J(t,kl),Ol&&J(t,Ol))},cs=function(){if(If()){wl=null;var t=Ys;t&&(t.style.display="none",t.style.left="",t.style.top="",Gu&&Gu(),Gu=null,t.textContent="",kl&&(mt(t,kl),kl=""),Ol&&(mt(t,Ol),Ol=""),A().markFocused())}},If=function(){return!!wl},ru=function(t){wl===t&&cs()},Sf=function(t,i,r){Ys.style.left=t+"px",Ys.style.top=i+"px",Ys.style.height=r+"px"},Cf=function(t,i,r,c){const u=pv(t,i,r);t=dv(t,i,r,c),0>u?Sf(t,0,r.height+u):Sf(t,u,r.height)},dv=function(t,i,r,c){return c?Math.min(Math.max(i.right-r.width,t.left),t.right-r.width):Math.max(Math.min(i.left,t.right-r.width),t.left)},pv=function(t,i,r){return i.bottom+r.height>=t.bottom?i.top-r.height:i.bottom},fv=function(t){return!(t==null||!t.repositionForWindowResize)},wf=function(){fv(wl)&&wl.repositionForWindowResize()||cs()},gv=function(){return Wu},kf=function(t){Wu=t},Fc=function(t,i,r){if(nu(rI,r,Of),i.length){var c=mv(i,r);zu=c,$v(c,t,r),setTimeout(function(){c.focus()},1),Wu=null}else Uc()},mv=function(t,i){const r=new Nm;r.setRole(Pi.MENU);for(let c=0;c<t.length;c++){const u=t[c],f=new Lm(u.text);f.setRightToLeft(i),f.setRole(Pi.MENUITEM),r.addChild(f),f.setEnabled(u.enabled),u.enabled&&f.onAction(function(){Uc(),requestAnimationFrame(()=>{setTimeout(()=>{u.callback(u.scope)},0)})},{})}return r},$v=function(t,i,r){const c=v();i=new ve(i.clientY+c.top,i.clientY+c.top,i.clientX+c.left,i.clientX+c.left),_v(t);const u=t.getSize();r&&(i.left+=u.width,i.right+=u.width,c.left+=u.width,c.right+=u.width),Cf(c,i,u,r),t.focus()},_v=function(t){var i=er();if(!i)throw Error("Attempting to create a context menu when widget div is null");i=t.render(i),J(i,"blocklyContextMenu"),yt(i,"contextmenu",null,Tv),t.focus()},Tv=function(t){t.preventDefault(),t.stopPropagation()},Uc=function(){ru(rI),Wu=null},Of=function(){zu&&(zu.dispose(),zu=null)},s.callbackFactory$$module$build$src$core$contextmenu=function(t,i){return()=>{s.disable$$module$build$src$core$events$utils();let r;try{r=i instanceof Element?nn(i,t.workspace):Qr(i,t.workspace);const c=t.getRelativeToSurfaceXY();c.x=t.RTL?c.x-s.config$$module$build$src$core$config.snapRadius:c.x+s.config$$module$build$src$core$config.snapRadius,c.y+=2*s.config$$module$build$src$core$config.snapRadius,r.moveBy(c.x,c.y)}finally{s.enable$$module$build$src$core$events$utils()}return Lt()&&!r.isShadow()&&it(new(ut(s.CREATE$$module$build$src$core$events$utils))(r)),r.select(),r}},Af=function(t){return{text:s.Msg$$module$build$src$core$msg.REMOVE_COMMENT,enabled:!0,callback:function(){s.setGroup$$module$build$src$core$events$utils(!0),t.dispose(),s.setGroup$$module$build$src$core$events$utils(!1)}}},Rf=function(t){return{text:s.Msg$$module$build$src$core$msg.DUPLICATE_COMMENT,enabled:!0,callback:function(){const i=t.toCopyData();i&&tl(i,t.workspace)}}},bv=function(t,i){const r={enabled:!0};return r.text=s.Msg$$module$build$src$core$msg.ADD_COMMENT,r.callback=function(){const c=new oi(t,s.Msg$$module$build$src$core$msg.WORKSPACE_COMMENT_DEFAULT_TEXT,oi.DEFAULT_SIZE,oi.DEFAULT_SIZE);var u=t.getInjectionDiv().getBoundingClientRect();u=new pt(i.clientX-u.left,i.clientY-u.top);const f=t.getOriginOffsetInPixels();u=pt.difference(u,f),u.scale(1/t.scale),c.moveBy(u.x,u.y),t.rendered&&(c.initSvg(),c.render(),c.select())},r},el=function(t){return t*Math.PI/180},Nf=function(t){return 180*t/Math.PI},il=function(t,i,r){if(r<t){const c=r;r=t,t=c}return Math.max(t,Math.min(i,r))},Lf=function(){document.querySelector(".blocklyDropDownDiv")||(le=document.createElement("div"),le.className="blocklyDropDownDiv",(K()||document.body).appendChild(le),Nl=document.createElement("div"),Nl.className="blocklyDropDownContent",le.appendChild(Nl),$r=document.createElement("div"),$r.className="blocklyDropDownArrow",le.appendChild($r),le.style.opacity="0",le.style.transition="transform "+Yu+"s, opacity "+Yu+"s",le.addEventListener("focusin",function(){J(le,"blocklyFocused")}),le.addEventListener("focusout",function(){mt(le,"blocklyFocused")}))},Mf=function(t){Bm=t},xf=function(){return _n},sl=function(){return Nl},lu=function(){Nl.textContent="",Nl.style.width=""},cu=function(t,i){le.style.backgroundColor=t,le.style.borderColor=i},Ev=function(t,i,r,c){return Bf(Df(i),t,r,c)},Hc=function(t,i,r){return cI=!0,Bf(Pf(t),t,i,r)},Df=function(t){var i=t.getSvgRoot();const r=t.workspace.scale,c=t.height*r;return t=t.width*r,i=Se(i),new ve(i.y,i.y+c,i.x,i.x+t)},Pf=function(t){return t=t.getScaledBBox(),new ve(t.top,t.bottom,t.left,t.right)},Bf=function(t,i,r,c){const u=t.left+(t.right-t.left)/2,f=t.bottom;t=t.top,c&&(t+=c),c=i.getSourceBlock();let E=c.workspace;for(;E.options.parentWorkspace;)E=E.options.parentWorkspace;return Mf(E.getParentSvg().parentNode),Ff(i,c.RTL,u,f,u,t,r)},Ff=function(t,i,r,c,u,f,E){return _n=t,mr=E||null,le.style.direction=i?"rtl":"ltr",t=A(),Al=t.getRenderer().getClassName(),Rl=t.getTheme().getClassName(),Al&&J(le,Al),Rl&&J(le,Rl),Gf(r,c,u,f)},Uf=function(t,i,r,c){return t=Vc(t,r.left,r.right,c.width),{initialX:t.divX,initialY:i,finalX:t.divX,finalY:i+Dm,arrowX:t.arrowX,arrowY:-(oa/2+xm),arrowAtTop:!0,arrowVisible:!0}},Hf=function(t,i,r,c){return t=Vc(t,r.left,r.right,c.width),{initialX:t.divX,initialY:i-c.height,finalX:t.divX,finalY:i-c.height-Dm,arrowX:t.arrowX,arrowY:c.height-2*xm-oa/2,arrowAtTop:!1,arrowVisible:!0}},vv=function(t,i,r){return t=Vc(t,i.left,i.right,r.width),{initialX:t.divX,initialY:0,finalX:t.divX,finalY:0,arrowAtTop:null,arrowX:null,arrowY:null,arrowVisible:!1}},Vc=function(t,i,r,c){return i=il(i,t-c/2,r-c),t=t-oa/2-i,r=lI,t=il(r,t,c-r-oa),{arrowX:t,divX:i}},Vf=function(){return!!_n},ol=function(t,i){return _n===t?(i?Es():au(),!0):!1},au=function(){le.style.transform="translate(0, 0)",le.style.opacity="0",Pm=setTimeout(function(){Es()},1e3*Yu),mr&&(mr(),mr=null)},Es=function(){Vf()&&(Pm&&clearTimeout(Pm),le.style.transform="",le.style.left="",le.style.top="",le.style.opacity="0",le.style.display="none",le.style.backgroundColor="",le.style.borderColor="",mr&&(mr(),mr=null),lu(),_n=null,Al&&(mt(le,Al),Al=""),Rl&&(mt(le,Rl),Rl=""),A().markFocused())},Gf=function(t,i,r,c){t=Fm.getPositionMetrics(t,i,r,c),t.arrowVisible?($r.style.display="",$r.style.transform="translate("+t.arrowX+"px,"+t.arrowY+"px) rotate(45deg)",$r.setAttribute("class",t.arrowAtTop?"blocklyDropDownArrow blocklyArrowTop":"blocklyDropDownArrow blocklyArrowBottom")):$r.style.display="none",i=Math.floor(t.initialX),r=Math.floor(t.initialY),c=Math.floor(t.finalX);const u=Math.floor(t.finalY);return le.style.left=i+"px",le.style.top=r+"px",le.style.display="block",le.style.opacity="1",le.style.transform="translate("+(c-i)+"px,"+(u-r)+"px)",!!t.arrowAtTop},Wf=function(){if(_n){var t=_n.getSourceBlock();t=cI?Pf(_n):Df(t);const i=t.left+(t.right-t.left)/2;Gf(i,t.bottom,i,t.top)}else au()},zf=function(t){if(!(100<t.getDescendants(!1).length)){var i=t.workspace,r=t.getSvgRoot();i.getAudioManager().play("delete");var c=i.getSvgXY(r);r=r.cloneNode(!0),r.setAttribute("transform","translate("+c.x+","+c.y+")"),i.getParentSvg().appendChild(r),Xf(r,{x:c.x,y:c.y,width:t.width,height:t.height},i.RTL,new Date,i.scale)}},Xf=function(t,i,r,c,u){const f=(new Date().getTime()-c.getTime())/150;1<f?Ct(t):(t.setAttribute("transform","translate("+(i.x+(r?-1:1)*i.width*u/2*f)+","+(i.y+i.height*u*f)+") scale("+(1-f)*u+")"),setTimeout(Xf,10,t,i,r,c,u))},Yf=function(t){var i=t.workspace;const r=i.scale;if(i.getAudioManager().play("click"),!(1>r)){var c=i.getSvgXY(t.getSvgRoot());t.outputConnection?(c.x+=(t.RTL?3:-3)*r,c.y+=13*r):t.previousConnection&&(c.x+=(t.RTL?-23:23)*r,c.y+=3*r);var u=R(D.CIRCLE,{cx:c.x,cy:c.y,r:0,fill:"none",stroke:"#888","stroke-width":10},i.getParentSvg());t=R(D.ANIMATE,{id:"animationCircle",begin:"indefinite",attributeName:"r",dur:"150ms",from:0,to:25*r},u),i=R(D.ANIMATE,{id:"animationOpacity",begin:"indefinite",attributeName:"opacity",dur:"150ms",from:1,to:0},u),t.beginElement(),i.beginElement(),setTimeout(()=>void Ct(u),150)}},Kf=function(t){if(nl(),t.workspace.getAudioManager().play("disconnect"),!(1>t.workspace.scale)){var i=t.getHeightWidth().height;i=Math.atan(10/i)/Math.PI*180,t.RTL||(i*=-1),na=t,jf(t,i,new Date)}},jf=function(t,i,r){const c=(new Date().getTime()-r.getTime())/200;let u="";1>=c&&(u=`skewX(${Math.round(Math.sin(c*Math.PI*3)*(1-c)*i)})`,Ku=setTimeout(jf,10,t,i,r)),t.getSvgRoot().setAttribute("transform",`${t.getTranslation()} ${u}`)},nl=function(){na&&(Ku&&(clearTimeout(Ku),Ku=null),na.getSvgRoot().setAttribute("transform",na.getTranslation()),na=null)},yv=function(t,i){return j("Blockly.utils.string.startsWith()","April 2022","April 2023","Use built-in string.startsWith"),t.startsWith(i)},Gc=function(t){return t.length?t.reduce(function(i,r){return i.length<r.length?i:r}).length:0},Jf=function(t,i){if(!t.length)return 0;if(t.length===1)return t[0].length;let r=0;i=i||Gc(t);let c;for(c=0;c<i;c++){for(var u=t[0][c],f=1;f<t.length;f++)if(u!==t[f][c])return r;u===" "&&(r=c+1)}for(u=1;u<t.length;u++)if((f=t[u][c])&&f!==" ")return r;return i},qf=function(t,i){if(!t.length)return 0;if(t.length===1)return t[0].length;let r=0;i=i||Gc(t);let c;for(c=0;c<i;c++){for(var u=t[0].substr(-c-1,1),f=1;f<t.length;f++)if(u!==t[f].substr(-c-1,1))return r;u===" "&&(r=c+1)}for(u=1;u<t.length;u++)if((f=t[u].charAt(t[u].length-c-1))&&f!==" ")return r;return i},s.wrap$$module$build$src$core$utils$string=function(t,i){t=t.split(`
`);for(let r=0;r<t.length;r++)t[r]=Iv(t[r],i);return t.join(`
`)},Iv=function(t,i){if(t.length<=i)return t;const r=t.trim().split(/\s+/);for(var c=0;c<r.length;c++)r[c].length>i&&(i=r[c].length);var u=-1/0;let f,E=1;do{c=u,f=t,t=[],u=r.length/E;let S=1;for(let W=0;W<r.length-1;W++)S<(W+1.5)/u?(S++,t[W]=!0):t[W]=!1;t=Zf(r,t,i),u=hu(r,t,i),t=Sv(r,t),E++}while(u>c);return f},hu=function(t,i,r){const c=[0],u=[];for(var f=0;f<t.length;f++)c[c.length-1]+=t[f].length,i[f]===!0?(c.push(0),u.push(t[f].charAt(t[f].length-1))):i[f]===!1&&c[c.length-1]++;for(t=Math.max(...c),i=0,f=0;f<c.length;f++)i-=2*Math.pow(Math.abs(r-c[f]),1.5),i-=Math.pow(t-c[f],1.5),".?!".indexOf(u[f])!==-1?i+=r/3:",;)]}".indexOf(u[f])!==-1&&(i+=r/4);return 1<c.length&&c[c.length-1]<=c[c.length-2]&&(i+=.5),i},Zf=function(t,i,r){let c=hu(t,i,r),u;for(let f=0;f<i.length-1;f++){if(i[f]===i[f+1])continue;const E=[].concat(i);E[f]=!E[f],E[f+1]=!E[f+1];const S=hu(t,E,r);S>c&&(c=S,u=E)}return u?Zf(t,u,r):i},Sv=function(t,i){const r=[];for(let c=0;c<t.length;c++)r.push(t[c]),i[c]!==void 0&&r.push(i[c]?`
`:" ");return r.join("")},s.isNumber$$module$build$src$core$utils$string=function(t){return/^\s*-?\d+(\.\d+)?\s*$/.test(t)},Cv=function(t){ju=t},wv=function(){return ju},kv=function(){return la},Ov=function(){return Xe},rl=function(t){if(t=Qf(t)){for(t=t.tooltip;typeof t=="function";)t=t();if(typeof t!="string")throw Error("Tooltip function must return a string.");return t}return""},Qf=function(t){for(;t&&t.tooltip;){if(typeof t.tooltip=="string"||typeof t.tooltip=="function")return t;t=t.tooltip}return null},tg=function(){document.querySelector(".blocklyTooltipDiv")||(Xe=document.createElement("div"),Xe.className="blocklyTooltipDiv",(K()||document.body).appendChild(Xe))},ll=function(t){t.mouseOverWrapper_=w(t,"pointerover",null,Av),t.mouseOutWrapper_=w(t,"pointerout",null,Rv),t.addEventListener("pointermove",eg,!1)},uu=function(t){t&&(N(t.mouseOverWrapper_),N(t.mouseOutWrapper_),t.removeEventListener("pointermove",eg))},Av=function(t){Ll||(t=Qf(t.currentTarget),as!==t&&(Io(),ca=null,as=t),clearTimeout(pI))},Rv=function(t){Ll||(pI=setTimeout(function(){ca=as=null,Io()},1),clearTimeout(br),br=0)},eg=function(t){if(as&&as.tooltip&&!Ll)if(la){const i=Wm-t.pageX;t=zm-t.pageY,Math.sqrt(i*i+t*t)>fI&&Io()}else ca!==as&&(clearTimeout(br),Wm=t.pageX,zm=t.pageY,br=setTimeout(xv,gI))},ig=function(){ca=as=null,Io()},Io=function(){la&&(la=!1,Xe&&(Xe.style.display="none")),br&&(clearTimeout(br),br=0)},sg=function(){Io(),Ll=!0},og=function(){Ll=!1},Nv=function(){Xe&&as&&(typeof ju=="function"?ju(Xe,as):Lv())},Lv=function(){var t=rl(as);t=s.wrap$$module$build$src$core$utils$string(t,dI),t=t.split(`
`);for(let i=0;i<t.length;i++){const r=document.createElement("div");r.appendChild(document.createTextNode(t[i])),Xe.appendChild(r)}},Mv=function(t){const i=document.documentElement.clientWidth,r=document.documentElement.clientHeight;let c=Wm;c=t?c-(Xm+Xe.offsetWidth):c+Xm;let u=zm+Ym;return u+Xe.offsetHeight>r+window.scrollY&&(u-=Xe.offsetHeight+2*Ym),t?c=Math.max(Ju-window.scrollX,c):c+Xe.offsetWidth>i+window.scrollX-2*Ju&&(c=i-Xe.offsetWidth-2*Ju),{x:c,y:u}},xv=function(){if(!Ll&&(ca=as,Xe)){Xe.textContent="",Nv();var t=as.RTL;Xe.style.direction=t?"rtl":"ltr",Xe.style.display="block",la=!0;var{x:i,y:r}=Mv(t);Xe.style.left=i+"px",Xe.style.top=r+"px"}},So=function(t,i){for(const r in i)t[r]=i[r]!==null&&typeof i[r]=="object"?So(t[r]||Object.create(null),i[r]):i[r];return t},ln=function(t){return t.bubbleIsVisible!==void 0&&t.setBubbleVisible!==void 0},du=function(){return jm},ng=function(t){jm=t},pu=function(){return Jm},rg=function(t){Jm=t},cn=function(t){t=`${t}`.toLowerCase().trim();var i=_I[t];if(i||(i=t.substring(0,2)==="0x"?"#"+t.substring(2):t,i=i[0]==="#"?i:"#"+i,/^#[0-9a-f]{6}$/.test(i)))return i;if(/^#[0-9a-f]{3}$/.test(i))return["#",i[1],i[1],i[2],i[2],i[3],i[3]].join("");var r=t.match(/^(?:rgb)?\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/);return r&&(t=Number(r[1]),i=Number(r[2]),r=Number(r[3]),0<=t&&256>t&&0<=i&&256>i&&0<=r&&256>r)?Wc(t,i,r):null},Wc=function(t,i,r){return i=t<<16|i<<8|r,16>t?"#"+(16777216|i).toString(16).substr(1):"#"+i.toString(16)},fu=function(t){return t=cn(t),t?(t=parseInt(t.substr(1),16),[t>>16,t>>8&255,t&255]):[0,0,0]},gu=function(t,i,r){let c=0,u=0,f=0;if(i===0)f=u=c=r;else{const E=Math.floor(t/60),S=t/60-E;t=r*(1-i);const W=r*(1-i*S);switch(i=r*(1-i*(1-S)),E){case 1:c=W,u=r,f=t;break;case 2:c=t,u=r,f=i;break;case 3:c=t,u=W,f=r;break;case 4:c=i,u=t,f=r;break;case 5:c=r,u=t,f=W;break;case 6:case 0:c=r,u=i,f=t}}return Wc(Math.floor(c),Math.floor(u),Math.floor(f))},ir=function(t,i,r){return t=cn(t),!t||(i=cn(i),!i)?null:(t=fu(t),i=fu(i),Wc(Math.round(i[0]+r*(t[0]-i[0])),Math.round(i[1]+r*(t[1]-i[1])),Math.round(i[2]+r*(t[2]-i[2]))))},lg=function(t){return gu(t,jm,255*Jm)},mu=function(t,i,r){const c=[];var u=t.split("");u.push("");var f=0;t=[];let E=null;for(let bt=0;bt<u.length;bt++){var S=u[bt];if(f===0)if(S==="%")(f=t.join(""))&&c.push(f),t.length=0,f=1;else if(r&&S===`
`){const ke=t.join("");ke&&c.push(ke),t.length=0,c.push(S)}else t.push(S);else if(f===1)S==="%"?(t.push(S),f=0):i&&"0"<=S&&"9">=S?(f=2,E=S,(S=t.join(""))&&c.push(S),t.length=0):S==="{"?f=3:(t.push("%",S),f=0);else if(f===2)if("0"<=S&&"9">=S)E+=S;else{var W=void 0;c.push(parseInt((W=E)!=null?W:"",10)),bt--,f=0}else f===3&&(S===""?(t.splice(0,0,"%{"),bt--,f=0):S!=="}"?t.push(S):(f=t.join(""),/[A-Z]\w*/i.test(f)?(S=f.toUpperCase(),(S=S.startsWith("BKY_")?S.substring(4):null)&&S in s.Msg$$module$build$src$core$msg?(f=s.Msg$$module$build$src$core$msg[S],typeof f=="string"?Array.prototype.push.apply(c,mu(f,i,r)):i?c.push(`${f}`):c.push(f)):c.push("%{"+f+"}")):c.push("%{"+f+"}"),f=t.length=0))}for((i=t.join(""))&&c.push(i),W=[],t.length=0,u=0;u<c.length;u++)typeof c[u]!="string"||r&&c[u]===`
`?((i=t.join(""))&&W.push(i),t.length=0,W.push(c[u])):t.push(c[u]);return(i=t.join(""))&&W.push(i),t.length=0,W},cg=function(t){return mu(t,!0,!0)},Fe=function(t){return typeof t!="string"?t:(t=mu(t,!1,!1),t.length?String(t[0]):"")},Dv=function(t){let i=!0;const r=s.Msg$$module$build$src$core$msg,c=t.match(/%{BKY_[A-Z]\w*}/gi);if(c)for(let u=0;u<c.length;u++){const f=c[u].toUpperCase();r[f.slice(6,-1)]===void 0&&(console.warn("No message string for "+c[u]+" in "+t),i=!1)}return i},cl=function(t){const i=typeof t=="string"?Fe(t):t;var r=Number(i);if(!isNaN(r)&&0<=r&&360>=r)return{hue:r,hex:gu(r,du(),255*pu())};if(r=cn(i))return{hue:null,hex:r};throw r='Invalid colour: "'+i+'"',t!==i&&(r+=' (from "'+t+'")'),Error(r)},an=function(t){return t.getProcedureModel!==void 0&&t.doProcedureUpdate!==void 0&&t.isProcedureDef!==void 0},$u=function(t){return t.startPublishing!==void 0&&t.stopPublishing!==void 0},zi=function(t,i){o(rt.FIELD,t,i)},Pv=function(t){a(rt.FIELD,t)},s.fromJson$$module$build$src$core$field_registry=function(t){return bI.fromJsonInternal(t)},Bv=function(t){const i=g(rt.FIELD,t.type);if(i){if(typeof i.fromJson!="function")throw new TypeError("returned Field was not a IRegistrableField");return i.fromJson(t)}return console.warn("Blockly could not create a field of type "+t.type+". The field is probably not being registered. This could be because the file is not loaded, the field does not register itself (Issue #1584), or the registration is not being reached."),null},Fv=function(t){let i=!1;const r=t.map(([E,S])=>typeof E=="string"?[Fe(E),S]:(i=!0,[E.alt!==null?Object.assign({},E,{alt:Fe(E.alt)}):Object.assign({},E),S]));if(i||2>t.length)return{options:r};var c=r.map(([E])=>E),u=Gc(c);t=Jf(c,u);const f=qf(c,u);return!t&&!f||u<=t+f?{options:r}:(u=t?c[0].substring(0,t-1):void 0,c=f?c[0].substr(1-f):void 0,{options:Uv(r,t,f),prefix:u,suffix:c})},Uv=function(t,i,r){return t.map(([c,u])=>[c.substring(i,c.length-r),u])},ag=function(t){if(!Array.isArray(t))throw TypeError("FieldDropdown options must be an array.");if(!t.length)throw TypeError("FieldDropdown options must not be an empty array.");let i=!1;for(let r=0;r<t.length;r++){const c=t[r];Array.isArray(c)?typeof c[1]!="string"?(i=!0,console.error("Invalid option["+r+"]: Each FieldDropdown option id must be a string. Found "+c[1]+" in: ",c)):c[0]&&typeof c[0]!="string"&&typeof c[0].src!="string"&&(i=!0,console.error("Invalid option["+r+"]: Each FieldDropdown option must have a string label or image description. Found"+c[0]+" in: ",c)):(i=!0,console.error("Invalid option["+r+"]: Each FieldDropdown option must be an array. Found: ",c))}if(i)throw TypeError("Found invalid FieldDropdown options.")},s.register$$module$build$src$core$extensions=function(t,i){if(typeof t!="string"||t.trim()==="")throw Error('Error: Invalid extension name "'+t+'"');if(Ml[t])throw Error('Error: Extension "'+t+'" is already registered.');if(typeof i!="function")throw Error('Error: Extension "'+t+'" must be a function');Ml[t]=i},s.registerMixin$$module$build$src$core$extensions=function(t,i){if(!i||typeof i!="object")throw Error('Error: Mixin "'+t+'" must be a object');s.register$$module$build$src$core$extensions(t,function(){this.mixin(i)})},s.registerMutator$$module$build$src$core$extensions=function(t,i,r,c){const u='Error when registering mutator "'+t+'": ';dg(u,i);const f=ug(i,u);if(r&&typeof r!="function")throw Error(u+'Extension "'+t+'" is not a function');s.register$$module$build$src$core$extensions(t,function(){f&&this.setMutator(new s.MutatorIcon$$module$build$src$core$icons$mutator_icon(c||[],this)),this.mixin(i),r&&r.apply(this)})},Hv=function(t){hg(t)?delete Ml[t]:console.warn('No extension mapping for name "'+t+'" found to unregister')},hg=function(t){return!!Ml[t]},_u=function(t,i,r){const c=Ml[t];if(typeof c!="function")throw Error('Error: Extension "'+t+'" not found.');let u;if(r?Vv(t,i):u=bu(i),c.apply(i),r)dg('Error after applying mutator "'+t+'": ',i);else if(!zv(u,i))throw Error('Error when applying extension "'+t+'": mutation properties changed when applying a non-mutator extension.')},Vv=function(t,i){if(bu(i).length)throw Error('Error: tried to apply mutation "'+t+'" to a block that already has mutator functions.  Block id: '+i.id)},Gv=function(t,i){return Tu(t.mutationToDom,t.domToMutation,i+" mutationToDom/domToMutation")},Wv=function(t,i){return Tu(t.saveExtraState,t.loadExtraState,i+" saveExtraState/loadExtraState")},ug=function(t,i){return Tu(t.compose,t.decompose,i+" compose/decompose")},Tu=function(t,i,r){if(t&&i){if(typeof t!="function"||typeof i!="function")throw Error(r+" must be a function");return!0}if(!t&&!i)return!1;throw Error(r+"Must have both or neither functions")},dg=function(t,i){const r=Gv(i,t),c=Wv(i,t);if(!r&&!c)throw Error(t+"Mutations must contain either XML hooks, or JSON hooks, or both");ug(i,t)},bu=function(t){const i=[];return t.domToMutation!==void 0&&i.push(t.domToMutation),t.mutationToDom!==void 0&&i.push(t.mutationToDom),t.saveExtraState!==void 0&&i.push(t.saveExtraState),t.loadExtraState!==void 0&&i.push(t.loadExtraState),t.compose!==void 0&&i.push(t.compose),t.decompose!==void 0&&i.push(t.decompose),i},zv=function(t,i){if(i=bu(i),i.length!==t.length)return!1;for(let r=0;r<i.length;r++)if(t[r]!==i[r])return!1;return!0},Xv=function(t){if(typeof document!="object")throw Error("runAfterPageLoad() requires browser document.");if(document.readyState==="complete")t();else{const i=setInterval(function(){document.readyState==="complete"&&(clearInterval(i),t())},10)}},s.buildTooltipForDropdown$$module$build$src$core$extensions=function(t,i){const r=[];return function(){r.indexOf(this.type)===-1&&(Yv(this,t,i),r.push(this.type)),this.setTooltip((function(){const c=String(this.getFieldValue(t));return Fe(i[c])}).bind(this))}},Yv=function(t,i,r){var c=t.getField(i);if(c instanceof Js&&!c.isOptionListDynamic()){c=c.getOptions();for(const[,u]of c)r[u]===void 0&&console.warn(`No tooltip mapping for value ${u} of field ${i} of block type ${t.type}.`)}},s.buildTooltipWithFieldText$$module$build$src$core$extensions=function(t,i){return function(){this.setTooltip((function(){const r=this.getField(i);return Fe(t).replace("%1",r?r.getText():"")}).bind(this))}},Kv=function(){const t=this.tooltip;this.setTooltip((function(){const i=this.getParent();return i&&i.getInputsInline()&&i.tooltip||t}).bind(this))},Ot=function(t,i){return" "+t+","+i+" "},Li=function(t,i){return" "+t+i.join("")},ei=function(t,i){return" M "+t+","+i+" "},Ne=function(t,i){return" m "+t+","+i+" "},Hs=function(t,i){return" l "+t+","+i+" "},al=function(t){return" l"+t.join("")},It=function(t,i){return" "+t+" "+i+" "},Ve=function(t,i,r,c){return t+" "+r+" "+r+" "+i+c},pg=function(t,i){o(rt.ICON,t.toString(),i)},jv=function(t){a(rt.ICON,t)},Eu=function(t){const i=t.getProcedureMap().getProcedures().filter(c=>!c.getReturnTypes()).map(c=>[c.getName(),c.getParameters().map(u=>u.getName()),!1]);t.getBlocksByType("procedures_defnoreturn",!1).forEach(c=>{!an(c)&&qr(c)&&i.push(c.getProcedureDef())});const r=t.getProcedureMap().getProcedures().filter(c=>!!c.getReturnTypes()).map(c=>[c.getName(),c.getParameters().map(u=>u.getName()),!0]);return t.getBlocksByType("procedures_defreturn",!1).forEach(c=>{!an(c)&&qr(c)&&r.push(c.getProcedureDef())}),i.sort(fg),r.sort(fg),[i,r]},fg=function(t,i){return t[0].localeCompare(i[0],void 0,{sensitivity:"base"})},s.findLegalName$$module$build$src$core$procedures=function(t,i){if(i.isInFlyout)return t;for(t=t||s.Msg$$module$build$src$core$msg.UNNAMED_KEY||"unnamed";!Jv(t,i.workspace,i);){const r=t.match(/^(.*?)(\d+)$/);t=r?r[1]+(parseInt(r[2])+1):t+"2"}return t},Jv=function(t,i,r){return!gg(t,i,r)},gg=function(t,i,r){for(const c of i.getAllBlocks(!1))if(c!==r&&qr(c)&&s.Names$$module$build$src$core$names.equals(c.getProcedureDef()[0],t))return!0;r=r&&an(r)?r==null?void 0:r.getProcedureModel():void 0;for(const c of i.getProcedureMap().getProcedures())if(c!==r&&s.Names$$module$build$src$core$names.equals(c.getName(),t))return!0;return!1},s.rename$$module$build$src$core$procedures=function(t){var i=this.getSourceBlock();if(!i)throw new ye;t=t.trim();const r=s.findLegalName$$module$build$src$core$procedures(t,i);an(i)&&!i.isInsertionMarker()&&i.getProcedureModel().setName(r);const c=this.getValue();if(c!==t&&c!==r)for(t=i.workspace.getAllBlocks(!1),i=0;i<t.length;i++){const u=t[i];u.renameProcedure&&u.renameProcedure(c,r)}return r},vu=function(t){function i(f,E){for(let W=0;W<f.length;W++){var S=f[W][0];const bt=f[W][1],ke=s.createElement$$module$build$src$core$utils$xml("block");ke.setAttribute("type",E),ke.setAttribute("gap","16");const Ie=s.createElement$$module$build$src$core$utils$xml("mutation");for(Ie.setAttribute("name",S),ke.appendChild(Ie),S=0;S<bt.length;S++){const Bi=s.createElement$$module$build$src$core$utils$xml("arg");Bi.setAttribute("name",bt[S]),Ie.appendChild(Bi)}r.push(ke)}}const r=[];if(Mi.procedures_defnoreturn){var c=s.createElement$$module$build$src$core$utils$xml("block");c.setAttribute("type","procedures_defnoreturn"),c.setAttribute("gap","16");var u=s.createElement$$module$build$src$core$utils$xml("field");u.setAttribute("name","NAME"),u.appendChild(s.createTextNode$$module$build$src$core$utils$xml(s.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_PROCEDURE)),c.appendChild(u),r.push(c)}return Mi.procedures_defreturn&&(c=s.createElement$$module$build$src$core$utils$xml("block"),c.setAttribute("type","procedures_defreturn"),c.setAttribute("gap","16"),u=s.createElement$$module$build$src$core$utils$xml("field"),u.setAttribute("name","NAME"),u.appendChild(s.createTextNode$$module$build$src$core$utils$xml(s.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_PROCEDURE)),c.appendChild(u),r.push(c)),Mi.procedures_ifreturn&&(c=s.createElement$$module$build$src$core$utils$xml("block"),c.setAttribute("type","procedures_ifreturn"),c.setAttribute("gap","16"),r.push(c)),r.length&&r[r.length-1].setAttribute("gap","24"),t=Eu(t),i(t[0],"procedures_callnoreturn"),i(t[1],"procedures_callreturn"),r},mg=function(t){var i=[],r=t.getBlocksByType("procedures_mutatorarg",!1);for(let f=0,E;E=r[f];f++)i.push(E.getFieldValue("NAME"));r=s.createElement$$module$build$src$core$utils$xml("xml");const c=s.createElement$$module$build$src$core$utils$xml("block");c.setAttribute("type","procedures_mutatorarg");const u=s.createElement$$module$build$src$core$utils$xml("field");u.setAttribute("name","NAME"),i=qh(s.DEFAULT_ARG$$module$build$src$core$procedures,i),i=s.createTextNode$$module$build$src$core$utils$xml(i),u.appendChild(i),c.appendChild(u),r.appendChild(c),t.updateToolbox(r)},$g=function(t){if(t.type===Vs&&t.bubbleType==="mutator"&&t.isOpen&&t.blockId){t=b(t.workspaceId).getBlockById(t.blockId);var i=t.type;(i==="procedures_defnoreturn"||i==="procedures_defreturn")&&(t=t.getIcon(s.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE).getWorkspace(),mg(t),t.addChangeListener(qv))}},qv=function(t){(t.type===s.CREATE$$module$build$src$core$events$utils||t.type===s.DELETE$$module$build$src$core$events$utils||t.type===s.CHANGE$$module$build$src$core$events$utils||t.type===un)&&(t=b(t.workspaceId),mg(t))},_g=function(t,i){return i.getAllBlocks(!1).filter(r=>Zv(r,t)||$E(r)&&s.Names$$module$build$src$core$names.equals(r.getProcedureCall(),t))},Zv=function(t,i){return an(t)&&!t.isProcedureDef()&&t.getProcedureModel()&&s.Names$$module$build$src$core$names.equals(t.getProcedureModel().getName(),i)},s.mutateCallers$$module$build$src$core$procedures=function(t){const i=vt();var r=t.getProcedureDef()[0];const c=t.mutationToDom(!0);t=_g(r,t.workspace);for(let f=0,E;E=t[f];f++){r=(r=E.mutationToDom())&&Ut(r),E.domToMutation&&E.domToMutation(c);var u=E.mutationToDom();u=u&&Ut(u),r!==u&&(gt(!1),it(new(ut(s.CHANGE$$module$build$src$core$events$utils))(E,"mutation",null,r,u)),gt(i))}},s.getDefinition$$module$build$src$core$procedures=function(t,i){for(const r of i.getAllBlocks(!1))if(an(r)&&r.isProcedureDef()&&s.Names$$module$build$src$core$names.equals(r.getProcedureModel().getName(),t)||qr(r)&&s.Names$$module$build$src$core$names.equals(r.getProcedureDef()[0],t))return r;return null},Tg=function(t){return t.isDynamic},zc=function(t){let i=t.outputConnection;return(!i||t.previousConnection&&t.previousConnection.isConnected())&&(i=t.previousConnection),i},Qv=function(t,i){if(!t||!i)throw Error("Cannot connect null connections.");t.targetConnection=i,i.targetConnection=t},ty=function(t,i){let r=null;i=i.outputConnection;const c=i==null?void 0:i.getConnectionChecker();for(let u=0,f;f=t.inputList[u];u++){const E=f.connection;let S;if(E&&((S=c)!=null&&S.canConnect(i,E,!1))){if(r)return null;r=E}}return r},ey=function(t,i){let r;for(;r=ty(t,i);)if(t=r.targetBlock(),!t||t.isShadow())return r;return null},hl=function(t,i){o(rt.RENDERER,t,i)},iy=function(t){a(rt.RENDERER,t)},bg=function(t,i,r){return t=new(p(rt.RENDERER,t))(t),t.init(i,r),t},Eg=function(t){Zr(t.getTargetWorkspace(),void 0,"String")},vg=function(t){Zr(t.getTargetWorkspace(),void 0,"Number")},yg=function(t){Zr(t.getTargetWorkspace(),void 0,"Colour")},yu=function(t){let i=[],r=document.createElement("button");return r.setAttribute("text",s.Msg$$module$build$src$core$msg.NEW_STRING_VARIABLE),r.setAttribute("callbackKey","CREATE_VARIABLE_STRING"),i.push(r),r=document.createElement("button"),r.setAttribute("text",s.Msg$$module$build$src$core$msg.NEW_NUMBER_VARIABLE),r.setAttribute("callbackKey","CREATE_VARIABLE_NUMBER"),i.push(r),r=document.createElement("button"),r.setAttribute("text",s.Msg$$module$build$src$core$msg.NEW_COLOUR_VARIABLE),r.setAttribute("callbackKey","CREATE_VARIABLE_COLOUR"),i.push(r),t.registerButtonCallback("CREATE_VARIABLE_STRING",Eg),t.registerButtonCallback("CREATE_VARIABLE_NUMBER",vg),t.registerButtonCallback("CREATE_VARIABLE_COLOUR",yg),t=Ig(t),i=i.concat(t)},Ig=function(t){t=t.getAllVariables();const i=[];if(0<t.length){if(Mi.variables_set_dynamic){var r=t[t.length-1];const c=s.createElement$$module$build$src$core$utils$xml("block");c.setAttribute("type","variables_set_dynamic"),c.setAttribute("gap","24"),c.appendChild(tr(r)),i.push(c)}if(Mi.variables_get_dynamic){t.sort(Qc.compareByName);for(let c=0,u;u=t[c];c++)r=s.createElement$$module$build$src$core$utils$xml("block"),r.setAttribute("type","variables_get_dynamic"),r.setAttribute("gap","8"),r.appendChild(tr(u)),i.push(r)}}return i},Xc=function(t){return t.toCopyData!==void 0},Sg=function(){ae.registry.register({name:eo.ESCAPE,preconditionFn(t){return!t.options.readOnly},callback(t){return t.hideChaff(),!0},keyCodes:[Kt.ESC]})},Cg=function(){ae.registry.register({name:eo.DELETE,preconditionFn(t){const i=z();return!t.options.readOnly&&i!=null&&i.isDeletable()},callback(t,i){return i.preventDefault(),Mo.inProgress()?!1:(z().checkAndDelete(),!0)},keyCodes:[Kt.DELETE,Kt.BACKSPACE]})},wg=function(){const t=ae.registry.createSerializedKey(Kt.C,[Kt.CTRL]),i=ae.registry.createSerializedKey(Kt.C,[Kt.ALT]),r=ae.registry.createSerializedKey(Kt.C,[Kt.META]);ae.registry.register({name:eo.COPY,preconditionFn(c){const u=z();return!c.options.readOnly&&!Mo.inProgress()&&u!=null&&u.isDeletable()&&u.isMovable()&&Xc(u)},callback(c,u){return u.preventDefault(),c.hideChaff(),u=z(),!u||!Xc(u)?!1:(ba=u.toCopyData(),ad=c,!!ba)},keyCodes:[t,i,r]})},kg=function(){const t=ae.registry.createSerializedKey(Kt.X,[Kt.CTRL]),i=ae.registry.createSerializedKey(Kt.X,[Kt.ALT]),r=ae.registry.createSerializedKey(Kt.X,[Kt.META]);ae.registry.register({name:eo.CUT,preconditionFn(c){const u=z();return!c.options.readOnly&&!Mo.inProgress()&&u!=null&&u instanceof to&&u.isDeletable()&&u.isMovable()&&!u.workspace.isFlyout},callback(c){const u=z();return!u||!Xc(u)?!1:(ba=u.toCopyData(),ad=c,u.checkAndDelete(),!0)},keyCodes:[t,i,r]})},Og=function(){const t=ae.registry.createSerializedKey(Kt.V,[Kt.CTRL]),i=ae.registry.createSerializedKey(Kt.V,[Kt.ALT]),r=ae.registry.createSerializedKey(Kt.V,[Kt.META]);ae.registry.register({name:eo.PASTE,preconditionFn(c){return!c.options.readOnly&&!Mo.inProgress()},callback(){return ba&&ad?!!tl(ba,ad):!1},keyCodes:[t,i,r]})},Ag=function(){const t=ae.registry.createSerializedKey(Kt.Z,[Kt.CTRL]),i=ae.registry.createSerializedKey(Kt.Z,[Kt.ALT]),r=ae.registry.createSerializedKey(Kt.Z,[Kt.META]);ae.registry.register({name:eo.UNDO,preconditionFn(c){return!c.options.readOnly&&!Mo.inProgress()},callback(c){return c.hideChaff(),c.undo(!1),!0},keyCodes:[t,i,r]})},Rg=function(){const t=ae.registry.createSerializedKey(Kt.Z,[Kt.SHIFT,Kt.CTRL]),i=ae.registry.createSerializedKey(Kt.Z,[Kt.SHIFT,Kt.ALT]),r=ae.registry.createSerializedKey(Kt.Z,[Kt.SHIFT,Kt.META]),c=ae.registry.createSerializedKey(Kt.Y,[Kt.CTRL]);ae.registry.register({name:eo.REDO,preconditionFn(u){return!Mo.inProgress()&&!u.options.readOnly},callback(u){return u.hideChaff(),u.undo(!0),!0},keyCodes:[t,i,r,c]})},Ng=function(){Sg(),Cg(),wg(),kg(),Og(),Ag(),Rg()},Lg=function(t){const i={id:t.getId(),name:t.getName(),returnTypes:t.getReturnTypes()};return t.getParameters().length&&(i.parameters=t.getParameters().map(r=>Mg(r))),i},Mg=function(t){const i={id:t.getId(),name:t.getName()};return t.getTypes().length&&(i.types=t.getTypes()),i},xg=function(t,i,r,c){if(t=new t(c,r.name,r.id).setReturnTypes(r.returnTypes),!r.parameters)return t;for(const[u,f]of r.parameters.entries())t.insertParameter(Dg(i,f,c),u);return t},Dg=function(t,i,r){return t=new t(r,i.name,i.id),i.types&&t.setTypes(i.types),t},sy=function(t){const i=Object.create(null),r=m(rt.SERIALIZER,!0);for(const c in r){let u;const f=(u=r[c])==null?void 0:u.save(t);f&&(i[c]=f)}return i},oy=function(t,i,{recordUndo:r=!1}={}){var c=m(rt.SERIALIZER,!0);if(c){c=Object.entries(c).sort((f,E)=>E[1].priority-f[1].priority);var u=vt();gt(r),(r=s.getGroup$$module$build$src$core$events$utils())||s.setGroup$$module$build$src$core$events$utils(!0),I(),i instanceof Ss&&i.setResizesEnabled(!1);for(const[,f]of c.reverse()){let E;(E=f)==null||E.clear(i)}for(let[f,E]of c.reverse())if(t[f]){let S;(S=E)==null||S.load(t[f],i)}i instanceof Ss&&i.setResizesEnabled(!0),M(),it(new(ut(rr))(i)),s.setGroup$$module$build$src$core$events$utils(r),gt(u)}},ul=function(t,i,r){const c=r.getBoundingRectangle(),u=c.right-c.left,f=il(i.top,c.top,i.top+i.height-(c.bottom-c.top))-c.top;let E=i.left;return i=i.left+i.width-u,t.RTL?E=Math.min(i,E):i=Math.max(E,i),(t=il(E,c.left,i)-c.left)||f?(r.moveBy(t,f,["inbounds"]),!0):!1},Pg=function(t){return i=>{var r=t.getMetricsManager();if(r.hasFixedEdges()&&!t.isDragging()){var c;if(Ou.indexOf((c=i.type)!=null?c:"")!==-1){c=r.getScrollMetrics(!0);const u=ny(t,i);u&&(r=s.getGroup$$module$build$src$core$events$utils()||!1,s.setGroup$$module$build$src$core$events$utils(i.group),ul(t,c,u)&&!i.group&&console.warn("Moved object in bounds but there was no event group. This may break undo."),s.setGroup$$module$build$src$core$events$utils(r))}else i.type===pn&&i.scale&&i.oldScale&&i.scale>i.oldScale&&Iu(t)}}},ny=function(t,i){let r=null;switch(i.type){case s.CREATE$$module$build$src$core$events$utils:case s.MOVE$$module$build$src$core$events$utils:(r=t.getBlockById(i.blockId))&&(r=r.getRootBlock());break;case fn:case Gs:r=t.getCommentById(i.commentId)}return r},Iu=function(t){var i=t.getMetricsManager();if(i.hasFixedEdges()&&!t.isDragging()){i=i.getScrollMetrics(!0);var r=t.getTopBoundedElements();for(let c=0,u;u=r[c];c++)ul(t,i,u)}},Bg=function(t,i){const r=[];for(const c of t.getIcons())(!ln(c)||c.bubbleIsVisible())&&(r.push({location:i,icon:c}),c.onLocationChange(i));for(const c of t.getChildren(!1))r.push(...Bg(c,pt.sum(i,c.relativeCoords)));return r},Fg=function(){ne.registry.register({displayText(){return s.Msg$$module$build$src$core$msg.UNDO},preconditionFn(t){return 0<t.workspace.getUndoStack().length?"enabled":"disabled"},callback(t){t.workspace.undo(!1)},scopeType:ne.ScopeType.WORKSPACE,id:"undoWorkspace",weight:1})},Ug=function(){ne.registry.register({displayText(){return s.Msg$$module$build$src$core$msg.REDO},preconditionFn(t){return 0<t.workspace.getRedoStack().length?"enabled":"disabled"},callback(t){t.workspace.undo(!0)},scopeType:ne.ScopeType.WORKSPACE,id:"redoWorkspace",weight:2})},Hg=function(){ne.registry.register({displayText(){return s.Msg$$module$build$src$core$msg.CLEAN_UP},preconditionFn(t){return t.workspace.isMovable()?1<t.workspace.getTopBlocks(!1).length?"enabled":"disabled":"hidden"},callback(t){t.workspace.cleanUp()},scopeType:ne.ScopeType.WORKSPACE,id:"cleanWorkspace",weight:3})},Vg=function(t,i){function r(f){u--,f.setCollapsed(t),u===0&&s.setGroup$$module$build$src$core$events$utils(!1)}let c=0,u=0;s.setGroup$$module$build$src$core$events$utils(!0);for(let f=0;f<i.length;f++){let E=i[f];for(;E;)u++,setTimeout(r.bind(null,E),c),E=E.getNextBlock(),c+=10}},Gg=function(){ne.registry.register({displayText(){return s.Msg$$module$build$src$core$msg.COLLAPSE_ALL},preconditionFn(t){if(t.workspace.options.collapse){t=t.workspace.getTopBlocks(!1);for(let i=0;i<t.length;i++){let r=t[i];for(;r;){if(!r.isCollapsed())return"enabled";r=r.getNextBlock()}}return"disabled"}return"hidden"},callback(t){Vg(!0,t.workspace.getTopBlocks(!0))},scopeType:ne.ScopeType.WORKSPACE,id:"collapseWorkspace",weight:4})},Wg=function(){ne.registry.register({displayText(){return s.Msg$$module$build$src$core$msg.EXPAND_ALL},preconditionFn(t){if(t.workspace.options.collapse){t=t.workspace.getTopBlocks(!1);for(let i=0;i<t.length;i++){let r=t[i];for(;r;){if(r.isCollapsed())return"enabled";r=r.getNextBlock()}}return"disabled"}return"hidden"},callback(t){Vg(!1,t.workspace.getTopBlocks(!0))},scopeType:ne.ScopeType.WORKSPACE,id:"expandWorkspace",weight:5})},zg=function(t,i){if(t.isDeletable())Array.prototype.push.apply(i,t.getDescendants(!1));else{t=t.getChildren(!1);for(let r=0;r<t.length;r++)zg(t[r],i)}},Su=function(t){const i=[];t=t.getTopBlocks(!0);for(let r=0;r<t.length;r++)zg(t[r],i);return i},Yc=function(t,i){i?s.setGroup$$module$build$src$core$events$utils(i):(s.setGroup$$module$build$src$core$events$utils(!0),i=s.getGroup$$module$build$src$core$events$utils());const r=t.shift();r&&(r.isDeadOrDying()?Yc(t,i):(r.dispose(!1,!0),setTimeout(Yc,10,t,i))),s.setGroup$$module$build$src$core$events$utils(!1)},Xg=function(){ne.registry.register({displayText(t){return t.workspace?(t=Su(t.workspace).length,t===1?s.Msg$$module$build$src$core$msg.DELETE_BLOCK:s.Msg$$module$build$src$core$msg.DELETE_X_BLOCKS.replace("%1",`${t}`)):""},preconditionFn(t){return t.workspace&&0<Su(t.workspace).length?"enabled":"disabled"},callback(t){if(t.workspace){t.workspace.cancelCurrentGesture();var i=Su(t.workspace);2>i.length?Yc(i):Kh(s.Msg$$module$build$src$core$msg.DELETE_ALL_BLOCKS.replace("%1",String(i.length)),function(r){r&&Yc(i)})}},scopeType:ne.ScopeType.WORKSPACE,id:"workspaceDelete",weight:6})},ry=function(){Fg(),Ug(),Hg(),Gg(),Wg(),Xg()},Yg=function(){ne.registry.register({displayText(){return s.Msg$$module$build$src$core$msg.DUPLICATE_BLOCK},preconditionFn(t){return t=t.block,!t.isInFlyout&&t.isDeletable()&&t.isMovable()?t.isDuplicatable()?"enabled":"disabled":"hidden"},callback(t){if(t.block){var i=t.block.toCopyData();i&&tl(i,t.block.workspace)}},scopeType:ne.ScopeType.BLOCK,id:"blockDuplicate",weight:1})},Kg=function(){ne.registry.register({displayText(t){return t.block.hasIcon(yi.TYPE)?s.Msg$$module$build$src$core$msg.REMOVE_COMMENT:s.Msg$$module$build$src$core$msg.ADD_COMMENT},preconditionFn(t){return t=t.block,!t.isInFlyout&&t.workspace.options.comments&&!t.isCollapsed()&&t.isEditable()?"enabled":"hidden"},callback(t){t=t.block,t.hasIcon(yi.TYPE)?t.setCommentText(null):t.setCommentText("")},scopeType:ne.ScopeType.BLOCK,id:"blockComment",weight:2})},jg=function(){ne.registry.register({displayText(t){return t.block.getInputsInline()?s.Msg$$module$build$src$core$msg.EXTERNAL_INPUTS:s.Msg$$module$build$src$core$msg.INLINE_INPUTS},preconditionFn(t){if(t=t.block,!t.isInFlyout&&t.isMovable()&&!t.isCollapsed()){for(let i=1;i<t.inputList.length;i++)if(!(t.inputList[i-1]instanceof ud||t.inputList[i]instanceof ud))return"enabled"}return"hidden"},callback(t){t.block.setInputsInline(!t.block.getInputsInline())},scopeType:ne.ScopeType.BLOCK,id:"blockInline",weight:3})},Jg=function(){ne.registry.register({displayText(t){return t.block.isCollapsed()?s.Msg$$module$build$src$core$msg.EXPAND_BLOCK:s.Msg$$module$build$src$core$msg.COLLAPSE_BLOCK},preconditionFn(t){return t=t.block,!t.isInFlyout&&t.isMovable()&&t.workspace.options.collapse?"enabled":"hidden"},callback(t){t.block.setCollapsed(!t.block.isCollapsed())},scopeType:ne.ScopeType.BLOCK,id:"blockCollapseExpand",weight:4})},qg=function(){ne.registry.register({displayText(t){return t.block.isEnabled()?s.Msg$$module$build$src$core$msg.DISABLE_BLOCK:s.Msg$$module$build$src$core$msg.ENABLE_BLOCK},preconditionFn(t){return t=t.block,!t.isInFlyout&&t.workspace.options.disable&&t.isEditable()?t.getInheritedDisabled()?"disabled":"enabled":"hidden"},callback(t){t=t.block;const i=s.getGroup$$module$build$src$core$events$utils();i||s.setGroup$$module$build$src$core$events$utils(!0),t.setEnabled(!t.isEnabled()),s.setGroup$$module$build$src$core$events$utils(i)},scopeType:ne.ScopeType.BLOCK,id:"blockDisable",weight:5})},Zg=function(){ne.registry.register({displayText(t){var i=t.block;return t=i.getDescendants(!1).length,(i=i.getNextBlock())&&(t-=i.getDescendants(!1).length),t===1?s.Msg$$module$build$src$core$msg.DELETE_BLOCK:s.Msg$$module$build$src$core$msg.DELETE_X_BLOCKS.replace("%1",`${t}`)},preconditionFn(t){return!t.block.isInFlyout&&t.block.isDeletable()?"enabled":"hidden"},callback(t){t.block&&t.block.checkAndDelete()},scopeType:ne.ScopeType.BLOCK,id:"blockDelete",weight:6})},Qg=function(){ne.registry.register({displayText(){return s.Msg$$module$build$src$core$msg.HELP},preconditionFn(t){return t=t.block,(typeof t.helpUrl=="function"?t.helpUrl():t.helpUrl)?"enabled":"hidden"},callback(t){t.block.showHelp()},scopeType:ne.ScopeType.BLOCK,id:"blockHelp",weight:7})},ly=function(){Yg(),Kg(),jg(),Jg(),qg(),Zg(),Qg()},tm=function(){ry(),ly()},cy=function(t,i){var r=null;r=typeof t=="string"?document.getElementById(t)||document.querySelector(t):t;let c;if(!document.contains(r)&&document!==((c=r)==null?void 0:c.ownerDocument))throw Error("Error: container is not in current document");t=new hs(i||{}),i=document.createElement("div"),i.className="injectionDiv",i.tabIndex=0,Re(i,we.LABEL,s.Msg$$module$build$src$core$msg.WORKSPACE_ARIA_LABEL),r.appendChild(i),r=ay(i,t);const u=hy(i,r,t);return uy(u),F(u),V(u),i.addEventListener("focusin",function(){F(u)}),u},ay=function(t,i){t.setAttribute("dir","LTR"),dt(i.hasCss,i.pathToMedia),t=R(D.SVG,{xmlns:jc,"xmlns:html":zs,"xmlns:xlink":Xi,version:"1.1",class:"blocklySvg",tabindex:"0"},t);const r=R(D.DEFS,{},t),c=String(Math.random()).substring(2);return i.gridPattern=Km.createDom(c,i.gridOptions,r),t},hy=function(t,i,r){r.parentWorkspace=null,r=new Ss(r);const c=r.options;r.scale=c.zoomOptions.startScale,i.appendChild(r.createDom("blocklyMainBackground",t));var u=r.getRenderer().getClassName();return u&&J(t,u),(u=r.getTheme().getClassName())&&J(t,u),!c.hasCategories&&c.languageTree&&(t=r.addFlyout(D.SVG),Qt(t,i)),c.hasTrashcan&&r.addTrashcan(),c.zoomOptions&&c.zoomOptions.controls&&r.addZoomControls(),r.getThemeManager().subscribe(i,"workspaceBackgroundColour","background-color"),r.translate(0,0),r.addChangeListener(Pg(r)),V(r),yf(),Lf(),tg(),r},uy=function(t){const i=t.options;var r=t.getParentSvg();if(yt(r.parentNode,"contextmenu",null,function(c){G(c)||c.preventDefault()}),r=yt(window,"resize",null,function(){Io(),t.hideComponents(!0),Wf(),wf(),V(t),Iu(t)}),t.setResizeHandlerWrapper(r),py(),i.languageTree){r=t.getToolbox();const c=t.getFlyout(!0);r?r.init():c&&(c.init(t),c.show(i.languageTree),typeof c.scrollToStart=="function"&&c.scrollToStart())}i.hasTrashcan&&t.trashcan.init(),i.zoomOptions&&i.zoomOptions.controls&&t.zoomControls_.init(),i.moveOptions&&i.moveOptions.scrollbars?(t.scrollbar=new b$(t,i.moveOptions.scrollbars===!0||!!i.moveOptions.scrollbars.horizontal,i.moveOptions.scrollbars===!0||!!i.moveOptions.scrollbars.vertical,"blocklyMainWorkspaceScrollbar"),t.scrollbar.resize()):t.setMetrics({x:.5,y:.5}),i.hasSounds&&fy(i.pathToMedia,t)},dy=function(t){const i=A();i&&!(G(t)||i.rendered&&!i.isVisible())&&ae.registry.onKeyDown(i,t)},py=function(){lS||(yt(document,"scroll",null,function(){const t=y();for(let i=0,r;r=t[i];i++)r instanceof Ss&&r.updateInverseScreenCTM()}),yt(document,"keydown",null,dy),w(document,"touchend",null,xe),w(document,"touchcancel",null,xe),El&&yt(window,"orientationchange",document,function(){V(A())})),lS=!0},fy=function(t,i){function r(){for(;u.length;){const f=u.pop();f&&N(f)}c.preload()}const c=i.getAudioManager();c.load([t+"click.mp3",t+"click.wav",t+"click.ogg"],"click"),c.load([t+"disconnect.wav",t+"disconnect.mp3",t+"disconnect.ogg"],"disconnect"),c.load([t+"delete.mp3",t+"delete.ogg",t+"delete.wav"],"delete");const u=[];u.push(yt(document,"pointermove",null,r,!0)),u.push(yt(document,"touchstart",null,r,!0))},gy=function(t){return t.getType!==void 0&&t.initView!==void 0&&t.dispose!==void 0&&t.getWeight!==void 0&&t.getSize!==void 0&&t.applyColour!==void 0&&t.hideForInsertionMarker!==void 0&&t.updateEditable!==void 0&&t.updateCollapsed!==void 0&&t.isShownWhenCollapsed!==void 0&&t.setOffsetInBlock!==void 0&&t.onLocationChange!==void 0&&t.onClick!==void 0},my=function(t){return t.paste!==void 0},$y=function(t){return t.isSelectable()},_y=function(t){A().hideChaff(t)},Mt=Mt||{},Mt.scope={},Mt.ASSUME_ES5=!1,Mt.ASSUME_NO_NATIVE_MAP=!1,Mt.ASSUME_NO_NATIVE_SET=!1,Mt.SIMPLE_FROUND_POLYFILL=!1,Mt.ISOLATE_POLYFILLS=!1,Mt.FORCE_POLYFILL_PROMISE=!1,Mt.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1,Mt.defineProperty=Mt.ASSUME_ES5||typeof Object.defineProperties=="function"?Object.defineProperty:function(t,i,r){return t==Array.prototype||t==Object.prototype||(t[i]=r.value),t},Mt.getGlobal=function(t){t=[typeof globalThis=="object"&&globalThis,t,typeof window=="object"&&window,typeof self=="object"&&self,typeof ps=="object"&&ps];for(var i=0;i<t.length;++i){var r=t[i];if(r&&r.Math==Math)return r}throw Error("Cannot find global object")},Mt.global=Mt.getGlobal(this),Mt.IS_SYMBOL_NATIVE=typeof Symbol=="function"&&typeof Symbol("x")=="symbol",Mt.TRUST_ES6_POLYFILLS=!Mt.ISOLATE_POLYFILLS||Mt.IS_SYMBOL_NATIVE,Mt.polyfills={},Mt.propertyToPolyfillSymbol={},Mt.POLYFILL_PREFIX="$jscp$",Mt.polyfill=function(t,i,r,c){i&&(Mt.ISOLATE_POLYFILLS?Mt.polyfillIsolated(t,i,r,c):Mt.polyfillUnisolated(t,i,r,c))},Mt.polyfillUnisolated=function(t,i,r,c){for(r=Mt.global,t=t.split("."),c=0;c<t.length-1;c++){var u=t[c];if(!(u in r))return;r=r[u]}t=t[t.length-1],c=r[t],i=i(c),i!=c&&i!=null&&Mt.defineProperty(r,t,{configurable:!0,writable:!0,value:i})},Mt.polyfillIsolated=function(t,i,r,c){var u=t.split(".");t=u.length===1,c=u[0],c=!t&&c in Mt.polyfills?Mt.polyfills:Mt.global;for(var f=0;f<u.length-1;f++){var E=u[f];if(!(E in c))return;c=c[E]}u=u[u.length-1],r=Mt.IS_SYMBOL_NATIVE&&r==="es6"?c[u]:null,i=i(r),i!=null&&(t?Mt.defineProperty(Mt.polyfills,u,{configurable:!0,writable:!0,value:i}):i!==r&&(Mt.propertyToPolyfillSymbol[u]===void 0&&(r=1e9*Math.random()>>>0,Mt.propertyToPolyfillSymbol[u]=Mt.IS_SYMBOL_NATIVE?Mt.global.Symbol(u):Mt.POLYFILL_PREFIX+r+"$"+u),Mt.defineProperty(c,Mt.propertyToPolyfillSymbol[u],{configurable:!0,writable:!0,value:i})))},Mt.polyfill("globalThis",function(t){return t||Mt.global},"es_2020","es3"),Mt.arrayIteratorImpl=function(t){var i=0;return function(){return i<t.length?{done:!1,value:t[i++]}:{done:!0}}},Mt.arrayIterator=function(t){return{next:Mt.arrayIteratorImpl(t)}},Mt.initSymbol=function(){},Mt.iteratorPrototype=function(t){return t={next:t},t[Symbol.iterator]=function(){return this},t},Mt.iteratorFromArray=function(t,i){t instanceof String&&(t+="");var r=0,c=!1,u={next:function(){if(!c&&r<t.length){var f=r++;return{value:i(f,t[f]),done:!1}}return c=!0,{done:!0,value:void 0}}};return u[Symbol.iterator]=function(){return u},u},Mt.polyfill("Array.prototype.values",function(t){return t||function(){return Mt.iteratorFromArray(this,function(i,r){return r})}},"es8","es3"),Mt.polyfill("Array.prototype.flat",function(t){return t||function(i){i=i===void 0?1:i;var r=[];return Array.prototype.forEach.call(this,function(c){Array.isArray(c)&&0<i?(c=Array.prototype.flat.call(c,i-1),r.push.apply(r,c)):r.push(c)}),r}},"es9","es5"),Mt.owns=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},Mt.polyfill("Object.entries",function(t){return t||function(i){var r=[],c;for(c in i)Mt.owns(i,c)&&r.push([c,i[c]]);return r}},"es8","es3"),Mt.polyfill("Object.values",function(t){return t||function(i){var r=[],c;for(c in i)Mt.owns(i,c)&&r.push(i[c]);return r}},"es8","es3");var hn=Object.create(null),jA={typeMap:hn},Cu=Object.create(null),Co="default",rt=class{constructor(t){this.name=t}toString(){return this.name}};rt.CONNECTION_CHECKER=new rt("connectionChecker"),rt.CURSOR=new rt("cursor"),rt.EVENT=new rt("event"),rt.FIELD=new rt("field"),rt.INPUT=new rt("input"),rt.RENDERER=new rt("renderer"),rt.TOOLBOX=new rt("toolbox"),rt.THEME=new rt("theme"),rt.TOOLBOX_ITEM=new rt("toolboxItem"),rt.FLYOUTS_VERTICAL_TOOLBOX=new rt("flyoutsVerticalToolbox"),rt.FLYOUTS_HORIZONTAL_TOOLBOX=new rt("flyoutsHorizontalToolbox"),rt.METRICS_MANAGER=new rt("metricsManager"),rt.BLOCK_DRAGGER=new rt("blockDragger"),rt.SERIALIZER=new rt("serializer"),rt.ICON=new rt("icon"),rt.PASTER=new rt("paster");var wo={DEFAULT:Co,TEST_ONLY:jA};wo.Type=rt,wo.getAllItems=m,wo.getClass=p,wo.getClassFromOptions=T,wo.getObject=g,wo.hasItem=d,wo.register=o,wo.unregister=a;var Mi=Object.create(null),Kc=Object.create(null),Ty,by=null,Ey,dl=[],vy={defineBlocksWithJsonArrayInternal:lt},ii={TEST_ONLY:vy};ii.createBlockDefinitionsFromJsonArray=s.createBlockDefinitionsFromJsonArray$$module$build$src$core$common,ii.defineBlocks=s.defineBlocks$$module$build$src$core$common,ii.defineBlocksWithJsonArray=$t,ii.draggingConnections=dl,ii.getAllWorkspaces=y,ii.getBlockTypeCounts=H,ii.getMainWorkspace=A,ii.getParentContainer=K,ii.getSelected=z,ii.getWorkspaceById=b,ii.registerWorkspace=C,ii.setMainWorkspace=F,ii.setParentContainer=Y,ii.setSelected=X,ii.svgResize=V,ii.unregisterWorkpace=L;var yy="!#$%()*+,-./:;=?@[]^_`{|}~ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",Iy={genUid:()=>{const t=yy.length,i=[];for(let r=0;20>r;r++)i[r]=yy.charAt(Math.random()*t);return i.join("")}},JA=0,em={TEST_ONLY:Iy};em.genUid=ct,em.getNextUniqueId=ot;var im,pl,wu,un,dn,sr,fl,ku,or,ko,Oo,gl,Vs,ml,$l,_l,pn,fn,nr,Tl,Gs,rr,Ou,lr,Au,Ei;im="",pl=!0,wu=0,s.CREATE$$module$build$src$core$events$utils="create",s.CREATE$$module$build$src$core$events$utils,s.DELETE$$module$build$src$core$events$utils="delete",s.DELETE$$module$build$src$core$events$utils,s.CHANGE$$module$build$src$core$events$utils="change",s.CHANGE$$module$build$src$core$events$utils,un="block_field_intermediate_change",s.MOVE$$module$build$src$core$events$utils="move",s.MOVE$$module$build$src$core$events$utils,dn="var_create",sr="var_delete",fl="var_rename",ku="ui",or="drag",ko="selected",Oo="click",gl="marker_move",Vs="bubble_open",ml="trashcan_open",$l="toolbox_item_select",_l="theme_change",pn="viewport_change",fn="comment_create",nr="comment_delete",Tl="comment_change",Gs="comment_move",rr="finished_loading",Ou=[s.CREATE$$module$build$src$core$events$utils,s.MOVE$$module$build$src$core$events$utils,fn,Gs],lr=[],Au={FIRE_QUEUE:lr,fireNow:Rt,fireInternal:Ft,setGroupInternal:Gt},Ei={BLOCK_CHANGE:s.CHANGE$$module$build$src$core$events$utils,BLOCK_CREATE:s.CREATE$$module$build$src$core$events$utils,BLOCK_DELETE:s.DELETE$$module$build$src$core$events$utils,BLOCK_DRAG:or,BLOCK_FIELD_INTERMEDIATE_CHANGE:un,BLOCK_MOVE:s.MOVE$$module$build$src$core$events$utils,BUBBLE_OPEN:Vs,BUMP_EVENTS:Ou,CHANGE:s.CHANGE$$module$build$src$core$events$utils,CLICK:Oo,COMMENT_CHANGE:Tl,COMMENT_CREATE:fn,COMMENT_DELETE:nr,COMMENT_MOVE:Gs,CREATE:s.CREATE$$module$build$src$core$events$utils,DELETE:s.DELETE$$module$build$src$core$events$utils,FINISHED_LOADING:rr,MARKER_MOVE:gl,MOVE:s.MOVE$$module$build$src$core$events$utils,SELECTED:ko,TEST_ONLY:Au,THEME_CHANGE:_l,TOOLBOX_ITEM_SELECT:$l,TRASHCAN_OPEN:ml,UI:ku,VAR_CREATE:dn,VAR_DELETE:sr,VAR_RENAME:fl,VIEWPORT_CHANGE:pn},Ei.clearPendingUndo=me,Ei.disable=s.disable$$module$build$src$core$events$utils,Ei.disableOrphans=be,Ei.enable=s.enable$$module$build$src$core$events$utils,Ei.filter=Nt,Ei.fire=it,Ei.fromJson=fe,Ei.get=ut,Ei.getDescendantIds=Ht,Ei.getGroup=s.getGroup$$module$build$src$core$events$utils,Ei.getRecordUndo=vt,Ei.isEnabled=Lt,Ei.setGroup=s.setGroup$$module$build$src$core$events$utils,Ei.setRecordUndo=gt;var bl=class{constructor(){this.workspaceId=void 0,this.isUiEvent=!1,this.type="",this.group=s.getGroup$$module$build$src$core$events$utils(),this.recordUndo=vt()}toJson(){return{type:this.type,group:this.group}}static fromJson(t,i,r){return r.isBlank=!1,r.group=t.group||"",r.workspaceId=i.id,r}isNull(){return!1}run(t){}getEventWorkspace_(){let t;if(this.workspaceId&&(t=b(this.workspaceId)),!t)throw Error("Workspace is null. Event must have been generated from real Blockly events.");return t}},Ws=class extends bl{constructor(t){super(),this.recordUndo=!1,this.isUiEvent=!0,this.isBlank=typeof t>"u",this.workspaceId=t||""}},sm=class extends Ws{constructor(t,i,r){i=t?t.workspace.id:i,i===null&&(i=void 0),super(i),this.type=Oo,this.blockId=t?t.id:void 0,this.targetType=r}toJson(){const t=super.toJson();if(!this.targetType)throw Error("The click target type is undefined. Either pass a block to the constructor, or call fromJson");return t.targetType=this.targetType,t.blockId=this.blockId,t}static fromJson(t,i,r){return i=super.fromJson(t,i,r??new sm),i.targetType=t.targetType,i.blockId=t.blockId,i}},om;(function(t){t.BLOCK="block",t.WORKSPACE="workspace",t.ZOOM_CONTROLS="zoom_controls"})(om||(om={})),o(rt.EVENT,Oo,sm);var qA=750,Sy="ontouchstart"in globalThis||!!(globalThis.document&&document.documentElement&&"ontouchstart"in document.documentElement)||!(!globalThis.navigator||!globalThis.navigator.maxTouchPoints&&!globalThis.navigator.msMaxTouchPoints),Ru=null,cr={mousedown:["pointerdown"],mouseenter:["pointerenter"],mouseleave:["pointerleave"],mousemove:["pointermove"],mouseout:["pointerout"],mouseover:["pointerover"],mouseup:["pointerup","pointercancel"],touchend:["pointerup"],touchcancel:["pointercancel"]},Nu=0,ar={TOUCH_ENABLED:Sy,TOUCH_MAP:cr};ar.checkTouchIdentifier=hi,ar.clearTouchIdentifier=Ee,ar.getTouchIdentifierFromEvent=Ke,ar.longStart=_e,ar.longStop=xe,ar.shouldHandleEvent=ai;var nm,Cy,wy,ky,Lu,Mu,rm,Oy,Ay,Ry;(function(t){function i(c){return r.indexOf(c.toUpperCase())!==-1}nm=t;const r=nm.toUpperCase();Cy=i("JavaFX"),wy=i("WebKit"),ky=i("Gecko")&&!wy,Lu=i("Android"),t=globalThis.navigator&&globalThis.navigator.maxTouchPoints,Mu=i("iPad")||i("Macintosh")&&0<t,rm=i("iPhone")&&!Mu,Oy=i("Macintosh"),Ay=Mu||Lu&&!i("Mobile")||i("Silk"),Ry=!Ay&&(rm||Lu)})(globalThis.navigator&&globalThis.navigator.userAgent||"");var ZA=nm,Ny=Cy,lm=ky,xu=Lu,El=Mu,Ly=rm,cm=Oy,am=Ry,QA={ANDROID:xu,GECKO:lm,IPAD:El,IPHONE:Ly,JavaFx:Ny,MAC:cm,MOBILE:am,raw:ZA},My=40,xy=125,Ao={};Ao.bind=w,Ao.conditionalBind=yt,Ao.getScrollDeltaPixels=st,Ao.isRightButton=q,Ao.isTargetInput=G,Ao.mouseToSvg=Z,Ao.unbind=N;var Dy={};Dy.removeElem=ht;var Ro=class{constructor(t){this.name_=t}toString(){return this.name_}};Ro.POSITIONABLE=new Ro("positionable"),Ro.DRAG_TARGET=new Ro("drag_target"),Ro.DELETE_AREA=new Ro("delete_area"),Ro.AUTOHIDEABLE=new Ro("autohideable");var je=class{constructor(){this.componentData=new Map,this.capabilityToComponentIds=new Map}addComponent(t,i){const r=t.component.id;if(!i&&this.componentData.has(r)){var c;throw Error('Plugin "'+r+'" with capabilities "'+((c=this.componentData.get(r))==null?void 0:c.capabilities)+'" already added.')}for(this.componentData.set(r,t),i=[],c=0;c<t.capabilities.length;c++){const u=String(t.capabilities[c]).toLowerCase();if(i.push(u),this.capabilityToComponentIds.has(u)){let f;(f=this.capabilityToComponentIds.get(u))==null||f.push(r)}else this.capabilityToComponentIds.set(u,[r])}this.componentData.get(r).capabilities=i}removeComponent(t){const i=this.componentData.get(t);if(i){for(let r=0;r<i.capabilities.length;r++){const c=String(i.capabilities[r]).toLowerCase();ht(this.capabilityToComponentIds.get(c),t)}this.componentData.delete(t)}}addCapability(t,i){if(!this.getComponent(t))throw Error('Cannot add capability, "'+i+'". Plugin "'+t+'" has not been added to the ComponentManager');if(this.hasCapability(t,i))console.warn('Plugin "'+t+'already has capability "'+i+'"');else{i=`${i}`.toLowerCase();var r;(r=this.componentData.get(t))==null||r.capabilities.push(i);var c;(c=this.capabilityToComponentIds.get(i))==null||c.push(t)}}removeCapability(t,i){if(!this.getComponent(t))throw Error('Cannot remove capability, "'+i+'". Plugin "'+t+'" has not been added to the ComponentManager');this.hasCapability(t,i)?(i=`${i}`.toLowerCase(),ht(this.componentData.get(t).capabilities,i),ht(this.capabilityToComponentIds.get(i),t)):console.warn('Plugin "'+t+`doesn't have capability "`+i+'" to remove')}hasCapability(t,i){return i=`${i}`.toLowerCase(),this.componentData.has(t)&&this.componentData.get(t).capabilities.indexOf(i)!==-1}getComponent(t){let i;return(i=this.componentData.get(t))==null?void 0:i.component}getComponents(t,i){if(t=`${t}`.toLowerCase(),t=this.capabilityToComponentIds.get(t),!t)return[];const r=[];if(i){const c=[];t.forEach(u=>{c.push(this.componentData.get(u))}),c.sort(function(u,f){return u.weight-f.weight}),c.forEach(function(u){r.push(u.component)})}else t.forEach(c=>{r.push(this.componentData.get(c).component)});return r}};je.Capability=Ro;var hm=!1,um=`
.blocklySvg {
  background-color: #fff;
  outline: none;
  overflow: hidden;  /* IE overflows by default. */
  position: absolute;
  display: block;
}

.blocklyWidgetDiv {
  display: none;
  position: absolute;
  z-index: 99999;  /* big value for bootstrap3 compatibility */
}

.injectionDiv {
  height: 100%;
  position: relative;
  overflow: hidden;  /* So blocks in drag surface disappear at edges */
  touch-action: none;
}

.blocklyNonSelectable {
  user-select: none;
  -ms-user-select: none;
  -webkit-user-select: none;
}

.blocklyBlockCanvas.blocklyCanvasTransitioning,
.blocklyBubbleCanvas.blocklyCanvasTransitioning {
  transition: transform .5s;
}

.blocklyTooltipDiv {
  background-color: #ffffc7;
  border: 1px solid #ddc;
  box-shadow: 4px 4px 20px 1px rgba(0,0,0,.15);
  color: #000;
  display: none;
  font: 9pt sans-serif;
  opacity: .9;
  padding: 2px;
  position: absolute;
  z-index: 100000;  /* big value for bootstrap3 compatibility */
}

.blocklyDropDownDiv {
  position: absolute;
  left: 0;
  top: 0;
  z-index: 1000;
  display: none;
  border: 1px solid;
  border-color: #dadce0;
  background-color: #fff;
  border-radius: 2px;
  padding: 4px;
  box-shadow: 0 0 3px 1px rgba(0,0,0,.3);
}

.blocklyDropDownDiv.blocklyFocused {
  box-shadow: 0 0 6px 1px rgba(0,0,0,.3);
}

.blocklyDropDownContent {
  max-height: 300px;  /* @todo: spec for maximum height. */
  overflow: auto;
  overflow-x: hidden;
  position: relative;
}

.blocklyDropDownArrow {
  position: absolute;
  left: 0;
  top: 0;
  width: 16px;
  height: 16px;
  z-index: -1;
  background-color: inherit;
  border-color: inherit;
}

.blocklyDropDownButton {
  display: inline-block;
  float: left;
  padding: 0;
  margin: 4px;
  border-radius: 4px;
  outline: none;
  border: 1px solid;
  transition: box-shadow .1s;
  cursor: pointer;
}

.blocklyArrowTop {
  border-top: 1px solid;
  border-left: 1px solid;
  border-top-left-radius: 4px;
  border-color: inherit;
}

.blocklyArrowBottom {
  border-bottom: 1px solid;
  border-right: 1px solid;
  border-bottom-right-radius: 4px;
  border-color: inherit;
}

.blocklyResizeSE {
  cursor: se-resize;
  fill: #aaa;
}

.blocklyResizeSW {
  cursor: sw-resize;
  fill: #aaa;
}

.blocklyResizeLine {
  stroke: #515A5A;
  stroke-width: 1;
}

.blocklyHighlightedConnectionPath {
  fill: none;
  stroke: #fc3;
  stroke-width: 4px;
}

.blocklyPathLight {
  fill: none;
  stroke-linecap: round;
  stroke-width: 1;
}

.blocklySelected>.blocklyPathLight {
  display: none;
}

.blocklyDraggable {
  cursor: grab;
  cursor: -webkit-grab;
}

.blocklyDragging {
  cursor: grabbing;
  cursor: -webkit-grabbing;
}

  /* Changes cursor on mouse down. Not effective in Firefox because of
     https://bugzilla.mozilla.org/show_bug.cgi?id=771241 */
.blocklyDraggable:active {
  cursor: grabbing;
  cursor: -webkit-grabbing;
}

.blocklyDragging.blocklyDraggingDelete {
  cursor: url("<<<PATH>>>/handdelete.cur"), auto;
}

.blocklyDragging>.blocklyPath,
.blocklyDragging>.blocklyPathLight {
  fill-opacity: .8;
  stroke-opacity: .8;
}

.blocklyDragging>.blocklyPathDark {
  display: none;
}

.blocklyDisabled>.blocklyPath {
  fill-opacity: .5;
  stroke-opacity: .5;
}

.blocklyDisabled>.blocklyPathLight,
.blocklyDisabled>.blocklyPathDark {
  display: none;
}

.blocklyInsertionMarker>.blocklyPath,
.blocklyInsertionMarker>.blocklyPathLight,
.blocklyInsertionMarker>.blocklyPathDark {
  fill-opacity: .2;
  stroke: none;
}

.blocklyMultilineText {
  font-family: monospace;
}

.blocklyNonEditableText>text {
  pointer-events: none;
}

.blocklyFlyout {
  position: absolute;
  z-index: 20;
}

.blocklyText text {
  cursor: default;
}

/*
  Don't allow users to select text.  It gets annoying when trying to
  drag a block and selected text moves instead.
*/
.blocklySvg text {
  user-select: none;
  -ms-user-select: none;
  -webkit-user-select: none;
  cursor: inherit;
}

.blocklyHidden {
  display: none;
}

.blocklyFieldDropdown:not(.blocklyHidden) {
  display: block;
}

.blocklyIconGroup {
  cursor: default;
}

.blocklyIconGroup:not(:hover),
.blocklyIconGroupReadonly {
  opacity: .6;
}

.blocklyIconShape {
  fill: #00f;
  stroke: #fff;
  stroke-width: 1px;
}

.blocklyIconSymbol {
  fill: #fff;
}

.blocklyMinimalBody {
  margin: 0;
  padding: 0;
}

.blocklyHtmlInput {
  border: none;
  border-radius: 4px;
  height: 100%;
  margin: 0;
  outline: none;
  padding: 0;
  width: 100%;
  text-align: center;
  display: block;
  box-sizing: border-box;
}

/* Remove the increase and decrease arrows on the field number editor */
input.blocklyHtmlInput[type=number]::-webkit-inner-spin-button,
input.blocklyHtmlInput[type=number]::-webkit-outer-spin-button {
  -webkit-appearance: none;
  margin: 0;
}

input[type=number] {
  -moz-appearance: textfield;
}

.blocklyMainBackground {
  stroke-width: 1;
  stroke: #c6c6c6;  /* Equates to #ddd due to border being off-pixel. */
}

.blocklyMutatorBackground {
  fill: #fff;
  stroke: #ddd;
  stroke-width: 1;
}

.blocklyFlyoutBackground {
  fill: #ddd;
  fill-opacity: .8;
}

.blocklyMainWorkspaceScrollbar {
  z-index: 20;
}

.blocklyFlyoutScrollbar {
  z-index: 30;
}

.blocklyScrollbarHorizontal,
.blocklyScrollbarVertical {
  position: absolute;
  outline: none;
}

.blocklyScrollbarBackground {
  opacity: 0;
}

.blocklyScrollbarHandle {
  fill: #ccc;
}

.blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,
.blocklyScrollbarHandle:hover {
  fill: #bbb;
}

/* Darken flyout scrollbars due to being on a grey background. */
/* By contrast, workspace scrollbars are on a white background. */
.blocklyFlyout .blocklyScrollbarHandle {
  fill: #bbb;
}

.blocklyFlyout .blocklyScrollbarBackground:hover+.blocklyScrollbarHandle,
.blocklyFlyout .blocklyScrollbarHandle:hover {
  fill: #aaa;
}

.blocklyInvalidInput {
  background: #faa;
}

.blocklyVerticalMarker {
  stroke-width: 3px;
  fill: rgba(255,255,255,.5);
  pointer-events: none;
}

.blocklyComputeCanvas {
  position: absolute;
  width: 0;
  height: 0;
}

.blocklyNoPointerEvents {
  pointer-events: none;
}

.blocklyContextMenu {
  border-radius: 4px;
  max-height: 100%;
}

.blocklyDropdownMenu {
  border-radius: 2px;
  padding: 0 !important;
}

.blocklyDropdownMenu .blocklyMenuItem {
  /* 28px on the left for icon or checkbox. */
  padding-left: 28px;
}

/* BiDi override for the resting state. */
.blocklyDropdownMenu .blocklyMenuItemRtl {
  /* Flip left/right padding for BiDi. */
  padding-left: 5px;
  padding-right: 28px;
}

.blocklyWidgetDiv .blocklyMenu {
  background: #fff;
  border: 1px solid transparent;
  box-shadow: 0 0 3px 1px rgba(0,0,0,.3);
  font: normal 13px Arial, sans-serif;
  margin: 0;
  outline: none;
  padding: 4px 0;
  position: absolute;
  overflow-y: auto;
  overflow-x: hidden;
  max-height: 100%;
  z-index: 20000;  /* Arbitrary, but some apps depend on it... */
}

.blocklyWidgetDiv .blocklyMenu.blocklyFocused {
  box-shadow: 0 0 6px 1px rgba(0,0,0,.3);
}

.blocklyDropDownDiv .blocklyMenu {
  background: inherit;  /* Compatibility with gapi, reset from goog-menu */
  border: inherit;  /* Compatibility with gapi, reset from goog-menu */
  font: normal 13px "Helvetica Neue", Helvetica, sans-serif;
  outline: none;
  position: relative;  /* Compatibility with gapi, reset from goog-menu */
  z-index: 20000;  /* Arbitrary, but some apps depend on it... */
}

/* State: resting. */
.blocklyMenuItem {
  border: none;
  color: #000;
  cursor: pointer;
  list-style: none;
  margin: 0;
  /* 7em on the right for shortcut. */
  min-width: 7em;
  padding: 6px 15px;
  white-space: nowrap;
}

/* State: disabled. */
.blocklyMenuItemDisabled {
  color: #ccc;
  cursor: inherit;
}

/* State: hover. */
.blocklyMenuItemHighlight {
  background-color: rgba(0,0,0,.1);
}

/* State: selected/checked. */
.blocklyMenuItemCheckbox {
  height: 16px;
  position: absolute;
  width: 16px;
}

.blocklyMenuItemSelected .blocklyMenuItemCheckbox {
  background: url(<<<PATH>>>/sprites.png) no-repeat -48px -16px;
  float: left;
  margin-left: -24px;
  position: static;  /* Scroll with the menu. */
}

.blocklyMenuItemRtl .blocklyMenuItemCheckbox {
  float: right;
  margin-right: -24px;
}

.blocklyBlockDragSurface {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  overflow: visible !important;
  z-index: 80;
  pointer-events: none;
}
`,dm={};dm.inject=dt,dm.register=et;var pt=class{constructor(t,i){this.x=t,this.y=i}clone(){return new pt(this.x,this.y)}scale(t){return this.x*=t,this.y*=t,this}translate(t,i){return this.x+=t,this.y+=i,this}static equals(t,i){return t===i?!0:t&&i?t.x===i.x&&t.y===i.y:!1}static distance(t,i){const r=t.x-i.x;return t=t.y-i.y,Math.sqrt(r*r+t*t)}static magnitude(t){return Math.sqrt(t.x*t.x+t.y*t.y)}static difference(t,i){return new pt(t.x-i.x,t.y-i.y)}static sum(t,i){return new pt(t.x+i.x,t.y+i.y)}},Py={};Py.warn=j;var jc="http://www.w3.org/2000/svg",zs="http://www.w3.org/1999/xhtml",Xi="http://www.w3.org/1999/xlink",No;(function(t){t[t.ELEMENT_NODE=1]="ELEMENT_NODE",t[t.TEXT_NODE=3]="TEXT_NODE",t[t.COMMENT_NODE=8]="COMMENT_NODE"})(No||(No={}));var vs=null,pm=0,Du=null,Je={HTML_NS:zs};Je.NodeType=No,Je.SVG_NS=jc,Je.XLINK_NS=Xi,Je.addClass=J,Je.containsNode=k,Je.createSvgElement=R,Je.getFastTextWidth=nt,Je.getFastTextWidthWithSizeString=Pt,Je.getTextWidth=P,Je.hasClass=Vt,Je.insertAfter=Qt,Je.measureFontMetrics=te,Je.removeClass=mt,Je.removeClasses=kt,Je.removeNode=Ct,Je.setCssTransform=_,Je.startTextWidthCache=I,Je.stopTextWidthCache=M;var D=class{constructor(t){this.tagName=t}toString(){return this.tagName}};D.ANIMATE=new D("animate"),D.CIRCLE=new D("circle"),D.CLIPPATH=new D("clipPath"),D.DEFS=new D("defs"),D.FECOMPOSITE=new D("feComposite"),D.FECOMPONENTTRANSFER=new D("feComponentTransfer"),D.FEFLOOD=new D("feFlood"),D.FEFUNCA=new D("feFuncA"),D.FEGAUSSIANBLUR=new D("feGaussianBlur"),D.FEPOINTLIGHT=new D("fePointLight"),D.FESPECULARLIGHTING=new D("feSpecularLighting"),D.FILTER=new D("filter"),D.FOREIGNOBJECT=new D("foreignObject"),D.G=new D("g"),D.IMAGE=new D("image"),D.LINE=new D("line"),D.PATH=new D("path"),D.PATTERN=new D("pattern"),D.POLYGON=new D("polygon"),D.RECT=new D("rect"),D.SVG=new D("svg"),D.TEXT=new D("text"),D.TSPAN=new D("tspan");var ve=class{constructor(t,i,r,c){this.top=t,this.bottom=i,this.left=r,this.right=c}getHeight(){return this.bottom-this.top}getWidth(){return this.right-this.left}contains(t,i){return t>=this.left&&t<=this.right&&i>=this.top&&i<=this.bottom}intersects(t){return!(this.left>t.right||this.right<t.left||this.top>t.bottom||this.bottom<t.top)}},Ce=class{constructor(t,i){this.width=t,this.height=i}static equals(t,i){return t===i?!0:t&&i?t.width===i.width&&t.height===i.height:!1}},By={getSizeInternal:Hh},gn={TEST_ONLY:By};gn.getBorderBox=Zn,gn.getComputedStyle=Gi,gn.getContainerOffsetToScrollInto=Jr,gn.getPageOffset=Se,gn.getSize=bi,gn.getViewportPageOffset=qn,gn.scrollIntoContainerView=Qn;var Fy=/translate\(\s*([-+\d.e]+)([ ,]\s*([-+\d.e]+)\s*)?/,Uy=/transform:\s*translate(?:3d)?\(\s*([-+\d.e]+)\s*px([ ,]\s*([-+\d.e]+)\s*px)?/,tR={XY_REGEX:Fy,XY_STYLE_REGEX:Uy},hr={TEST_ONLY:tR};hr.getDocumentScroll=O,hr.getInjectionDivXY=$,hr.getRelativeXY=ls,hr.getViewportBBox=v,hr.screenToWsCoordinates=B,hr.wsToScreenCoordinates=tt;var Ge=class{constructor(t,i,r,c,u){this.workspace=t,this.horizontal=i,this.oldHostMetrics=null,this.ratio=1,this.origin=new pt(0,0),this.startDragHandle=this.handlePosition=this.handleLength=this.scrollbarLength=this.startDragMouse=0,this.containerVisible=this.isHandleVisible=!0,this.position=new pt(0,0),this.onMouseMoveWrapper_=this.onMouseUpWrapper_=null,this.pair=r||!1,this.margin=u!==void 0?u:Ge.DEFAULT_SCROLLBAR_MARGIN,t="blocklyScrollbar"+(this.horizontal?"Horizontal":"Vertical"),c&&(t+=" "+c),this.outerSvg=R(D.SVG,{class:t}),c=R(D.G,{},this.outerSvg),this.svgBackground=R(D.RECT,{class:"blocklyScrollbarBackground"},c),t=Math.floor((Ge.scrollbarThickness-5)/2),this.svgHandle=R(D.RECT,{class:"blocklyScrollbarHandle",rx:t,ry:t},c),this.workspace.getThemeManager().subscribe(this.svgHandle,"scrollbarColour","fill"),this.workspace.getThemeManager().subscribe(this.svgHandle,"scrollbarOpacity","fill-opacity"),Qt(this.outerSvg,this.workspace.getParentSvg()),this.setInitialThickness(),i?(this.lengthAttribute_="width",this.positionAttribute_="x"):(this.lengthAttribute_="height",this.positionAttribute_="y"),this.onMouseDownBarWrapper_=yt(this.svgBackground,"pointerdown",this,this.onMouseDownBar),this.onMouseDownHandleWrapper_=yt(this.svgHandle,"pointerdown",this,this.onMouseDownHandle)}setInitialThickness(){const t=Ge.scrollbarThickness;this.horizontal?(this.svgBackground.setAttribute("height",String(t)),this.outerSvg.setAttribute("height",String(t)),this.svgHandle.setAttribute("height",String(t-5)),this.svgHandle.setAttribute("y","2.5")):(this.svgBackground.setAttribute("width",String(t)),this.outerSvg.setAttribute("width",String(t)),this.svgHandle.setAttribute("width",String(t-5)),this.svgHandle.setAttribute("x","2.5"))}dispose(){this.cleanUp(),N(this.onMouseDownBarWrapper_),N(this.onMouseDownHandleWrapper_),Ct(this.outerSvg),this.workspace.getThemeManager().unsubscribe(this.svgHandle)}constrainHandleLength(t){return t=0>=t||isNaN(t)?0:Math.min(t,this.scrollbarLength)}setHandleLength(t){this.handleLength=t,this.svgHandle.setAttribute(this.lengthAttribute_,String(this.handleLength))}constrainHandlePosition(t){return t=0>=t||isNaN(t)?0:Math.min(t,this.scrollbarLength-this.handleLength)}setHandlePosition(t){this.handlePosition=t,this.svgHandle.setAttribute(this.positionAttribute_,String(this.handlePosition))}setScrollbarLength(t){this.scrollbarLength=t,this.outerSvg.setAttribute(this.lengthAttribute_,String(this.scrollbarLength)),this.svgBackground.setAttribute(this.lengthAttribute_,String(this.scrollbarLength))}setPosition(t,i){this.position.x=t,this.position.y=i,_(this.outerSvg,"translate("+(this.position.x+this.origin.x)+"px,"+(this.position.y+this.origin.y)+"px)")}resize(t){!t&&(t=this.workspace.getMetrics(),!t)||this.oldHostMetrics&&Ge.metricsAreEquivalent(t,this.oldHostMetrics)||(this.horizontal?this.resizeHorizontal(t):this.resizeVertical(t),this.oldHostMetrics=t,this.updateMetrics())}requiresViewResize(t){return this.oldHostMetrics?this.oldHostMetrics.viewWidth!==t.viewWidth||this.oldHostMetrics.viewHeight!==t.viewHeight||this.oldHostMetrics.absoluteLeft!==t.absoluteLeft||this.oldHostMetrics.absoluteTop!==t.absoluteTop:!0}resizeHorizontal(t){this.requiresViewResize(t)?this.resizeViewHorizontal(t):this.resizeContentHorizontal(t)}resizeViewHorizontal(t){var i=t.viewWidth-2*this.margin;this.pair&&(i-=Ge.scrollbarThickness),this.setScrollbarLength(Math.max(0,i)),i=t.absoluteLeft+this.margin,this.pair&&this.workspace.RTL&&(i+=Ge.scrollbarThickness),this.setPosition(i,t.absoluteTop+t.viewHeight-Ge.scrollbarThickness-this.margin),this.resizeContentHorizontal(t)}resizeContentHorizontal(t){if(t.viewWidth>=t.scrollWidth)this.setHandleLength(this.scrollbarLength),this.setHandlePosition(0),this.pair||this.setVisible(!1);else{this.pair||this.setVisible(!0);var i=this.scrollbarLength*t.viewWidth/t.scrollWidth;i=this.constrainHandleLength(i),this.setHandleLength(i),i=t.scrollWidth-t.viewWidth;var r=this.scrollbarLength-this.handleLength;t=(t.viewLeft-t.scrollLeft)/i*r,t=this.constrainHandlePosition(t),this.setHandlePosition(t),this.ratio=r/i}}resizeVertical(t){this.requiresViewResize(t)?this.resizeViewVertical(t):this.resizeContentVertical(t)}resizeViewVertical(t){let i=t.viewHeight-2*this.margin;this.pair&&(i-=Ge.scrollbarThickness),this.setScrollbarLength(Math.max(0,i)),this.setPosition(this.workspace.RTL?t.absoluteLeft+this.margin:t.absoluteLeft+t.viewWidth-Ge.scrollbarThickness-this.margin,t.absoluteTop+this.margin),this.resizeContentVertical(t)}resizeContentVertical(t){if(t.viewHeight>=t.scrollHeight)this.setHandleLength(this.scrollbarLength),this.setHandlePosition(0),this.pair||this.setVisible(!1);else{this.pair||this.setVisible(!0);var i=this.scrollbarLength*t.viewHeight/t.scrollHeight;i=this.constrainHandleLength(i),this.setHandleLength(i),i=t.scrollHeight-t.viewHeight;var r=this.scrollbarLength-this.handleLength;t=(t.viewTop-t.scrollTop)/i*r,t=this.constrainHandlePosition(t),this.setHandlePosition(t),this.ratio=r/i}}isVisible(){return this.isHandleVisible}setContainerVisible(t){const i=t!==this.containerVisible;this.containerVisible=t,i&&this.updateDisplay_()}setVisible(t){if(this.pair)throw Error("Unable to toggle visibility of paired scrollbars.");this.setVisibleInternal(t)}setVisibleInternal(t){const i=t!==this.isVisible();this.isHandleVisible=t,i&&this.updateDisplay_()}updateDisplay_(){this.containerVisible&&this.isVisible()?this.outerSvg.setAttribute("display","block"):this.outerSvg.setAttribute("display","none")}onMouseDownBar(t){if(this.workspace.markFocused(),Ee(),this.cleanUp(),q(t))t.stopPropagation();else{var i=Z(t,this.workspace.getParentSvg(),this.workspace.getInverseScreenCTM());i=this.horizontal?i.x:i.y;var r=$(this.svgHandle);r=this.horizontal?r.x:r.y;var c=this.handlePosition,u=.95*this.handleLength;i<=r?c-=u:i>=r+this.handleLength&&(c+=u),this.setHandlePosition(this.constrainHandlePosition(c)),this.updateMetrics(),t.stopPropagation(),t.preventDefault()}}onMouseDownHandle(t){this.workspace.markFocused(),this.cleanUp(),q(t)?t.stopPropagation():(this.startDragHandle=this.handlePosition,this.startDragMouse=this.horizontal?t.clientX:t.clientY,this.onMouseUpWrapper_=yt(document,"pointerup",this,this.onMouseUpHandle),this.onMouseMoveWrapper_=yt(document,"pointermove",this,this.onMouseMoveHandle),t.stopPropagation(),t.preventDefault())}onMouseMoveHandle(t){this.setHandlePosition(this.constrainHandlePosition(this.startDragHandle+((this.horizontal?t.clientX:t.clientY)-this.startDragMouse))),this.updateMetrics()}onMouseUpHandle(){Ee(),this.cleanUp()}cleanUp(){this.workspace.hideChaff(!0),this.onMouseUpWrapper_&&(N(this.onMouseUpWrapper_),this.onMouseUpWrapper_=null),this.onMouseMoveWrapper_&&(N(this.onMouseMoveWrapper_),this.onMouseMoveWrapper_=null)}getRatio_(){let t=this.handlePosition/(this.scrollbarLength-this.handleLength);return isNaN(t)&&(t=0),t}updateMetrics(){const t=this.getRatio_();this.horizontal?this.workspace.setMetrics({x:t}):this.workspace.setMetrics({y:t})}set(t,i){this.setHandlePosition(this.constrainHandlePosition(t*this.ratio)),(i||i===void 0)&&this.updateMetrics()}setOrigin(t,i){this.origin=new pt(t,i)}static metricsAreEquivalent(t,i){return t.viewWidth===i.viewWidth&&t.viewHeight===i.viewHeight&&t.viewLeft===i.viewLeft&&t.viewTop===i.viewTop&&t.absoluteTop===i.absoluteTop&&t.absoluteLeft===i.absoluteLeft&&t.scrollWidth===i.scrollWidth&&t.scrollHeight===i.scrollHeight&&t.scrollLeft===i.scrollLeft&&t.scrollTop===i.scrollTop}};Ge.scrollbarThickness=Sy?25:15,Ge.DEFAULT_SCROLLBAR_MARGIN=.5;var Pu={parseFromString:function(){throw Error("DOMParser was not found in the global scope and was not properly injected using injectDependencies")}},fm={serializeToString:function(){throw Error("XMLSerializer was not foundin the global scope and was not properly injected using injectDependencies")}},{document:Bu,DOMParser:Jc,XMLSerializer:qc}=globalThis;Jc&&(Pu=new Jc),qc&&(fm=new qc);var Hy="https://developers.google.com/blockly/xml",eR=/[\x00-\x09\x0B\x0C\x0E-\x1F]/g,vl={NAME_SPACE:Hy};vl.createElement=s.createElement$$module$build$src$core$utils$xml,vl.createTextNode=s.createTextNode$$module$build$src$core$utils$xml,vl.domToText=Ut,vl.injectDependencies=At,vl.textToDom=s.textToDom$$module$build$src$core$utils$xml;var gm="categoryToolbox",Vy="flyoutToolbox",Wt;(function(t){t[t.TOP=0]="TOP",t[t.BOTTOM=1]="BOTTOM",t[t.LEFT=2]="LEFT",t[t.RIGHT=3]="RIGHT"})(Wt||(Wt={}));var Gy={hasCategoriesInternal:uE},mn={};mn.Position=Wt,mn.TEST_ONLY=Gy,mn.convertFlyoutDefToJsonArray=Ps,mn.convertToolboxDefToJson=yo,mn.hasCategories=Vh,mn.isCategoryCollapsible=Gh,mn.parseToolboxTree=of;var Lo;(function(t){t[t.TOP=0]="TOP",t[t.BOTTOM=1]="BOTTOM"})(Lo||(Lo={}));var yl;(function(t){t[t.LEFT=0]="LEFT",t[t.RIGHT=1]="RIGHT"})(yl||(yl={}));var $n;(function(t){t[t.UP=0]="UP",t[t.DOWN=1]="DOWN"})($n||($n={}));var ur={};ur.bumpDirection=$n,ur.bumpPositionRect=Yh,ur.getCornerOppositeToolbox=Xh,ur.getStartPositionRect=zh,ur.horizontalPosition=yl,ur.verticalPosition=Lo;var vi={width:96,height:124,url:"sprites.png"},Wy=class{constructor(t){this.workspace=t,this.id="zoomControls",this.boundEvents=[],this.zoomResetGroup=this.zoomOutGroup=this.zoomInGroup=null,this.HEIGHT=this.WIDTH=32,this.SMALL_SPACING=2,this.LARGE_SPACING=11,this.MARGIN_HORIZONTAL=this.MARGIN_VERTICAL=20,this.svgGroup=null,this.top=this.left=0,this.initialized=!1}createDom(){this.svgGroup=R(D.G,{});const t=String(Math.random()).substring(2);return this.createZoomOutSvg(t),this.createZoomInSvg(t),this.workspace.isMovable()&&this.createZoomResetSvg(t),this.svgGroup}init(){this.workspace.getComponentManager().addComponent({component:this,weight:2,capabilities:[je.Capability.POSITIONABLE]}),this.initialized=!0}dispose(){this.workspace.getComponentManager().removeComponent("zoomControls"),this.svgGroup&&Ct(this.svgGroup);for(const t of this.boundEvents)N(t);this.boundEvents.length=0}getBoundingRectangle(){let t=this.SMALL_SPACING+2*this.HEIGHT;return this.zoomResetGroup&&(t+=this.LARGE_SPACING+this.HEIGHT),new ve(this.top,this.top+t,this.left,this.left+this.WIDTH)}position(t,i){if(this.initialized){var r=Xh(this.workspace,t),c=this.SMALL_SPACING+2*this.HEIGHT;if(this.zoomResetGroup&&(c+=this.LARGE_SPACING+this.HEIGHT),t=zh(r,new Ce(this.WIDTH,c),this.MARGIN_HORIZONTAL,this.MARGIN_VERTICAL,t,this.workspace),r=r.vertical,i=Yh(t,this.MARGIN_VERTICAL,r===Lo.TOP?$n.DOWN:$n.UP,i),r===Lo.TOP){var u=this.SMALL_SPACING+this.HEIGHT,f;(f=this.zoomInGroup)==null||f.setAttribute("transform","translate(0, "+u+")"),this.zoomResetGroup&&this.zoomResetGroup.setAttribute("transform","translate(0, "+(u+this.LARGE_SPACING+this.HEIGHT)+")")}else{f=this.zoomResetGroup?this.LARGE_SPACING+this.HEIGHT:0;let S;(S=this.zoomInGroup)==null||S.setAttribute("transform","translate(0, "+f+")"),f=f+this.SMALL_SPACING+this.HEIGHT,(u=this.zoomOutGroup)==null||u.setAttribute("transform","translate(0, "+f+")")}this.top=i.top,this.left=i.left;var E;(E=this.svgGroup)==null||E.setAttribute("transform","translate("+this.left+","+this.top+")")}}createZoomOutSvg(t){this.zoomOutGroup=R(D.G,{class:"blocklyZoom blocklyZoomOut"},this.svgGroup);const i=R(D.CLIPPATH,{id:"blocklyZoomoutClipPath"+t},this.zoomOutGroup);R(D.RECT,{width:32,height:32},i),R(D.IMAGE,{width:vi.width,height:vi.height,x:-64,y:-92,"clip-path":"url(#blocklyZoomoutClipPath"+t+")"},this.zoomOutGroup).setAttributeNS(Xi,"xlink:href",this.workspace.options.pathToMedia+vi.url),this.boundEvents.push(yt(this.zoomOutGroup,"pointerdown",null,this.zoom.bind(this,-1)))}createZoomInSvg(t){this.zoomInGroup=R(D.G,{class:"blocklyZoom blocklyZoomIn"},this.svgGroup);const i=R(D.CLIPPATH,{id:"blocklyZoominClipPath"+t},this.zoomInGroup);R(D.RECT,{width:32,height:32},i),R(D.IMAGE,{width:vi.width,height:vi.height,x:-32,y:-92,"clip-path":"url(#blocklyZoominClipPath"+t+")"},this.zoomInGroup).setAttributeNS(Xi,"xlink:href",this.workspace.options.pathToMedia+vi.url),this.boundEvents.push(yt(this.zoomInGroup,"pointerdown",null,this.zoom.bind(this,1)))}zoom(t,i){this.workspace.markFocused(),this.workspace.zoomCenter(t),this.fireZoomEvent(),Ee(),i.stopPropagation(),i.preventDefault()}createZoomResetSvg(t){this.zoomResetGroup=R(D.G,{class:"blocklyZoom blocklyZoomReset"},this.svgGroup);const i=R(D.CLIPPATH,{id:"blocklyZoomresetClipPath"+t},this.zoomResetGroup);R(D.RECT,{width:32,height:32},i),R(D.IMAGE,{width:vi.width,height:vi.height,y:-92,"clip-path":"url(#blocklyZoomresetClipPath"+t+")"},this.zoomResetGroup).setAttributeNS(Xi,"xlink:href",this.workspace.options.pathToMedia+vi.url),this.boundEvents.push(yt(this.zoomResetGroup,"pointerdown",null,this.resetZoom.bind(this)))}resetZoom(t){this.workspace.markFocused();const i=Math.log(this.workspace.options.zoomOptions.startScale/this.workspace.scale)/Math.log(this.workspace.options.zoomOptions.scaleSpeed);this.workspace.beginCanvasTransition(),this.workspace.zoomCenter(i),this.workspace.scrollCenter(),setTimeout(this.workspace.endCanvasTransition.bind(this.workspace),500),this.fireZoomEvent(),Ee(),t.stopPropagation(),t.preventDefault()}fireZoomEvent(){const t=new(ut(Oo))(null,this.workspace.id,"zoom_controls");it(t)}};et(`
.blocklyZoom>image, .blocklyZoom>svg>image {
  opacity: .4;
}

.blocklyZoom>image:hover, .blocklyZoom>svg>image:hover {
  opacity: .6;
}

.blocklyZoom>image:active, .blocklyZoom>svg>image:active {
  opacity: .8;
}
`);var xi=class{constructor(t){this.name=t}toString(){return this.name}equals(t){return this.name===t.toString()}};xi.MUTATOR=new xi("mutator"),xi.WARNING=new xi("warning"),xi.COMMENT=new xi("comment"),function(t){t[t.VALUE=1]="VALUE",t[t.STATEMENT=3]="STATEMENT",t[t.DUMMY=5]="DUMMY",t[t.CUSTOM=6]="CUSTOM",t[t.END_ROW=7]="END_ROW"}(s.inputTypes$$module$build$src$core$inputs$input_types||(s.inputTypes$$module$build$src$core$inputs$input_types={})),s.inputTypes$$module$build$src$core$inputs$input_types;var zy=function(t,i){window.alert(t),i&&i()},Xy=function(t,i){i(window.confirm(t))},Yy=function(t,i,r){r(window.prompt(t,i))},Ky={confirmInternal:fE},dr={TEST_ONLY:Ky};dr.alert=Dc,dr.confirm=Kh,dr.prompt=jh,dr.setAlert=pE,dr.setConfirm=gE,dr.setPrompt=mE;var mm,jy;s.Msg$$module$build$src$core$msg=Object.create(null),mm=function(t){Object.keys(t).forEach(function(i){s.Msg$$module$build$src$core$msg[i]=t[i]})},jy={Msg:s.Msg$$module$build$src$core$msg,setLocale:mm};var Zc=class extends bl{constructor(t){super(),this.isBlank=typeof t>"u",t&&(this.varId=t.getId(),this.workspaceId=t.workspace.id)}toJson(){const t=super.toJson();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");return t.varId=this.varId,t}static fromJson(t,i,r){return i=super.fromJson(t,i,r??new Zc),i.varId=t.varId,i}},$m=class extends Zc{constructor(t){super(t),this.type=dn,t&&(this.varType=t.type,this.varName=t.name)}toJson(){const t=super.toJson();if(this.varType===void 0)throw Error("The var type is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");return t.varType=this.varType,t.varName=this.varName,t}static fromJson(t,i,r){return i=super.fromJson(t,i,r??new $m),i.varType=t.varType,i.varName=t.varName,i}run(t){const i=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");t?i.createVariable(this.varName,this.varType,this.varId):i.deleteVariableById(this.varId)}};o(rt.EVENT,dn,$m);var Qc=class{constructor(t,i,r,c){this.workspace=t,this.name=i,this.type=r||"",this.id_=c||ct()}getId(){return this.id_}static compareByName(t,i){return t.name.localeCompare(i.name,void 0,{sensitivity:"base"})}},_m="VARIABLE",Tm="ijkmnopqrstuvwxyzabcdefgh",Jy={generateUniqueNameInternal:_E},si={CATEGORY_NAME:_m,TEST_ONLY:Jy,VAR_LETTER_OPTIONS:Tm};si.allDeveloperVariables=s.allDeveloperVariables$$module$build$src$core$variables,si.allUsedVarModels=s.allUsedVarModels$$module$build$src$core$variables,si.createVariableButtonHandler=Zr,si.flyoutCategory=Jh,si.flyoutCategoryBlocks=rf,si.generateUniqueName=lf,si.generateUniqueNameFromOptions=qh,si.generateVariableFieldDom=tr,si.getAddedVariables=Qh,si.getOrCreateVariablePackage=s.getOrCreateVariablePackage$$module$build$src$core$variables,si.getVariable=s.getVariable$$module$build$src$core$variables,si.nameUsedWithAnyType=cf,si.nameUsedWithConflictingParam=af,si.promptName=Zh,si.renameVariable=s.renameVariable$$module$build$src$core$variables;var Xs=class{constructor(t,i,r,c,u){this.workspace=t,this.editable=this.movable=this.deletable=!0,this.disposed_=!1,this.isComment=!0,this.id=u&&!t.getCommentById(u)?u:ct(),t.addTopComment(this),this.xy_=new pt(0,0),this.height_=r,this.width_=c,this.RTL=t.RTL,this.content_=i,Xs.fireCreateEvent(this)}dispose(){this.disposed_||(Lt()&&it(new(ut(nr))(this)),this.workspace.removeTopComment(this),this.disposed_=!0)}getHeight(){return this.height_}setHeight(t){this.height_=t}getWidth(){return this.width_}setWidth(t){this.width_=t}getRelativeToSurfaceXY(){return new pt(this.xy_.x,this.xy_.y)}moveBy(t,i){const r=new(ut(Gs))(this);this.xy_.translate(t,i),r.recordNew(),it(r)}isDeletable(){return this.deletable&&!(this.workspace&&this.workspace.options.readOnly)}setDeletable(t){this.deletable=t}isMovable(){return this.movable&&!(this.workspace&&this.workspace.options.readOnly)}setMovable(t){this.movable=t}isEditable(){return this.editable&&!(this.workspace&&this.workspace.options.readOnly)}setEditable(t){this.editable=t}getContent(){return this.content_}setContent(t){this.content_!==t&&(it(new(ut(Tl))(this,this.content_,t)),this.content_=t)}toXmlWithXY(t){return t=this.toXml(t),t.setAttribute("x",String(Math.round(this.xy_.x))),t.setAttribute("y",String(Math.round(this.xy_.y))),t.setAttribute("h",String(this.height_)),t.setAttribute("w",String(this.width_)),t}toXml(t){const i=s.createElement$$module$build$src$core$utils$xml("comment");return t||(i.id=this.id),i.textContent=this.getContent(),i}static fireCreateEvent(t){if(Lt()){const i=s.getGroup$$module$build$src$core$events$utils();i||s.setGroup$$module$build$src$core$events$utils(!0);try{it(new(ut(fn))(t))}finally{s.setGroup$$module$build$src$core$events$utils(i)}}}static fromXml(t,i){var r=Xs.parseAttributes(t);return i=new Xs(i,r.content,r.h,r.w,r.id),r=t.getAttribute("x"),t=t.getAttribute("y"),r=r?parseInt(r,10):NaN,t=t?parseInt(t,10):NaN,isNaN(r)||isNaN(t)||i.moveBy(r,t),Xs.fireCreateEvent(i),i}static parseAttributes(t){const i=t.getAttribute("h"),r=t.getAttribute("w"),c=t.getAttribute("x"),u=t.getAttribute("y"),f=t.getAttribute("id");if(!f)throw Error("No ID present in XML comment definition.");let E;return{id:f,h:i?parseInt(i):100,w:r?parseInt(r):100,x:c?parseInt(c):NaN,y:u?parseInt(u):NaN,content:(E=t.textContent)!=null?E:""}}},bm=class extends Ws{constructor(t,i,r){super(r),this.type=ko,this.oldElementId=t??void 0,this.newElementId=i??void 0}toJson(){const t=super.toJson();return t.oldElementId=this.oldElementId,t.newElementId=this.newElementId,t}static fromJson(t,i,r){return i=super.fromJson(t,i,r??new bm),i.oldElementId=t.oldElementId,i.newElementId=t.newElementId,i}};o(rt.EVENT,ko,bm);var Em={};Em.register=tu,Em.unregister=yE;var Fu=class{paste(t,i,r){const c=t.commentState;if(r)c.setAttribute("x",`${r.x}`),c.setAttribute("y",`${r.y}`);else{var u;r=parseInt((u=c.getAttribute("x"))!=null?u:"0")+50;let f;u=parseInt((f=c.getAttribute("y"))!=null?f:"0")+50,c.setAttribute("x",`${r}`),c.setAttribute("y",`${u}`)}return oi.fromXmlRendered(t.commentState,i)}};Fu.TYPE="workspace-comment",tu(Fu.TYPE,new Fu);var ze=8,Uu=3,iR=2,oi=class extends Xs{constructor(t,i,r,c,u){super(t,i,r,c,u),this.onMouseMoveWrapper=this.onMouseUpWrapper=null,this.eventsInit=!1,this.deleteIconBorder=this.deleteGroup=this.resizeGroup=this.foreignObject=this.svgHandleTarget=this.svgRectTarget=this.textarea=null,this.rendered=this.autoLayout=this.focused=!1,this.svgGroup=R(D.G,{class:"blocklyComment"}),this.workspace=t,this.svgRect_=R(D.RECT,{class:"blocklyCommentRect",x:0,y:0,rx:Uu,ry:Uu}),this.svgGroup.appendChild(this.svgRect_),this.render()}dispose(){this.disposed_||(z()===this&&(this.unselect(),this.workspace.cancelCurrentGesture()),Lt()&&it(new(ut(nr))(this)),Ct(this.svgGroup),s.disable$$module$build$src$core$events$utils(),super.dispose(),s.enable$$module$build$src$core$events$utils())}initSvg(t){if(!this.workspace.rendered)throw TypeError("Workspace is headless.");this.workspace.options.readOnly||this.eventsInit||(yt(this.svgRectTarget,"pointerdown",this,this.pathMouseDown),yt(this.svgHandleTarget,"pointerdown",this,this.pathMouseDown)),this.eventsInit=!0,this.updateMovable(),this.getSvgRoot().parentNode||this.workspace.getBubbleCanvas().appendChild(this.getSvgRoot()),!t&&this.textarea&&this.textarea.select()}pathMouseDown(t){const i=this.workspace.getGesture(t);i&&i.handleBubbleStart(t,this)}showContextMenu(t){throw Error("The implementation of showContextMenu should be monkey-patched in by blockly.ts")}select(){if(z()!==this){var t=null;if(z()){t=z().id,s.disable$$module$build$src$core$events$utils();try{z().unselect()}finally{s.enable$$module$build$src$core$events$utils()}}t=new(ut(ko))(t,this.id,this.workspace.id),it(t),X(this),this.addSelect()}}unselect(){if(z()===this){var t=new(ut(ko))(this.id,null,this.workspace.id);it(t),X(null),this.removeSelect(),this.blurFocus()}}addSelect(){J(this.svgGroup,"blocklySelected"),this.setFocus()}removeSelect(){J(this.svgGroup,"blocklySelected"),this.blurFocus()}addFocus(){J(this.svgGroup,"blocklyFocused")}removeFocus(){mt(this.svgGroup,"blocklyFocused")}getRelativeToSurfaceXY(){const t=this.workspace.getLayerManager();if(!t)throw Error("Cannot calculate position because the workspace has not been appended");let i=0,r=0,c=this.getSvgRoot();if(c)do{const u=ls(c);i+=u.x,r+=u.y,c=c.parentNode}while(c&&!t.hasLayer(c)&&c!==null);return this.xy_=new pt(i,r)}moveBy(t,i){const r=new(ut(Gs))(this),c=this.getRelativeToSurfaceXY();this.translate(c.x+t,c.y+i),this.xy_=new pt(c.x+t,c.y+i),r.recordNew(),it(r),this.workspace.resizeContents()}translate(t,i){this.xy_=new pt(t,i),this.getSvgRoot().setAttribute("transform","translate("+t+","+i+")")}moveDuringDrag(t){t=`translate(${t.x}, ${t.y})`,this.getSvgRoot().setAttribute("transform",t)}moveTo(t,i){this.translate(t,i)}clearTransformAttributes(){this.getSvgRoot().removeAttribute("transform")}getBoundingRectangle(){var t=this.getRelativeToSurfaceXY();const i=this.getHeightWidth(),r=t.y,c=t.y+i.height;let u;return this.RTL?(u=t.x-i.width,t=t.x):(u=t.x,t=t.x+i.width),new ve(r,c,u,t)}updateMovable(){this.isMovable()?J(this.svgGroup,"blocklyDraggable"):mt(this.svgGroup,"blocklyDraggable")}setMovable(t){super.setMovable(t),this.updateMovable()}setEditable(t){super.setEditable(t),this.textarea&&(this.textarea.readOnly=!t)}setDragging(t){t?J(this.getSvgRoot(),"blocklyDragging"):mt(this.getSvgRoot(),"blocklyDragging")}getSvgRoot(){return this.svgGroup}getContent(){return this.textarea?this.textarea.value:this.content_}setContent(t){super.setContent(t),this.textarea&&(this.textarea.value=t)}setDeleteStyle(t){t?J(this.svgGroup,"blocklyDraggingDelete"):mt(this.svgGroup,"blocklyDraggingDelete")}setAutoLayout(t){}toXmlWithXY(t){let i=0;this.workspace.RTL&&(i=this.workspace.getWidth()),t=this.toXml(t);const r=this.getRelativeToSurfaceXY();return t.setAttribute("x",String(Math.round(this.workspace.RTL?i-r.x:r.x))),t.setAttribute("y",String(Math.round(r.y))),t.setAttribute("h",String(this.getHeight())),t.setAttribute("w",String(this.getWidth())),t}toCopyData(){return{paster:Fu.TYPE,commentState:this.toXmlWithXY()}}getHeightWidth(){return{width:this.getWidth(),height:this.getHeight()}}render(){if(!this.rendered){var t=this.getHeightWidth(),i=this.createEditor();this.svgGroup.appendChild(i),this.svgHandleTarget=R(D.RECT,{class:"blocklyCommentHandleTarget",x:0,y:0}),this.svgGroup.appendChild(this.svgHandleTarget),this.svgRectTarget=R(D.RECT,{class:"blocklyCommentTarget",x:0,y:0,rx:Uu,ry:Uu}),this.svgGroup.appendChild(this.svgRectTarget),this.addResizeDom(),this.isDeletable()&&this.addDeleteDom(),this.setSize(t.width,t.height),this.textarea.value=this.content_,this.rendered=!0,this.resizeGroup&&yt(this.resizeGroup,"pointerdown",this,this.resizeMouseDown),this.isDeletable()&&(yt(this.deleteGroup,"pointerdown",this,this.deleteMouseDown),yt(this.deleteGroup,"pointerout",this,this.deleteMouseOut),yt(this.deleteGroup,"pointerup",this,this.deleteMouseUp))}}createEditor(){this.foreignObject=R(D.FOREIGNOBJECT,{x:0,y:oi.TOP_OFFSET,class:"blocklyCommentForeignObject"});const t=document.createElementNS(zs,"body");t.setAttribute("xmlns",zs),t.className="blocklyMinimalBody";const i=document.createElementNS(zs,"textarea");return i.className="blocklyCommentTextarea",i.setAttribute("dir",this.RTL?"RTL":"LTR"),i.readOnly=!this.isEditable(),t.appendChild(i),this.textarea=i,this.foreignObject.appendChild(t),yt(i,"wheel",this,function(r){r.stopPropagation()}),yt(i,"change",this,function(r){this.setContent(i.value)}),this.foreignObject}addResizeDom(){this.resizeGroup=R(D.G,{class:this.RTL?"blocklyResizeSW":"blocklyResizeSE"},this.svgGroup),R(D.POLYGON,{points:`0,${ze} ${ze},${ze} ${ze},0`},this.resizeGroup),R(D.LINE,{class:"blocklyResizeLine",x1:ze/3,y1:ze-1,x2:ze-1,y2:ze/3},this.resizeGroup),R(D.LINE,{class:"blocklyResizeLine",x1:2*ze/3,y1:ze-1,x2:ze-1,y2:2*ze/3},this.resizeGroup)}addDeleteDom(){this.deleteGroup=R(D.G,{class:"blocklyCommentDeleteIcon"},this.svgGroup),this.deleteIconBorder=R(D.CIRCLE,{class:"blocklyDeleteIconShape",r:"7",cx:"7.5",cy:"7.5"},this.deleteGroup),R(D.LINE,{x1:"5",y1:"10",x2:"10",y2:"5",stroke:"#fff","stroke-width":"2"},this.deleteGroup),R(D.LINE,{x1:"5",y1:"5",x2:"10",y2:"10",stroke:"#fff","stroke-width":"2"},this.deleteGroup)}resizeMouseDown(t){this.unbindDragEvents(),q(t)||(this.workspace.startDrag(t,new pt(this.workspace.RTL?-this.width_:this.width_,this.height_)),this.onMouseUpWrapper=yt(document,"pointerup",this,this.resizeMouseUp),this.onMouseMoveWrapper=yt(document,"pointermove",this,this.resizeMouseMove),this.workspace.hideChaff()),t.stopPropagation()}deleteMouseDown(t){this.deleteIconBorder&&J(this.deleteIconBorder,"blocklyDeleteIconHighlighted"),t.stopPropagation()}deleteMouseOut(t){this.deleteIconBorder&&mt(this.deleteIconBorder,"blocklyDeleteIconHighlighted")}deleteMouseUp(t){this.dispose(),t.stopPropagation()}unbindDragEvents(){this.onMouseUpWrapper&&(N(this.onMouseUpWrapper),this.onMouseUpWrapper=null),this.onMouseMoveWrapper&&(N(this.onMouseMoveWrapper),this.onMouseMoveWrapper=null)}resizeMouseUp(t){Ee(),this.unbindDragEvents()}resizeMouseMove(t){this.autoLayout=!1,t=this.workspace.moveDrag(t),this.setSize(this.RTL?-t.x:t.x,t.y)}resizeComment(){const t=this.getHeightWidth(),i=oi.TOP_OFFSET,r=2*iR;let c;(c=this.foreignObject)==null||c.setAttribute("width",String(t.width));let u;if((u=this.foreignObject)==null||u.setAttribute("height",String(t.height-i)),this.RTL){let f;(f=this.foreignObject)==null||f.setAttribute("x",String(-t.width))}this.textarea&&(this.textarea.style.width=t.width-r+"px",this.textarea.style.height=t.height-r-i+"px")}setSize(t,i){t=Math.max(t,45),i=Math.max(i,20+oi.TOP_OFFSET),this.width_=t,this.height_=i,this.svgRect_.setAttribute("width",`${t}`),this.svgRect_.setAttribute("height",`${i}`);let r;(r=this.svgRectTarget)==null||r.setAttribute("width",`${t}`);let c;(c=this.svgRectTarget)==null||c.setAttribute("height",`${i}`);let u;(u=this.svgHandleTarget)==null||u.setAttribute("width",`${t}`);let f;if((f=this.svgHandleTarget)==null||f.setAttribute("height",String(oi.TOP_OFFSET)),this.RTL){this.svgRect_.setAttribute("transform","scale(-1 1)");let E;(E=this.svgRectTarget)==null||E.setAttribute("transform","scale(-1 1)")}if(this.resizeGroup)if(this.RTL){this.resizeGroup.setAttribute("transform","translate("+(-t+ze)+","+(i-ze)+") scale(-1 1)");let E;(E=this.deleteGroup)==null||E.setAttribute("transform","translate("+(-t+ze)+","+-ze+") scale(-1 1)")}else{this.resizeGroup.setAttribute("transform","translate("+(t-ze)+","+(i-ze)+")");let E;(E=this.deleteGroup)==null||E.setAttribute("transform","translate("+(t-ze)+","+-ze+")")}this.resizeComment()}setFocus(){this.focused=!0,setTimeout(()=>{this.disposed_||(this.textarea.focus(),this.addFocus(),this.svgRectTarget&&J(this.svgRectTarget,"blocklyCommentTargetFocused"),this.svgHandleTarget&&J(this.svgHandleTarget,"blocklyCommentHandleTargetFocused"))},0)}blurFocus(){this.focused=!1,setTimeout(()=>{this.disposed_||(this.textarea.blur(),this.removeFocus(),this.svgRectTarget&&mt(this.svgRectTarget,"blocklyCommentTargetFocused"),this.svgHandleTarget&&mt(this.svgHandleTarget,"blocklyCommentHandleTargetFocused"))},0)}static fromXmlRendered(t,i,r){s.disable$$module$build$src$core$events$utils();let c;try{const u=Xs.parseAttributes(t);if(c=new oi(i,u.content,u.h,u.w,u.id),i.rendered&&(c.initSvg(!0),c.render()),!isNaN(u.x)&&!isNaN(u.y))if(i.RTL){const f=r||i.getWidth();c.moveBy(f-u.x,u.y)}else c.moveBy(u.x,u.y)}finally{s.enable$$module$build$src$core$events$utils()}return Xs.fireCreateEvent(c),c}};oi.DEFAULT_SIZE=100,oi.TOP_OFFSET=10,et(`
.blocklyCommentForeignObject {
  position: relative;
  z-index: 0;
}

.blocklyCommentRect {
  fill: #E7DE8E;
  stroke: #bcA903;
  stroke-width: 1px;
}

.blocklyCommentTarget {
  fill: transparent;
  stroke: #bcA903;
}

.blocklyCommentTargetFocused {
  fill: none;
}

.blocklyCommentHandleTarget {
  fill: none;
}

.blocklyCommentHandleTargetFocused {
  fill: transparent;
}

.blocklyFocused>.blocklyCommentRect {
  fill: #B9B272;
  stroke: #B9B272;
}

.blocklySelected>.blocklyCommentTarget {
  stroke: #fc3;
  stroke-width: 3px;
}

.blocklyCommentDeleteIcon {
  cursor: pointer;
  fill: #000;
  display: none;
}

.blocklySelected > .blocklyCommentDeleteIcon {
  display: block;
}

.blocklyDeleteIconShape {
  fill: #000;
  stroke: #000;
  stroke-width: 1px;
}

.blocklyDeleteIconShape.blocklyDeleteIconHighlighted {
  stroke: #fc3;
}
`);var Hu=new Set,vm=new WeakSet,Il=null,ym=null,qy=0,Vu={};Vu.finishQueuedRenders=Pc,Vu.queueRender=hf,Vu.triggerQueuedRenders=Bs;var Di={};Di.appendDomToWorkspace=RE,Di.blockToDom=on,Di.blockToDomWithXY=Bc,Di.clearWorkspaceAndLoadFromXml=AE,Di.deleteNext=UE,Di.domToBlock=s.domToBlock$$module$build$src$core$xml,Di.domToBlockInternal=nn,Di.domToPrettyText=OE,Di.domToText=Fs,Di.domToVariables=mf,Di.domToWorkspace=s.domToWorkspace$$module$build$src$core$xml,Di.variablesToDom=ff,Di.workspaceToDom=CE;var Sl=class extends Error{},Zy=class extends Sl{constructor(t){super("Expected to find a 'type' property, defining the block type"),this.state=t}},ta=class extends Sl{constructor(t,i,r){super(`The block ${i.toDevString()} is missing a(n) ${t}
connection`),this.block=i,this.state=r}},Qy=class extends Sl{constructor(t,i,r,c){super(`The block ${r.toDevString()} could not connect its
${i} to its parent, because: ${t}`),this.childBlock=r,this.childState=c}},tI=class extends Sl{constructor(t){super(`Encountered a real block which is defined as a child of a shadow
block. It is an invariant of Blockly that shadow blocks only have shadow
children`),this.state=t}},eI=class extends Sl{constructor(t,i,r){super(`Cannot add an icon of type '${t}' to the block ${i.toDevString()}, because there is no icon registered with type '${t}'. Make sure that all of your icons have been registered.`),this.block=i,this.state=r}},pr={};pr.BadConnectionCheck=Qy,pr.DeserializationError=Sl,pr.MissingBlockType=Zy,pr.MissingConnection=ta,pr.RealChildOfShadow=tI,pr.UnregisteredIcon=eI;var iI=100,sI=75,oI=50,sR={BLOCKS:oI,PROCEDURES:sI,VARIABLES:iI},Im={};Im.register=ou,Im.unregister=HE;var nI=class{constructor(){this.priority=oI}save(t){const i=[];for(const r of t.getTopBlocks(!1))(t=Us(r,{addCoordinates:!0,doFullSerialization:!1}))&&i.push(t);return i.length?{languageVersion:0,blocks:i}:null}load(t,i){t=t.blocks;for(const r of t)rn(r,i,{recordUndo:vt()})}clear(t){for(const i of t.getTopBlocks(!1))i.dispose(!1)}};ou("blocks",new nI);var ea={};ea.BlockSerializer=nI,ea.append=rn,ea.appendInternal=Qr,ea.save=Us;var fr=class extends bl{constructor(t){super(),this.isBlank=!t,t&&(this.blockId=t.id,this.workspaceId=t.workspace.id)}toJson(){const t=super.toJson();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");return t.blockId=this.blockId,t}static fromJson(t,i,r){return i=super.fromJson(t,i,r??new fr),i.blockId=t.blockId,i}},Sm=class extends fr{constructor(t){super(t),this.type=s.CREATE$$module$build$src$core$events$utils,t&&(t.isShadow()&&(this.recordUndo=!1),this.xml=Bc(t),this.ids=Ht(t),this.json=Us(t,{addCoordinates:!0}))}toJson(){const t=super.toJson();if(!this.xml)throw Error("The block XML is undefined. Either pass a block to the constructor, or call fromJson");if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(!this.json)throw Error("The block JSON is undefined. Either pass a block to the constructor, or call fromJson");return t.xml=Fs(this.xml),t.ids=this.ids,t.json=this.json,this.recordUndo||(t.recordUndo=this.recordUndo),t}static fromJson(t,i,r){return i=super.fromJson(t,i,r??new Sm),i.xml=s.textToDom$$module$build$src$core$utils$xml(t.xml),i.ids=t.ids,i.json=t.json,t.recordUndo!==void 0&&(i.recordUndo=t.recordUndo),i}run(t){const i=this.getEventWorkspace_();if(!this.json)throw Error("The block JSON is undefined. Either pass a block to the constructor, or call fromJson");if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(!oR(i,this.ids))if(t)rn(this.json,i);else for(t=0;t<this.ids.length;t++){const r=this.ids[t],c=i.getBlockById(r);c?c.dispose(!1):r===this.blockId&&console.warn("Can't uncreate non-existent block: "+r)}}},oR=function(t,i){return i.map(r=>t.getBlockById(r)).filter(r=>r&&r.isShadow()).length===i.length};o(rt.EVENT,s.CREATE$$module$build$src$core$events$utils,Sm);var Cm=class extends Ws{constructor(t,i){super(i),this.type=_l,this.themeName=t}toJson(){const t=super.toJson();if(!this.themeName)throw Error("The theme name is undefined. Either pass a theme name to the constructor, or call fromJson");return t.themeName=this.themeName,t}static fromJson(t,i,r){return i=super.fromJson(t,i,r??new Cm),i.themeName=t.themeName,i}};o(rt.EVENT,_l,Cm);var wm=class extends Ws{constructor(t,i,r,c,u){super(c),this.type=pn,this.viewTop=t,this.viewLeft=i,this.scale=r,this.oldScale=u}toJson(){const t=super.toJson();if(this.viewTop===void 0)throw Error("The view top is undefined. Either pass a value to the constructor, or call fromJson");if(this.viewLeft===void 0)throw Error("The view left is undefined. Either pass a value to the constructor, or call fromJson");if(this.scale===void 0)throw Error("The scale is undefined. Either pass a value to the constructor, or call fromJson");if(this.oldScale===void 0)throw Error("The old scale is undefined. Either pass a value to the constructor, or call fromJson");return t.viewTop=this.viewTop,t.viewLeft=this.viewLeft,t.scale=this.scale,t.oldScale=this.oldScale,t}static fromJson(t,i,r){return i=super.fromJson(t,i,r??new wm),i.viewTop=t.viewTop,i.viewLeft=t.viewLeft,i.scale=t.scale,i.oldScale=t.oldScale,i}};o(rt.EVENT,pn,wm);var km;km=28,s.config$$module$build$src$core$config={dragRadius:5,flyoutDragRadius:10,snapRadius:km,connectingSnapRadius:km,currentConnectionPreference:8,bumpDelay:250},s.config$$module$build$src$core$config;var wt;(function(t){t[t.INPUT_VALUE=1]="INPUT_VALUE",t[t.OUTPUT_VALUE=2]="OUTPUT_VALUE",t[t.NEXT_STATEMENT=3]="NEXT_STATEMENT",t[t.PREVIOUS_STATEMENT=4]="PREVIOUS_STATEMENT"})(wt||(wt={}));var Cl=class{constructor(t){this.connectionChecker=t,this.connections=[]}addConnection(t,i){i=this.calculateIndexForYPos(i),this.connections.splice(i,0,t)}findIndexOfConnection(t,i){if(!this.connections.length)return-1;const r=this.calculateIndexForYPos(i);if(r>=this.connections.length)return-1;i=t.y;let c=r;for(;0<=c&&this.connections[c].y===i;){if(this.connections[c]===t)return c;c--}for(c=r;c<this.connections.length&&this.connections[c].y===i;){if(this.connections[c]===t)return c;c++}return-1}calculateIndexForYPos(t){if(!this.connections.length)return 0;let i=0,r=this.connections.length;for(;i<r;){const c=Math.floor((i+r)/2);if(this.connections[c].y<t)i=c+1;else if(this.connections[c].y>t)r=c;else{i=c;break}}return i}removeConnection(t,i){if(t=this.findIndexOfConnection(t,i),t===-1)throw Error("Unable to find connection in connectionDB.");this.connections.splice(t,1)}getNeighbours(t,i){function r(bt){const ke=u-c[bt].x,Ie=f-c[bt].y;return Math.sqrt(ke*ke+Ie*Ie)<=i&&W.push(c[bt]),Ie<i}const c=this.connections,u=t.x,f=t.y;t=0;let E=c.length-2,S=E;for(;t<S;)c[S].y<f?t=S:E=S,S=Math.floor((t+E)/2);const W=[];if(E=t=S,c.length){for(;0<=t&&r(t);)t--;do E++;while(E<c.length&&r(E))}return W}isInYRange(t,i,r){return Math.abs(this.connections[t].y-i)<=r}searchForClosest(t,i,r){if(!this.connections.length)return{connection:null,radius:i};const c=t.y,u=t.x;t.x=u+r.x,t.y=c+r.y;var f=this.calculateIndexForYPos(t.y);r=null;let E=i,S,W=f-1;for(;0<=W&&this.isInYRange(W,t.y,i);)S=this.connections[W],this.connectionChecker.canConnect(t,S,!0,E)&&(r=S,E=S.distanceFrom(t)),W--;for(;f<this.connections.length&&this.isInYRange(f,t.y,i);)S=this.connections[f],this.connectionChecker.canConnect(t,S,!0,E)&&(r=S,E=S.distanceFrom(t)),f++;return t.x=u,t.y=c,{connection:r,radius:E}}static init(t){const i=[];return i[wt.INPUT_VALUE]=new Cl(t),i[wt.OUTPUT_VALUE]=new Cl(t),i[wt.NEXT_STATEMENT]=new Cl(t),i[wt.PREVIOUS_STATEMENT]=new Cl(t),i}},ia=class{paste(t,i,r){if(!i.isCapacityAvailable(t.typeCounts))return null;r&&(t.blockState.x=r.x,t.blockState.y=r.y),s.disable$$module$build$src$core$events$utils();let c;try{c=rn(t.blockState,i),ov(c)}finally{s.enable$$module$build$src$core$events$utils()}return c&&(Lt()&&!c.isShadow()&&it(new(ut(s.CREATE$$module$build$src$core$events$utils))(c)),c.select(),c)}};ia.TYPE="block",tu(ia.TYPE,new ia);var Om=null,Am=null,Rm={duplicateInternal:hv,copyInternal:cv},gr={};gr.BlockPaster=ia,gr.TEST_ONLY=Rm,gr.copy=lv,gr.duplicate=av,gr.paste=tl,gr.registry=Em;var nR="aria-",rR="role",Pi;(function(t){t.GRID="grid",t.GRIDCELL="gridcell",t.GROUP="group",t.LISTBOX="listbox",t.MENU="menu",t.MENUITEM="menuitem",t.MENUITEMCHECKBOX="menuitemcheckbox",t.OPTION="option",t.PRESENTATION="presentation",t.ROW="row",t.TREE="tree",t.TREEITEM="treeitem"})(Pi||(Pi={}));var we;(function(t){t.ACTIVEDESCENDANT="activedescendant",t.COLCOUNT="colcount",t.DISABLED="disabled",t.EXPANDED="expanded",t.INVALID="invalid",t.LABEL="label",t.LABELLEDBY="labelledby",t.LEVEL="level",t.ORIENTATION="orientation",t.POSINSET="posinset",t.ROWCOUNT="rowcount",t.SELECTED="selected",t.SETSIZE="setsize",t.VALUEMAX="valuemax",t.VALUEMIN="valuemin"})(we||(we={}));var sa={};sa.Role=Pi,sa.State=we,sa.setRole=bs,sa.setState=Re;var Nm=class{constructor(){this.menuItems=[],this.roleName=this.element=this.onKeyDownHandler=this.mouseLeaveHandler=this.mouseEnterHandler=this.clickHandler=this.mouseOverHandler=this.highlightedItem=this.openingCoords=null}addChild(t){this.menuItems.push(t)}render(t){const i=document.createElement("div");i.className="blocklyMenu goog-menu blocklyNonSelectable",i.tabIndex=0,this.roleName&&bs(i,this.roleName),this.element=i;for(let r=0,c;c=this.menuItems[r];r++)i.appendChild(c.createDom());return this.mouseOverHandler=yt(i,"pointerover",this,this.handleMouseOver,!0),this.clickHandler=yt(i,"pointerup",this,this.handleClick,!0),this.mouseEnterHandler=yt(i,"pointerenter",this,this.handleMouseEnter,!0),this.mouseLeaveHandler=yt(i,"pointerleave",this,this.handleMouseLeave,!0),this.onKeyDownHandler=yt(i,"keydown",this,this.handleKeyEvent),t.appendChild(i),i}getElement(){return this.element}focus(){const t=this.getElement();t&&(t.focus({preventScroll:!0}),J(t,"blocklyFocused"))}blur(){const t=this.getElement();t&&(t.blur(),mt(t,"blocklyFocused"))}setRole(t){this.roleName=t}dispose(){this.mouseOverHandler&&(N(this.mouseOverHandler),this.mouseOverHandler=null),this.clickHandler&&(N(this.clickHandler),this.clickHandler=null),this.mouseEnterHandler&&(N(this.mouseEnterHandler),this.mouseEnterHandler=null),this.mouseLeaveHandler&&(N(this.mouseLeaveHandler),this.mouseLeaveHandler=null),this.onKeyDownHandler&&(N(this.onKeyDownHandler),this.onKeyDownHandler=null);for(let t=0,i;i=this.menuItems[t];t++)i.dispose();this.element=null}getMenuItem(t){const i=this.getElement();for(;t&&t!==i;){if(t.classList.contains("blocklyMenuItem")){for(let r=0,c;c=this.menuItems[r];r++)if(c.getElement()===t)return c}t=t.parentElement}return null}setHighlighted(t){var i=this.highlightedItem;i&&(i.setHighlighted(!1),this.highlightedItem=null),t&&(t.setHighlighted(!0),this.highlightedItem=t,i=this.getElement(),Qn(t.getElement(),i),Re(i,we.ACTIVEDESCENDANT,t.getId()))}highlightNext(){const t=this.highlightedItem?this.menuItems.indexOf(this.highlightedItem):-1;this.highlightHelper(t,1)}highlightPrevious(){const t=this.highlightedItem?this.menuItems.indexOf(this.highlightedItem):-1;this.highlightHelper(0>t?this.menuItems.length:t,-1)}highlightFirst(){this.highlightHelper(-1,1)}highlightLast(){this.highlightHelper(this.menuItems.length,-1)}highlightHelper(t,i){t+=i;let r;for(;r=this.menuItems[t];){if(r.isEnabled()){this.setHighlighted(r);break}t+=i}}handleMouseOver(t){(t=this.getMenuItem(t.target))&&(t.isEnabled()?this.highlightedItem!==t&&this.setHighlighted(t):this.setHighlighted(null))}handleClick(t){const i=this.openingCoords;if(this.openingCoords=null,i&&typeof t.clientX=="number"){const r=new pt(t.clientX,t.clientY);if(1>pt.distance(i,r))return}(t=this.getMenuItem(t.target))&&t.performAction()}handleMouseEnter(t){this.focus()}handleMouseLeave(t){this.getElement()&&(this.blur(),this.setHighlighted(null))}handleKeyEvent(t){if(this.menuItems.length&&!(t.shiftKey||t.ctrlKey||t.metaKey||t.altKey)){var i=this.highlightedItem;switch(t.key){case"Enter":case" ":i&&i.performAction();break;case"ArrowUp":this.highlightPrevious();break;case"ArrowDown":this.highlightNext();break;case"PageUp":case"Home":this.highlightFirst();break;case"PageDown":case"End":this.highlightLast();break;default:return}t.preventDefault(),t.stopPropagation()}}getSize(){const t=this.getElement(),i=bi(t);return i.height=t.scrollHeight,i}},Lm=class{constructor(t,i){this.content=t,this.opt_value=i,this.enabled=!0,this.element=null,this.rightToLeft=!1,this.roleName=null,this.highlight=this.checked=this.checkable=!1,this.actionHandler=null}createDom(){const t=document.createElement("div");t.id=ot(),this.element=t,t.className="blocklyMenuItem goog-menuitem "+(this.enabled?"":"blocklyMenuItemDisabled goog-menuitem-disabled ")+(this.checked?"blocklyMenuItemSelected goog-option-selected ":"")+(this.highlight?"blocklyMenuItemHighlight goog-menuitem-highlight ":"")+(this.rightToLeft?"blocklyMenuItemRtl goog-menuitem-rtl ":"");const i=document.createElement("div");if(i.className="blocklyMenuItemContent goog-menuitem-content",this.checkable){var r=document.createElement("div");r.className="blocklyMenuItemCheckbox goog-menuitem-checkbox",i.appendChild(r)}return r=this.content,typeof this.content=="string"&&(r=document.createTextNode(this.content)),i.appendChild(r),t.appendChild(i),this.roleName&&bs(t,this.roleName),Re(t,we.SELECTED,this.checkable&&this.checked||!1),Re(t,we.DISABLED,!this.enabled),t}dispose(){this.element=null}getElement(){return this.element}getId(){return this.element.id}getValue(){let t;return(t=this.opt_value)!=null?t:null}setRightToLeft(t){this.rightToLeft=t}setRole(t){this.roleName=t}setCheckable(t){this.checkable=t}setChecked(t){this.checked=t}setHighlighted(t){this.highlight=t;const i=this.getElement();i&&this.isEnabled()&&(t?(J(i,"blocklyMenuItemHighlight"),J(i,"goog-menuitem-highlight")):(mt(i,"blocklyMenuItemHighlight"),mt(i,"goog-menuitem-highlight")))}isEnabled(){return this.enabled}setEnabled(t){this.enabled=t}performAction(){this.isEnabled()&&this.actionHandler&&this.actionHandler(this)}onAction(t,i){this.actionHandler=t.bind(i)}},wl=null,Gu=null,Mm="blocklyWidgetDiv",kl="",Ol="",Ys,Ks={};Ks.createDom=yf,Ks.getDiv=er,Ks.hide=cs,Ks.hideIfOwner=ru,Ks.isVisible=If,Ks.positionWithAnchor=Cf,Ks.repositionForWindowResize=wf,Ks.show=nu,Ks.testOnly_setDiv=uv;var Wu=null,rI={},zu=null,js={};js.callbackFactory=s.callbackFactory$$module$build$src$core$contextmenu,js.commentDeleteOption=Af,js.commentDuplicateOption=Rf,js.dispose=Of,js.getCurrentBlock=gv,js.hide=Uc,js.setCurrentBlock=kf,js.show=Fc,js.workspaceCommentOption=bv;var ne=class{constructor(){this.registry_=new Map,this.reset()}reset(){this.registry_.clear()}register(t){if(this.registry_.has(t.id))throw Error('Menu item with ID "'+t.id+'" is already registered.');this.registry_.set(t.id,t)}unregister(t){if(!this.registry_.has(t))throw Error('Menu item with ID "'+t+'" not found.');this.registry_.delete(t)}getItem(t){let i;return(i=this.registry_.get(t))!=null?i:null}getContextMenuOptions(t,i){const r=[];for(const u of this.registry_.values())if(t===u.scopeType){var c=u.preconditionFn(i);c!=="hidden"&&(c={text:typeof u.displayText=="function"?u.displayText(i):u.displayText,enabled:c==="enabled",callback:u.callback,scope:i,weight:u.weight},r.push(c))}return r.sort(function(u,f){return u.weight-f.weight}),r}};(function(t){var i=t.ScopeType||(t.ScopeType={});i.BLOCK="block",i.WORKSPACE="workspace",t.registry=new t})(ne||(ne={})),ne.ScopeType;var Xu={};Xu.clamp=il,Xu.toDegrees=Nf,Xu.toRadians=el;var oa=16,xm=1,lI=12,Dm=16,Yu=.25,Pm=null,mr=null,Al="",Rl="",le,Nl,$r,Bm=null,_n=null,cI=null,Fm={getBoundsInfo:function(){const t=Se(Bm),i=bi(Bm);return{left:t.x,right:t.x+i.width,top:t.y,bottom:t.y+i.height,width:i.width,height:i.height}},getPositionMetrics:function(t,i,r,c){const u=Fm.getBoundsInfo(),f=bi(le);return i+f.height<u.bottom?Uf(t,i,u,f):c-f.height>u.top?Hf(r,c,u,f):i+f.height<document.documentElement.clientHeight?Uf(t,i,u,f):c-f.height>document.documentElement.clientTop?Hf(r,c,u,f):vv(t,u,f)}},ui={ANIMATION_TIME:Yu,ARROW_HORIZONTAL_PADDING:lI,ARROW_SIZE:oa,BORDER_SIZE:xm,PADDING_Y:Dm,TEST_ONLY:Fm};ui.clearContent=lu,ui.createDom=Lf,ui.getContentDiv=sl,ui.getOwner=xf,ui.getPositionX=Vc,ui.hide=au,ui.hideIfOwner=ol,ui.hideWithoutAnimation=Es,ui.isVisible=Vf,ui.repositionForWindowResize=Wf,ui.setBoundsElement=Mf,ui.setColour=cu,ui.show=Ff,ui.showPositionedByBlock=Ev,ui.showPositionedByField=Hc;var Ku=null,na=null,ra={};ra.connectionUiEffect=Yf,ra.disconnectUiEffect=Kf,ra.disconnectUiStop=nl,ra.disposeUiEffect=zf;var Um=50,Hm=100,aI=class{constructor(t,i){this.bubble=t,this.workspace=i,this.dragTarget_=null,this.wouldDeleteBubble_=!1,this.startXY_=this.bubble.getRelativeToSurfaceXY()}startBubbleDrag(){s.getGroup$$module$build$src$core$events$utils()||s.setGroup$$module$build$src$core$events$utils(!0),this.workspace.setResizesEnabled(!1),this.bubble.setAutoLayout&&this.bubble.setAutoLayout(!1);let t;(t=this.workspace.getLayerManager())==null||t.moveToDragLayer(this.bubble),this.bubble.setDragging&&this.bubble.setDragging(!0)}dragBubble(t,i){i=this.pixelsToWorkspaceUnits_(i),i=pt.sum(this.startXY_,i),this.bubble.moveDuringDrag(i),i=this.dragTarget_,this.dragTarget_=this.workspace.getDragTarget(t),t=this.wouldDeleteBubble_,this.wouldDeleteBubble_=this.shouldDelete_(this.dragTarget_),t!==this.wouldDeleteBubble_&&this.updateCursorDuringBubbleDrag_(),this.dragTarget_!==i&&(i&&i.onDragExit(this.bubble),this.dragTarget_&&this.dragTarget_.onDragEnter(this.bubble)),this.dragTarget_&&this.dragTarget_.onDragOver(this.bubble)}shouldDelete_(t){return t&&this.workspace.getComponentManager().hasCapability(t.id,je.Capability.DELETE_AREA)?t.wouldDelete(this.bubble,!1):!1}updateCursorDuringBubbleDrag_(){this.bubble.setDeleteStyle(this.wouldDeleteBubble_)}endBubbleDrag(t,i){if(this.dragBubble(t,i),this.dragTarget_&&this.dragTarget_.shouldPreventMove(this.bubble)?t=this.startXY_:(t=this.pixelsToWorkspaceUnits_(i),t=pt.sum(this.startXY_,t)),this.bubble.moveTo(t.x,t.y),this.dragTarget_&&this.dragTarget_.onDrop(this.bubble),this.wouldDeleteBubble_)this.fireMoveEvent_(),this.bubble.dispose();else{if(this.bubble.setDragging){this.bubble.setDragging(!1);let r;(r=this.workspace.getLayerManager())==null||r.moveOffDragLayer(this.bubble,Hm)}this.fireMoveEvent_()}this.workspace.setResizesEnabled(!0),s.setGroup$$module$build$src$core$events$utils(!1)}fireMoveEvent_(){if(this.bubble instanceof oi){const t=new(ut(Gs))(this.bubble);t.setOldCoordinate(this.startXY_),t.recordNew(),it(t)}}pixelsToWorkspaceUnits_(t){return t=new pt(t.x/this.workspace.scale,t.y/this.workspace.scale),this.workspace.isMutator&&t.scale(1/this.workspace.options.parentWorkspace.scale),t}},hI=30,uI=!0,_r=[];_r[wt.INPUT_VALUE]=wt.OUTPUT_VALUE,_r[wt.OUTPUT_VALUE]=wt.INPUT_VALUE,_r[wt.NEXT_STATEMENT]=wt.PREVIOUS_STATEMENT,_r[wt.PREVIOUS_STATEMENT]=wt.NEXT_STATEMENT;var Vm="RENAME_VARIABLE_ID",Gm="DELETE_VARIABLE_ID",Tr={};Tr.commonWordPrefix=Jf,Tr.commonWordSuffix=qf,Tr.isNumber=s.isNumber$$module$build$src$core$utils$string,Tr.shortestStringLength=Gc,Tr.startsWith=yv,Tr.wrap=s.wrap$$module$build$src$core$utils$string;var ju=void 0,la=!1,Ll=!1,dI=50,pI=0,br=0,Wm=0,zm=0,as=null,ca=null,Xm=0,Ym=10,fI=10,gI=750,Ju=5,Xe=null,Yi={HOVER_MS:gI,LIMIT:dI,MARGINS:Ju,OFFSET_X:Xm,OFFSET_Y:Ym,RADIUS_OK:fI};Yi.bindMouseEvents=ll,Yi.block=sg,Yi.createDom=tg,Yi.dispose=ig,Yi.getCustomTooltip=wv,Yi.getDiv=Ov,Yi.getTooltipOfObject=rl,Yi.hide=Io,Yi.isVisible=kv,Yi.setCustomTooltip=Cv,Yi.unbindMouseEvents=uu,Yi.unblock=og;var mI=class{constructor(t){this.workspace=t,this.horizontalScrollEnabled_=this.workspace.isMovableHorizontally(),this.verticalScrollEnabled_=this.workspace.isMovableVertically(),this.startScrollXY_=new pt(t.scrollX,t.scrollY)}dispose(){this.workspace=null}startDrag(){z()&&z().unselect()}endDrag(t){this.drag(t)}drag(t){if(t=pt.sum(this.startScrollXY_,t),this.horizontalScrollEnabled_&&this.verticalScrollEnabled_)this.workspace.scroll(t.x,t.y);else if(this.horizontalScrollEnabled_)this.workspace.scroll(t.x,this.workspace.scrollY);else if(this.verticalScrollEnabled_)this.workspace.scroll(this.workspace.scrollX,t.y);else throw new TypeError("Invalid state.")}},lR=5,cR=6,Mo=class{constructor(t,i){this.creatorWorkspace=i,this.mouseDownXY=new pt(0,0),this.startWorkspace_=this.targetBlock=this.startBlock=this.startIcon=this.startField=this.startBubble=null,this.hasExceededDragRadius=!1,this.boundEvents=[],this.flyout=this.workspaceDragger=this.blockDragger=this.bubbleDragger=null,this.isMultiTouch_=this.isEnding_=this.gestureHasStarted=this.calledUpdateIsDragging=!1,this.cachedPoints=new Map,this.startDistance=this.previousScale=0,this.currentDropdownOwner=this.isPinchZoomEnabled=null,this.mostRecentEvent=t,this.currentDragDeltaXY=new pt(0,0),this.healStack=!uI}dispose(){Ee(),og(),this.creatorWorkspace.clearGesture();for(const t of this.boundEvents)N(t);this.boundEvents.length=0,this.blockDragger&&this.blockDragger.dispose(),this.workspaceDragger&&this.workspaceDragger.dispose()}updateFromEvent(t){const i=new pt(t.clientX,t.clientY);this.updateDragDelta(i)&&(this.updateIsDragging(),xe()),this.mostRecentEvent=t}updateDragDelta(t){return this.currentDragDeltaXY=pt.difference(t,this.mouseDownXY),this.hasExceededDragRadius?!1:this.hasExceededDragRadius=pt.magnitude(this.currentDragDeltaXY)>(this.flyout?s.config$$module$build$src$core$config.flyoutDragRadius:s.config$$module$build$src$core$config.dragRadius)}updateIsDraggingFromFlyout(){let t;if(!this.targetBlock||(t=this.flyout)==null||!t.isBlockCreatable(this.targetBlock))return!1;if(!this.flyout.targetWorkspace)throw Error(`Cannot update dragging from the flyout because the ' +
          'flyout's target workspace is undefined`);return!this.flyout.isScrollable()||this.flyout.isDragTowardWorkspace(this.currentDragDeltaXY)?(this.startWorkspace_=this.flyout.targetWorkspace,this.startWorkspace_.updateScreenCalculationsIfScrolled(),s.getGroup$$module$build$src$core$events$utils()||s.setGroup$$module$build$src$core$events$utils(!0),this.startBlock=null,this.targetBlock=this.flyout.createBlock(this.targetBlock),this.targetBlock.select(),!0):!1}updateIsDraggingBubble(){return this.startBubble?(this.startDraggingBubble(),!0):!1}updateIsDraggingBlock(){if(!this.targetBlock)return!1;if(this.flyout){if(this.updateIsDraggingFromFlyout())return this.startDraggingBlock(),!0}else if(this.targetBlock.isMovable())return this.startDraggingBlock(),!0;return!1}updateIsDraggingWorkspace(){if(!this.startWorkspace_)throw Error("Cannot update dragging the workspace because the start workspace is undefined");(this.flyout?this.flyout.isScrollable():this.startWorkspace_&&this.startWorkspace_.isDraggable())&&(this.workspaceDragger=new mI(this.startWorkspace_),this.workspaceDragger.startDrag())}updateIsDragging(){if(this.calledUpdateIsDragging)throw Error("updateIsDragging_ should only be called once per gesture.");this.calledUpdateIsDragging=!0,this.updateIsDraggingBubble()||this.updateIsDraggingBlock()||this.updateIsDraggingWorkspace()}startDraggingBlock(){this.blockDragger=new(T(rt.BLOCK_DRAGGER,this.creatorWorkspace.options,!0))(this.targetBlock,this.startWorkspace_),this.blockDragger.startDrag(this.currentDragDeltaXY,this.healStack),this.blockDragger.drag(this.mostRecentEvent,this.currentDragDeltaXY)}startDraggingBubble(){if(!this.startBubble)throw Error("Cannot update dragging the bubble because the start bubble is undefined");if(!this.startWorkspace_)throw Error("Cannot update dragging the bubble because the start workspace is undefined");this.bubbleDragger=new aI(this.startBubble,this.startWorkspace_),this.bubbleDragger.startBubbleDrag(),this.bubbleDragger.dragBubble(this.mostRecentEvent,this.currentDragDeltaXY)}doStart(t){if(!this.startWorkspace_)throw Error("Cannot start the touch gesture becauase the start workspace is undefined");this.isPinchZoomEnabled=this.startWorkspace_.options.zoomOptions&&this.startWorkspace_.options.zoomOptions.pinch,G(t)?this.cancel():(this.gestureHasStarted=!0,nl(),this.startWorkspace_.updateScreenCalculationsIfScrolled(),this.startWorkspace_.isMutator&&this.startWorkspace_.resize(),this.currentDropdownOwner=xf(),this.startWorkspace_.hideChaff(!!this.flyout),this.startWorkspace_.markFocused(),this.mostRecentEvent=t,sg(),this.targetBlock&&this.targetBlock.select(),q(t)?this.handleRightClick(t):(t.type.toLowerCase()==="pointerdown"&&t.pointerType!=="mouse"&&_e(t,this),this.mouseDownXY=new pt(t.clientX,t.clientY),this.healStack=t.altKey||t.ctrlKey||t.metaKey,this.bindMouseEvents(t),this.isEnding_||this.handleTouchStart(t)))}bindMouseEvents(t){this.boundEvents.push(yt(document,"pointerdown",null,this.handleStart.bind(this),!0)),this.boundEvents.push(yt(document,"pointermove",null,this.handleMove.bind(this),!0)),this.boundEvents.push(yt(document,"pointerup",null,this.handleUp.bind(this),!0)),t.preventDefault(),t.stopPropagation()}handleStart(t){this.isDragging()||(this.handleTouchStart(t),this.isMultiTouch()&&xe())}handleMove(t){this.isDragging()&&ai(t)||!this.isMultiTouch()?(this.updateFromEvent(t),this.workspaceDragger?this.workspaceDragger.drag(this.currentDragDeltaXY):this.blockDragger?this.blockDragger.drag(this.mostRecentEvent,this.currentDragDeltaXY):this.bubbleDragger&&this.bubbleDragger.dragBubble(this.mostRecentEvent,this.currentDragDeltaXY),t.preventDefault(),t.stopPropagation()):this.isMultiTouch()&&(this.handleTouchMove(t),xe())}handleUp(t){if(this.isDragging()||this.handleTouchEnd(t),!this.isMultiTouch()||this.isDragging()){if(!ai(t))return;if(this.updateFromEvent(t),xe(),this.isEnding_){console.log("Trying to end a gesture recursively.");return}this.isEnding_=!0,this.bubbleDragger?this.bubbleDragger.endBubbleDrag(t,this.currentDragDeltaXY):this.blockDragger?this.blockDragger.endDrag(t,this.currentDragDeltaXY):this.workspaceDragger?this.workspaceDragger.endDrag(this.currentDragDeltaXY):this.isBubbleClick()?this.doBubbleClick():this.isFieldClick()?this.doFieldClick():this.isIconClick()?this.doIconClick():this.isBlockClick()?this.doBlockClick():this.isWorkspaceClick()&&this.doWorkspaceClick(t)}t.preventDefault(),t.stopPropagation(),this.dispose()}handleTouchStart(t){var i=Ke(t);this.cachedPoints.set(i,this.getTouchPoint(t));var r=Array.from(this.cachedPoints.keys());r.length===2&&(i=this.cachedPoints.get(r[0]),r=this.cachedPoints.get(r[1]),this.startDistance=pt.distance(i,r),this.isMultiTouch_=!0,t.preventDefault())}handleTouchMove(t){const i=Ke(t);this.cachedPoints.set(i,this.getTouchPoint(t)),this.isPinchZoomEnabled&&this.cachedPoints.size===2?this.handlePinch(t):this.handleMove(t)}handlePinch(t){var i=Array.from(this.cachedPoints.keys()),r=this.cachedPoints.get(i[0]);if(i=this.cachedPoints.get(i[1]),r=pt.distance(r,i)/this.startDistance,0<this.previousScale&&1/0>this.previousScale){if(i=r-this.previousScale,i=0<i?i*lR:i*cR,!this.startWorkspace_)throw Error("Cannot handle a pinch because the start workspace is undefined");const c=this.startWorkspace_,u=Z(t,c.getParentSvg(),c.getInverseScreenCTM());c.zoom(u.x,u.y,i)}this.previousScale=r,t.preventDefault()}handleTouchEnd(t){t=Ke(t),this.cachedPoints.has(t)&&this.cachedPoints.delete(t),2>this.cachedPoints.size&&(this.cachedPoints.clear(),this.previousScale=0)}getTouchPoint(t){return this.startWorkspace_?new pt(t.pageX,t.pageY):null}isMultiTouch(){return this.isMultiTouch_}cancel(){this.isEnding_||(xe(),this.bubbleDragger?this.bubbleDragger.endBubbleDrag(this.mostRecentEvent,this.currentDragDeltaXY):this.blockDragger?this.blockDragger.endDrag(this.mostRecentEvent,this.currentDragDeltaXY):this.workspaceDragger&&this.workspaceDragger.endDrag(this.currentDragDeltaXY),this.dispose())}handleRightClick(t){this.targetBlock?(this.bringBlockToFront(),this.targetBlock.workspace.hideChaff(!!this.flyout),this.targetBlock.showContextMenu(t)):this.startBubble?this.startBubble.showContextMenu(t):this.startWorkspace_&&!this.flyout&&(this.startWorkspace_.hideChaff(),this.startWorkspace_.showContextMenu(t)),t.preventDefault(),t.stopPropagation(),this.dispose()}handleWsStart(t,i){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleWsStart, but the gesture had already been started.");this.setStartWorkspace(i),this.mostRecentEvent=t,this.doStart(t)}fireWorkspaceClick(t){it(new(ut(Oo))(null,t.id,"workspace"))}handleFlyoutStart(t,i){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleFlyoutStart, but the gesture had already been started.");this.setStartFlyout(i),this.handleWsStart(t,i.getWorkspace())}handleBlockStart(t,i){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleBlockStart, but the gesture had already been started.");this.setStartBlock(i),this.mostRecentEvent=t}handleBubbleStart(t,i){if(this.gestureHasStarted)throw Error("Tried to call gesture.handleBubbleStart, but the gesture had already been started.");this.setStartBubble(i),this.mostRecentEvent=t}doBubbleClick(){this.startBubble instanceof oi&&(this.startBubble.setFocus(),this.startBubble.select())}doFieldClick(){if(!this.startField)throw Error("Cannot do a field click because the start field is undefined");this.currentDropdownOwner!==this.startField&&this.startField.showEditor(this.mostRecentEvent),this.bringBlockToFront()}doIconClick(){if(!this.startIcon)throw Error("Cannot do an icon click because the start icon is undefined");this.bringBlockToFront(),this.startIcon.onClick()}doBlockClick(){if(this.flyout&&this.flyout.autoClose){if(!this.targetBlock)throw Error("Cannot do a block click because the target block is undefined");this.targetBlock.isEnabled()&&(s.getGroup$$module$build$src$core$events$utils()||s.setGroup$$module$build$src$core$events$utils(!0),this.flyout.createBlock(this.targetBlock).scheduleSnapAndBump())}else{if(!this.startWorkspace_)throw Error("Cannot do a block click because the start workspace is undefined");const t=new(ut(Oo))(this.startBlock,this.startWorkspace_.id,"block");it(t)}this.bringBlockToFront(),s.setGroup$$module$build$src$core$events$utils(!1)}doWorkspaceClick(t){t=this.creatorWorkspace,z()&&z().unselect(),this.fireWorkspaceClick(this.startWorkspace_||t)}bringBlockToFront(){this.targetBlock&&!this.flyout&&this.targetBlock.bringToFront()}setStartField(t){if(this.gestureHasStarted)throw Error("Tried to call gesture.setStartField, but the gesture had already been started.");this.startField||(this.startField=t)}setStartIcon(t){if(this.gestureHasStarted)throw Error("Tried to call gesture.setStartIcon, but the gesture had already been started.");this.startIcon||(this.startIcon=t)}setStartBubble(t){this.startBubble||(this.startBubble=t)}setStartBlock(t){this.startBlock||this.startBubble||(this.startBlock=t,t.isInFlyout&&t!==t.getRootBlock()?this.setTargetBlock(t.getRootBlock()):this.setTargetBlock(t))}setTargetBlock(t){t.isShadow()?this.setTargetBlock(t.getParent()):this.targetBlock=t}setStartWorkspace(t){this.startWorkspace_||(this.startWorkspace_=t)}setStartFlyout(t){this.flyout||(this.flyout=t)}isBubbleClick(){return!!this.startBubble&&!this.hasExceededDragRadius}isBlockClick(){return!!this.startBlock&&!this.hasExceededDragRadius&&!this.isFieldClick()&&!this.isIconClick()}isFieldClick(){return this.startField?this.startField.isClickable()&&!this.hasExceededDragRadius&&(!this.flyout||this.startField.isClickableInFlyout(this.flyout.autoClose)):!1}isIconClick(){if(!this.startIcon)return!1;const t=!this.flyout||!this.startIcon.isClickableInFlyout||this.startIcon.isClickableInFlyout(this.flyout.autoClose);return!this.hasExceededDragRadius&&t}isWorkspaceClick(){return!this.startBlock&&!this.startBubble&&!this.startField&&!this.hasExceededDragRadius}isDragging(){return!!this.workspaceDragger||!!this.blockDragger||!!this.bubbleDragger}hasStarted(){return this.gestureHasStarted}getInsertionMarkers(){return this.blockDragger?this.blockDragger.getInsertionMarkers():[]}getCurrentDragger(){let t,i;return(i=(t=this.blockDragger)!=null?t:this.workspaceDragger)!=null?i:this.bubbleDragger}static inProgress(){const t=y();for(let i=0,r;r=t[i];i++)if(r.currentGesture_)return!0;return!1}},Km=class{constructor(t,i){this.pattern=t;let r;this.spacing=(r=i.spacing)!=null?r:0;let c;this.length=(c=i.length)!=null?c:1,this.line2=(this.line1=t.firstChild)&&this.line1.nextSibling;let u;this.snapToGrid=(u=i.snap)!=null?u:!1}shouldSnap(){return this.snapToGrid}getSpacing(){return this.spacing}getPatternId(){return this.pattern.id}update(t){var i=this.spacing*t;this.pattern.setAttribute("width",`${i}`),this.pattern.setAttribute("height",`${i}`),i=Math.floor(this.spacing/2)+.5;let r=i-this.length/2,c=i+this.length/2;i*=t,r*=t,c*=t,this.setLineAttributes(this.line1,t,r,c,i,i),this.setLineAttributes(this.line2,t,i,i,r,c)}setLineAttributes(t,i,r,c,u,f){t&&(t.setAttribute("stroke-width",`${i}`),t.setAttribute("x1",`${r}`),t.setAttribute("y1",`${u}`),t.setAttribute("x2",`${c}`),t.setAttribute("y2",`${f}`))}moveTo(t,i){this.pattern.setAttribute("x",`${t}`),this.pattern.setAttribute("y",`${i}`)}static createDom(t,i,r){t=R(D.PATTERN,{id:"blocklyGridPattern"+t,patternUnits:"userSpaceOnUse"},r);let c,u;if(0<((c=i.length)!=null?c:1)&&0<((u=i.spacing)!=null?u:0)){R(D.LINE,{stroke:i.colour},t);let f;(f=i.length)!=null&&f&&R(D.LINE,{stroke:i.colour},t)}else R(D.LINE,{},t);return t}},aa=class{constructor(t){this.workspace=t,this.cursorSvg_=this.cursor_=null,this.markers=new Map,this.markerSvg_=null}registerMarker(t,i){this.markers.has(t)&&this.unregisterMarker(t),i.setDrawer(this.workspace.getRenderer().makeMarkerDrawer(this.workspace,i)),this.setMarkerSvg(i.getDrawer().createDom()),this.markers.set(t,i)}unregisterMarker(t){const i=this.markers.get(t);if(i)i.dispose(),this.markers.delete(t);else throw Error("Marker with ID "+t+" does not exist. Can only unregister markers that exist.")}getCursor(){return this.cursor_}getMarker(t){return this.markers.get(t)||null}setCursor(t){this.cursor_&&this.cursor_.getDrawer()&&this.cursor_.getDrawer().dispose(),(this.cursor_=t)&&(t=this.workspace.getRenderer().makeMarkerDrawer(this.workspace,this.cursor_),this.cursor_.setDrawer(t),this.setCursorSvg(this.cursor_.getDrawer().createDom()))}setCursorSvg(t){t?(this.workspace.getBlockCanvas().appendChild(t),this.cursorSvg_=t):this.cursorSvg_=null}setMarkerSvg(t){t?this.workspace.getBlockCanvas()&&(this.cursorSvg_?this.workspace.getBlockCanvas().insertBefore(t,this.cursorSvg_):this.workspace.getBlockCanvas().appendChild(t)):this.markerSvg_=null}updateMarkers(){this.workspace.keyboardAccessibilityMode&&this.cursorSvg_&&this.workspace.getCursor().draw()}dispose(){const t=Object.keys(this.markers);for(let i=0,r;r=t[i];i++)this.unregisterMarker(r);this.markers.clear(),this.cursor_&&(this.cursor_.dispose(),this.cursor_=null)}};aa.LOCAL_MARKER="local_marker_1";var $I={};$I.deepMerge=So;var Er=class{constructor(t,i,r,c){this.name=t,this.startHats=!1,this.blockStyles=i||Object.create(null),this.categoryStyles=r||Object.create(null),this.componentStyles=c||Object.create(null),this.fontStyle=Object.create(null),o(rt.THEME,t,this,!0)}getClassName(){return this.name+"-theme"}setBlockStyle(t,i){this.blockStyles[t]=i}setCategoryStyle(t,i){this.categoryStyles[t]=i}getComponentStyle(t){if(t=this.componentStyles[t],!t)return null;if(typeof t=="string"){const i=this.getComponentStyle(t);if(i)return i}return`${t}`}setComponentStyle(t,i){this.componentStyles[t]=i}setFontStyle(t){this.fontStyle=t}setStartHats(t){this.startHats=t}static defineTheme(t,i){t=t.toLowerCase();const r=new Er(t);let c=i.base;if(c){if(typeof c=="string"){let u;c=(u=g(rt.THEME,c))!=null?u:void 0}c instanceof Er&&(So(r,c),r.name=t)}return So(r.blockStyles,i.blockStyles),So(r.categoryStyles,i.categoryStyles),So(r.componentStyles,i.componentStyles),So(r.fontStyle,i.fontStyle),i.startHats!==null&&(r.startHats=i.startHats),r}},aR={colour_blocks:{colourPrimary:"20"},list_blocks:{colourPrimary:"260"},logic_blocks:{colourPrimary:"210"},loop_blocks:{colourPrimary:"120"},math_blocks:{colourPrimary:"230"},procedure_blocks:{colourPrimary:"290"},text_blocks:{colourPrimary:"160"},variable_blocks:{colourPrimary:"330"},variable_dynamic_blocks:{colourPrimary:"310"},hat_blocks:{colourPrimary:"330",hat:"cap"}},hR={colour_category:{colour:"20"},list_category:{colour:"260"},logic_category:{colour:"210"},loop_category:{colour:"120"},math_category:{colour:"230"},procedure_category:{colour:"290"},text_category:{colour:"160"},variable_category:{colour:"330"},variable_dynamic_category:{colour:"310"}},qu=new Er("classic",aR,hR),hs=class{constructor(t){this.gridPattern=null,this.getMetrics=this.setMetrics=void 0;let i=null,r=!1;var c=!1,u=!1,f=!1,E=!1,S=!1;const W=!!t.readOnly;if(!W){var bt;i=yo((bt=t.toolbox)!=null?bt:null),r=Vh(i),c=t.trashcan,c=c===void 0?r:c,u=t.collapse,u=u===void 0?r:u,f=t.comments,f=f===void 0?r:f,E=t.disable,E=E===void 0?r:E,S=t.sounds,S=S===void 0?!0:S}bt=t.maxTrashcanContents,c?bt===void 0&&(bt=32):bt=0;const ke=!!t.rtl;let Ie=t.horizontalLayout;Ie===void 0&&(Ie=!1);var Bi=t.toolboxPosition!=="end";Bi=Ie?Bi?Wt.TOP:Wt.BOTTOM:Bi===ke?Wt.RIGHT:Wt.LEFT;let zl=t.css;zl===void 0&&(zl=!0);let Xl="https://blockly-demo.appspot.com/static/media/";t.media?Xl=t.media.endsWith("/")?t.media:t.media+"/":"path"in t&&(j("path","Nov 2014","Jul 2023","media"),Xl=t.path+"media/");const IS=t.oneBasedIndex,YR=t.renderer||"geras",KR=t.plugins||{};let P$=t.modalInputs;P$===void 0&&(P$=!0),this.RTL=ke,this.oneBasedIndex=IS===void 0?!0:IS,this.collapse=u,this.comments=f,this.disable=E,this.readOnly=W,this.maxBlocks=t.maxBlocks||1/0;let SS;this.maxInstances=(SS=t.maxInstances)!=null?SS:null,this.modalInputs=P$,this.pathToMedia=Xl,this.hasCategories=r,this.moveOptions=hs.parseMoveOptions_(t,r),this.hasScrollbars=!!this.moveOptions.scrollbars,this.hasTrashcan=c,this.maxTrashcanContents=bt,this.hasSounds=S,this.hasCss=zl,this.horizontalLayout=Ie,this.languageTree=i,this.gridOptions=hs.parseGridOptions_(t),this.zoomOptions=hs.parseZoomOptions_(t),this.toolboxPosition=Bi,this.theme=hs.parseThemeOptions_(t),this.renderer=YR;let CS;this.rendererOverrides=(CS=t.rendererOverrides)!=null?CS:null;let wS;this.parentWorkspace=(wS=t.parentWorkspace)!=null?wS:null,this.plugins=KR}static parseMoveOptions_(t,i){const r=t.move||{},c={};return r.scrollbars===void 0&&t.scrollbars===void 0?c.scrollbars=i:typeof r.scrollbars=="object"?(c.scrollbars={horizontal:!!r.scrollbars.horizontal,vertical:!!r.scrollbars.vertical},c.scrollbars.horizontal&&c.scrollbars.vertical?c.scrollbars=!0:c.scrollbars.horizontal||c.scrollbars.vertical||(c.scrollbars=!1)):c.scrollbars=!!r.scrollbars||!!t.scrollbars,c.wheel=c.scrollbars&&r.wheel!==void 0?!!r.wheel:typeof c.scrollbars=="object",c.drag=c.scrollbars?r.drag===void 0?!0:!!r.drag:!1,c}static parseZoomOptions_(t){t=t.zoom||{};const i={};return i.controls=t.controls===void 0?!1:!!t.controls,i.wheel=t.wheel===void 0?!1:!!t.wheel,i.startScale=t.startScale===void 0?1:Number(t.startScale),i.maxScale=t.maxScale===void 0?3:Number(t.maxScale),i.minScale=t.minScale===void 0?.3:Number(t.minScale),i.scaleSpeed=t.scaleSpeed===void 0?1.2:Number(t.scaleSpeed),i.pinch=t.pinch===void 0?i.wheel||i.controls:!!t.pinch,i}static parseGridOptions_(t){t=t.grid||{};const i={};return i.spacing=Number(t.spacing)||0,i.colour=t.colour||"#888",i.length=t.length===void 0?1:Number(t.length),i.snap=0<i.spacing&&!!t.snap,i}static parseThemeOptions_(t){return t=t.theme||qu,typeof t=="string"?g(rt.THEME,t):t instanceof Er?t:Er.defineTheme(t.name||"builtin"+ot(),t)}},vr=class extends fr{constructor(t,i,r,c,u){super(t),this.type=s.CHANGE$$module$build$src$core$events$utils,t&&(this.element=i,this.name=r||void 0,this.oldValue=c,this.newValue=u)}toJson(){const t=super.toJson();if(!this.element)throw Error("The changed element is undefined. Either pass an element to the constructor, or call fromJson");return t.element=this.element,t.name=this.name,t.oldValue=this.oldValue,t.newValue=this.newValue,t}static fromJson(t,i,r){return i=super.fromJson(t,i,r??new vr),i.element=t.element,i.name=t.name,i.oldValue=t.oldValue,i.newValue=t.newValue,i}isNull(){return this.oldValue===this.newValue}run(t){var i=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");if(i=i.getBlockById(this.blockId),!i)throw Error("The associated block is undefined. Either pass a block to the constructor, or call fromJson");var r=i.getIcon(xi.MUTATOR);switch(r&&ln(r)&&r.bubbleIsVisible()&&r.setBubbleVisible(!1),t=t?this.newValue:this.oldValue,this.element){case"field":(i=i.getField(this.name))?i.setValue(t):console.warn("Can't set non-existent field: "+this.name);break;case"comment":i.setCommentText(t||null);break;case"collapsed":i.setCollapsed(!!t);break;case"disabled":i.setEnabled(!t);break;case"inline":i.setInputsInline(!!t);break;case"mutation":r=vr.getExtraBlockState_(i),i.loadExtraState?i.loadExtraState(JSON.parse(t||"{}")):i.domToMutation&&i.domToMutation(s.textToDom$$module$build$src$core$utils$xml(t||"<mutation/>")),it(new vr(i,"mutation",null,r,t));break;default:console.warn("Unknown change type: "+this.element)}}static getExtraBlockState_(t){return t.saveExtraState?(t=t.saveExtraState(!0))?JSON.stringify(t):"":t.mutationToDom&&(t=t.mutationToDom())?Fs(t):""}};o(rt.EVENT,s.CHANGE$$module$build$src$core$events$utils,vr);var jm=.45,Jm=.65,_I={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00"},us={};us.blend=ir,us.getHsvSaturation=du,us.getHsvValue=pu,us.hexToRgb=fu,us.hsvToHex=gu,us.hueToHex=lg,us.names=_I,us.parse=cn,us.rgbToHex=Wc,us.setHsvSaturation=ng,us.setHsvValue=rg;var ha={};ha.checkMessageReferences=Dv,ha.parseBlockColour=cl,ha.replaceMessageReferences=Fe,ha.tokenizeInterpolation=cg;var qt=class{constructor(t,i,r){this.DEFAULT_VALUE=null,this.name=void 0,this.constants_=this.mouseDownWrapper_=this.textContent_=this.textElement_=this.borderRect_=this.fieldGroup_=this.markerSvg_=this.cursorSvg_=this.tooltip_=this.validator_=null,this.disposed=!1,this.maxDisplayLength=50,this.sourceBlock_=null,this.enabled_=this.visible_=this.isDirty_=!0,this.suffixField=this.prefixField=this.clickTarget_=null,this.EDITABLE=!0,this.SERIALIZABLE=!1,this.CURSOR="",this.value_="DEFAULT_VALUE"in new.target.prototype?new.target.prototype.DEFAULT_VALUE:this.DEFAULT_VALUE,this.size_=new Ce(0,0),t!==qt.SKIP_SETUP&&(r&&this.configure_(r),this.setValue(t),i&&this.setValidator(i))}configure_(t){t.tooltip&&this.setTooltip(Fe(t.tooltip))}setSourceBlock(t){if(this.sourceBlock_)throw Error("Field already bound to a block");this.sourceBlock_=t}getConstants(){return!this.constants_&&this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()&&this.sourceBlock_.workspace.rendered&&(this.constants_=this.sourceBlock_.workspace.getRenderer().getConstants()),this.constants_}getSourceBlock(){return this.sourceBlock_}init(){this.fieldGroup_||(this.fieldGroup_=R(D.G,{}),this.isVisible()||(this.fieldGroup_.style.display="none"),this.sourceBlock_.getSvgRoot().appendChild(this.fieldGroup_),this.initView(),this.updateEditable(),this.setTooltip(this.tooltip_),this.bindEvents_(),this.initModel())}initView(){this.createBorderRect_(),this.createTextElement_()}initModel(){}isFullBlockField(){return!this.borderRect_}createBorderRect_(){this.borderRect_=R(D.RECT,{rx:this.getConstants().FIELD_BORDER_RECT_RADIUS,ry:this.getConstants().FIELD_BORDER_RECT_RADIUS,x:0,y:0,height:this.size_.height,width:this.size_.width,class:"blocklyFieldRect"},this.fieldGroup_)}createTextElement_(){this.textElement_=R(D.TEXT,{class:"blocklyText"},this.fieldGroup_),this.getConstants().FIELD_TEXT_BASELINE_CENTER&&this.textElement_.setAttribute("dominant-baseline","central"),this.textContent_=document.createTextNode(""),this.textElement_.appendChild(this.textContent_)}bindEvents_(){const t=this.getClickTarget_();if(!t)throw Error("A click target has not been set.");ll(t),this.mouseDownWrapper_=yt(t,"pointerdown",this,this.onMouseDown_)}fromXml(t){this.setValue(t.textContent)}toXml(t){return t.textContent=this.getValue(),t}saveState(t){return t=this.saveLegacyState(qt),t!==null?t:this.getValue()}loadState(t){this.loadLegacyState(qt,t)||this.setValue(t)}saveLegacyState(t){return t.prototype.saveState===this.saveState&&t.prototype.toXml!==this.toXml?(t=s.createElement$$module$build$src$core$utils$xml("field"),t.setAttribute("name",this.name||""),Ut(this.toXml(t)).replace(' xmlns="https://developers.google.com/blockly/xml"',"")):null}loadLegacyState(t,i){return t.prototype.loadState===this.loadState&&t.prototype.fromXml!==this.fromXml?(this.fromXml(s.textToDom$$module$build$src$core$utils$xml(i)),!0):!1}dispose(){ol(this),ru(this);let t;(t=this.getSourceBlock())!=null&&t.isDeadOrDying()||Ct(this.fieldGroup_),this.disposed=!0}updateEditable(){const t=this.fieldGroup_,i=this.getSourceBlock();this.EDITABLE&&t&&i&&(this.enabled_&&i.isEditable()?(J(t,"blocklyEditableText"),mt(t,"blocklyNonEditableText"),t.style.cursor=this.CURSOR):(J(t,"blocklyNonEditableText"),mt(t,"blocklyEditableText"),t.style.cursor=""))}setEnabled(t){this.enabled_=t,this.updateEditable()}isEnabled(){return this.enabled_}isClickable(){return this.enabled_&&!!this.sourceBlock_&&this.sourceBlock_.isEditable()&&this.showEditor_!==qt.prototype.showEditor_}isClickableInFlyout(t){return!t}isCurrentlyEditable(){return this.enabled_&&this.EDITABLE&&!!this.sourceBlock_&&this.sourceBlock_.isEditable()}isSerializable(){let t=!1;return this.name&&(this.SERIALIZABLE?t=!0:this.EDITABLE&&(console.warn("Detected an editable field that was not serializable. Please define SERIALIZABLE property as true on all editable custom fields. Proceeding with serialization."),t=!0)),t}isVisible(){return this.visible_}setVisible(t){if(this.visible_!==t){this.visible_=t;var i=this.fieldGroup_;i&&(i.style.display=t?"block":"none")}}setValidator(t){this.validator_=t}getValidator(){return this.validator_}getSvgRoot(){return this.fieldGroup_}getBorderRect(){if(!this.borderRect_)throw Error(`The border rectangle is ${this.borderRect_}.`);return this.borderRect_}getTextElement(){if(!this.textElement_)throw Error(`The text element is ${this.textElement_}.`);return this.textElement_}getTextContent(){if(!this.textContent_)throw Error(`The text content is ${this.textContent_}.`);return this.textContent_}applyColour(){}render_(){this.textContent_&&(this.textContent_.nodeValue=this.getDisplayText_()),this.updateSize_()}showEditor(t){this.isClickable()&&this.showEditor_(t)}showEditor_(t){}repositionForWindowResize(){return!1}updateSize_(t){const i=this.getConstants();t=t!==void 0?t:this.isFullBlockField()?0:this.getConstants().FIELD_BORDER_RECT_X_PADDING;let r=2*t,c=i.FIELD_TEXT_HEIGHT,u=0;this.textElement_&&(u=nt(this.textElement_,i.FIELD_TEXT_FONTSIZE,i.FIELD_TEXT_FONTWEIGHT,i.FIELD_TEXT_FONTFAMILY),r+=u),this.isFullBlockField()||(c=Math.max(c,i.FIELD_BORDER_RECT_HEIGHT)),this.size_.height=c,this.size_.width=r,this.positionTextElement_(t,u),this.positionBorderRect_()}positionTextElement_(t,i){if(this.textElement_){var r=this.getConstants(),c=this.size_.height/2,u;this.textElement_.setAttribute("x",String((u=this.getSourceBlock())!=null&&u.RTL?this.size_.width-i-t:t)),this.textElement_.setAttribute("y",String(r.FIELD_TEXT_BASELINE_CENTER?c:c-r.FIELD_TEXT_HEIGHT/2+r.FIELD_TEXT_BASELINE))}}positionBorderRect_(){this.borderRect_&&(this.borderRect_.setAttribute("width",String(this.size_.width)),this.borderRect_.setAttribute("height",String(this.size_.height)),this.borderRect_.setAttribute("rx",String(this.getConstants().FIELD_BORDER_RECT_RADIUS)),this.borderRect_.setAttribute("ry",String(this.getConstants().FIELD_BORDER_RECT_RADIUS)))}getSize(){return this.isVisible()?(this.isDirty_?(this.render_(),this.isDirty_=!1):this.visible_&&this.size_.width===0&&(this.render_(),this.size_.width!==0&&console.warn("Deprecated use of setting size_.width to 0 to rerender a field. Set field.isDirty_ to true instead.")),this.size_):new Ce(0,0)}getScaledBBox(){let t;var i=this.getSourceBlock();if(!i)throw new ye;if(this.isFullBlockField()){var r=this.sourceBlock_.getHeightWidth();const c=i.workspace.scale;t=this.getAbsoluteXY_(),i=(r.width+1)*c,r=(r.height+1)*c,lm?(t.x+=1.5*c,t.y+=1.5*c):(t.x-=.5*c,t.y-=.5*c)}else r=this.borderRect_.getBoundingClientRect(),t=Se(this.borderRect_),i=r.width,r=r.height;return new ve(t.y,t.y+r,t.x,t.x+i)}onLocationChange(t){}getDisplayText_(){let t=this.getText();return t?(t.length>this.maxDisplayLength&&(t=t.substring(0,this.maxDisplayLength-2)+""),t=t.replace(/\s/g,qt.NBSP),this.sourceBlock_&&this.sourceBlock_.RTL&&(t+=""),t):qt.NBSP}getText(){const t=this.getText_();return String(t!==null?t:this.getValue())}getText_(){return null}markDirty(){this.isDirty_=!0,this.constants_=null}forceRerender(){this.isDirty_=!0,this.sourceBlock_&&this.sourceBlock_.rendered&&(this.sourceBlock_.queueRender(),this.sourceBlock_.bumpNeighbours())}setValue(t,i=!0){if(t!==null){var r=this.doClassValidation_(t);if(t=this.processValidation_(t,r),!(t instanceof Error)){var c;r=(c=this.getValidator())==null?void 0:c.call(this,t),c=this.processValidation_(t,r),c instanceof Error||(t=this.sourceBlock_,t&&t.disposed||(r=this.getValue(),r===c?this.doValueUpdate_(c):(this.doValueUpdate_(c),i&&t&&Lt()&&it(new(ut(s.CHANGE$$module$build$src$core$events$utils))(t,"field",this.name||null,r,c)),this.isDirty_&&this.forceRerender())))}}}processValidation_(t,i){return i===null?(this.doValueInvalid_(t),this.isDirty_&&this.forceRerender(),Error()):i===void 0?t:i}getValue(){return this.value_}doClassValidation_(t){return t??null}doValueUpdate_(t){this.value_=t,this.isDirty_=!0}doValueInvalid_(t){}onMouseDown_(t){this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()&&(t=this.sourceBlock_.workspace.getGesture(t))&&t.setStartField(this)}setTooltip(t){t||t===""||(t=this.sourceBlock_);const i=this.getClickTarget_();i?i.tooltip=t:this.tooltip_=t}getTooltip(){const t=this.getClickTarget_();return rl(t||{tooltip:this.tooltip_})}getClickTarget_(){return this.clickTarget_||this.getSvgRoot()}getAbsoluteXY_(){return Se(this.getClickTarget_())}referencesVariables(){return!1}refreshVariableName(){}getParentInput(){let t=null;const i=this.getSourceBlock();if(!i)throw new ye;const r=i.inputList;for(let c=0;c<i.inputList.length;c++){const u=r[c],f=u.fieldRow;for(let E=0;E<f.length;E++)if(f[E]===this){t=u;break}}return t}getFlipRtl(){return!1}isTabNavigable(){return!1}onShortcut(t){return!1}setCursorSvg(t){if(t){if(!this.fieldGroup_)throw Error(`The field group is ${this.fieldGroup_}.`);this.fieldGroup_.appendChild(t),this.cursorSvg_=t}else this.cursorSvg_=null}setMarkerSvg(t){if(t){if(!this.fieldGroup_)throw Error(`The field group is ${this.fieldGroup_}.`);this.fieldGroup_.appendChild(t),this.markerSvg_=t}else this.markerSvg_=null}updateMarkers_(){var t=this.getSourceBlock();if(!t)throw new ye;t=t.workspace,t.keyboardAccessibilityMode&&this.cursorSvg_&&t.getCursor().draw(),t.keyboardAccessibilityMode&&this.markerSvg_&&t.getMarker(aa.LOCAL_MARKER).draw()}};qt.NBSP="",qt.SKIP_SETUP=Symbol("SKIP_SETUP");var ye=class extends Error{constructor(){super("The field has not yet been attached to its input. Call appendField to attach it.")}};s.Names$$module$build$src$core$names=class{constructor(t,i){this.db=new Map,this.dbReverse=new Set,this.variableMap=null,this.variablePrefix=i||"",this.reservedWords=new Set(t?t.split(","):[])}reset(){this.db.clear(),this.dbReverse.clear(),this.variableMap=null}setVariableMap(t){this.variableMap=t}getNameForUserVariable(t){return this.variableMap?(t=this.variableMap.getVariableById(t))?t.name:null:(console.warn(`Deprecated call to Names.prototype.getName without defining a variable map. To fix, add the following code in your generator's init() function:
Blockly.YourGeneratorName.nameDB_.setVariableMap(workspace.getVariableMap());`),null)}populateVariables(t){t=s.allUsedVarModels$$module$build$src$core$variables(t);for(let i=0;i<t.length;i++)this.getName(t[i].getId(),s.NameType$$module$build$src$core$names.VARIABLE)}populateProcedures(t){throw Error("The implementation of populateProcedures should be monkey-patched in by blockly.ts")}getName(t,i){let r=t;i===s.NameType$$module$build$src$core$names.VARIABLE&&(t=this.getNameForUserVariable(t))&&(r=t),t=r.toLowerCase();const c=i===s.NameType$$module$build$src$core$names.VARIABLE||i===s.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE?this.variablePrefix:"";this.db.has(i)||this.db.set(i,new Map);const u=this.db.get(i);return u.has(t)?c+u.get(t):(i=this.getDistinctName(r,i),u.set(t,i.substr(c.length)),i)}getUserNames(t){let i;return(t=(i=this.db.get(t))==null?void 0:i.keys())?Array.from(t):[]}getDistinctName(t,i){t=this.safeName(t);let r=null,c,u;for(;this.dbReverse.has(t+((c=r)!=null?c:""))||this.reservedWords.has(t+((u=r)!=null?u:""));)r=r?r+1:2;let f;return t+=(f=r)!=null?f:"",this.dbReverse.add(t),(i===s.NameType$$module$build$src$core$names.VARIABLE||i===s.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE?this.variablePrefix:"")+t}safeName(t){return t?(t=encodeURI(t.replace(/ /g,"_")).replace(/[^\w]/g,"_"),"0123456789".indexOf(t[0])!==-1&&(t="my_"+t)):t=s.Msg$$module$build$src$core$msg.UNNAMED_KEY||"unnamed",t}static equals(t,i){return t.toLowerCase()===i.toLowerCase()}},function(t){t=t.NameType||(t.NameType={}),t.DEVELOPER_VARIABLE="DEVELOPER_VARIABLE",t.VARIABLE="VARIABLE",t.PROCEDURE="PROCEDURE"}(s.Names$$module$build$src$core$names||(s.Names$$module$build$src$core$names={})),s.NameType$$module$build$src$core$names=s.Names$$module$build$src$core$names.NameType,s.Names$$module$build$src$core$names.DEVELOPER_VARIABLE_TYPE=s.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE,s.NameType$$module$build$src$core$names,s.Names$$module$build$src$core$names;var TI=class extends Map{constructor(){super()}set(t,i){return this.get(t)===i?this:(super.set(t,i),$u(i)&&i.startPublishing(),this)}delete(t){const i=this.get(t);return t=super.delete(t),t&&($u(i)&&i.stopPublishing(),t)}clear(){if(this.size)for(const t of this.keys())this.delete(t)}add(t){return this.set(t.getId(),t)}getProcedures(){return[...this.values()]}},Zu=class{constructor(t){this.sourceBlock=t,this.offsetInBlock=new pt(0,0),this.workspaceLocation=new pt(0,0),this.svgRoot=null,this.tooltip=t}getType(){throw Error("Icons must implement getType")}initView(t){if(!this.svgRoot){var i=this.sourceBlock;this.svgRoot=R(D.G,{class:"blocklyIconGroup"}),i.getSvgRoot().appendChild(this.svgRoot),this.updateSvgRootOffset(),yt(this.svgRoot,"pointerdown",this,t),this.svgRoot.tooltip=this,ll(this.svgRoot)}}dispose(){uu(this.svgRoot),Ct(this.svgRoot)}getWeight(){return-1}getSize(){return new Ce(0,0)}setTooltip(t){this.tooltip=t??this.sourceBlock}getTooltip(){return this.tooltip}applyColour(){}updateEditable(){}updateCollapsed(){this.svgRoot&&(this.sourceBlock.isCollapsed()?this.svgRoot.style.display="none":this.svgRoot.style.display="block",ln(this)&&this.setBubbleVisible(!1))}hideForInsertionMarker(){this.svgRoot&&(this.svgRoot.style.display="none")}isShownWhenCollapsed(){return!1}setOffsetInBlock(t){this.offsetInBlock=t,this.updateSvgRootOffset()}updateSvgRootOffset(){let t;(t=this.svgRoot)==null||t.setAttribute("transform",`translate(${this.offsetInBlock.x}, ${this.offsetInBlock.y})`)}onLocationChange(t){this.workspaceLocation=pt.sum(t,this.offsetInBlock)}onClick(){}isClickableInFlyout(t){return!0}setVisible(t){j("setVisible","v10","v11","setBubbleVisible"),ln(this)&&this.setBubbleVisible(t)}},bI={fromJsonInternal:Bv},Qu={TEST_ONLY:bI};Qu.fromJson=s.fromJson$$module$build$src$core$field_registry,Qu.register=zi,Qu.unregister=Pv;var Js=class extends qt{constructor(t,i,r){super(qt.SKIP_SETUP),this.svgArrow=this.arrow=this.imageElement=this.menu_=this.selectedMenuItem=null,this.SERIALIZABLE=!0,this.CURSOR="default",this.clickTarget_=this.suffixField=this.prefixField=this.generatedOptions=null,t!==qt.SKIP_SETUP&&(Array.isArray(t)?(ag(t),t=Fv(t),this.menuGenerator_=t.options,this.prefixField=t.prefix||null,this.suffixField=t.suffix||null):this.menuGenerator_=t,this.selectedOption=this.getOptions(!1)[0],r&&this.configure_(r),this.setValue(this.selectedOption[1]),i&&this.setValidator(i))}fromXml(t){this.isOptionListDynamic()&&this.getOptions(!1),this.setValue(t.textContent)}loadState(t){this.loadLegacyState(Js,t)||(this.isOptionListDynamic()&&this.getOptions(!1),this.setValue(t))}initView(){this.shouldAddBorderRect_()?this.createBorderRect_():this.clickTarget_=this.sourceBlock_.getSvgRoot(),this.createTextElement_(),this.imageElement=R(D.IMAGE,{},this.fieldGroup_),this.getConstants().FIELD_DROPDOWN_SVG_ARROW?this.createSVGArrow_():this.createTextArrow_(),this.borderRect_&&J(this.borderRect_,"blocklyDropdownRect")}shouldAddBorderRect_(){let t;return!this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW||this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW&&!((t=this.getSourceBlock())!=null&&t.isShadow())}createTextArrow_(){this.arrow=R(D.TSPAN,{},this.textElement_);let t;this.arrow.appendChild(document.createTextNode((t=this.getSourceBlock())!=null&&t.RTL?Js.ARROW_CHAR+" ":" "+Js.ARROW_CHAR));let i;(i=this.getSourceBlock())!=null&&i.RTL?this.getTextElement().insertBefore(this.arrow,this.textContent_):this.getTextElement().appendChild(this.arrow)}createSVGArrow_(){this.svgArrow=R(D.IMAGE,{height:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px",width:this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE+"px"},this.fieldGroup_),this.svgArrow.setAttributeNS(Xi,"xlink:href",this.getConstants().FIELD_DROPDOWN_SVG_ARROW_DATAURI)}showEditor_(t){var i=this.getSourceBlock();if(!i)throw new ye;this.dropdownCreate(),this.menu_.openingCoords=t&&typeof t.clientX=="number"?new pt(t.clientX,t.clientY):null,lu(),t=this.menu_.render(sl()),J(t,"blocklyDropdownMenu"),this.getConstants().FIELD_DROPDOWN_COLOURED_DIV&&(i=i.getColour(),cu(i,this.sourceBlock_.style.colourTertiary)),Hc(this,this.dropdownDispose_.bind(this)),this.menu_.focus(),this.selectedMenuItem&&(this.menu_.setHighlighted(this.selectedMenuItem),Qn(this.selectedMenuItem.getElement(),sl(),!0)),this.applyColour()}dropdownCreate(){const t=this.getSourceBlock();if(!t)throw new ye;const i=new Nm;i.setRole(Pi.LISTBOX),this.menu_=i;const r=this.getOptions(!1);this.selectedMenuItem=null;for(let u=0;u<r.length;u++){const[f,E]=r[u];if(typeof f=="object"){var c=new Image(f.width,f.height);c.src=f.src,c.alt=f.alt||""}else c=f;c=new Lm(c,E),c.setRole(Pi.OPTION),c.setRightToLeft(t.RTL),c.setCheckable(!0),i.addChild(c),c.setChecked(E===this.value_),E===this.value_&&(this.selectedMenuItem=c),c.onAction(this.handleMenuActionEvent,this)}}dropdownDispose_(){this.menu_&&this.menu_.dispose(),this.selectedMenuItem=this.menu_=null,this.applyColour()}handleMenuActionEvent(t){ol(this,!0),this.onItemSelected_(this.menu_,t)}onItemSelected_(t,i){this.setValue(i.getValue())}isOptionListDynamic(){return typeof this.menuGenerator_=="function"}getOptions(t){if(!this.menuGenerator_)throw TypeError("A menu generator was never defined.");return Array.isArray(this.menuGenerator_)?this.menuGenerator_:t&&this.generatedOptions?this.generatedOptions:(this.generatedOptions=this.menuGenerator_(),ag(this.generatedOptions),this.generatedOptions)}doClassValidation_(t){return this.getOptions(!0).some(i=>i[1]===t)?t:(this.sourceBlock_&&console.warn("Cannot set the dropdown's value to an unavailable option. Block type: "+this.sourceBlock_.type+", Field name: "+this.name+", Value: "+t),null)}doValueUpdate_(t){super.doValueUpdate_(t),t=this.getOptions(!0);for(let i=0,r;r=t[i];i++)r[1]===this.value_&&(this.selectedOption=r)}applyColour(){const t=this.sourceBlock_.style;this.borderRect_&&(this.borderRect_.setAttribute("stroke",t.colourTertiary),this.menu_?this.borderRect_.setAttribute("fill",t.colourTertiary):this.borderRect_.setAttribute("fill","transparent")),this.sourceBlock_&&this.arrow&&(this.sourceBlock_.isShadow()?this.arrow.style.fill=t.colourSecondary:this.arrow.style.fill=t.colourPrimary)}render_(){this.getTextContent().nodeValue="",this.imageElement.style.display="none";const t=this.selectedOption&&this.selectedOption[0];t&&typeof t=="object"?this.renderSelectedImage(t):this.renderSelectedText(),this.positionBorderRect_()}renderSelectedImage(t){const i=this.getSourceBlock();if(!i)throw new ye;this.imageElement.style.display="",this.imageElement.setAttributeNS(Xi,"xlink:href",t.src),this.imageElement.setAttribute("height",String(t.height)),this.imageElement.setAttribute("width",String(t.width));const r=Number(t.height);t=Number(t.width);var c=!!this.borderRect_;const u=Math.max(c?this.getConstants().FIELD_DROPDOWN_BORDER_RECT_HEIGHT:0,r+dR);c=c?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0;let f;f=this.svgArrow?this.positionSVGArrow(t+c,u/2-this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE/2):nt(this.arrow,this.getConstants().FIELD_TEXT_FONTSIZE,this.getConstants().FIELD_TEXT_FONTWEIGHT,this.getConstants().FIELD_TEXT_FONTFAMILY),this.size_.width=t+f+2*c,this.size_.height=u;let E=0;i.RTL?this.imageElement.setAttribute("x",`${c+f}`):(E=t+f,this.getTextElement().setAttribute("text-anchor","end"),this.imageElement.setAttribute("x",`${c}`)),this.imageElement.setAttribute("y",String(u/2-r/2)),this.positionTextElement_(E+c,t+f)}renderSelectedText(){this.getTextContent().nodeValue=this.getDisplayText_();var t=this.getTextElement();J(t,"blocklyDropdownText"),t.setAttribute("text-anchor","start");var i=!!this.borderRect_;t=Math.max(i?this.getConstants().FIELD_DROPDOWN_BORDER_RECT_HEIGHT:0,this.getConstants().FIELD_TEXT_HEIGHT);const r=nt(this.getTextElement(),this.getConstants().FIELD_TEXT_FONTSIZE,this.getConstants().FIELD_TEXT_FONTWEIGHT,this.getConstants().FIELD_TEXT_FONTFAMILY);i=i?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0;let c=0;this.svgArrow&&(c=this.positionSVGArrow(r+i,t/2-this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE/2)),this.size_.width=r+c+2*i,this.size_.height=t,this.positionTextElement_(i,r)}positionSVGArrow(t,i){if(!this.svgArrow)return 0;const r=this.getSourceBlock();if(!r)throw new ye;const c=this.borderRect_?this.getConstants().FIELD_BORDER_RECT_X_PADDING:0,u=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_PADDING,f=this.getConstants().FIELD_DROPDOWN_SVG_ARROW_SIZE;return this.svgArrow.setAttribute("transform","translate("+(r.RTL?c:t+u)+","+i+")"),f+u}getText_(){if(!this.selectedOption)return null;const t=this.selectedOption[0];return typeof t=="object"?t.alt:t}static fromJson(t){if(!t.options)throw Error("options are required for the dropdown field. The options property must be assigned an array of [humanReadableValue, languageNeutralValue] tuples.");return new this(t.options,void 0,t)}};Js.CHECKMARK_OVERHANG=25,Js.MAX_MENU_HEIGHT_VH=.45,Js.ARROW_CHAR="";var uR=5,dR=2*uR;zi("field_dropdown",Js);var Ki,ce=class{constructor(t,i,r){this.workspace=t,this.anchor=i,this.ownerRect=r,this.size=new Ce(0,0),this.colour="#ffffff",this.disposed=!1,this.relativeLeft=this.relativeTop=0,this.svgRoot=R(D.G,{},t.getBubbleCanvas()),t=R(D.G,{filter:`url(#${this.workspace.getRenderer().getConstants().embossFilterId})`},this.svgRoot),this.tail=R(D.PATH,{},t),this.background=R(D.RECT,{class:"blocklyDraggable",x:0,y:0,rx:Ki.BORDER_WIDTH,ry:Ki.BORDER_WIDTH},t),this.contentContainer=R(D.G,{},this.svgRoot),yt(this.background,"pointerdown",this,this.onMouseDown)}dispose(){Ct(this.svgRoot),this.disposed=!0}setAnchorLocation(t,i=!1){this.anchor=t,i?this.positionByRect(this.ownerRect):this.positionRelativeToAnchor(),this.renderTail()}setPositionRelativeToAnchor(t,i){this.relativeLeft=t,this.relativeTop=i,this.positionRelativeToAnchor(),this.renderTail()}getSize(){return this.size}setSize(t,i=!1){t.width=Math.max(t.width,Ki.MIN_SIZE),t.height=Math.max(t.height,Ki.MIN_SIZE),this.size=t,this.background.setAttribute("width",`${t.width}`),this.background.setAttribute("height",`${t.height}`),i?this.positionByRect(this.ownerRect):this.positionRelativeToAnchor(),this.renderTail()}getColour(){return this.colour}setColour(t){this.colour=t,this.tail.setAttribute("fill",t),this.background.setAttribute("fill",t)}onMouseDown(t){let i;(i=this.workspace.getGesture(t))==null||i.handleBubbleStart(t,this)}positionRelativeToAnchor(){let t=this.anchor.x;t=this.workspace.RTL?t-(this.relativeLeft+this.size.width):t+this.relativeLeft,this.moveTo(t,this.relativeTop+this.anchor.y)}moveTo(t,i){this.svgRoot.setAttribute("transform",`translate(${t}, ${i})`)}positionByRect(t=new ve(0,0,0,0)){var i=this.workspace.getMetricsManager().getViewMetrics(!0),r=this.getOptimalRelativeLeft(i),c=this.getOptimalRelativeTop(i);const u={x:r,y:-this.size.height-this.workspace.getRenderer().getConstants().MIN_BLOCK_HEIGHT},f={x:-this.size.width-30,y:c};c={x:t.getWidth(),y:c};var E={x:r,y:t.getHeight()};r=t.getWidth()<t.getHeight()?c:E,t=t.getWidth()<t.getHeight()?E:c,c=this.getOverlap(u,i),E=this.getOverlap(f,i);const S=this.getOverlap(r,i);i=this.getOverlap(t,i),i=Math.max(c,E,S,i),c===i?(this.relativeLeft=u.x,this.relativeTop=u.y):E===i?(this.relativeLeft=f.x,this.relativeTop=f.y):S===i?(this.relativeLeft=r.x,this.relativeTop=r.y):(this.relativeLeft=t.x,this.relativeTop=t.y),this.positionRelativeToAnchor()}getOverlap(t,i){var r=this.workspace.RTL?this.anchor.x-t.x-this.size.width:t.x+this.anchor.x;return t=t.y+this.anchor.y,Math.max(0,Math.min(1,(Math.min(r+this.size.width,i.left+i.width)-Math.max(r,i.left))*(Math.min(t+this.size.height,i.top+i.height)-Math.max(t,i.top))/(this.size.width*this.size.height)))}getOptimalRelativeLeft(t){let i=-this.size.width/4;if(this.size.width>t.width)return i;if(t=this.getWorkspaceViewRect(t),this.workspace.RTL){var r=this.anchor.x-i;r-this.size.width<t.left?i=-(t.left-this.anchor.x+this.size.width):r>t.right&&(i=-(t.right-this.anchor.x))}else{r=i+this.anchor.x;const c=r+this.size.width;r<t.left?i=t.left-this.anchor.x:c>t.right&&(i=t.right-this.anchor.x-this.size.width)}return i}getOptimalRelativeTop(t){let i=-this.size.height/4;if(this.size.height>t.height)return i;const r=this.anchor.y+i,c=r+this.size.height;return t=this.getWorkspaceViewRect(t),r<t.top?i=t.top-this.anchor.y:c>t.bottom&&(i=t.bottom-this.anchor.y-this.size.height),i}getWorkspaceViewRect(t){const i=t.top;let r=t.top+t.height,c=t.left;return t=t.left+t.width,r-=this.getScrollbarThickness(),this.workspace.RTL?c-=this.getScrollbarThickness():t-=this.getScrollbarThickness(),new ve(i,r,c,t)}getScrollbarThickness(){return Ge.scrollbarThickness/this.workspace.scale}renderTail(){const t=[];var i=this.size.width/2,r=this.size.height/2,c=-this.relativeLeft,u=-this.relativeTop;if(i===c&&r===u)t.push("M "+i+","+r);else{u-=r,c-=i,this.workspace.RTL&&(c*=-1);var f=Math.sqrt(u*u+c*c),E=Math.acos(c/f);0>u&&(E=2*Math.PI-E);var S=E+Math.PI/2;S>2*Math.PI&&(S-=2*Math.PI);var W=Math.sin(S);const ke=Math.cos(S);let Ie=(this.size.width+this.size.height)/Ki.TAIL_THICKNESS;Ie=Math.min(Ie,this.size.width,this.size.height)/4,S=1-Ki.ANCHOR_RADIUS/f,c=i+S*c,u=r+S*u,S=i+Ie*ke;const Bi=r+Ie*W;i-=Ie*ke,r-=Ie*W,W=el(this.workspace.RTL?-Ki.TAIL_ANGLE:Ki.TAIL_ANGLE),W=E+W,W>2*Math.PI&&(W-=2*Math.PI),E=Math.sin(W)*f/Ki.TAIL_BEND,f=Math.cos(W)*f/Ki.TAIL_BEND,t.push("M"+S+","+Bi),t.push("C"+(S+f)+","+(Bi+E)+" "+c+","+u+" "+c+","+u),t.push("C"+c+","+u+" "+(i+f)+","+(r+E)+" "+i+","+r)}t.push("z");let bt;(bt=this.tail)==null||bt.setAttribute("d",t.join(" "))}bringToFront(){let t;const i=(t=this.svgRoot)==null?void 0:t.parentNode;return this.svgRoot&&(i==null?void 0:i.lastChild)!==this.svgRoot?(i==null||i.appendChild(this.svgRoot),!0):!1}getRelativeToSurfaceXY(){return new pt(this.workspace.RTL?-this.relativeLeft+this.anchor.x-this.size.width:this.anchor.x+this.relativeLeft,this.anchor.y+this.relativeTop)}getSvgRoot(){return this.svgRoot}moveDuringDrag(t){this.moveTo(t.x,t.y),this.relativeLeft=this.workspace.RTL?this.anchor.x-t.x-this.size.width:t.x-this.anchor.x,this.relativeTop=t.y-this.anchor.y,this.renderTail()}setDragging(t){}setDeleteStyle(t){}isDeletable(){return!1}showContextMenu(t){}};Ki=ce,ce.BORDER_WIDTH=6,ce.DOUBLE_BORDER=2*Ki.BORDER_WIDTH,ce.MIN_SIZE=Ki.DOUBLE_BORDER,ce.TAIL_THICKNESS=1,ce.TAIL_ANGLE=20,ce.TAIL_BEND=4,ce.ANCHOR_RADIUS=8;var xo=class extends ce{constructor(t,i,r,c){super(i,r,c),this.workspace=i,this.anchor=r,this.ownerRect=c,this.autoLayout=!0,i=new hs(t),this.validateWorkspaceOptions(i),this.svgDialog=R(D.SVG,{x:ce.BORDER_WIDTH,y:ce.BORDER_WIDTH},this.contentContainer),t.parentWorkspace=this.workspace,this.miniWorkspace=this.newWorkspaceSvg(new hs(t)),this.miniWorkspace.internalIsMutator=!0,t=this.miniWorkspace.createDom("blocklyMutatorBackground"),this.svgDialog.appendChild(t),i.languageTree&&(t.insertBefore(this.miniWorkspace.addFlyout(D.G),this.miniWorkspace.getCanvas()),t=this.miniWorkspace.getFlyout(),t==null||t.init(this.miniWorkspace),t==null||t.show(i.languageTree)),this.miniWorkspace.addChangeListener(this.onWorkspaceChange.bind(this));let u,f;(u=this.miniWorkspace.getFlyout())==null||(f=u.getWorkspace())==null||f.addChangeListener(this.onWorkspaceChange.bind(this)),this.updateBubbleSize()}dispose(){this.miniWorkspace.dispose(),super.dispose()}getWorkspace(){return this.miniWorkspace}addWorkspaceChangeListener(t){this.miniWorkspace.addChangeListener(t)}validateWorkspaceOptions(t){if(t.hasCategories)throw Error("The miniworkspace bubble does not support toolboxes with categories");if(t.hasTrashcan)throw Error("The miniworkspace bubble does not support trashcans");if(t.zoomOptions.controls||t.zoomOptions.wheel||t.zoomOptions.pinch)throw Error("The miniworkspace bubble does not support zooming");if(t.moveOptions.scrollbars||t.moveOptions.wheel||t.moveOptions.drag)throw Error("The miniworkspace bubble does not scrolling/moving the workspace");if(t.horizontalLayout)throw Error("The miniworkspace bubble does not support horizontal layouts")}onWorkspaceChange(){this.bumpBlocksIntoBounds(),this.updateBubbleSize()}bumpBlocksIntoBounds(){if(!this.miniWorkspace.isDragging())for(const t of this.miniWorkspace.getTopBlocks(!1)){const i=t.getRelativeToSurfaceXY();if(20>i.y&&t.moveBy(0,20-i.y),t.RTL){let r=-20;const c=this.miniWorkspace.getFlyout();c&&(r-=c.getWidth()),i.x>r&&t.moveBy(r-i.x,0)}else 20>i.x&&t.moveBy(20-i.x,0)}}updateBubbleSize(){if(!this.miniWorkspace.isDragging()){var t=this.getSize(),i=this.calculateWorkspaceSize();Math.abs(t.width-i.width)<xo.MINIMUM_VIEW_CHANGE&&Math.abs(t.height-i.height)<xo.MINIMUM_VIEW_CHANGE||(this.svgDialog.setAttribute("width",`${i.width}px`),this.svgDialog.setAttribute("height",`${i.height}px`),this.miniWorkspace.setCachedParentSvgSize(i.width,i.height),this.miniWorkspace.RTL&&this.miniWorkspace.getCanvas().setAttribute("transform",`translate(${i.width}, 0)`),this.setSize(new Ce(i.width+ce.DOUBLE_BORDER,i.height+ce.DOUBLE_BORDER),this.autoLayout),this.miniWorkspace.resize(),this.miniWorkspace.recordDragTargets())}}calculateWorkspaceSize(){var t=this.miniWorkspace.getCanvas().getBBox();let i=t.width+xo.MARGIN;t=t.height+xo.MARGIN;const r=this.miniWorkspace.getFlyout();if(r){const c=r.getWorkspace().getMetricsManager().getScrollMetrics();t=Math.max(t,c.height+20),i+=r.getWidth()}return new Ce(i,t)}updateBlockStyles(){for(var t of this.miniWorkspace.getAllBlocks(!1))t.setStyle(t.getStyleName());let i;if(t=(i=this.miniWorkspace.getFlyout())==null?void 0:i.getWorkspace())for(const r of t.getAllBlocks(!1))r.setStyle(r.getStyleName())}moveDuringDrag(t){super.moveDuringDrag(t),this.autoLayout=!1}moveTo(t,i){super.moveTo(t,i),this.miniWorkspace.recordDragTargets()}newWorkspaceSvg(t){throw Error("The implementation of newWorkspaceSvg should be monkey-patched in by blockly.ts")}};xo.MINIMUM_VIEW_CHANGE=10,xo.MARGIN=3*ce.DOUBLE_BORDER;var td,ed;td=17,ed=16,s.MutatorIcon$$module$build$src$core$icons$mutator_icon=class extends Zu{constructor(t,i){super(i),this.flyoutBlockTypes=t,this.sourceBlock=i,this.saveConnectionsListener=this.updateWorkspacePid=this.rootBlock=this.miniWorkspaceBubble=null}getType(){return s.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE}initView(t){this.svgRoot||(super.initView(t),R(D.RECT,{class:"blocklyIconShape",rx:"4",ry:"4",height:"16",width:"16"},this.svgRoot),R(D.PATH,{class:"blocklyIconSymbol",d:"m4.203,7.296 0,1.368 -0.92,0.677 -0.11,0.41 0.9,1.559 0.41,0.11 1.043,-0.457 1.187,0.683 0.127,1.134 0.3,0.3 1.8,0 0.3,-0.299 0.127,-1.138 1.185,-0.682 1.046,0.458 0.409,-0.11 0.9,-1.559 -0.11,-0.41 -0.92,-0.677 0,-1.366 0.92,-0.677 0.11,-0.41 -0.9,-1.559 -0.409,-0.109 -1.046,0.458 -1.185,-0.682 -0.127,-1.138 -0.3,-0.299 -1.8,0 -0.3,0.3 -0.126,1.135 -1.187,0.682 -1.043,-0.457 -0.41,0.11 -0.899,1.559 0.108,0.409z"},this.svgRoot),R(D.CIRCLE,{class:"blocklyIconShape",r:"2.7",cx:"8",cy:"8"},this.svgRoot),J(this.svgRoot,"blockly-icon-mutator"))}dispose(){super.dispose();let t;(t=this.miniWorkspaceBubble)==null||t.dispose()}getWeight(){return s.MutatorIcon$$module$build$src$core$icons$mutator_icon.WEIGHT}getSize(){return new Ce(td,td)}applyColour(){super.applyColour();let t;(t=this.miniWorkspaceBubble)==null||t.setColour(this.sourceBlock.style.colourPrimary);let i;(i=this.miniWorkspaceBubble)==null||i.updateBlockStyles()}updateCollapsed(){super.updateCollapsed(),this.sourceBlock.isCollapsed()&&this.setBubbleVisible(!1)}onLocationChange(t){super.onLocationChange(t);let i;(i=this.miniWorkspaceBubble)==null||i.setAnchorLocation(this.getAnchorLocation())}onClick(){super.onClick(),this.sourceBlock.isEditable()&&this.setBubbleVisible(!this.bubbleIsVisible())}isClickableInFlyout(){return!1}bubbleIsVisible(){return!!this.miniWorkspaceBubble}setBubbleVisible(t){if(this.bubbleIsVisible()!==t){if(t){this.miniWorkspaceBubble=new xo(this.getMiniWorkspaceConfig(),this.sourceBlock.workspace,this.getAnchorLocation(),this.getBubbleOwnerRect()),this.applyColour(),this.createRootBlock(),this.addSaveConnectionsListener();let i;(i=this.miniWorkspaceBubble)==null||i.addWorkspaceChangeListener(this.createMiniWorkspaceChangeListener())}else{let i;(i=this.miniWorkspaceBubble)==null||i.dispose(),this.miniWorkspaceBubble=null,this.saveConnectionsListener&&this.sourceBlock.workspace.removeChangeListener(this.saveConnectionsListener),this.saveConnectionsListener=null}it(new(ut(Vs))(this.sourceBlock,t,"mutator"))}}getMiniWorkspaceConfig(){let t;const i={disable:!1,media:this.sourceBlock.workspace.options.pathToMedia,rtl:this.sourceBlock.RTL,renderer:this.sourceBlock.workspace.options.renderer,rendererOverrides:(t=this.sourceBlock.workspace.options.rendererOverrides)!=null?t:void 0};return this.flyoutBlockTypes.length&&(i.toolbox={kind:"flyoutToolbox",contents:this.flyoutBlockTypes.map(r=>({kind:"block",type:r}))}),i}getAnchorLocation(){const t=td/2;return pt.sum(this.workspaceLocation,new pt(t,t))}getBubbleOwnerRect(){const t=this.sourceBlock.getSvgRoot().getBBox();return new ve(t.y,t.y+t.height,t.x,t.x+t.width)}createRootBlock(){if(!this.sourceBlock.decompose)throw Error("Blocks with mutator icons must include a decompose method");this.rootBlock=this.sourceBlock.decompose(this.miniWorkspaceBubble.getWorkspace());for(var t of this.rootBlock.getDescendants(!1))t.queueRender();this.rootBlock.setMovable(!1),this.rootBlock.setDeletable(!1);let i,r,c,u;t=(u=(i=this.miniWorkspaceBubble)==null||(r=i.getWorkspace())==null||(c=r.getFlyout())==null?void 0:c.getWidth())!=null?u:0,this.rootBlock.moveBy(this.rootBlock.RTL?-(t+ed):ed,ed)}addSaveConnectionsListener(){this.sourceBlock.saveConnections&&this.rootBlock&&(this.saveConnectionsListener=()=>{this.sourceBlock.saveConnections&&this.rootBlock&&this.sourceBlock.saveConnections(this.rootBlock)},this.saveConnectionsListener(),this.sourceBlock.workspace.addChangeListener(this.saveConnectionsListener))}createMiniWorkspaceChangeListener(){return t=>{s.MutatorIcon$$module$build$src$core$icons$mutator_icon.isIgnorableMutatorEvent(t)||this.updateWorkspacePid||(this.updateWorkspacePid=setTimeout(()=>{this.updateWorkspacePid=null,this.recomposeSourceBlock()},0))}}static isIgnorableMutatorEvent(t){return t.isUiEvent||t.type===s.CREATE$$module$build$src$core$events$utils||t.type===s.CHANGE$$module$build$src$core$events$utils&&t.element==="disabled"}recomposeSourceBlock(){if(this.rootBlock){if(!this.sourceBlock.compose)throw Error("Blocks with mutator icons must include a compose method");var t=s.getGroup$$module$build$src$core$events$utils();t||s.setGroup$$module$build$src$core$events$utils(!0);var i=vr.getExtraBlockState_(this.sourceBlock);this.sourceBlock.compose(this.rootBlock);var r=vr.getExtraBlockState_(this.sourceBlock);i!==r&&it(new(ut(s.CHANGE$$module$build$src$core$events$utils))(this.sourceBlock,"mutation",null,i,r)),s.setGroup$$module$build$src$core$events$utils(t)}}getWorkspace(){let t;return(t=this.miniWorkspaceBubble)==null?void 0:t.getWorkspace()}static reconnect(t,i,r){return j("MutatorIcon.reconnect","v10","v11","connection.reconnect"),t?t.reconnect(i,r):!1}static findParentWs(t){return j("MutatorIcon.findParentWs","v10","v11","workspace.getRootWorkspace"),t.getRootWorkspace()}},s.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE=xi.MUTATOR,s.MutatorIcon$$module$build$src$core$icons$mutator_icon.WEIGHT=1,s.MutatorIcon$$module$build$src$core$icons$mutator_icon;var Ml=Object.create(null),pR={allExtensions:Ml};s.register$$module$build$src$core$extensions("parent_tooltip_when_inline",Kv);var ys={TEST_ONLY:pR};ys.apply=_u,ys.buildTooltipForDropdown=s.buildTooltipForDropdown$$module$build$src$core$extensions,ys.buildTooltipWithFieldText=s.buildTooltipWithFieldText$$module$build$src$core$extensions,ys.isRegistered=hg,ys.register=s.register$$module$build$src$core$extensions,ys.registerMixin=s.registerMixin$$module$build$src$core$extensions,ys.registerMutator=s.registerMutator$$module$build$src$core$extensions,ys.runAfterPageLoad=Xv,ys.unregister=Hv;var Kt;(function(t){t[t.WIN_KEY_FF_LINUX=0]="WIN_KEY_FF_LINUX",t[t.MAC_ENTER=3]="MAC_ENTER",t[t.BACKSPACE=8]="BACKSPACE",t[t.TAB=9]="TAB",t[t.NUM_CENTER=12]="NUM_CENTER",t[t.ENTER=13]="ENTER",t[t.SHIFT=16]="SHIFT",t[t.CTRL=17]="CTRL",t[t.ALT=18]="ALT",t[t.PAUSE=19]="PAUSE",t[t.CAPS_LOCK=20]="CAPS_LOCK",t[t.ESC=27]="ESC",t[t.SPACE=32]="SPACE",t[t.PAGE_UP=33]="PAGE_UP",t[t.PAGE_DOWN=34]="PAGE_DOWN",t[t.END=35]="END",t[t.HOME=36]="HOME",t[t.LEFT=37]="LEFT",t[t.UP=38]="UP",t[t.RIGHT=39]="RIGHT",t[t.DOWN=40]="DOWN",t[t.PLUS_SIGN=43]="PLUS_SIGN",t[t.PRINT_SCREEN=44]="PRINT_SCREEN",t[t.INSERT=45]="INSERT",t[t.DELETE=46]="DELETE",t[t.ZERO=48]="ZERO",t[t.ONE=49]="ONE",t[t.TWO=50]="TWO",t[t.THREE=51]="THREE",t[t.FOUR=52]="FOUR",t[t.FIVE=53]="FIVE",t[t.SIX=54]="SIX",t[t.SEVEN=55]="SEVEN",t[t.EIGHT=56]="EIGHT",t[t.NINE=57]="NINE",t[t.FF_SEMICOLON=59]="FF_SEMICOLON",t[t.FF_EQUALS=61]="FF_EQUALS",t[t.FF_DASH=173]="FF_DASH",t[t.FF_HASH=163]="FF_HASH",t[t.QUESTION_MARK=63]="QUESTION_MARK",t[t.AT_SIGN=64]="AT_SIGN",t[t.A=65]="A",t[t.B=66]="B",t[t.C=67]="C",t[t.D=68]="D",t[t.E=69]="E",t[t.F=70]="F",t[t.G=71]="G",t[t.H=72]="H",t[t.I=73]="I",t[t.J=74]="J",t[t.K=75]="K",t[t.L=76]="L",t[t.M=77]="M",t[t.N=78]="N",t[t.O=79]="O",t[t.P=80]="P",t[t.Q=81]="Q",t[t.R=82]="R",t[t.S=83]="S",t[t.T=84]="T",t[t.U=85]="U",t[t.V=86]="V",t[t.W=87]="W",t[t.X=88]="X",t[t.Y=89]="Y",t[t.Z=90]="Z",t[t.META=91]="META",t[t.WIN_KEY_RIGHT=92]="WIN_KEY_RIGHT",t[t.CONTEXT_MENU=93]="CONTEXT_MENU",t[t.NUM_ZERO=96]="NUM_ZERO",t[t.NUM_ONE=97]="NUM_ONE",t[t.NUM_TWO=98]="NUM_TWO",t[t.NUM_THREE=99]="NUM_THREE",t[t.NUM_FOUR=100]="NUM_FOUR",t[t.NUM_FIVE=101]="NUM_FIVE",t[t.NUM_SIX=102]="NUM_SIX",t[t.NUM_SEVEN=103]="NUM_SEVEN",t[t.NUM_EIGHT=104]="NUM_EIGHT",t[t.NUM_NINE=105]="NUM_NINE",t[t.NUM_MULTIPLY=106]="NUM_MULTIPLY",t[t.NUM_PLUS=107]="NUM_PLUS",t[t.NUM_MINUS=109]="NUM_MINUS",t[t.NUM_PERIOD=110]="NUM_PERIOD",t[t.NUM_DIVISION=111]="NUM_DIVISION",t[t.F1=112]="F1",t[t.F2=113]="F2",t[t.F3=114]="F3",t[t.F4=115]="F4",t[t.F5=116]="F5",t[t.F6=117]="F6",t[t.F7=118]="F7",t[t.F8=119]="F8",t[t.F9=120]="F9",t[t.F10=121]="F10",t[t.F11=122]="F11",t[t.F12=123]="F12",t[t.NUMLOCK=144]="NUMLOCK",t[t.SCROLL_LOCK=145]="SCROLL_LOCK",t[t.FIRST_MEDIA_KEY=166]="FIRST_MEDIA_KEY",t[t.LAST_MEDIA_KEY=183]="LAST_MEDIA_KEY",t[t.SEMICOLON=186]="SEMICOLON",t[t.DASH=189]="DASH",t[t.EQUALS=187]="EQUALS",t[t.COMMA=188]="COMMA",t[t.PERIOD=190]="PERIOD",t[t.SLASH=191]="SLASH",t[t.APOSTROPHE=192]="APOSTROPHE",t[t.TILDE=192]="TILDE",t[t.SINGLE_QUOTE=222]="SINGLE_QUOTE",t[t.OPEN_SQUARE_BRACKET=219]="OPEN_SQUARE_BRACKET",t[t.BACKSLASH=220]="BACKSLASH",t[t.CLOSE_SQUARE_BRACKET=221]="CLOSE_SQUARE_BRACKET",t[t.WIN_KEY=224]="WIN_KEY",t[t.MAC_FF_META=224]="MAC_FF_META",t[t.MAC_WK_CMD_LEFT=91]="MAC_WK_CMD_LEFT",t[t.MAC_WK_CMD_RIGHT=93]="MAC_WK_CMD_RIGHT",t[t.WIN_IME=229]="WIN_IME",t[t.VK_NONAME=252]="VK_NONAME",t[t.PHANTOM=255]="PHANTOM"})(Kt||(Kt={}));var Do={};Do.arc=Ve,Do.curve=Li,Do.line=al,Do.lineOnAxis=It,Do.lineTo=Hs,Do.moveBy=Ne,Do.moveTo=ei,Do.point=Ot;var De={};De.Coordinate=pt,De.KeyCodes=Kt,De.Rect=ve,De.Size=Ce,De.Svg=D,De.aria=sa,De.array=Dy,De.browserEvents=Ao,De.colour=us,De.deprecation=Py,De.dom=Je,De.extensions=ys,De.idGenerator=em,De.math=Xu,De.object=$I,De.parsing=ha,De.string=Tr,De.style=gn,De.svgMath=hr,De.svgPaths=Do,De.toolbox=mn,De.userAgent=QA,De.xml=vl;var qm={};qm.register=pg,qm.unregister=jv;var Zm=class extends ce{constructor(t,i,r,c){super(i,r,c),this.text=t,this.workspace=i,this.anchor=r,this.ownerRect=c,this.paragraph=this.stringToSvg(t,this.contentContainer),this.updateBubbleSize()}getText(){return this.text}setText(t){this.text=t,Ct(this.paragraph),this.paragraph=this.stringToSvg(t,this.contentContainer),this.updateBubbleSize()}stringToSvg(t,i){return i=this.createParagraph(i),t=this.createSpans(i,t),this.workspace.RTL&&this.rightAlignSpans(i.getBBox().width,t),i}createParagraph(t){return R(D.TEXT,{class:"blocklyText blocklyBubbleText blocklyNoPointerEvents",y:ce.BORDER_WIDTH},t)}createSpans(t,i){return i.split(`
`).map(r=>{const c=R(D.TSPAN,{dy:"1em",x:ce.BORDER_WIDTH},t);return r=document.createTextNode(r),c.appendChild(r),c})}rightAlignSpans(t,i){for(const r of i)r.setAttribute("text-anchor","end"),r.setAttribute("x",`${t+ce.BORDER_WIDTH}`)}updateBubbleSize(){const t=this.paragraph.getBBox();this.setSize(new Ce(t.width+2*ce.BORDER_WIDTH,t.height+2*ce.BORDER_WIDTH),!0)}},EI=class extends ce{constructor(t,i,r){super(t,i,r),this.workspace=t,this.anchor=i,this.ownerRect=r,this.resizePointerMoveListener=this.resizePointerUpListener=null,this.textChangeListeners=[],this.sizeChangeListeners=[],this.text="",this.DEFAULT_SIZE=new Ce(160+ce.DOUBLE_BORDER,80+ce.DOUBLE_BORDER),this.MIN_SIZE=new Ce(45+ce.DOUBLE_BORDER,20+ce.DOUBLE_BORDER),{inputRoot:this.inputRoot,textArea:this.textArea}=this.createEditor(this.contentContainer),this.resizeGroup=this.createResizeHandle(this.svgRoot),this.setSize(this.DEFAULT_SIZE,!0)}getText(){return this.text}setText(t){this.text=t,this.textArea.value=t,this.onTextChange()}addTextChangeListener(t){this.textChangeListeners.push(t)}addSizeChangeListener(t){this.sizeChangeListeners.push(t)}createEditor(t){t=R(D.FOREIGNOBJECT,{x:ce.BORDER_WIDTH,y:ce.BORDER_WIDTH},t);const i=document.createElementNS(zs,"body");i.setAttribute("xmlns",zs),i.className="blocklyMinimalBody";const r=document.createElementNS(zs,"textarea");return r.className="blocklyCommentTextarea",r.setAttribute("dir",this.workspace.RTL?"RTL":"LTR"),i.appendChild(r),t.appendChild(i),this.bindTextAreaEvents(r),setTimeout(()=>{r.focus()},0),{inputRoot:t,textArea:r}}bindTextAreaEvents(t){yt(t,"wheel",this,i=>{i.stopPropagation()}),yt(t,"focus",this,this.onStartEdit,!0),yt(t,"change",this,this.onTextChange)}createResizeHandle(t){t=R(D.G,{class:this.workspace.RTL?"blocklyResizeSW":"blocklyResizeSE"},t);const i=2*ce.BORDER_WIDTH;return R(D.POLYGON,{points:`0,${i} ${i},${i} ${i},0`},t),R(D.LINE,{class:"blocklyResizeLine",x1:i/3,y1:i-1,x2:i-1,y2:i/3},t),R(D.LINE,{class:"blocklyResizeLine",x1:2*i/3,y1:i-1,x2:i-1,y2:2*i/3},t),yt(t,"pointerdown",this,this.onResizePointerDown),t}setSize(t,i=!1){t.width=Math.max(t.width,this.MIN_SIZE.width),t.height=Math.max(t.height,this.MIN_SIZE.height);const r=t.width-ce.DOUBLE_BORDER,c=t.height-ce.DOUBLE_BORDER;this.inputRoot.setAttribute("width",`${r}`),this.inputRoot.setAttribute("height",`${c}`),this.textArea.style.width=`${r-4}px`,this.textArea.style.height=`${c-4}px`,this.workspace.RTL?this.resizeGroup.setAttribute("transform",`translate(${ce.DOUBLE_BORDER}, ${c}) scale(-1 1)`):this.resizeGroup.setAttribute("transform",`translate(${r}, ${c})`),super.setSize(t,i),this.onSizeChange()}getSize(){return super.getSize()}onResizePointerDown(t){this.bringToFront(),q(t)||(this.workspace.startDrag(t,new pt(this.workspace.RTL?-this.getSize().width:this.getSize().width,this.getSize().height)),this.resizePointerUpListener=yt(document,"pointerup",this,this.onResizePointerUp),this.resizePointerMoveListener=yt(document,"pointermove",this,this.onResizePointerMove),this.workspace.hideChaff()),t.stopPropagation()}onResizePointerUp(t){Ee(),this.resizePointerUpListener&&(N(this.resizePointerUpListener),this.resizePointerUpListener=null),this.resizePointerMoveListener&&(N(this.resizePointerMoveListener),this.resizePointerMoveListener=null)}onResizePointerMove(t){t=this.workspace.moveDrag(t),this.setSize(new Ce(this.workspace.RTL?-t.x:t.x,t.y),!1),this.onSizeChange()}onStartEdit(){this.bringToFront()&&this.textArea.focus()}onTextChange(){this.text=this.textArea.value;for(const t of this.textChangeListeners)t()}onSizeChange(){for(const t of this.sizeChangeListeners)t()}};et(`
.blocklyCommentTextarea {
  background-color: #fef49c;
  border: 0;
  display: block;
  margin: 0;
  outline: 0;
  padding: 3px;
  resize: none;
  text-overflow: hidden;
}
`);var Qm=17,vI=160,yI=80,yi=class extends Zu{constructor(t){super(t),this.sourceBlock=t,this.textBubble=this.textInputBubble=null,this.text="",this.bubbleSize=new Ce(vI,yI),this.bubbleVisiblity=!1}getType(){return yi.TYPE}initView(t){this.svgRoot||(super.initView(t),R(D.CIRCLE,{class:"blocklyIconShape",r:"8",cx:"8",cy:"8"},this.svgRoot),R(D.PATH,{class:"blocklyIconSymbol",d:"m6.8,10h2c0.003,-0.617 0.271,-0.962 0.633,-1.266 2.875,-2.4050.607,-5.534 -3.765,-3.874v1.7c3.12,-1.657 3.698,0.118 2.336,1.25-1.201,0.998 -1.201,1.528 -1.204,2.19z"},this.svgRoot),R(D.RECT,{class:"blocklyIconSymbol",x:"6.8",y:"10.78",height:"2",width:"2"},this.svgRoot),J(this.svgRoot,"blockly-icon-comment"))}dispose(){super.dispose();let t;(t=this.textInputBubble)==null||t.dispose();let i;(i=this.textBubble)==null||i.dispose()}getWeight(){return yi.WEIGHT}getSize(){return new Ce(Qm,Qm)}applyColour(){super.applyColour();const t=this.sourceBlock.style.colourPrimary;let i;(i=this.textInputBubble)==null||i.setColour(t);let r;(r=this.textBubble)==null||r.setColour(t)}updateEditable(){super.updateEditable(),this.bubbleIsVisible()&&(this.setBubbleVisible(!1),this.setBubbleVisible(!0))}onLocationChange(t){super.onLocationChange(t),t=this.getAnchorLocation();let i;(i=this.textInputBubble)==null||i.setAnchorLocation(t);let r;(r=this.textBubble)==null||r.setAnchorLocation(t)}setText(t){const i=this.text;it(new(ut(s.CHANGE$$module$build$src$core$events$utils))(this.sourceBlock,"comment",null,i,t)),this.text=t;let r;(r=this.textInputBubble)==null||r.setText(this.text);let c;(c=this.textBubble)==null||c.setText(this.text)}getText(){return this.text}setBubbleSize(t){this.bubbleSize=t;let i;(i=this.textInputBubble)==null||i.setSize(this.bubbleSize,!0)}getBubbleSize(){return this.bubbleSize}saveState(){return this.text?{text:this.text,pinned:this.bubbleIsVisible(),height:this.bubbleSize.height,width:this.bubbleSize.width}:null}loadState(t){let i;this.text=(i=t.text)!=null?i:"";let r,c;this.bubbleSize=new Ce((r=t.width)!=null?r:vI,(c=t.height)!=null?c:yI);let u;this.bubbleVisiblity=(u=t.pinned)!=null?u:!1,setTimeout(()=>this.setBubbleVisible(this.bubbleVisiblity),1)}onClick(){super.onClick(),this.setBubbleVisible(!this.bubbleIsVisible())}isClickableInFlyout(){return!1}onTextChange(){if(this.textInputBubble){var t=this.textInputBubble.getText();this.text!==t&&(it(new(ut(s.CHANGE$$module$build$src$core$events$utils))(this.sourceBlock,"comment",null,this.text,t)),this.text=t)}}onSizeChange(){this.textInputBubble&&(this.bubbleSize=this.textInputBubble.getSize())}bubbleIsVisible(){return this.bubbleVisiblity}setBubbleVisible(t){(!t||!this.textBubble&&!this.textInputBubble)&&(t||this.textBubble||this.textInputBubble)&&(this.bubbleVisiblity=t,this.sourceBlock.rendered&&!this.sourceBlock.isInFlyout&&(t?(this.sourceBlock.isEditable()?this.showEditableBubble():this.showNonEditableBubble(),this.applyColour()):this.hideBubble(),it(new(ut(Vs))(this.sourceBlock,t,"comment"))))}showEditableBubble(){this.textInputBubble=new EI(this.sourceBlock.workspace,this.getAnchorLocation(),this.getBubbleOwnerRect()),this.textInputBubble.setText(this.getText()),this.textInputBubble.setSize(this.bubbleSize,!0),this.textInputBubble.addTextChangeListener(()=>this.onTextChange()),this.textInputBubble.addSizeChangeListener(()=>this.onSizeChange())}showNonEditableBubble(){this.textBubble=new Zm(this.getText(),this.sourceBlock.workspace,this.getAnchorLocation(),this.getBubbleOwnerRect())}hideBubble(){let t;(t=this.textInputBubble)==null||t.dispose(),this.textInputBubble=null;let i;(i=this.textBubble)==null||i.dispose(),this.textBubble=null}getAnchorLocation(){const t=Qm/2;return pt.sum(this.workspaceLocation,new pt(t,t))}getBubbleOwnerRect(){const t=this.sourceBlock.getSvgRoot().getBBox();return new ve(t.y,t.y+t.height,t.x,t.x+t.width)}};yi.TYPE=xi.COMMENT,yi.WEIGHT=3,pg(yi.TYPE,yi);var t$=17,Is=class extends Zu{constructor(t){super(t),this.sourceBlock=t,this.textMap=new Map,this.textBubble=null}getType(){return Is.TYPE}initView(t){this.svgRoot||(super.initView(t),R(D.PATH,{class:"blocklyIconShape",d:"M2,15Q-1,15 0.5,12L6.5,1.7Q8,-1 9.5,1.7L15.5,12Q17,15 14,15z"},this.svgRoot),R(D.PATH,{class:"blocklyIconSymbol",d:"m7,4.8v3.16l0.27,2.27h1.46l0.27,-2.27v-3.16z"},this.svgRoot),R(D.RECT,{class:"blocklyIconSymbol",x:"7",y:"11",height:"2",width:"2"},this.svgRoot),J(this.svgRoot,"blockly-icon-warning"))}dispose(){super.dispose();let t;(t=this.textBubble)==null||t.dispose()}getWeight(){return Is.WEIGHT}getSize(){return new Ce(t$,t$)}applyColour(){super.applyColour();let t;(t=this.textBubble)==null||t.setColour(this.sourceBlock.style.colourPrimary)}updateCollapsed(){}isShownWhenCollapsed(){return!0}onLocationChange(t){super.onLocationChange(t);let i;(i=this.textBubble)==null||i.setAnchorLocation(this.getAnchorLocation())}addMessage(t,i){if(this.textMap.get(i)===t)return this;t?this.textMap.set(i,t):this.textMap.delete(i);let r;return(r=this.textBubble)==null||r.setText(this.getText()),this}getText(){return[...this.textMap.values()].join(`
`)}onClick(){super.onClick(),this.setBubbleVisible(!this.bubbleIsVisible())}isClickableInFlyout(){return!1}bubbleIsVisible(){return!!this.textBubble}setBubbleVisible(t){if(this.bubbleIsVisible()!==t){if(t)this.textBubble=new Zm(this.getText(),this.sourceBlock.workspace,this.getAnchorLocation(),this.getBubbleOwnerRect()),this.applyColour();else{let i;(i=this.textBubble)==null||i.dispose(),this.textBubble=null}it(new(ut(Vs))(this.sourceBlock,t,"warning"))}}getAnchorLocation(){const t=t$/2;return pt.sum(this.workspaceLocation,new pt(t,t))}getBubbleOwnerRect(){const t=this.sourceBlock.getSvgRoot().getBBox();return new ve(t.y,t.y+t.height,t.x,t.x+t.width)}};Is.TYPE=xi.WARNING,Is.WEIGHT=2;var II=class extends Error{constructor(t){super(`Tried to append an icon of type ${t.getType()} when an icon of that type already exists on the block. Use getIcon to access the existing icon.`),this.icon=t}},SI={};SI.DuplicateIconType=II;var Tn={};Tn.CommentIcon=yi,Tn.Icon=Zu,Tn.IconType=xi,Tn.MutatorIcon=s.MutatorIcon$$module$build$src$core$icons$mutator_icon,Tn.WarningIcon=Is,Tn.exceptions=SI,Tn.registry=qm;var id,Ii;id="PROCEDURE",s.DEFAULT_ARG$$module$build$src$core$procedures="x",Ii={CATEGORY_NAME:id,DEFAULT_ARG:s.DEFAULT_ARG$$module$build$src$core$procedures},Ii.ObservableProcedureMap=TI,Ii.allProcedures=Eu,Ii.findLegalName=s.findLegalName$$module$build$src$core$procedures,Ii.flyoutCategory=vu,Ii.getCallers=_g,Ii.getDefinition=s.getDefinition$$module$build$src$core$procedures,Ii.isNameUsed=gg,Ii.isProcedureBlock=an,Ii.mutateCallers=s.mutateCallers$$module$build$src$core$procedures,Ii.mutatorOpenListener=$g,Ii.rename=s.rename$$module$build$src$core$procedures;var fR=class{constructor(){this.NONE=0,this.FIELD=1,this.HAT=2,this.ICON=4,this.SPACER=8,this.BETWEEN_ROW_SPACER=16,this.IN_ROW_SPACER=32,this.EXTERNAL_VALUE_INPUT=64,this.INPUT=128,this.INLINE_INPUT=256,this.STATEMENT_INPUT=512,this.CONNECTION=1024,this.PREVIOUS_CONNECTION=2048,this.NEXT_CONNECTION=4096,this.OUTPUT_CONNECTION=8192,this.CORNER=16384,this.LEFT_SQUARE_CORNER=32768,this.LEFT_ROUND_CORNER=65536,this.RIGHT_SQUARE_CORNER=131072,this.RIGHT_ROUND_CORNER=262144,this.JAGGED_EDGE=524288,this.ROW=1048576,this.TOP_ROW=2097152,this.BOTTOM_ROW=4194304,this.INPUT_ROW=8388608,this.LEFT_CORNER=this.LEFT_SQUARE_CORNER|this.LEFT_ROUND_CORNER,this.RIGHT_CORNER=this.RIGHT_SQUARE_CORNER|this.RIGHT_ROUND_CORNER,this.nextTypeValue_=16777216}getType(t){return Object.prototype.hasOwnProperty.call(this,t)||(this[t]=this.nextTypeValue_,this.nextTypeValue_<<=1),this[t]}isField(t){return t.type&this.FIELD}isHat(t){return t.type&this.HAT}isIcon(t){return t.type&this.ICON}isSpacer(t){return t.type&this.SPACER}isInRowSpacer(t){return t.type&this.IN_ROW_SPACER}isInput(t){return t.type&this.INPUT}isExternalInput(t){return t.type&this.EXTERNAL_VALUE_INPUT}isInlineInput(t){return t.type&this.INLINE_INPUT}isStatementInput(t){return t.type&this.STATEMENT_INPUT}isPreviousConnection(t){return t.type&this.PREVIOUS_CONNECTION}isNextConnection(t){return t.type&this.NEXT_CONNECTION}isPreviousOrNextConnection(t){return t.type&(this.PREVIOUS_CONNECTION|this.NEXT_CONNECTION)}isLeftRoundedCorner(t){return t.type&this.LEFT_ROUND_CORNER}isRightRoundedCorner(t){return t.type&this.RIGHT_ROUND_CORNER}isLeftSquareCorner(t){return t.type&this.LEFT_SQUARE_CORNER}isRightSquareCorner(t){return t.type&this.RIGHT_SQUARE_CORNER}isCorner(t){return t.type&this.CORNER}isJaggedEdge(t){return t.type&this.JAGGED_EDGE}isRow(t){return t.type&this.ROW}isBetweenRowSpacer(t){return t.type&this.BETWEEN_ROW_SPACER}isTopRow(t){return t.type&this.TOP_ROW}isBottomRow(t){return t.type&this.BOTTOM_ROW}isTopOrBottomRow(t){return t.type&(this.TOP_ROW|this.BOTTOM_ROW)}isInputRow(t){return t.type&this.INPUT_ROW}},x=new fR,qs=class{constructor(t){this.centerline=this.xPos=this.height=this.width=0,this.constants_=t,this.type=x.NONE,this.notchOffset=this.constants_.NOTCH_OFFSET_LEFT}},ua=class{constructor(t){this.elements=[],this.xPos=this.yPos=this.widthWithConnectedBlocks=this.minWidth=this.minHeight=this.width=this.height=0,this.hasStatement=this.hasExternalInput=!1,this.statementEdge=0,this.hasJaggedEdge=this.hasDummyInput=this.hasInlineInput=!1,this.align=null,this.constants_=t,this.type=x.ROW,this.notchOffset=this.constants_.NOTCH_OFFSET_LEFT}getLastInput(){for(let t=this.elements.length-1;0<=t;t--){const i=this.elements[t];if(x.isInput(i))return i}return null}measure(){throw Error("Unexpected attempt to measure a base Row.")}startsWithElemSpacer(){return!0}endsWithElemSpacer(){return!0}getFirstSpacer(){for(let t=0;t<this.elements.length;t++){const i=this.elements[t];if(x.isSpacer(i))return i}return null}getLastSpacer(){for(let t=this.elements.length-1;0<=t;t--){const i=this.elements[t];if(x.isSpacer(i))return i}return null}},e$=class extends ua{constructor(t){super(t),this.hasNextConnection=!1,this.connection=null,this.baseline=this.descenderHeight=0,this.type|=x.BOTTOM_ROW}hasLeftSquareCorner(t){return!!t.outputConnection||!!t.getNextBlock()}hasRightSquareCorner(t){return!0}measure(){let t=0,i=0,r=0;for(let c=0;c<this.elements.length;c++){const u=this.elements[c];i+=u.width,x.isSpacer(u)||(x.isNextConnection(u)?r=Math.max(r,u.height):t=Math.max(t,u.height))}this.width=Math.max(this.minWidth,i),this.height=Math.max(this.minHeight,t)+r,this.descenderHeight=r,this.widthWithConnectedBlocks=this.width}startsWithElemSpacer(){return!1}endsWithElemSpacer(){return!1}},yr=class extends qs{constructor(t,i){super(t),this.connectionModel=i,this.shape=this.constants_.shapeFor(i),this.isDynamicShape="isDynamic"in this.shape&&this.shape.isDynamic,this.type|=x.CONNECTION}},bn=class extends yr{constructor(t,i){super(t,i.connection),this.input=i,this.connectionOffsetY=this.connectionOffsetX=0,this.type|=x.INPUT,this.align=i.align,(this.connectedBlock=i.connection&&i.connection.targetBlock()?i.connection.targetBlock():null)?(t=this.connectedBlock.getHeightWidth(),this.connectedBlockWidth=t.width,this.connectedBlockHeight=t.height):this.connectedBlockHeight=this.connectedBlockWidth=0}},sd=class extends bn{constructor(t,i){super(t,i),this.height=0,this.type|=x.EXTERNAL_VALUE_INPUT,this.height=this.connectedBlock?this.connectedBlockHeight-this.constants_.TAB_OFFSET_FROM_TOP-this.constants_.MEDIUM_PADDING:this.shape.height,this.width=this.shape.width+this.constants_.EXTERNAL_VALUE_INPUT_PADDING,this.connectionOffsetY=this.constants_.TAB_OFFSET_FROM_TOP,this.connectionHeight=this.shape.height,this.connectionWidth=this.shape.width}},xl=class extends qs{constructor(t,i,r){super(t),this.field=i,this.parentInput=r,this.isEditable=i.EDITABLE,this.flipRtl=i.getFlipRtl(),this.type|=x.FIELD,t=this.field.getSize(),this.height=t.height,this.width=t.width}},i$=class extends qs{constructor(t){super(t),this.type|=x.HAT,this.height=this.constants_.START_HAT.height,this.width=this.constants_.START_HAT.width,this.ascenderHeight=this.height}},CI=class extends qs{constructor(t,i){super(t),this.icon=i,this.flipRtl=!1,this.isVisible=ln(i)&&i.bubbleIsVisible(),this.type|=x.ICON,t=i.getSize(),this.height=t.height,this.width=t.width}},ji=class extends qs{constructor(t,i){super(t),this.type=this.type|x.SPACER|x.IN_ROW_SPACER,this.width=i,this.height=this.constants_.SPACER_DEFAULT_HEIGHT}},s$=class extends bn{constructor(t,i){super(t,i),this.type|=x.INLINE_INPUT,this.connectedBlock?(this.width=this.connectedBlockWidth,this.height=this.connectedBlockHeight):(this.height=this.constants_.EMPTY_INLINE_INPUT_HEIGHT,this.width=this.constants_.EMPTY_INLINE_INPUT_PADDING),this.connectionHeight=this.isDynamicShape?this.shape.height(this.height):this.shape.height,this.connectionWidth=this.isDynamicShape?this.shape.width(this.height):this.shape.width,this.connectedBlock||(this.width+=this.connectionWidth*(this.isDynamicShape?2:1)),this.connectionOffsetY="connectionOffsetY"in this.shape?this.shape.connectionOffsetY(this.connectionHeight):this.constants_.TAB_OFFSET_FROM_TOP,this.connectionOffsetX="connectionOffsetX"in this.shape?this.shape.connectionOffsetX(this.connectionWidth):0}},da=class extends bn{constructor(t,i){super(t,i),this.type|=x.STATEMENT_INPUT,this.height=this.connectedBlock?this.connectedBlockHeight+this.constants_.STATEMENT_BOTTOM_SPACER:this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT,this.width=this.constants_.STATEMENT_INPUT_NOTCH_OFFSET+this.shape.width}},o$=class extends ua{constructor(t){super(t),this.connectedBlockWidths=0,this.type|=x.INPUT_ROW}measure(){this.width=this.minWidth,this.height=this.minHeight;let t=0;for(let i=0;i<this.elements.length;i++){const r=this.elements[i];this.width+=r.width,x.isInput(r)&&r instanceof bn&&(x.isStatementInput(r)&&r instanceof da?t+=r.connectedBlockWidth:x.isExternalInput(r)&&r instanceof sd&&r.connectedBlockWidth!==0&&(t+=r.connectedBlockWidth-r.connectionWidth)),x.isSpacer(r)||(this.height=Math.max(this.height,r.height))}this.connectedBlockWidths=t,this.widthWithConnectedBlocks=this.width+t}endsWithElemSpacer(){return!this.hasExternalInput&&!this.hasStatement}},wI=class extends qs{constructor(t){super(t),this.type|=x.JAGGED_EDGE,this.height=this.constants_.JAGGED_TEETH.height,this.width=this.constants_.JAGGED_TEETH.width}},kI=class extends yr{constructor(t,i){super(t,i),this.type|=x.NEXT_CONNECTION,this.height=this.shape.height,this.width=this.shape.width}},OI=class extends yr{constructor(t,i){super(t,i),this.connectionOffsetX=0,this.type|=x.OUTPUT_CONNECTION,this.height=this.isDynamicShape?0:this.shape.height,this.startX=this.width=this.isDynamicShape?0:this.shape.width,this.connectionOffsetY=this.constants_.TAB_OFFSET_FROM_TOP}},AI=class extends yr{constructor(t,i){super(t,i),this.type|=x.PREVIOUS_CONNECTION,this.height=this.shape.height,this.width=this.shape.width}},pa=class extends qs{constructor(t,i){super(t),this.type=(i&&i!=="left"?x.RIGHT_ROUND_CORNER:x.LEFT_ROUND_CORNER)|x.CORNER,this.width=this.constants_.CORNER_RADIUS,this.height=this.constants_.CORNER_RADIUS/2}},n$=class extends ua{constructor(t,i,r){super(t),this.height=i,this.width=r,this.precedesStatement=this.followsStatement=!1,this.widthWithConnectedBlocks=0,this.type=this.type|x.SPACER|x.BETWEEN_ROW_SPACER,this.elements=[new ji(this.constants_,r)]}measure(){}},fa=class extends qs{constructor(t,i){super(t),this.type=(i&&i!=="left"?x.RIGHT_SQUARE_CORNER:x.LEFT_SQUARE_CORNER)|x.CORNER,this.width=this.height=this.constants_.NO_PADDING}},r$=class extends ua{constructor(t){super(t),this.ascenderHeight=this.capline=0,this.hasPreviousConnection=!1,this.connection=null,this.type|=x.TOP_ROW}hasLeftSquareCorner(t){const i=(t.hat?t.hat==="cap":this.constants_.ADD_START_HATS)&&!t.outputConnection&&!t.previousConnection,r=t.getPreviousBlock();return!!t.outputConnection||i||(r?r.getNextBlock()===t:!1)}hasRightSquareCorner(t){return!0}measure(){let t=0,i=0,r=0;for(let c=0;c<this.elements.length;c++){const u=this.elements[c];i+=u.width,x.isSpacer(u)||(x.isHat(u)&&u instanceof i$?r=Math.max(r,u.ascenderHeight):t=Math.max(t,u.height))}this.width=Math.max(this.minWidth,i),this.height=Math.max(this.minHeight,t)+r,this.capline=this.ascenderHeight=r,this.widthWithConnectedBlocks=this.width}startsWithElemSpacer(){return!1}endsWithElemSpacer(){return!1}},ga=class{constructor(){this.NO_PADDING=0,this.SMALL_PADDING=3,this.MEDIUM_PADDING=5,this.MEDIUM_LARGE_PADDING=8,this.LARGE_PADDING=10,this.TAB_HEIGHT=15,this.TAB_OFFSET_FROM_TOP=5,this.TAB_VERTICAL_OVERLAP=2.5,this.TAB_WIDTH=8,this.NOTCH_WIDTH=15,this.NOTCH_HEIGHT=4,this.MIN_BLOCK_WIDTH=12,this.EMPTY_BLOCK_SPACER_HEIGHT=16,this.CORNER_RADIUS=8,this.NOTCH_OFFSET_LEFT=15,this.STATEMENT_BOTTOM_SPACER=0,this.STATEMENT_INPUT_PADDING_LEFT=20,this.BETWEEN_STATEMENT_PADDING_Y=4,this.ADD_START_HATS=!1,this.START_HAT_HEIGHT=15,this.START_HAT_WIDTH=100,this.SPACER_DEFAULT_HEIGHT=15,this.MIN_BLOCK_HEIGHT=24,this.EMPTY_INLINE_INPUT_PADDING=14.5,this.EXTERNAL_VALUE_INPUT_PADDING=2,this.JAGGED_TEETH_HEIGHT=12,this.JAGGED_TEETH_WIDTH=6,this.FIELD_TEXT_FONTSIZE=11,this.FIELD_TEXT_FONTWEIGHT="normal",this.FIELD_TEXT_FONTFAMILY="sans-serif",this.FIELD_TEXT_BASELINE=this.FIELD_TEXT_HEIGHT=-1,this.FIELD_BORDER_RECT_RADIUS=4,this.FIELD_BORDER_RECT_HEIGHT=16,this.FIELD_BORDER_RECT_X_PADDING=5,this.FIELD_BORDER_RECT_Y_PADDING=3,this.FIELD_BORDER_RECT_COLOUR="#fff",this.FIELD_DROPDOWN_SVG_ARROW=this.FIELD_DROPDOWN_COLOURED_DIV=this.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW=!1,this.FIELD_DROPDOWN_SVG_ARROW_SIZE=12,this.FIELD_COLOUR_FULL_BLOCK=this.FIELD_TEXTINPUT_BOX_SHADOW=!1,this.FIELD_COLOUR_DEFAULT_WIDTH=26,this.defs=null,this.embossFilterId="",this.embossFilter=null,this.disabledPatternId="",this.disabledPattern=null,this.debugFilterId="",this.cssNode=this.debugFilter=null,this.CURSOR_COLOUR="#cc0a0a",this.MARKER_COLOUR="#4286f4",this.CURSOR_WS_WIDTH=100,this.WS_CURSOR_HEIGHT=5,this.CURSOR_STACK_PADDING=10,this.CURSOR_BLOCK_PADDING=2,this.CURSOR_STROKE_WIDTH=4,this.FULL_BLOCK_FIELDS=!1,this.INSERTION_MARKER_COLOUR="#000000",this.INSERTION_MARKER_OPACITY=.2,this.SHAPES={PUZZLE:1,NOTCH:2},this.TALL_INPUT_FIELD_OFFSET_Y=this.MEDIUM_PADDING,this.DUMMY_INPUT_SHADOW_MIN_HEIGHT=this.DUMMY_INPUT_MIN_HEIGHT=this.TAB_HEIGHT,this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT,this.TOP_ROW_MIN_HEIGHT=this.MEDIUM_PADDING,this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.BOTTOM_ROW_MIN_HEIGHT=this.MEDIUM_PADDING,this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.EMPTY_INLINE_INPUT_HEIGHT=this.TAB_HEIGHT+11,this.EMPTY_STATEMENT_INPUT_HEIGHT=this.MIN_BLOCK_HEIGHT,this.START_POINT=Ne(0,0),this.FIELD_TEXT_BASELINE_CENTER=!0,this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT,this.FIELD_DROPDOWN_SVG_ARROW_PADDING=this.FIELD_BORDER_RECT_X_PADDING,this.FIELD_DROPDOWN_SVG_ARROW_DATAURI="data:image/svg+xml;base64,PHN2ZyBpZD0iTGF5ZXJfMSIgZGF0YS1uYW1lPSJMYXllciAxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMi43MSIgaGVpZ2h0PSI4Ljc5IiB2aWV3Qm94PSIwIDAgMTIuNzEgOC43OSI+PHRpdGxlPmRyb3Bkb3duLWFycm93PC90aXRsZT48ZyBvcGFjaXR5PSIwLjEiPjxwYXRoIGQ9Ik0xMi43MSwyLjQ0QTIuNDEsMi40MSwwLDAsMSwxMiw0LjE2TDguMDgsOC4wOGEyLjQ1LDIuNDUsMCwwLDEtMy40NSwwTDAuNzIsNC4xNkEyLjQyLDIuNDIsMCwwLDEsMCwyLjQ0LDIuNDgsMi40OCwwLDAsMSwuNzEuNzFDMSwwLjQ3LDEuNDMsMCw2LjM2LDBTMTEuNzUsMC40NiwxMiwuNzFBMi40NCwyLjQ0LDAsMCwxLDEyLjcxLDIuNDRaIiBmaWxsPSIjMjMxZjIwIi8+PC9nPjxwYXRoIGQ9Ik02LjM2LDcuNzlhMS40MywxLjQzLDAsMCwxLTEtLjQyTDEuNDIsMy40NWExLjQ0LDEuNDQsMCwwLDEsMC0yYzAuNTYtLjU2LDkuMzEtMC41Niw5Ljg3LDBhMS40NCwxLjQ0LDAsMCwxLDAsMkw3LjM3LDcuMzdBMS40MywxLjQzLDAsMCwxLDYuMzYsNy43OVoiIGZpbGw9IiNmZmYiLz48L3N2Zz4=",this.FIELD_COLOUR_DEFAULT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT,this.FIELD_CHECKBOX_X_OFFSET=this.FIELD_BORDER_RECT_X_PADDING-3,this.randomIdentifier=String(Math.random()).substring(2)}init(){this.JAGGED_TEETH=this.makeJaggedTeeth(),this.NOTCH=this.makeNotch(),this.START_HAT=this.makeStartHat(),this.PUZZLE_TAB=this.makePuzzleTab(),this.INSIDE_CORNERS=this.makeInsideCorners(),this.OUTSIDE_CORNERS=this.makeOutsideCorners()}setTheme(t){this.blockStyles=Object.create(null);const i=t.blockStyles;for(const r in i)this.blockStyles[r]=this.validatedBlockStyle_(i[r]);this.setDynamicProperties_(t)}setDynamicProperties_(t){this.setFontConstants_(t),this.setComponentConstants_(t),this.ADD_START_HATS=t.startHats!==void 0?t.startHats:this.ADD_START_HATS}setFontConstants_(t){t.fontStyle&&t.fontStyle.family&&(this.FIELD_TEXT_FONTFAMILY=t.fontStyle.family),t.fontStyle&&t.fontStyle.weight&&(this.FIELD_TEXT_FONTWEIGHT=t.fontStyle.weight),t.fontStyle&&t.fontStyle.size&&(this.FIELD_TEXT_FONTSIZE=t.fontStyle.size),t=te("Hg",this.FIELD_TEXT_FONTSIZE+"pt",this.FIELD_TEXT_FONTWEIGHT,this.FIELD_TEXT_FONTFAMILY),this.FIELD_TEXT_HEIGHT=t.height,this.FIELD_TEXT_BASELINE=t.baseline}setComponentConstants_(t){this.CURSOR_COLOUR=t.getComponentStyle("cursorColour")||this.CURSOR_COLOUR,this.MARKER_COLOUR=t.getComponentStyle("markerColour")||this.MARKER_COLOUR,this.INSERTION_MARKER_COLOUR=t.getComponentStyle("insertionMarkerColour")||this.INSERTION_MARKER_COLOUR,this.INSERTION_MARKER_OPACITY=Number(t.getComponentStyle("insertionMarkerOpacity"))||this.INSERTION_MARKER_OPACITY}getBlockStyleForColour(t){const i="auto_"+t;return this.blockStyles[i]||(this.blockStyles[i]=this.createBlockStyle_(t)),{style:this.blockStyles[i],name:i}}getBlockStyle(t){return this.blockStyles[t||""]||(t&&t.indexOf("auto_")===0?this.getBlockStyleForColour(t.substring(5)).style:this.createBlockStyle_("#000000"))}createBlockStyle_(t){return this.validatedBlockStyle_({colourPrimary:t})}validatedBlockStyle_(t){const i={};return t&&Object.assign(i,t),t=cl(i.colourPrimary||"#000"),i.colourPrimary=t.hex,i.colourSecondary=i.colourSecondary?cl(i.colourSecondary).hex:this.generateSecondaryColour_(i.colourPrimary),i.colourTertiary=i.colourTertiary?cl(i.colourTertiary).hex:this.generateTertiaryColour_(i.colourPrimary),i.hat=i.hat||"",i}generateSecondaryColour_(t){return ir("#fff",t,.6)||t}generateTertiaryColour_(t){return ir("#fff",t,.3)||t}dispose(){this.embossFilter&&Ct(this.embossFilter),this.disabledPattern&&Ct(this.disabledPattern),this.debugFilter&&Ct(this.debugFilter),this.cssNode=null}makeJaggedTeeth(){const t=this.JAGGED_TEETH_HEIGHT,i=this.JAGGED_TEETH_WIDTH,r=al([Ot(i,t/4),Ot(2*-i,t/2),Ot(i,t/4)]);return{height:t,width:i,path:r}}makeStartHat(){const t=this.START_HAT_HEIGHT,i=this.START_HAT_WIDTH,r=Li("c",[Ot(30,-t),Ot(70,-t),Ot(i,0)]);return{height:t,width:i,path:r}}makePuzzleTab(){function t(f){f=f?-1:1;const E=-f;var S=r/2;const W=S+2.5,bt=S+.5,ke=Ot(-i,f*S);return S=Ot(i,f*S),Li("c",[Ot(0,f*W),Ot(-i,E*bt),ke])+Li("s",[Ot(i,2.5*E),S])}const i=this.TAB_WIDTH,r=this.TAB_HEIGHT,c=t(!0),u=t(!1);return{type:this.SHAPES.PUZZLE,width:i,height:r,pathDown:u,pathUp:c}}makeNotch(){function t(E){return al([Ot(E*c,r),Ot(3*E,0),Ot(E*c,-r)])}const i=this.NOTCH_WIDTH,r=this.NOTCH_HEIGHT,c=(i-3)/2,u=t(1),f=t(-1);return{type:this.SHAPES.NOTCH,width:i,height:r,pathLeft:u,pathRight:f}}makeInsideCorners(){const t=this.CORNER_RADIUS,i=Ve("a","0 0,0",t,Ot(-t,t)),r=Ve("a","0 0,0",t,Ot(t,t));return{width:t,height:t,pathTop:i,pathBottom:r}}makeOutsideCorners(){const t=this.CORNER_RADIUS,i=Ne(0,t)+Ve("a","0 0,1",t,Ot(t,-t)),r=Ve("a","0 0,1",t,Ot(t,t)),c=Ve("a","0 0,1",t,Ot(-t,-t)),u=Ve("a","0 0,1",t,Ot(-t,t));return{topLeft:i,topRight:r,bottomRight:u,bottomLeft:c,rightHeight:t}}shapeFor(t){switch(t.type){case wt.INPUT_VALUE:case wt.OUTPUT_VALUE:return this.PUZZLE_TAB;case wt.PREVIOUS_STATEMENT:case wt.NEXT_STATEMENT:return this.NOTCH;default:throw Error("Unknown connection type")}}createDom(t,i,r){this.injectCSS_(i,r),this.defs=R(D.DEFS,{},t),t=R(D.FILTER,{id:"blocklyEmbossFilter"+this.randomIdentifier},this.defs),R(D.FEGAUSSIANBLUR,{in:"SourceAlpha",stdDeviation:1,result:"blur"},t),i=R(D.FESPECULARLIGHTING,{in:"blur",surfaceScale:1,specularConstant:.5,specularExponent:10,"lighting-color":"white",result:"specOut"},t),R(D.FEPOINTLIGHT,{x:-5e3,y:-1e4,z:2e4},i),R(D.FECOMPOSITE,{in:"specOut",in2:"SourceAlpha",operator:"in",result:"specOut"},t),R(D.FECOMPOSITE,{in:"SourceGraphic",in2:"specOut",operator:"arithmetic",k1:0,k2:1,k3:1,k4:0},t),this.embossFilterId=t.id,this.embossFilter=t,t=R(D.PATTERN,{id:"blocklyDisabledPattern"+this.randomIdentifier,patternUnits:"userSpaceOnUse",width:10,height:10},this.defs),R(D.RECT,{width:10,height:10,fill:"#aaa"},t),R(D.PATH,{d:"M 0 0 L 10 10 M 10 0 L 0 10",stroke:"#cc0"},t),this.disabledPatternId=t.id,this.disabledPattern=t,this.createDebugFilter()}createDebugFilter(){if(!this.debugFilter){const t=R(D.FILTER,{id:"blocklyDebugFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},this.defs),i=R(D.FECOMPONENTTRANSFER,{result:"outBlur"},t);R(D.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},i),R(D.FEFLOOD,{"flood-color":"#ff0000","flood-opacity":.5,result:"outColor"},t),R(D.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},t),this.debugFilterId=t.id,this.debugFilter=t}}injectCSS_(t,i){i=this.getCSS_(i),t="blockly-renderer-style-"+t,this.cssNode=document.getElementById(t);const r=i.join(`
`);this.cssNode?this.cssNode.firstChild.textContent=r:(i=document.createElement("style"),i.id=t,t=document.createTextNode(r),i.appendChild(t),document.head.insertBefore(i,document.head.firstChild),this.cssNode=i)}getCSS_(t){return[`${t} .blocklyText, `,`${t} .blocklyFlyoutLabelText {`,`font: ${this.FIELD_TEXT_FONTWEIGHT} ${this.FIELD_TEXT_FONTSIZE}pt ${this.FIELD_TEXT_FONTFAMILY};`,"}",`${t} .blocklyText {`,"fill: #fff;","}",`${t} .blocklyNonEditableText>rect,`,`${t} .blocklyEditableText>rect {`,`fill: ${this.FIELD_BORDER_RECT_COLOUR};`,"fill-opacity: .6;","stroke: none;","}",`${t} .blocklyNonEditableText>text,`,`${t} .blocklyEditableText>text {`,"fill: #000;","}",`${t} .blocklyFlyoutLabelText {`,"fill: #000;","}",`${t} .blocklyText.blocklyBubbleText {`,"fill: #000;","}",`${t} .blocklyEditableText:not(.editing):hover>rect {`,"stroke: #fff;","stroke-width: 2;","}",`${t} .blocklyHtmlInput {`,`font-family: ${this.FIELD_TEXT_FONTFAMILY};`,`font-weight: ${this.FIELD_TEXT_FONTWEIGHT};`,"}",`${t} .blocklySelected>.blocklyPath {`,"stroke: #fc3;","stroke-width: 3px;","}",`${t} .blocklyHighlightedConnectionPath {`,"stroke: #fc3;","}",`${t} .blocklyReplaceable .blocklyPath {`,"fill-opacity: .5;","}",`${t} .blocklyReplaceable .blocklyPathLight,`,`${t} .blocklyReplaceable .blocklyPathDark {`,"display: none;","}",`${t} .blocklyInsertionMarker>.blocklyPath {`,`fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,"stroke: none;","}"]}},ma=class{constructor(t,i){this.inlinePath_=this.outlinePath_="",this.block_=t,this.info_=i,this.topLeft_=t.getRelativeToSurfaceXY(),this.constants_=i.getRenderer().getConstants()}draw(){this.drawOutline_(),this.drawInternals_(),this.block_.pathObject.setPath(this.outlinePath_+`
`+this.inlinePath_),this.info_.RTL&&this.block_.pathObject.flipRTL(),this.recordSizeOnBlock_()}hideHiddenIcons_(){j("hideHiddenIcons_","v10","v11")}recordSizeOnBlock_(){this.block_.height=this.info_.height,this.block_.width=this.info_.widthWithChildren}drawOutline_(){this.drawTop_();for(let t=1;t<this.info_.rows.length-1;t++){const i=this.info_.rows[t];i.hasJaggedEdge?this.drawJaggedEdge_(i):i.hasStatement?this.drawStatementInput_(i):i.hasExternalInput?this.drawValueInput_(i):this.drawRightSideRow_(i)}this.drawBottom_(),this.drawLeft_()}drawTop_(){const t=this.info_.topRow,i=t.elements;this.positionPreviousConnection_(),this.outlinePath_+=Ne(t.xPos,this.info_.startY);for(let r=0,c;c=i[r];r++)x.isLeftRoundedCorner(c)?this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.topLeft:x.isRightRoundedCorner(c)?this.outlinePath_+=this.constants_.OUTSIDE_CORNERS.topRight:x.isPreviousConnection(c)&&c instanceof yr?this.outlinePath_+=c.shape.pathLeft:x.isHat(c)?this.outlinePath_+=this.constants_.START_HAT.path:x.isSpacer(c)&&(this.outlinePath_+=It("h",c.width));this.outlinePath_+=It("v",t.height)}drawJaggedEdge_(t){this.outlinePath_+=this.constants_.JAGGED_TEETH.path+It("v",t.height-this.constants_.JAGGED_TEETH.height)}drawValueInput_(t){const i=t.getLastInput();this.positionExternalValueConnection_(t);const r=Tg(i.shape)?i.shape.pathDown(i.height):i.shape.pathDown;this.outlinePath_+=It("H",i.xPos+i.width)+r+It("v",t.height-i.connectionHeight)}drawStatementInput_(t){var i=t.getLastInput();if(i){var r=i.xPos+i.notchOffset+i.shape.width;i=i.shape.pathRight+It("h",-(i.notchOffset-this.constants_.INSIDE_CORNERS.width))+this.constants_.INSIDE_CORNERS.pathTop;var c=t.height-2*this.constants_.INSIDE_CORNERS.height;this.outlinePath_+=It("H",r)+i+It("v",c)+this.constants_.INSIDE_CORNERS.pathBottom+It("H",t.xPos+t.width),this.positionStatementInputConnection_(t)}}drawRightSideRow_(t){this.outlinePath_+=It("V",t.yPos+t.height)}drawBottom_(){const t=this.info_.bottomRow,i=t.elements;this.positionNextConnection_();let r=0,c="";for(let u=i.length-1,f;f=i[u];u--)x.isNextConnection(f)&&f instanceof yr?c+=f.shape.pathRight:x.isLeftSquareCorner(f)?c+=It("H",t.xPos):x.isLeftRoundedCorner(f)?c+=this.constants_.OUTSIDE_CORNERS.bottomLeft:x.isRightRoundedCorner(f)?(c+=this.constants_.OUTSIDE_CORNERS.bottomRight,r=this.constants_.OUTSIDE_CORNERS.rightHeight):x.isSpacer(f)&&(c+=It("h",-1*f.width));this.outlinePath_+=It("V",t.baseline-r),this.outlinePath_+=c}drawLeft_(){var t=this.info_.outputConnection;if(this.positionOutputConnection_(),t){const i=t.connectionOffsetY+t.height;t=Tg(t.shape)?t.shape.pathUp(t.height):t.shape.pathUp,this.outlinePath_+=It("V",i)+t}this.outlinePath_+="z"}drawInternals_(){for(let t=0,i;i=this.info_.rows[t];t++)for(let r=0,c;c=i.elements[r];r++)x.isInlineInput(c)?this.drawInlineInput_(c):(x.isIcon(c)||x.isField(c))&&this.layoutField_(c)}layoutField_(t){const i=t.centerline-t.height/2;let r=t.xPos;var c="";this.info_.RTL&&(r=-(r+t.width),t.flipRtl&&(r+=t.width,c="scale(-1 1)")),x.isIcon(t)?(c=t.icon,c.setOffsetInBlock(new pt(r,i)),this.info_.isInsertionMarker&&c.hideForInsertionMarker()):(t=t.field.getSvgRoot(),t.setAttribute("transform","translate("+r+","+i+")"+c),this.info_.isInsertionMarker&&t.setAttribute("display","none"))}drawInlineInput_(t){const i=t.width,r=t.height,c=t.connectionOffsetY,u=t.connectionHeight+c;this.inlinePath_+=ei(t.xPos+t.connectionWidth,t.centerline-r/2)+It("v",c)+t.shape.pathDown+It("v",r-u)+It("h",i-t.connectionWidth)+It("v",-r)+"z",this.positionInlineInputConnection_(t)}positionInlineInputConnection_(t){const i=t.centerline-t.height/2;if(t.connectionModel){let r=t.xPos+t.connectionWidth+t.connectionOffsetX;this.info_.RTL&&(r*=-1),t.connectionModel.setOffsetInBlock(r,i+t.connectionOffsetY)}}positionStatementInputConnection_(t){const i=t.getLastInput();if(i!=null&&i.connectionModel){let r=t.xPos+t.statementEdge+i.notchOffset;this.info_.RTL&&(r*=-1),i.connectionModel.setOffsetInBlock(r,t.yPos)}}positionExternalValueConnection_(t){const i=t.getLastInput();if(i&&i.connectionModel){let r=t.xPos+t.width;this.info_.RTL&&(r*=-1),i.connectionModel.setOffsetInBlock(r,t.yPos)}}positionPreviousConnection_(){const t=this.info_.topRow;if(t.connection){const i=t.xPos+t.notchOffset;t.connection.connectionModel.setOffsetInBlock(this.info_.RTL?-i:i,0)}}positionNextConnection_(){const t=this.info_.bottomRow;if(t.connection){const i=t.connection,r=i.xPos;i.connectionModel.setOffsetInBlock(this.info_.RTL?-r:r,t.baseline)}}positionOutputConnection_(){if(this.info_.outputConnection){const t=this.info_.startX+this.info_.outputConnection.connectionOffsetX;this.block_.outputConnection.setOffsetInBlock(this.info_.RTL?-t:t,this.info_.outputConnection.connectionOffsetY)}}};(function(t){t[t.LEFT=-1]="LEFT",t[t.CENTRE=0]="CENTRE",t[t.RIGHT=1]="RIGHT"})(s.Align$$module$build$src$core$inputs$align||(s.Align$$module$build$src$core$inputs$align={})),s.Align$$module$build$src$core$inputs$align;var Ir=class extends qt{constructor(t,i,r){super(qt.SKIP_SETUP),this.class=null,this.EDITABLE=!1,this.maxDisplayLength=1/0,t!==qt.SKIP_SETUP&&(r?this.configure_(r):this.class=i||null,this.setValue(t))}configure_(t){super.configure_(t),t.class&&(this.class=t.class)}initView(){this.createTextElement_(),this.class&&J(this.getTextElement(),this.class)}doClassValidation_(t){return t==null?null:`${t}`}setClass(t){this.textElement_&&(this.class&&mt(this.textElement_,this.class),t&&J(this.textElement_,t)),this.class=t}static fromJson(t){return new this(Fe(t.text),void 0,t)}};zi("field_label",Ir),Ir.prototype.DEFAULT_VALUE="";var Zs=class{constructor(t,i){this.name=t,this.sourceBlock=i,this.fieldRow=[],this.align=s.Align$$module$build$src$core$inputs$input.LEFT,this.visible=!0,this.type=s.inputTypes$$module$build$src$core$inputs$input_types.CUSTOM,this.connection=null}getSourceBlock(){return this.sourceBlock}appendField(t,i){return this.insertFieldAt(this.fieldRow.length,t,i),this}insertFieldAt(t,i,r){if(0>t||t>this.fieldRow.length)throw Error("index "+t+" out of bounds.");return(i||i===""&&r)&&(typeof i=="string"&&(i=s.fromJson$$module$build$src$core$field_registry({type:"field_label",text:i})),i.setSourceBlock(this.sourceBlock),this.sourceBlock.rendered&&(i.init(),i.applyColour()),i.name=r,i.setVisible(this.isVisible()),i.prefixField&&(t=this.insertFieldAt(t,i.prefixField)),this.fieldRow.splice(t,0,i),t++,i.suffixField&&(t=this.insertFieldAt(t,i.suffixField)),this.sourceBlock.rendered&&(this.sourceBlock.queueRender(),this.sourceBlock.bumpNeighbours())),t}removeField(t,i){for(let r=0,c;c=this.fieldRow[r];r++)if(c.name===t)return c.dispose(),this.fieldRow.splice(r,1),this.sourceBlock.rendered&&(this.sourceBlock.queueRender(),this.sourceBlock.bumpNeighbours()),!0;if(i)return!1;throw Error('Field "'+t+'" not found.')}isVisible(){return this.visible}setVisible(t){let i=[];if(this.visible===t)return i;this.visible=t;for(let c=0,u;u=this.fieldRow[c];c++)u.setVisible(t);if(this.connection){var r=this.connection;t?i=r.startTrackingAll():r.stopTrackingAll(),(r=r.targetBlock())&&(r.getSvgRoot().style.display=t?"block":"none")}return i}markDirty(){for(let t=0,i;i=this.fieldRow[t];t++)i.markDirty()}setCheck(t){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.setCheck(t),this}setAlign(t){return this.align=t,this.sourceBlock.rendered&&this.sourceBlock.queueRender(),this}setShadowDom(t){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.setShadowDom(t),this}getShadowDom(){if(!this.connection)throw Error("This input does not have a connection.");return this.connection.getShadowDom()}init(){if(this.sourceBlock.workspace.rendered)for(let t=0;t<this.fieldRow.length;t++)this.fieldRow[t].init()}dispose(){for(let t=0,i;i=this.fieldRow[t];t++)i.dispose();this.connection&&this.connection.dispose()}makeConnection(t){return this.sourceBlock.makeConnection_(t)}},RI;(function(t){t=t.Align||(t.Align={}),t[t.LEFT=-1]="LEFT",t[t.CENTRE=0]="CENTRE",t[t.RIGHT=1]="RIGHT"})(Zs||(Zs={})),s.Align$$module$build$src$core$inputs$input=Zs.Align,RI={Align:s.Align$$module$build$src$core$inputs$input},RI.Input=Zs;var Qs=class extends Zs{constructor(t,i){super(t,i),this.name=t,this.type=s.inputTypes$$module$build$src$core$inputs$input_types.DUMMY}},Po=class extends Zs{constructor(t,i){super(t,i),this.name=t,this.type=s.inputTypes$$module$build$src$core$inputs$input_types.END_ROW}},Ji=class extends Zs{constructor(t,i){if(!t)throw Error("Statement inputs must have a non-empty name");super(t,i),this.name=t,this.type=s.inputTypes$$module$build$src$core$inputs$input_types.STATEMENT,this.connection=this.makeConnection(wt.NEXT_STATEMENT)}},NI;s.ValueInput$$module$build$src$core$inputs$value_input=class extends Zs{constructor(t,i){if(!t)throw Error("Value inputs must have a non-empty name");super(t,i),this.name=t,this.type=s.inputTypes$$module$build$src$core$inputs$input_types.VALUE,this.connection=this.makeConnection(wt.INPUT_VALUE)}},NI={},NI.ValueInput=s.ValueInput$$module$build$src$core$inputs$value_input;var Dl=class{constructor(t,i){this.statementEdge=this.width=this.widthWithChildren=this.height=0,this.rows=[],this.inputRows=[],this.startY=this.startX=0,this.renderer_=t,this.block_=i,this.constants_=this.renderer_.getConstants(),this.outputConnection=i.outputConnection?new OI(this.constants_,i.outputConnection):null,this.isInline=i.getInputsInline()&&!i.isCollapsed(),this.isCollapsed=i.isCollapsed(),this.isInsertionMarker=i.isInsertionMarker(),this.RTL=i.RTL,this.topRow=new r$(this.constants_),this.bottomRow=new e$(this.constants_)}getRenderer(){return this.renderer_}measure(){this.createRows_(),this.addElemSpacing_(),this.addRowSpacing_(),this.computeBounds_(),this.alignRowElements_(),this.finalize_()}createRows_(){this.populateTopRow_(),this.rows.push(this.topRow);let t=new o$(this.constants_);this.inputRows.push(t);var i=this.block_.getIcons();for(let r=0,c;c=i[r];r++){const u=new CI(this.constants_,c);this.isCollapsed&&!c.isShownWhenCollapsed()||t.elements.push(u)}i=void 0;for(let r=0,c;c=this.block_.inputList[r];r++)if(c.isVisible()){this.shouldStartNewRow_(c,i)&&(this.rows.push(t),t=new o$(this.constants_),this.inputRows.push(t));for(let u=0,f;f=c.fieldRow[u];u++)t.elements.push(new xl(this.constants_,f,c));this.addInput_(c,t),i=c}this.isCollapsed&&(t.hasJaggedEdge=!0,t.elements.push(new wI(this.constants_))),(t.elements.length||t.hasDummyInput)&&this.rows.push(t),this.populateBottomRow_(),this.rows.push(this.bottomRow)}populateTopRow_(){var t=!!this.block_.previousConnection;const i=(this.block_.hat?this.block_.hat==="cap":this.constants_.ADD_START_HATS)&&!this.outputConnection&&!t;let r=this.topRow.hasLeftSquareCorner(this.block_)?fa:pa;this.topRow.elements.push(new r(this.constants_)),i?(t=new i$(this.constants_),this.topRow.elements.push(t),this.topRow.capline=t.ascenderHeight):t&&(this.topRow.hasPreviousConnection=!0,this.topRow.connection=new AI(this.constants_,this.block_.previousConnection),this.topRow.elements.push(this.topRow.connection)),this.block_.inputList.length&&this.block_.inputList[0]instanceof Ji&&!this.block_.isCollapsed()?this.topRow.minHeight=this.constants_.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT:this.topRow.minHeight=this.constants_.TOP_ROW_MIN_HEIGHT,r=this.topRow.hasRightSquareCorner(this.block_)?fa:pa,this.topRow.elements.push(new r(this.constants_,"right"))}populateBottomRow_(){this.bottomRow.hasNextConnection=!!this.block_.nextConnection,this.bottomRow.minHeight=this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1]instanceof Ji?this.constants_.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT:this.constants_.BOTTOM_ROW_MIN_HEIGHT,this.bottomRow.hasLeftSquareCorner(this.block_)?this.bottomRow.elements.push(new fa(this.constants_)):this.bottomRow.elements.push(new pa(this.constants_)),this.bottomRow.hasNextConnection&&(this.bottomRow.connection=new kI(this.constants_,this.block_.nextConnection),this.bottomRow.elements.push(this.bottomRow.connection)),this.bottomRow.hasRightSquareCorner(this.block_)?this.bottomRow.elements.push(new fa(this.constants_,"right")):this.bottomRow.elements.push(new pa(this.constants_,"right"))}addInput_(t,i){this.isInline&&t instanceof s.ValueInput$$module$build$src$core$inputs$value_input?(i.elements.push(new s$(this.constants_,t)),i.hasInlineInput=!0):t instanceof Ji?(i.elements.push(new da(this.constants_,t)),i.hasStatement=!0):t instanceof s.ValueInput$$module$build$src$core$inputs$value_input?(i.elements.push(new sd(this.constants_,t)),i.hasExternalInput=!0):(t instanceof Qs||t instanceof Po)&&(i.minHeight=Math.max(i.minHeight,t.getSourceBlock()&&t.getSourceBlock().isShadow()?this.constants_.DUMMY_INPUT_SHADOW_MIN_HEIGHT:this.constants_.DUMMY_INPUT_MIN_HEIGHT),i.hasDummyInput=!0),i.align===null&&(i.align=t.align)}shouldStartNewRow_(t,i){return i?i instanceof Po||t instanceof Ji||i instanceof Ji?!0:t instanceof s.ValueInput$$module$build$src$core$inputs$value_input||t instanceof Qs||i instanceof s.ValueInput$$module$build$src$core$inputs$value_input?!this.isInline:!1:!1}addElemSpacing_(){for(let t=0,i;i=this.rows[t];t++){const r=i.elements;if(i.elements=[],i.startsWithElemSpacer()&&i.elements.push(new ji(this.constants_,this.getInRowSpacing_(null,r[0]))),r.length){for(let c=0;c<r.length-1;c++){i.elements.push(r[c]);const u=this.getInRowSpacing_(r[c],r[c+1]);i.elements.push(new ji(this.constants_,u))}i.elements.push(r[r.length-1]),i.endsWithElemSpacer()&&i.elements.push(new ji(this.constants_,this.getInRowSpacing_(r[r.length-1],null)))}}}getInRowSpacing_(t,i){if(!t&&i&&x.isStatementInput(i))return this.constants_.STATEMENT_INPUT_PADDING_LEFT;if(t&&x.isInput(t)&&!i){if(x.isExternalInput(t))return this.constants_.NO_PADDING;if(x.isInlineInput(t))return this.constants_.LARGE_PADDING;if(x.isStatementInput(t))return this.constants_.NO_PADDING}return t&&x.isLeftSquareCorner(t)&&i&&(x.isPreviousConnection(i)||x.isNextConnection(i))?i.notchOffset:t&&x.isLeftRoundedCorner(t)&&i&&(x.isPreviousConnection(i)||x.isNextConnection(i))?i.notchOffset-this.constants_.CORNER_RADIUS:this.constants_.MEDIUM_PADDING}computeBounds_(){let t=0,i=0,r=0;for(let u=0,f;f=this.rows[u];u++){if(f.measure(),i=Math.max(i,f.width),f.hasStatement){var c=f.getLastInput();let E,S;c=f.width-((S=(E=c)==null?void 0:E.width)!=null?S:0),t=Math.max(t,c)}r=Math.max(r,f.widthWithConnectedBlocks)}this.statementEdge=t,this.width=i;for(let u=0,f;f=this.rows[u];u++)f.hasStatement&&(f.statementEdge=this.statementEdge);this.widthWithChildren=Math.max(i,r),this.outputConnection&&(this.startX=this.outputConnection.width,this.width+=this.outputConnection.width,this.widthWithChildren+=this.outputConnection.width)}alignRowElements_(){for(let i=0,r;r=this.rows[i];i++)if(r.hasStatement)this.alignStatementRow_(r);else{var t=r.width;t=this.getDesiredRowWidth_(r)-t,0<t&&this.addAlignmentPadding_(r,t),x.isTopOrBottomRow(r)&&(r.widthWithConnectedBlocks=r.width)}}getDesiredRowWidth_(t){return this.width-this.startX}addAlignmentPadding_(t,i){const r=t.getFirstSpacer(),c=t.getLastSpacer();if((t.hasExternalInput||t.hasStatement)&&(t.widthWithConnectedBlocks+=i),t.align===s.Align$$module$build$src$core$inputs$align.LEFT&&c)c.width+=i;else if(t.align===s.Align$$module$build$src$core$inputs$align.CENTRE&&r&&c)r.width+=i/2,c.width+=i/2;else if(t.align===s.Align$$module$build$src$core$inputs$align.RIGHT&&r)r.width+=i;else if(c)c.width+=i;else return;t.width+=i}alignStatementRow_(t){const i=t.getLastInput();if(i){var r=t.width-i.width,c=this.statementEdge;r=c-r,0<r&&this.addAlignmentPadding_(t,r),r=t.width,c=this.getDesiredRowWidth_(t),i.width+=c-r,i.height=Math.max(i.height,t.height),t.width+=c-r,t.widthWithConnectedBlocks=Math.max(t.width,this.statementEdge+t.connectedBlockWidths)}}addRowSpacing_(){const t=this.rows;this.rows=[];for(let i=0;i<t.length;i++)this.rows.push(t[i]),i!==t.length-1&&this.rows.push(this.makeSpacerRow_(t[i],t[i+1]))}makeSpacerRow_(t,i){var r=this.getSpacerRowHeight_(t,i);const c=this.getSpacerRowWidth_(t,i);return r=new n$(this.constants_,r,c),t.hasStatement&&(r.followsStatement=!0),i.hasStatement&&(r.precedesStatement=!0),r}getSpacerRowWidth_(t,i){return this.width-this.startX}getSpacerRowHeight_(t,i){return this.constants_.MEDIUM_PADDING}getElemCenterline_(t,i){return x.isSpacer(i)?t.yPos+i.height/2:x.isBottomRow(t)?(t=t.yPos+t.height-t.descenderHeight,x.isNextConnection(i)?t+i.height/2:t-i.height/2):x.isTopRow(t)?x.isHat(i)?t.capline-i.height/2:t.capline+i.height/2:t.yPos+t.height/2}recordElemPositions_(t){let i=t.xPos;for(let r=0,c;c=t.elements[r];r++)x.isSpacer(c)&&(c.height=t.height),c.xPos=i,c.centerline=this.getElemCenterline_(t,c),i+=c.width}finalize_(){let t=0,i=0;for(let r=0,c;c=this.rows[r];r++)c.yPos=i,c.xPos=this.startX,i+=c.height,t=Math.max(t,c.widthWithConnectedBlocks),this.recordElemPositions_(c);if(this.outputConnection&&this.block_.nextConnection){const r=this.block_.nextConnection.targetBlock();r&&(t=Math.max(t,r.getHeightWidth().width))}this.widthWithChildren=t+this.startX,this.height=i,this.startY=this.topRow.capline,this.bottomRow.baseline=i-this.bottomRow.descenderHeight}},Q=class{constructor(t,i,r){if(this.wsCoordinate=null,!i)throw Error("Cannot create a node without a location.");this.type=t,this.isConnectionLocation=Q.isConnectionType(t),this.location=i,this.processParams(r||null)}processParams(t){t&&t.wsCoordinate&&(this.wsCoordinate=t.wsCoordinate)}getLocation(){return this.location}getType(){return this.type}getWsCoordinate(){return this.wsCoordinate}isConnection(){return this.isConnectionLocation}findNextForInput(){var t=this.location.getParentInput();const i=t.getSourceBlock();for(t=i.inputList.indexOf(t),t+=1;t<i.inputList.length;t++){const r=i.inputList[t],c=r.fieldRow;for(let u=0;u<c.length;u++){const f=c[u];if(f.isClickable()||Q.NAVIGATE_ALL_FIELDS)return Q.createFieldNode(f)}if(r.connection)return Q.createInputNode(r)}return null}findNextForField(){var t=this.location,i=t.getParentInput();const r=t.getSourceBlock();if(!r)throw Error("The current AST location is not associated with a block");var c=r.inputList.indexOf(i);for(t=i.fieldRow.indexOf(t)+1;c<r.inputList.length;c++){i=r.inputList[c];const u=i.fieldRow;for(;t<u.length;){if(u[t].isClickable()||Q.NAVIGATE_ALL_FIELDS)return Q.createFieldNode(u[t]);t++}if(t=0,i.connection)return Q.createInputNode(i)}return null}findPrevForInput(){const t=this.location.getParentInput(),i=t.getSourceBlock();for(var r=i.inputList.indexOf(t);0<=r;r--){var c=i.inputList[r];if(c.connection&&c!==t)return Q.createInputNode(c);c=c.fieldRow;for(let u=c.length-1;0<=u;u--){const f=c[u];if(f.isClickable()||Q.NAVIGATE_ALL_FIELDS)return Q.createFieldNode(f)}}return null}findPrevForField(){var t=this.location;const i=t.getParentInput(),r=t.getSourceBlock();if(!r)throw Error("The current AST location is not associated with a block");var c=r.inputList.indexOf(i);for(t=i.fieldRow.indexOf(t)-1;0<=c;c--){var u=r.inputList[c];if(u.connection&&u!==i)return Q.createInputNode(u);for(u=u.fieldRow;-1<t;){if(u[t].isClickable()||Q.NAVIGATE_ALL_FIELDS)return Q.createFieldNode(u[t]);t--}0<=c-1&&(t=r.inputList[c-1].fieldRow.length-1)}return null}navigateBetweenStacks(t){var i=this.getLocation();if(i.getSourceBlock){var r=i.getSourceBlock();r&&(i=r)}if(!i||i.isDeadOrDying())return null;r=i.getRootBlock(),i=r.workspace.getTopBlocks(!0);for(let c=0;c<i.length;c++)if(r.id===i[c].id)return t=c+(t?1:-1),t===-1||t===i.length?null:Q.createStackNode(i[t]);throw Error("Couldn't find "+(t?"next":"previous")+" stack?!")}findTopASTNodeForBlock(t){const i=zc(t);return i?Q.createConnectionNode(i):Q.createBlockNode(t)}getOutAstNodeForBlock(t){if(!t)return null;t=t.getTopStackBlock();const i=zc(t);return i&&i.targetConnection&&i.targetConnection.getParentInput()?Q.createInputNode(i.targetConnection.getParentInput()):Q.createStackNode(t)}findFirstFieldOrInput(t){t=t.inputList;for(let i=0;i<t.length;i++){const r=t[i],c=r.fieldRow;for(let u=0;u<c.length;u++){const f=c[u];if(f.isClickable()||Q.NAVIGATE_ALL_FIELDS)return Q.createFieldNode(f)}if(r.connection)return Q.createInputNode(r)}return null}getSourceBlock(){return this.getType()===Q.types.BLOCK?this.getLocation():this.getType()===Q.types.STACK?this.getLocation():this.getType()===Q.types.WORKSPACE?null:this.getLocation().getSourceBlock()}next(){switch(this.type){case Q.types.STACK:return this.navigateBetweenStacks(!0);case Q.types.OUTPUT:return Q.createBlockNode(this.location.getSourceBlock());case Q.types.FIELD:return this.findNextForField();case Q.types.INPUT:return this.findNextForInput();case Q.types.BLOCK:const t=this.location.nextConnection;if(!t)break;return Q.createConnectionNode(t);case Q.types.PREVIOUS:return Q.createBlockNode(this.location.getSourceBlock());case Q.types.NEXT:return Q.createConnectionNode(this.location.targetConnection)}return null}in(){switch(this.type){case Q.types.WORKSPACE:const t=this.location.getTopBlocks(!0);if(0<t.length)return Q.createStackNode(t[0]);break;case Q.types.STACK:return this.findTopASTNodeForBlock(this.location);case Q.types.BLOCK:return this.findFirstFieldOrInput(this.location);case Q.types.INPUT:return Q.createConnectionNode(this.location.targetConnection)}return null}prev(){switch(this.type){case Q.types.STACK:return this.navigateBetweenStacks(!1);case Q.types.FIELD:return this.findPrevForField();case Q.types.INPUT:return this.findPrevForInput();case Q.types.BLOCK:var t=zc(this.location);if(!t)break;return Q.createConnectionNode(t);case Q.types.PREVIOUS:if((t=this.location.targetConnection)&&!t.getParentInput())return Q.createConnectionNode(t);break;case Q.types.NEXT:return Q.createBlockNode(this.location.getSourceBlock())}return null}out(){switch(this.type){case Q.types.STACK:var t=this.location,i=t.getRelativeToSurfaceXY();return i=new pt(i.x,i.y+Q.DEFAULT_OFFSET_Y),Q.createWorkspaceNode(t.workspace,i);case Q.types.OUTPUT:return t=this.location,(i=t.targetConnection)?Q.createConnectionNode(i):Q.createStackNode(t.getSourceBlock());case Q.types.FIELD:if(t=this.location.getSourceBlock(),!t)throw Error("The current AST location is not associated with a block");return Q.createBlockNode(t);case Q.types.INPUT:return Q.createBlockNode(this.location.getSourceBlock());case Q.types.BLOCK:return this.getOutAstNodeForBlock(this.location);case Q.types.PREVIOUS:return this.getOutAstNodeForBlock(this.location.getSourceBlock());case Q.types.NEXT:return this.getOutAstNodeForBlock(this.location.getSourceBlock())}return null}static isConnectionType(t){switch(t){case Q.types.PREVIOUS:case Q.types.NEXT:case Q.types.INPUT:case Q.types.OUTPUT:return!0}return!1}static createFieldNode(t){return t?new Q(Q.types.FIELD,t):null}static createConnectionNode(t){if(!t)return null;const i=t.type;return i===wt.INPUT_VALUE||i===wt.NEXT_STATEMENT&&t.getParentInput()?Q.createInputNode(t.getParentInput()):i===wt.NEXT_STATEMENT?new Q(Q.types.NEXT,t):i===wt.OUTPUT_VALUE?new Q(Q.types.OUTPUT,t):i===wt.PREVIOUS_STATEMENT?new Q(Q.types.PREVIOUS,t):null}static createInputNode(t){return t&&t.connection?new Q(Q.types.INPUT,t.connection):null}static createBlockNode(t){return t?new Q(Q.types.BLOCK,t):null}static createStackNode(t){return t?new Q(Q.types.STACK,t):null}static createWorkspaceNode(t,i){return i&&t?new Q(Q.types.WORKSPACE,t,{wsCoordinate:i}):null}static createTopNode(t){const i=zc(t);return i?Q.createConnectionNode(i):Q.createBlockNode(t)}};Q.NAVIGATE_ALL_FIELDS=!1,Q.DEFAULT_OFFSET_Y=-20,function(t){t=t.types||(t.types={}),t.FIELD="field",t.BLOCK="block",t.INPUT="input",t.OUTPUT="output",t.NEXT="next",t.PREVIOUS="previous",t.STACK="stack",t.WORKSPACE="workspace"}(Q||(Q={}));var l$=class extends Ws{constructor(t,i,r,c){let u=t?t.workspace.id:void 0;c&&c.getType()===Q.types.WORKSPACE&&(u=c.getLocation().id),super(u),this.type=gl,this.blockId=t==null?void 0:t.id,this.oldNode=r||void 0,this.newNode=c,this.isCursor=i}toJson(){const t=super.toJson();if(this.isCursor===void 0)throw Error("Whether this is a cursor event or not is undefined. Either pass a value to the constructor, or call fromJson");if(!this.newNode)throw Error("The new node is undefined. Either pass a node to the constructor, or call fromJson");return t.isCursor=this.isCursor,t.blockId=this.blockId,t.oldNode=this.oldNode,t.newNode=this.newNode,t}static fromJson(t,i,r){return i=super.fromJson(t,i,r??new l$),i.isCursor=t.isCursor,i.blockId=t.blockId,i.oldNode=t.oldNode,i.newNode=t.newNode,i}};o(rt.EVENT,gl,l$);var gR="blocklyCursor",mR="blocklyMarker",$R=.75,c$=class{constructor(t,i,r){this.workspace=t,this.marker=r,this.markerSvgRect_=this.markerSvgLine_=this.markerInput_=this.markerBlock_=this.svgGroup_=this.markerSvg_=this.currentMarkerSvg=this.parent=null,this.constants_=i,t=this.isCursor()?this.constants_.CURSOR_COLOUR:this.constants_.MARKER_COLOUR,this.colour_=r.colour||t}getSvgRoot(){return this.svgGroup_}getMarker(){return this.marker}isCursor(){return this.marker.type==="cursor"}createDom(){const t=this.isCursor()?gR:mR;return this.svgGroup_=R(D.G,{class:t}),this.createDomInternal_(),this.svgGroup_}setParent_(t){this.isCursor()?(this.parent&&this.parent.setCursorSvg(null),t.setCursorSvg(this.getSvgRoot())):(this.parent&&this.parent.setMarkerSvg(null),t.setMarkerSvg(this.getSvgRoot())),this.parent=t}draw(t,i){if(i){this.constants_=this.workspace.getRenderer().getConstants();var r=this.isCursor()?this.constants_.CURSOR_COLOUR:this.constants_.MARKER_COLOUR;this.colour_=this.marker.colour||r,this.applyColour_(i),this.showAtLocation_(i),this.fireMarkerEvent(t,i),t=this.currentMarkerSvg.childNodes[0],t!==void 0&&t.beginElement&&t.beginElement()}else this.hide()}showAtLocation_(t){const i=t.getLocation().type;t.getType()===Q.types.BLOCK?this.showWithBlock_(t):t.getType()===Q.types.OUTPUT?this.showWithOutput_(t):i===wt.INPUT_VALUE?this.showWithInput_(t):i===wt.NEXT_STATEMENT?this.showWithNext_(t):t.getType()===Q.types.PREVIOUS?this.showWithPrevious_(t):t.getType()===Q.types.FIELD?this.showWithField_(t):t.getType()===Q.types.WORKSPACE?this.showWithCoordinates_(t):t.getType()===Q.types.STACK&&this.showWithStack_(t)}showWithBlockPrevOutput(t){t=t.getSourceBlock();const i=t.width;var r=t.height,c=r*$R;const u=this.constants_.CURSOR_BLOCK_PADDING;t.previousConnection?(r=this.constants_.shapeFor(t.previousConnection),this.positionPrevious_(i,u,c,r)):t.outputConnection?(c=this.constants_.shapeFor(t.outputConnection),this.positionOutput_(i,r,c)):this.positionBlock_(i,u,c),this.setParent_(t),this.showCurrent_()}showWithBlock_(t){this.showWithBlockPrevOutput(t)}showWithPrevious_(t){this.showWithBlockPrevOutput(t)}showWithOutput_(t){this.showWithBlockPrevOutput(t)}showWithCoordinates_(t){var i=t.getWsCoordinate();t=i.x,i=i.y,this.workspace.RTL&&(t-=this.constants_.CURSOR_WS_WIDTH),this.positionLine_(t,i,this.constants_.CURSOR_WS_WIDTH),this.setParent_(this.workspace),this.showCurrent_()}showWithField_(t){t=t.getLocation();const i=t.getSize().width,r=t.getSize().height;this.positionRect_(0,0,i,r),this.setParent_(t),this.showCurrent_()}showWithInput_(t){t=t.getLocation();const i=t.getSourceBlock();this.positionInput_(t),this.setParent_(i),this.showCurrent_()}showWithNext_(t){var i=t.getLocation();t=i.getSourceBlock();let r=0;i=i.getOffsetInBlock().y;const c=t.getHeightWidth().width;this.workspace.RTL&&(r=-c),this.positionLine_(r,i,c),this.setParent_(t),this.showCurrent_()}showWithStack_(t){t=t.getLocation();var i=t.getHeightWidth();const r=i.width+this.constants_.CURSOR_STACK_PADDING;i=i.height+this.constants_.CURSOR_STACK_PADDING;const c=-this.constants_.CURSOR_STACK_PADDING/2,u=-this.constants_.CURSOR_STACK_PADDING/2;let f=c;this.workspace.RTL&&(f=-(r+c)),this.positionRect_(f,u,r,i),this.setParent_(t),this.showCurrent_()}showCurrent_(){this.hide(),this.currentMarkerSvg&&(this.currentMarkerSvg.style.display="")}positionBlock_(t,i,r){if(t=Ne(-i,r)+It("V",-i)+It("H",t+2*i)+It("V",r),!this.markerBlock_)throw Error("createDom should be called before positioning the marker");this.markerBlock_.setAttribute("d",t),this.workspace.RTL&&this.flipRtl(this.markerBlock_),this.currentMarkerSvg=this.markerBlock_}positionInput_(t){const i=t.getOffsetInBlock().x,r=t.getOffsetInBlock().y;t=ei(0,0)+this.constants_.shapeFor(t).pathDown,this.markerInput_.setAttribute("d",t),this.markerInput_.setAttribute("transform","translate("+i+","+r+")"+(this.workspace.RTL?" scale(-1 1)":"")),this.currentMarkerSvg=this.markerInput_}positionLine_(t,i,r){if(!this.markerSvgLine_)throw Error("createDom should be called before positioning the line");this.markerSvgLine_.setAttribute("x",`${t}`),this.markerSvgLine_.setAttribute("y",`${i}`),this.markerSvgLine_.setAttribute("width",`${r}`),this.currentMarkerSvg=this.markerSvgLine_}positionOutput_(t,i,r){if(!this.markerBlock_)throw Error("createDom should be called before positioning the output");t=Ne(t,0)+It("h",-(t-r.width))+It("v",this.constants_.TAB_OFFSET_FROM_TOP)+r.pathDown+It("V",i)+It("H",t),this.markerBlock_.setAttribute("d",t),this.workspace.RTL&&this.flipRtl(this.markerBlock_),this.currentMarkerSvg=this.markerBlock_}positionPrevious_(t,i,r,c){if(!this.markerBlock_)throw Error("createDom should be called before positioning the previous connection marker");t=Ne(-i,r)+It("V",-i)+It("H",this.constants_.NOTCH_OFFSET_LEFT)+c.pathLeft+It("H",t+2*i)+It("V",r),this.markerBlock_.setAttribute("d",t),this.workspace.RTL&&this.flipRtl(this.markerBlock_),this.currentMarkerSvg=this.markerBlock_}positionRect_(t,i,r,c){if(!this.markerSvgRect_)throw Error("createDom should be called before positioning the rect");this.markerSvgRect_.setAttribute("x",`${t}`),this.markerSvgRect_.setAttribute("y",`${i}`),this.markerSvgRect_.setAttribute("width",`${r}`),this.markerSvgRect_.setAttribute("height",`${c}`),this.currentMarkerSvg=this.markerSvgRect_}flipRtl(t){t.setAttribute("transform","scale(-1 1)")}hide(){if(!(this.markerSvgLine_&&this.markerSvgRect_&&this.markerInput_&&this.markerBlock_))throw Error("createDom should be called before hiding the marker");this.markerSvgLine_.style.display="none",this.markerSvgRect_.style.display="none",this.markerInput_.style.display="none",this.markerBlock_.style.display="none"}fireMarkerEvent(t,i){const r=i.getSourceBlock();t=new(ut(gl))(r,this.isCursor(),t,i),it(t)}getBlinkProperties_(){return{attributeType:"XML",attributeName:"fill",dur:"1s",values:this.colour_+";transparent;transparent;",repeatCount:"indefinite"}}createDomInternal_(){if(this.markerSvg_=R(D.G,{width:this.constants_.CURSOR_WS_WIDTH,height:this.constants_.WS_CURSOR_HEIGHT},this.svgGroup_),this.markerSvgLine_=R(D.RECT,{width:this.constants_.CURSOR_WS_WIDTH,height:this.constants_.WS_CURSOR_HEIGHT},this.markerSvg_),this.markerSvgRect_=R(D.RECT,{class:"blocklyVerticalMarker",rx:10,ry:10},this.markerSvg_),this.markerInput_=R(D.PATH,{transform:""},this.markerSvg_),this.markerBlock_=R(D.PATH,{transform:"",fill:"none","stroke-width":this.constants_.CURSOR_STROKE_WIDTH},this.markerSvg_),this.hide(),this.isCursor()){const t=this.getBlinkProperties_();R(D.ANIMATE,t,this.markerSvgLine_),R(D.ANIMATE,t,this.markerInput_),R(D.ANIMATE,Object.assign({},t,{attributeName:"stroke"}),this.markerBlock_)}return this.markerSvg_}applyColour_(t){if(!(this.markerSvgLine_&&this.markerSvgRect_&&this.markerInput_&&this.markerBlock_))throw Error("createDom should be called before applying color to the markerj");this.markerSvgLine_.setAttribute("fill",this.colour_),this.markerSvgRect_.setAttribute("stroke",this.colour_),this.markerInput_.setAttribute("fill",this.colour_),this.markerBlock_.setAttribute("stroke",this.colour_),this.isCursor()&&(t=this.colour_+";transparent;transparent;",this.markerSvgLine_.firstElementChild.setAttribute("values",t),this.markerInput_.firstElementChild.setAttribute("values",t),this.markerBlock_.firstElementChild.setAttribute("values",t))}dispose(){this.svgGroup_&&Ct(this.svgGroup_)}},od=class{constructor(t,i,r){this.markerSvg=this.cursorSvg=null,this.constants=r,this.style=i,this.svgRoot=t,this.svgPath=R(D.PATH,{class:"blocklyPath"},this.svgRoot)}setPath(t){this.svgPath.setAttribute("d",t)}flipRTL(){this.svgPath.setAttribute("transform","scale(-1 1)")}setCursorSvg(t){t?(this.svgRoot.appendChild(t),this.cursorSvg=t):this.cursorSvg=null}setMarkerSvg(t){t?(this.cursorSvg?this.svgRoot.insertBefore(t,this.cursorSvg):this.svgRoot.appendChild(t),this.markerSvg=t):this.markerSvg=null}applyColour(t){this.svgPath.setAttribute("stroke",this.style.colourTertiary),this.svgPath.setAttribute("fill",this.style.colourPrimary),this.updateShadow_(t.isShadow()),this.updateDisabled_(!t.isEnabled()||t.getInheritedDisabled())}setStyle(t){this.style=t}setClass_(t,i){t&&(i?J(this.svgRoot,t):mt(this.svgRoot,t))}updateHighlighted(t){t?this.svgPath.setAttribute("filter","url(#"+this.constants.embossFilterId+")"):this.svgPath.setAttribute("filter","none")}updateShadow_(t){t&&(this.svgPath.setAttribute("stroke","none"),this.svgPath.setAttribute("fill",this.style.colourSecondary))}updateDisabled_(t){this.setClass_("blocklyDisabled",t),t&&this.svgPath.setAttribute("fill","url(#"+this.constants.disabledPatternId+")")}updateSelected(t){this.setClass_("blocklySelected",t)}updateDraggingDelete(t){this.setClass_("blocklyDraggingDelete",t)}updateInsertionMarker(t){this.setClass_("blocklyInsertionMarker",t)}updateMovable(t){this.setClass_("blocklyDraggable",t)}updateReplacementFade(t){this.setClass_("blocklyReplaceable",t)}updateShapeForInputHighlight(t,i){}},re=class{constructor(t,i){this.type=i,this.targetConnection=null,this.disposed=!1,this.shadowDom=this.check=null,this.y=this.x=0,this.shadowState=null,this.sourceBlock_=t}connect_(t){const i=wt.INPUT_VALUE,r=this.getSourceBlock();var c=t.getSourceBlock();t.isConnected()&&t.disconnectInternal(!1);let u;if(this.isConnected()){const E=this.stashShadowState(),S=this.targetBlock();S.isShadow()?S.dispose(!1):(this.disconnectInternal(),u=S),this.applyShadowState(E)}let f;Lt()&&(f=new(ut(s.MOVE$$module$build$src$core$events$utils))(c),f.setReason(["connect"])),Qv(this,t),c.setParent(r),f&&(f.recordNew(),it(f)),u&&(t=this.type===i?u.outputConnection:u.previousConnection)&&((c=re.getConnectionForOrphanedConnection(c,t))?t.connect(c):t.onFailedConnect(this))}dispose(){if(this.isConnected()){this.setShadowStateInternal();const t=this.targetBlock();t&&!t.isDeadOrDying()&&t.unplug()}this.disposed=!0}getSourceBlock(){return this.sourceBlock_}isSuperior(){return this.type===wt.INPUT_VALUE||this.type===wt.NEXT_STATEMENT}isConnected(){return!!this.targetConnection}getConnectionChecker(){return this.sourceBlock_.workspace.connectionChecker}onFailedConnect(t){}connect(t){if(this.targetConnection===t)return!0;if(this.getConnectionChecker().canConnect(this,t,!1)){const i=s.getGroup$$module$build$src$core$events$utils();i||s.setGroup$$module$build$src$core$events$utils(!0),this.isSuperior()?this.connect_(t):t.connect_(this),s.setGroup$$module$build$src$core$events$utils(i)}return this.isConnected()}disconnect(){this.disconnectInternal()}disconnectInternal(t=!0){const{parentConnection:i,childConnection:r}=this.getParentAndChildConnections();if(!i||!r)throw Error("Source connection not connected.");const c=s.getGroup$$module$build$src$core$events$utils();c||s.setGroup$$module$build$src$core$events$utils(!0);let u;Lt()&&(u=new(ut(s.MOVE$$module$build$src$core$events$utils))(r.getSourceBlock()),u.setReason(["disconnect"]));const f=this.targetConnection;f&&(f.targetConnection=null),this.targetConnection=null,t&&r.getSourceBlock().setParent(null),u&&(u.recordNew(),it(u)),r.getSourceBlock().isShadow()||i.respawnShadow_(),s.setGroup$$module$build$src$core$events$utils(c)}getParentAndChildConnections(){return this.targetConnection?this.isSuperior()?{parentConnection:this,childConnection:this.targetConnection}:{parentConnection:this.targetConnection,childConnection:this}:{}}respawnShadow_(){this.createShadowBlock(!0)}reconnect(t,i){if(this.getSourceBlock().isDeadOrDying())return!1;var r;return i=(r=t.getInput(i))==null?void 0:r.connection,r=this.targetBlock(),r&&r!==t||!i||i.targetConnection===this?!1:(i.isConnected()&&i.disconnect(),i.connect(this),!0)}targetBlock(){if(this.isConnected()){let t,i;return(i=(t=this.targetConnection)==null?void 0:t.getSourceBlock())!=null?i:null}return null}onCheckChanged_(){!this.isConnected()||this.targetConnection&&this.getConnectionChecker().canConnect(this,this.targetConnection,!1)||(this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug()}setCheck(t){return t?(Array.isArray(t)||(t=[t]),this.check=t,this.onCheckChanged_()):this.check=null,this}getCheck(){return this.check}setShadowDom(t){this.setShadowStateInternal({shadowDom:t})}getShadowDom(t){return t&&this.targetBlock().isShadow()?on(this.targetBlock()):this.shadowDom}setShadowState(t){this.setShadowStateInternal({shadowState:t})}getShadowState(t){return t&&this.targetBlock()&&this.targetBlock().isShadow()?Us(this.targetBlock()):this.shadowState}neighbours(t){return[]}getParentInput(){let t=null;const i=this.sourceBlock_.inputList;for(let r=0;r<i.length;r++)if(i[r].connection===this){t=i[r];break}return t}toString(){const t=this.sourceBlock_;if(!t)return"Orphan Connection";if(t.outputConnection===this)var i="Output Connection of ";else if(t.previousConnection===this)i="Previous Connection of ";else if(t.nextConnection===this)i="Next Connection of ";else{i=null;for(let r=0,c;c=t.inputList[r];r++)if(c.connection===this){i=c;break}if(i)i='Input "'+i.name+'" connection on ';else return console.warn("Connection not actually connected to sourceBlock_"),"Orphan Connection"}return i+t.toDevString()}stashShadowState(){const t=this.getShadowDom(!0),i=this.getShadowState(!0);return this.shadowState=this.shadowDom=null,{shadowDom:t,shadowState:i}}applyShadowState({shadowDom:t,shadowState:i}){this.shadowDom=t,this.shadowState=i}setShadowStateInternal({shadowDom:t=null,shadowState:i=null}={}){this.shadowDom=t,this.shadowState=i,(t=this.targetBlock())?t.isShadow()?(t.dispose(!1),this.getSourceBlock().isDeadOrDying()||(this.respawnShadow_(),this.targetBlock()&&this.targetBlock().isShadow()&&this.serializeShadow(this.targetBlock()))):(t=this.createShadowBlock(!1),this.serializeShadow(t),t&&t.dispose(!1)):(this.respawnShadow_(),this.targetBlock()&&this.targetBlock().isShadow()&&this.serializeShadow(this.targetBlock()))}createShadowBlock(t){var i=this.getSourceBlock();const r=this.getShadowState(),c=this.getShadowDom();if(i.isDeadOrDying()||!r&&!c)return null;if(r)return i=Qr(r,i.workspace,{parentConnection:t?this:void 0,isShadow:!0,recordUndo:!1});if(c){if(i=nn(c,i.workspace),t)if(this.type===wt.INPUT_VALUE){if(!i.outputConnection)throw Error("Shadow block is missing an output connection");if(!this.connect(i.outputConnection))throw Error("Could not connect shadow block to connection")}else if(this.type===wt.NEXT_STATEMENT){if(!i.previousConnection)throw Error("Shadow block is missing previous connection");if(!this.connect(i.previousConnection))throw Error("Could not connect shadow block to connection")}else throw Error("Cannot connect a shadow block to a previous/output connection");return i}return null}serializeShadow(t){t&&(this.shadowDom=on(t),this.shadowState=Us(t))}static getConnectionForOrphanedConnection(t,i){if(i.type===wt.OUTPUT_VALUE)return ey(t,i.getSourceBlock());t=t.lastConnectionInStack(!0);const r=i.getConnectionChecker();return t&&r.canConnect(i,t,!1)?t:null}};re.CAN_CONNECT=0,re.REASON_SELF_CONNECTION=1,re.REASON_WRONG_TYPE=2,re.REASON_TARGET_NULL=3,re.REASON_CHECKS_FAILED=4,re.REASON_DIFFERENT_WORKSPACES=5,re.REASON_SHADOW_PARENT=6,re.REASON_DRAG_CHECKS_FAILED=7,re.REASON_PREVIOUS_AND_OUTPUT=8;var Pl="_TEMP_COLLAPSED_INPUT",nd="_TEMP_COLLAPSED_FIELD",_R={COLLAPSED_FIELD_NAME:nd,COLLAPSED_INPUT_NAME:Pl},LI="The insertion marker manager tried to create a marker but the result is missing %1. If you are using a mutator, make sure your domToMutation method is properly defined.",qi=class{constructor(t){this.activeCandidate=this.lastMarker=this.lastOnStack=null,this.wouldDeleteBlock=!1,this.fadedBlock=this.highlightedBlock=this.markerConnection=null,X(t),this.topBlock=t,this.workspace=t.workspace,this.firstMarker=this.createMarkerBlock(this.topBlock),this.availableConnections=this.initAvailableConnections(),this.lastOnStack&&(this.lastMarker=this.createMarkerBlock(this.lastOnStack.getSourceBlock()))}dispose(){this.availableConnections.length=0,this.disposeInsertionMarker(this.firstMarker),this.disposeInsertionMarker(this.lastMarker)}updateAvailableConnections(){this.availableConnections=this.initAvailableConnections()}wouldConnectBlock(){return!!this.activeCandidate}applyConnections(){if(this.activeCandidate){s.disable$$module$build$src$core$events$utils(),this.hidePreview(),s.enable$$module$build$src$core$events$utils();var{local:t,closest:i}=this.activeCandidate;if(t.connect(i),this.topBlock.rendered){const r=t.isSuperior()?i:t,c=this.topBlock.getRootBlock();Pc().then(()=>{Yf(r.getSourceBlock()),setTimeout(()=>{c.bringToFront()},0)})}}}update(t,i){const r=this.getCandidate(t);((this.wouldDeleteBlock=this.shouldDelete(!!r,i))||this.shouldUpdatePreviews(r,t))&&(s.disable$$module$build$src$core$events$utils(),this.maybeHidePreview(r),this.maybeShowPreview(r),s.enable$$module$build$src$core$events$utils())}createMarkerBlock(t){var i=t.type;s.disable$$module$build$src$core$events$utils();let r;try{if(r=this.workspace.newBlock(i),r.setInsertionMarker(!0),t.saveExtraState){var c=t.saveExtraState(!0);c&&r.loadExtraState&&r.loadExtraState(c)}else if(t.mutationToDom){const u=t.mutationToDom();u&&r.domToMutation&&r.domToMutation(u)}for(i=0;i<t.inputList.length;i++){const u=t.inputList[i];if(u.name===Pl)continue;const f=r.inputList[i];if(!f)throw Error(LI.replace("%1","an input"));for(c=0;c<u.fieldRow.length;c++){const E=u.fieldRow[c],S=f.fieldRow[c];if(!S)throw Error(LI.replace("%1","a field"));S.setValue(E.getValue())}}for(const u of r.getDescendants(!1))u.setInsertionMarker(!0);r.setCollapsed(t.isCollapsed()),r.setInputsInline(t.getInputsInline()),r.initSvg(),r.getSvgRoot().setAttribute("visibility","hidden")}finally{s.enable$$module$build$src$core$events$utils()}return r}initAvailableConnections(){const t=this.topBlock.getConnections_(!1),i=this.topBlock.lastConnectionInStack(!0);return i&&i!==this.topBlock.nextConnection&&(t.push(i),this.lastOnStack=i),t}shouldUpdatePreviews(t,i){if(!t)return!!this.activeCandidate;if(!this.activeCandidate)return!0;const{local:r,closest:c}=this.activeCandidate;if(c===t.closest&&r===t.local)return!1;const u=r.x+i.x-c.x;return i=r.y+i.y-c.y,t.radius<Math.sqrt(u*u+i*i)-s.config$$module$build$src$core$config.currentConnectionPreference}getCandidate(t){this.markerConnection&&this.markerConnection.isConnected()||this.updateAvailableConnections();let i=this.getStartRadius(),r=null;for(let c=0;c<this.availableConnections.length;c++){const u=this.availableConnections[c],f=u.closest(i,t);f.connection&&(r={closest:f.connection,local:u,radius:f.radius},i=f.radius)}return r}getStartRadius(){return this.activeCandidate?s.config$$module$build$src$core$config.connectingSnapRadius:s.config$$module$build$src$core$config.snapRadius}shouldDelete(t,i){return i&&this.workspace.getComponentManager().hasCapability(i.id,je.Capability.DELETE_AREA)?i.wouldDelete(this.topBlock,t):!1}maybeShowPreview(t){if(!this.wouldDeleteBlock&&t){var i=t.closest,r;i===((r=this.activeCandidate)==null?void 0:r.closest)||i.getSourceBlock().isInsertionMarker()?console.log("Trying to connect to an insertion marker"):(this.activeCandidate=t,this.showPreview(this.activeCandidate))}}showPreview(t){const i=this.workspace.getRenderer();switch(i.getConnectionPreviewMethod(t.closest,t.local,this.topBlock)){case qi.PREVIEW_TYPE.INPUT_OUTLINE:this.showInsertionInputOutline(t);break;case qi.PREVIEW_TYPE.INSERTION_MARKER:this.showInsertionMarker(t);break;case qi.PREVIEW_TYPE.REPLACEMENT_FADE:this.showReplacementFade(t)}i.shouldHighlightConnection(t.closest)&&t.closest.highlight()}maybeHidePreview(t){if(!t)this.hidePreview();else if(this.activeCandidate){const i=this.activeCandidate.local!==t.local;(this.activeCandidate.closest!==t.closest||i||this.wouldDeleteBlock)&&this.hidePreview()}this.activeCandidate=this.markerConnection=null}hidePreview(){let t;const i=(t=this.activeCandidate)==null?void 0:t.closest;i&&i.targetBlock()&&this.workspace.getRenderer().shouldHighlightConnection(i)&&i.unhighlight(),this.hideReplacementFade(),this.hideInsertionInputOutline(),this.hideInsertionMarker()}showInsertionMarker(t){const{local:i,closest:r}=t;let c=(t=this.lastOnStack&&i===this.lastOnStack)?this.lastMarker:this.firstMarker;if(!c)throw Error("Cannot show the insertion marker because there is no insertion marker block");let u;try{u=c.getMatchingConnection(i.getSourceBlock(),i)}catch{if(t&&this.lastOnStack?(this.disposeInsertionMarker(this.lastMarker),c=this.lastMarker=this.createMarkerBlock(this.lastOnStack.getSourceBlock())):(this.disposeInsertionMarker(this.firstMarker),c=this.firstMarker=this.createMarkerBlock(this.topBlock)),!c)throw Error("Cannot show the insertion marker because there is no insertion marker block");u=c.getMatchingConnection(i.getSourceBlock(),i)}if(!u)throw Error("Cannot show the insertion marker because there is no associated connection");if(u===this.markerConnection)throw Error("Made it to showInsertionMarker_ even though the marker isn't changing");c.queueRender(),Bs(),u.connect(r);const f={x:r.x-u.x,y:r.y-u.y},E=u.getOffsetInBlock().clone(),S=u;Pc().then(()=>{let W;(W=c)==null||W.positionNearConnection(S,f,E);let bt;(bt=c)==null||bt.getSvgRoot().setAttribute("visibility","visible")}),this.markerConnection=u}hideInsertionMarker(){if(this.markerConnection){var t=this.markerConnection,i=t.getSourceBlock(),r=i.outputConnection,c;if((c=i.previousConnection)!=null&&c.targetConnection||r!=null&&r.targetConnection)i.unplug(!0);else{let u;(u=t.targetBlock())==null||u.unplug(!1)}if(t.targetConnection)throw Error("markerConnection still connected at the end of disconnectInsertionMarker");this.markerConnection=null,(t=i.getSvgRoot())&&t.setAttribute("visibility","hidden")}}showInsertionInputOutline(t){t=t.closest,this.highlightedBlock=t.getSourceBlock(),this.highlightedBlock.highlightShapeForInput(t,!0)}hideInsertionInputOutline(){if(this.highlightedBlock){if(!this.activeCandidate)throw Error("Cannot hide the insertion marker outline because there is no active candidate");this.highlightedBlock.highlightShapeForInput(this.activeCandidate.closest,!1),this.highlightedBlock=null}}showReplacementFade(t){if(this.fadedBlock=t.closest.targetBlock(),!this.fadedBlock)throw Error("Cannot show the replacement fade because the closest connection does not have a target block");this.fadedBlock.fadeForReplacement(!0)}hideReplacementFade(){this.fadedBlock&&(this.fadedBlock.fadeForReplacement(!1),this.fadedBlock=null)}getInsertionMarkers(){const t=[];return this.firstMarker&&t.push(this.firstMarker),this.lastMarker&&t.push(this.lastMarker),t}disposeInsertionMarker(t){if(t){s.disable$$module$build$src$core$events$utils();try{t.dispose()}finally{s.enable$$module$build$src$core$events$utils()}}}};(function(t){t=t.PREVIEW_TYPE||(t.PREVIEW_TYPE={}),t[t.INSERTION_MARKER=0]="INSERTION_MARKER",t[t.INPUT_OUTLINE=1]="INPUT_OUTLINE",t[t.REPLACEMENT_FADE=2]="REPLACEMENT_FADE"})(qi||(qi={})),qi.PREVIEW_TYPE;var $a=class{constructor(t){this.overrides=null,this.name=t}getClassName(){return this.name+"-renderer"}init(t,i){this.constants_=this.makeConstants_(),i&&(this.overrides=i,Object.assign(this.constants_,i)),this.constants_.setTheme(t),this.constants_.init()}createDom(t,i){this.constants_.createDom(t,this.name+"-"+i.name,"."+this.getClassName()+"."+i.getClassName())}refreshDom(t,i){const r=this.getConstants();r.dispose(),this.constants_=this.makeConstants_(),this.overrides&&Object.assign(this.constants_,this.overrides),this.constants_.randomIdentifier=r.randomIdentifier,this.constants_.setTheme(i),this.constants_.init(),this.createDom(t,i)}dispose(){this.constants_&&this.constants_.dispose()}makeConstants_(){return new ga}makeRenderInfo_(t){return new Dl(this,t)}makeDrawer_(t,i){return new ma(t,i)}makeMarkerDrawer(t,i){return new c$(t,this.getConstants(),i)}makePathObject(t,i){return new od(t,i,this.constants_)}getConstants(){return this.constants_}shouldHighlightConnection(t){return!0}orphanCanConnectAtEnd(t,i,r){return!!re.getConnectionForOrphanedConnection(t,r===wt.OUTPUT_VALUE?i.outputConnection:i.previousConnection)}getConnectionPreviewMethod(t,i,r){return i.type===wt.OUTPUT_VALUE||i.type===wt.PREVIOUS_STATEMENT?!t.isConnected()||this.orphanCanConnectAtEnd(r,t.targetBlock(),i.type)?qi.PREVIEW_TYPE.INSERTION_MARKER:qi.PREVIEW_TYPE.REPLACEMENT_FADE:qi.PREVIEW_TYPE.INSERTION_MARKER}render(t){const i=this.makeRenderInfo_(t);i.measure(),this.makeDrawer_(t,i).draw()}},de={};de.BottomRow=e$,de.Connection=yr,de.ConstantProvider=ga,de.Drawer=ma,de.ExternalValueInput=sd,de.Field=xl,de.Hat=i$,de.Icon=CI,de.InRowSpacer=ji,de.InlineInput=s$,de.InputConnection=bn,de.InputRow=o$,de.JaggedEdge=wI,de.MarkerSvg=c$,de.Measurable=qs,de.NextConnection=kI,de.OutputConnection=OI,de.PathObject=od,de.PreviousConnection=AI,de.RenderInfo=Dl,de.Renderer=$a,de.RoundCorner=pa,de.Row=ua,de.SpacerRow=n$,de.SquareCorner=fa,de.StatementInput=da,de.TopRow=r$,de.Types=x,de.init=bg,de.register=hl,de.unregister=iy;var MI=class{constructor(t,i){this.workspace=t,this.theme=i,this.subscribedWorkspaces_=[],this.componentDB=new Map}getTheme(){return this.theme}setTheme(t){var i=this.theme;this.theme=t,(t=this.workspace.getInjectionDiv())&&(i&&(i=i.getClassName())&&mt(t,i),(i=this.theme.getClassName())&&J(t,i));for(let r=0,c;c=this.subscribedWorkspaces_[r];r++)c.refreshTheme();for(const[r,c]of this.componentDB)for(const u of c){t=u.element,i=u.propertyName;const f=this.theme&&this.theme.getComponentStyle(r);t.style.setProperty(i,f||"")}for(const r of this.subscribedWorkspaces_)r.hideChaff()}subscribeWorkspace(t){this.subscribedWorkspaces_.push(t)}unsubscribeWorkspace(t){if(!ht(this.subscribedWorkspaces_,t))throw Error("Cannot unsubscribe a workspace that hasn't been subscribed.")}subscribe(t,i,r){this.componentDB.has(i)||this.componentDB.set(i,[]),this.componentDB.get(i).push({element:t,propertyName:r}),i=this.theme&&this.theme.getComponentStyle(i),t.style.setProperty(r,i||"")}unsubscribe(t){if(t)for(const[i,r]of this.componentDB){for(let c=r.length-1;0<=c;c--)r[c].element===t&&r.splice(c,1);r.length||this.componentDB.delete(i)}}dispose(){this.subscribedWorkspaces_.length=0,this.componentDB.clear()}},a$="VARIABLE_DYNAMIC",Sr={CATEGORY_NAME:a$};Sr.flyoutCategory=yu,Sr.flyoutCategoryBlocks=Ig,Sr.onCreateVariableButtonClick_Colour=yg,Sr.onCreateVariableButtonClick_Number=vg,Sr.onCreateVariableButtonClick_String=Eg;var xI=class{canConnect(t,i,r,c){return this.canConnectWithReason(t,i,r,c)===re.CAN_CONNECT}canConnectWithReason(t,i,r,c){const u=this.doSafetyChecks(t,i);return u!==re.CAN_CONNECT?u:this.doTypeChecks(t,i)?r&&!this.doDragChecks(t,i,c||0)?re.REASON_DRAG_CHECKS_FAILED:re.CAN_CONNECT:re.REASON_CHECKS_FAILED}getErrorMessage(t,i,r){switch(t){case re.REASON_SELF_CONNECTION:return"Attempted to connect a block to itself.";case re.REASON_DIFFERENT_WORKSPACES:return"Blocks not on same workspace.";case re.REASON_WRONG_TYPE:return"Attempt to connect incompatible types.";case re.REASON_TARGET_NULL:return"Target connection is null.";case re.REASON_CHECKS_FAILED:return"Connection checks failed. "+(i+" expected "+i.getCheck()+", found "+r.getCheck());case re.REASON_SHADOW_PARENT:return"Connecting non-shadow to shadow block.";case re.REASON_DRAG_CHECKS_FAILED:return"Drag checks failed.";case re.REASON_PREVIOUS_AND_OUTPUT:return"Block would have an output and a previous connection.";default:return"Unknown connection failure: this should never happen!"}}doSafetyChecks(t,i){if(!t||!i)return re.REASON_TARGET_NULL;let r,c,u;return t.isSuperior()?(r=t.getSourceBlock(),c=i.getSourceBlock(),u=i):(c=t.getSourceBlock(),r=i.getSourceBlock(),u=t,t=i),r===c?re.REASON_SELF_CONNECTION:u.type!==_r[t.type]?re.REASON_WRONG_TYPE:r.workspace!==c.workspace?re.REASON_DIFFERENT_WORKSPACES:r.isShadow()&&!c.isShadow()?re.REASON_SHADOW_PARENT:u.type===wt.OUTPUT_VALUE&&c.previousConnection&&c.previousConnection.isConnected()||u.type===wt.PREVIOUS_STATEMENT&&c.outputConnection&&c.outputConnection.isConnected()?re.REASON_PREVIOUS_AND_OUTPUT:re.CAN_CONNECT}doTypeChecks(t,i){if(t=t.getCheck(),i=i.getCheck(),!t||!i)return!0;for(let r=0;r<t.length;r++)if(i.indexOf(t[r])!==-1)return!0;return!1}doDragChecks(t,i,r){if(t.distanceFrom(i)>r||i.getSourceBlock().isInsertionMarker())return!1;switch(i.type){case wt.PREVIOUS_STATEMENT:return this.canConnectToPrevious_(t,i);case wt.OUTPUT_VALUE:if(i.isConnected()&&!i.targetBlock().isInsertionMarker()||t.isConnected())return!1;break;case wt.INPUT_VALUE:if(i.isConnected()&&!i.targetBlock().isMovable()&&!i.targetBlock().isShadow())return!1;break;case wt.NEXT_STATEMENT:if(i.isConnected()&&!t.getSourceBlock().nextConnection&&!i.targetBlock().isShadow()&&i.targetBlock().nextConnection||i.targetBlock()&&!i.targetBlock().isMovable()&&!i.targetBlock().isShadow())return!1;break;default:return!1}return dl.indexOf(i)===-1}canConnectToPrevious_(t,i){return t.targetConnection||dl.indexOf(i)!==-1?!1:i.targetConnection?(t=i.targetBlock(),t.isInsertionMarker()?!t.getPreviousBlock():!1):!0}};o(rt.CONNECTION_CHECKER,Co,xI);var h$=class extends Zc{constructor(t){super(t),this.type=sr,t&&(this.varType=t.type,this.varName=t.name)}toJson(){const t=super.toJson();if(this.varType===void 0)throw Error("The var type is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");return t.varType=this.varType,t.varName=this.varName,t}static fromJson(t,i,r){return i=super.fromJson(t,i,r??new h$),i.varType=t.varType,i.varName=t.varName,i}run(t){const i=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.varName)throw Error("The var name is undefined. Either pass a variable to the constructor, or call fromJson");t?i.deleteVariableById(this.varId):i.createVariable(this.varName,this.varType,this.varId)}};o(rt.EVENT,sr,h$);var u$=class extends Zc{constructor(t,i){super(t),this.type=fl,t&&(this.oldName=t.name,this.newName=typeof i>"u"?"":i)}toJson(){const t=super.toJson();if(!this.oldName)throw Error("The old var name is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.newName)throw Error("The new var name is undefined. Either pass a value to the constructor, or call fromJson");return t.oldName=this.oldName,t.newName=this.newName,t}static fromJson(t,i,r){return i=super.fromJson(t,i,r??new u$),i.oldName=t.oldName,i.newName=t.newName,i}run(t){const i=this.getEventWorkspace_();if(!this.varId)throw Error("The var ID is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.oldName)throw Error("The old var name is undefined. Either pass a variable to the constructor, or call fromJson");if(!this.newName)throw Error("The new var name is undefined. Either pass a value to the constructor, or call fromJson");t?i.renameVariableById(this.varId,this.newName):i.renameVariableById(this.varId,this.oldName)}};o(rt.EVENT,fl,u$);var d$=class{constructor(t){this.workspace=t,this.variableMap=new Map}clear(){for(const t of this.variableMap.values())for(;0<t.length;)this.deleteVariable(t[0]);if(this.variableMap.size!==0)throw Error("Non-empty variable map")}renameVariable(t,i){if(t.name!==i){var r=this.getVariable(i,t.type),c=this.workspace.getAllBlocks(!1),u=s.getGroup$$module$build$src$core$events$utils();u||s.setGroup$$module$build$src$core$events$utils(!0);try{r&&r.getId()!==t.getId()?this.renameVariableWithConflict_(t,i,r,c):this.renameVariableAndUses_(t,i,c)}finally{s.setGroup$$module$build$src$core$events$utils(u)}}}renameVariableById(t,i){const r=this.getVariableById(t);if(!r)throw Error("Tried to rename a variable that didn't exist. ID: "+t);this.renameVariable(r,i)}renameVariableAndUses_(t,i,r){for(it(new(ut(fl))(t,i)),t.name=i,i=0;i<r.length;i++)r[i].updateVarName(t)}renameVariableWithConflict_(t,i,r,c){const u=t.type;for(i!==r.name&&this.renameVariableAndUses_(r,i,c),i=0;i<c.length;i++)c[i].renameVarById(t.getId(),r.getId());it(new(ut(sr))(t)),ht(this.variableMap.get(u),t)}createVariable(t,i,r){var c=this.getVariable(t,i);if(c){if(r&&c.getId()!==r)throw Error('Variable "'+t+'" is already in use and its id is "'+c.getId()+'" which conflicts with the passed in id, "'+r+'".');return c}if(r&&this.getVariableById(r))throw Error('Variable id, "'+r+'", is already in use.');return c=r||ct(),i=i||"",c=new Qc(this.workspace,t,i,c),t=this.variableMap.get(i)||[],t.push(c),this.variableMap.delete(i),this.variableMap.set(i,t),it(new(ut(dn))(c)),c}deleteVariable(t){const i=t.getId(),r=this.variableMap.get(t.type);if(r){for(let c=0;c<r.length;c++)if(r[c].getId()===i){r.splice(c,1),it(new(ut(sr))(t)),r.length===0&&this.variableMap.delete(t.type);break}}}deleteVariableById(t){const i=this.getVariableById(t);if(i){var r=i.name;const c=this.getVariableUsesById(t);for(let u=0,f;f=c[u];u++)if(f.type==="procedures_defnoreturn"||f.type==="procedures_defreturn"){t=String(f.getFieldValue("NAME")),r=s.Msg$$module$build$src$core$msg.CANNOT_DELETE_VARIABLE_PROCEDURE.replace("%1",r).replace("%2",t),Dc(r);return}1<c.length?(r=s.Msg$$module$build$src$core$msg.DELETE_VARIABLE_CONFIRMATION.replace("%1",String(c.length)).replace("%2",r),Kh(r,u=>{u&&i&&this.deleteVariableInternal(i,c)})):this.deleteVariableInternal(i,c)}else console.warn("Can't delete non-existent variable: "+t)}deleteVariableInternal(t,i){const r=s.getGroup$$module$build$src$core$events$utils();r||s.setGroup$$module$build$src$core$events$utils(!0);try{for(let c=0;c<i.length;c++)i[c].dispose(!0);this.deleteVariable(t)}finally{s.setGroup$$module$build$src$core$events$utils(r)}}getVariable(t,i){if(i=this.variableMap.get(i||"")){for(let r=0,c;c=i[r];r++)if(s.Names$$module$build$src$core$names.equals(c.name,t))return c}return null}getVariableById(t){for(const i of this.variableMap.values())for(const r of i)if(r.getId()===t)return r;return null}getVariablesOfType(t){return(t=this.variableMap.get(t||""))?t.slice():[]}getVariableTypes(t){const i=new Set(this.variableMap.keys());if(t&&t.getPotentialVariableMap())for(const r of t.getPotentialVariableMap().variableMap.keys())i.add(r);return i.has("")||i.add(""),Array.from(i.values())}getAllVariables(){let t=[];for(const i of this.variableMap.values())t=t.concat(i);return t}getAllVariableNames(){return Array.from(this.variableMap.values()).flat().map(t=>t.name)}getVariableUsesById(t){const i=[],r=this.workspace.getAllBlocks(!1);for(let c=0;c<r.length;c++){const u=r[c].getVarModels();if(u)for(let f=0;f<u.length;f++)u[f].getId()===t&&i.push(r[c])}return i}},_a=class{get isFlyout(){return this.internalIsFlyout}get isMutator(){return this.internalIsMutator}constructor(t){this.isClearing=this.internalIsMutator=this.internalIsFlyout=this.rendered=!1,this.MAX_UNDO=1024,this.connectionDBList=[],this.topBlocks=[],this.topComments=[],this.commentDB=new Map,this.listeners=[],this.undoStack_=[],this.redoStack_=[],this.blockDB=new Map,this.typedBlocksDB=new Map,this.procedureMap=new TI,this.potentialVariableMap=null,this.id=ct(),C(this),this.options=t||new hs({}),this.RTL=!!this.options.RTL,this.horizontalLayout=!!this.options.horizontalLayout,this.toolboxPosition=this.options.toolboxPosition,this.connectionChecker=new(T(rt.CONNECTION_CHECKER,this.options,!0))(this),this.variableMap=new d$(this)}dispose(){this.listeners.length=0,this.clear(),L(this)}sortObjects_(t,i){const r=Math.sin(el(_a.SCAN_ANGLE))*(this.RTL?-1:1);return t=t.getRelativeToSurfaceXY(),i=i.getRelativeToSurfaceXY(),t.y+r*t.x-(i.y+r*i.x)}addTopBlock(t){this.topBlocks.push(t)}removeTopBlock(t){if(!ht(this.topBlocks,t))throw Error("Block not present in workspace's list of top-most blocks.")}getTopBlocks(t=!1){const i=[].concat(this.topBlocks);return t&&1<i.length&&i.sort(this.sortObjects_.bind(this)),i}addTypedBlock(t){this.typedBlocksDB.has(t.type)||this.typedBlocksDB.set(t.type,[]),this.typedBlocksDB.get(t.type).push(t)}removeTypedBlock(t){ht(this.typedBlocksDB.get(t.type),t),this.typedBlocksDB.get(t.type).length||this.typedBlocksDB.delete(t.type)}getBlocksByType(t,i=!1){return this.typedBlocksDB.has(t)?(t=this.typedBlocksDB.get(t).slice(0),i&&t&&1<t.length&&t.sort(this.sortObjects_.bind(this)),t.filter(function(r){return!r.isInsertionMarker()})):[]}addTopComment(t){this.topComments.push(t),this.commentDB.has(t.id)&&console.warn('Overriding an existing comment on this workspace, with id "'+t.id+'"'),this.commentDB.set(t.id,t)}removeTopComment(t){if(!ht(this.topComments,t))throw Error("Comment not present in workspace's list of top-most comments.");this.commentDB.delete(t.id)}getTopComments(t=!1){const i=[].concat(this.topComments);return t&&1<i.length&&i.sort(this.sortObjects_.bind(this)),i}getAllBlocks(t=!1){if(t){var i=this.getTopBlocks(!0);t=[];for(let r=0;r<i.length;r++)t.push(...i[r].getDescendants(!0))}else for(t=this.getTopBlocks(!1),i=0;i<t.length;i++)t.push(...t[i].getChildren(!1));return t.filter(function(r){return!r.isInsertionMarker()})}clear(){this.isClearing=!0;try{const t=s.getGroup$$module$build$src$core$events$utils();for(t||s.setGroup$$module$build$src$core$events$utils(!0);this.topBlocks.length;)this.topBlocks[0].dispose(!1);for(;this.topComments.length;)this.topComments[this.topComments.length-1].dispose();s.setGroup$$module$build$src$core$events$utils(t),this.variableMap.clear(),this.potentialVariableMap&&this.potentialVariableMap.clear()}finally{this.isClearing=!1}}renameVariableById(t,i){this.variableMap.renameVariableById(t,i)}createVariable(t,i,r){return this.variableMap.createVariable(t,i,r)}getVariableUsesById(t){return this.variableMap.getVariableUsesById(t)}deleteVariableById(t){this.variableMap.deleteVariableById(t)}getVariable(t,i){return this.variableMap.getVariable(t,i)}getVariableById(t){return this.variableMap.getVariableById(t)}getVariablesOfType(t){return this.variableMap.getVariablesOfType(t)}getVariableTypes(){return this.variableMap.getVariableTypes(this)}getAllVariables(){return this.variableMap.getAllVariables()}getAllVariableNames(){return this.variableMap.getAllVariableNames()}getWidth(){return 0}newBlock(t,i){throw Error("The implementation of newBlock should be monkey-patched in by blockly.ts")}remainingCapacity(){return isNaN(this.options.maxBlocks)?1/0:this.options.maxBlocks-this.getAllBlocks(!1).length}remainingCapacityOfType(t){return this.options.maxInstances?(this.options.maxInstances[t]!==void 0?this.options.maxInstances[t]:1/0)-this.getBlocksByType(t,!1).length:1/0}isCapacityAvailable(t){if(!this.hasBlockLimits())return!0;let i=0;for(const r in t){if(t[r]>this.remainingCapacityOfType(r))return!1;i+=t[r]}return!(i>this.remainingCapacity())}hasBlockLimits(){return this.options.maxBlocks!==1/0||!!this.options.maxInstances}getUndoStack(){return this.undoStack_}getRedoStack(){return this.redoStack_}undo(t){var i=t?this.redoStack_:this.undoStack_,r=t?this.undoStack_:this.redoStack_;const c=i.pop();if(c){for(var u=[c];i.length&&c.group&&c.group===i[i.length-1].group;){const f=i.pop();f&&u.push(f)}for(i=0;i<u.length;i++)r.push(u[i]);u=Nt(u,t),gt(!1);try{for(r=0;r<u.length;r++)u[r].run(t)}finally{gt(!0)}}}clearUndo(){this.undoStack_.length=0,this.redoStack_.length=0,me()}addChangeListener(t){return this.listeners.push(t),t}removeChangeListener(t){ht(this.listeners,t)}fireChangeListener(t){if(t.recordUndo)for(this.undoStack_.push(t),this.redoStack_.length=0;this.undoStack_.length>this.MAX_UNDO&&0<=this.MAX_UNDO;)this.undoStack_.shift();for(let i=0;i<this.listeners.length;i++)(0,this.listeners[i])(t)}getBlockById(t){return this.blockDB.get(t)||null}setBlockById(t,i){this.blockDB.set(t,i)}removeBlockById(t){this.blockDB.delete(t)}getCommentById(t){let i;return(i=this.commentDB.get(t))!=null?i:null}allInputsFilled(t){const i=this.getTopBlocks(!1);for(let r=0;r<i.length;r++)if(!i[r].allInputsFilled(t))return!1;return!0}getPotentialVariableMap(){return this.potentialVariableMap}createPotentialVariableMap(){this.potentialVariableMap=new d$(this)}getVariableMap(){return this.variableMap}setVariableMap(t){this.variableMap=t}getProcedureMap(){return this.procedureMap}getRootWorkspace(){let t=null;const i=this.options.parentWorkspace;return this.isFlyout?i&&i.options&&(t=i.options.parentWorkspace):i&&(t=i),t}static getById(t){return b(t)}static getAll(){return y()}};_a.SCAN_ANGLE=3;var TR=100,DI=class{constructor(t){this.parentWorkspace=t,this.sounds=new Map,this.lastSound_=null}dispose(){this.sounds.clear()}load(t,i){if(t.length){try{var r=new globalThis.Audio}catch{return}for(let u=0;u<t.length;u++){const f=t[u],E=f.match(/\.(\w+)$/);if(E&&r.canPlayType("audio/"+E[1])){var c=new globalThis.Audio(f);break}}c&&this.sounds.set(i,c)}}preload(){for(const t of this.sounds.values()){t.volume=.01;const i=t.play();if(i!==void 0?i.then(t.pause).catch(function(){}):t.pause(),El||Ly)break}}play(t,i){var r=this.sounds.get(t);r?(t=new Date,this.lastSound_!==null&&t.getTime()-this.lastSound_.getTime()<TR||(this.lastSound_=t,r=El||xu?r:r.cloneNode(),r.volume=i===void 0?1:i,r.play())):this.parentWorkspace&&this.parentWorkspace.getAudioManager().play(t,i)}},bR=class{constructor(t){this.workspace=t,this.layers=new Map,(t=t.getInjectionDiv())&&(this.dragLayer=this.createDragLayer(t)),t=this.createLayer(Um),J(t,"blocklyBlockCanvas"),t=this.createLayer(Hm),J(t,"blocklyBubbleCanvas")}createDragLayer(t){const i=R(D.SVG,{class:"blocklyBlockDragSurface",xmlns:jc,"xmlns:html":zs,"xmlns:xlink":Xi,version:"1.1"});return t.append(i),R(D.G,{},i)}translateLayers(t,i){t=`translate(${t.x}, ${t.y}) scale(${i})`;let r;(r=this.dragLayer)==null||r.setAttribute("transform",t);for(const[,c]of this.layers)c.setAttribute("transform",t)}moveToDragLayer(t){let i;(i=this.dragLayer)==null||i.appendChild(t.getSvgRoot())}moveOffDragLayer(t,i){this.append(t,i)}append(t,i){this.layers.has(i)||this.createLayer(i);let r;(r=this.layers.get(i))==null||r.appendChild(t.getSvgRoot())}createLayer(t){const i=this.workspace.getSvgGroup(),r=R(D.G,{});let c=!1;const u=[...this.layers].sort((f,E)=>f[0]-E[0]);for(const[f,E]of u)if(t<f){i.insertBefore(r,E),c=!0;break}return c||i.appendChild(r),this.layers.set(t,r),r}hasLayer(t){return t===this.dragLayer||new Set(this.layers.values()).has(t)}getBlockLayer(){return this.layers.get(Um)}getBubbleLayer(){return this.layers.get(Hm)}},ER=20,Ss=class extends _a{constructor(t){super(t),this.resizeHandlerWrapper=null,this.resizesEnabled=this.isVisible_=this.rendered=!0,this.startScrollY=this.startScrollX=this.scrollY=this.scrollX=0,this.dragDeltaXY=null,this.oldScale=this.scale=1,this.oldLeft=this.oldTop=0,this.inverseScreenCTM=this.targetWorkspace=this.dummyWheelListener=this.configureContextMenu=this.lastRecordedPageScroll=this.injectionDiv=this.currentGesture_=this.toolbox_=this.flyout=this.scrollbar=this.trashcan=null,this.inverseScreenCTMDirty=!0,this.highlightedBlocks=[],this.toolboxCategoryCallbacks=new Map,this.flyoutButtonCallbacks=new Map,this.cachedParentSvg=null,this.keyboardAccessibilityMode=!1,this.topBoundedElements=[],this.dragTargetAreas=[],this.zoomControls_=this.layerManager=null,this.metricsManager=new(T(rt.METRICS_MANAGER,t,!0))(this),this.getMetrics=t.getMetrics||this.metricsManager.getMetrics.bind(this.metricsManager),this.setMetrics=t.setMetrics||Ss.setTopLevelWorkspaceMetrics_,this.componentManager=new je,this.connectionDBList=Cl.init(this.connectionChecker),this.audioManager=new DI(t.parentWorkspace),this.grid=this.options.gridPattern?new Km(this.options.gridPattern,t.gridOptions):null,this.markerManager=new aa(this),si&&Jh&&this.registerToolboxCategoryCallback(_m,Jh),Sr&&yu&&this.registerToolboxCategoryCallback(a$,yu),Ii&&vu&&(this.registerToolboxCategoryCallback(id,vu),this.addChangeListener($g)),this.themeManager_=this.options.parentWorkspace?this.options.parentWorkspace.getThemeManager():new MI(this,this.options.theme||qu),this.themeManager_.subscribeWorkspace(this);let i;this.renderer=bg(this.options.renderer||"geras",this.getTheme(),(i=this.options.rendererOverrides)!=null?i:void 0),this.cachedParentSvgSize=new Ce(0,0)}getMarkerManager(){return this.markerManager}getMetricsManager(){return this.metricsManager}setMetricsManager(t){this.metricsManager=t,this.getMetrics=this.metricsManager.getMetrics.bind(this.metricsManager)}getComponentManager(){return this.componentManager}setCursorSvg(t){this.markerManager.setCursorSvg(t)}setMarkerSvg(t){this.markerManager.setMarkerSvg(t)}getMarker(t){return this.markerManager?this.markerManager.getMarker(t):null}getCursor(){return this.markerManager?this.markerManager.getCursor():null}getRenderer(){return this.renderer}getThemeManager(){return this.themeManager_}getTheme(){return this.themeManager_.getTheme()}setTheme(t){t||(t=qu),this.themeManager_.setTheme(t)}refreshTheme(){this.svgGroup_&&this.renderer.refreshDom(this.svgGroup_,this.getTheme()),this.updateBlockStyles_(this.getAllBlocks(!1).filter(function(i){return!!i.getStyleName()})),this.refreshToolboxSelection(),this.toolbox_&&this.toolbox_.refreshTheme(),this.isVisible()&&this.setVisible(!0);const t=new(ut(_l))(this.getTheme().name,this.id);it(t)}updateBlockStyles_(t){for(let i=0,r;r=t[i];i++){const c=r.getStyleName();c&&r.setStyle(c)}}getInverseScreenCTM(){if(this.inverseScreenCTMDirty){const t=this.getParentSvg().getScreenCTM();t&&(this.inverseScreenCTM=t.inverse(),this.inverseScreenCTMDirty=!1)}return this.inverseScreenCTM}updateInverseScreenCTM(){this.inverseScreenCTMDirty=!0}isVisible(){return this.isVisible_}getSvgXY(t){let i=0,r=0,c=1;(this.getCanvas().contains(t)||this.getBubbleCanvas().contains(t))&&(c=this.scale);do{const u=ls(t);(t===this.getCanvas()||t===this.getBubbleCanvas())&&(c=1),i+=u.x*c,r+=u.y*c,t=t.parentNode}while(t&&t!==this.getParentSvg()&&t!==this.getInjectionDiv());return new pt(i,r)}getCachedParentSvgSize(){const t=this.cachedParentSvgSize;return new Ce(t.width,t.height)}getOriginOffsetInPixels(){return $(this.getCanvas())}getInjectionDiv(){if(!this.injectionDiv){let t=this.svgGroup_;for(;t;){if((" "+(t.getAttribute("class")||"")+" ").indexOf(" injectionDiv ")!==-1){this.injectionDiv=t;break}t=t.parentNode}}return this.injectionDiv}getSvgGroup(){return this.svgGroup_}getBlockCanvas(){return this.getCanvas()}setResizeHandlerWrapper(t){this.resizeHandlerWrapper=t}createDom(t,i){return this.injectionDiv||(this.injectionDiv=i??null),this.svgGroup_=R(D.G,{class:"blocklyWorkspace"}),t&&(this.svgBackground_=R(D.RECT,{height:"100%",width:"100%",class:t},this.svgGroup_),t==="blocklyMainBackground"&&this.grid?this.svgBackground_.style.fill="url(#"+this.grid.getPatternId()+")":this.themeManager_.subscribe(this.svgBackground_,"workspaceBackgroundColour","fill")),this.layerManager=new bR(this),this.svgBlockCanvas_=this.layerManager.getBlockLayer(),this.svgBubbleCanvas_=this.layerManager.getBubbleLayer(),this.isFlyout||(yt(this.svgGroup_,"pointerdown",this,this.onMouseDown_,!1),this.dummyWheelListener=()=>{},document.body.addEventListener("wheel",this.dummyWheelListener),yt(this.svgGroup_,"wheel",this,this.onMouseWheel_)),this.options.hasCategories&&(this.toolbox_=new(T(rt.TOOLBOX,this.options,!0))(this)),this.grid&&this.grid.update(this.scale),this.recordDragTargets(),(t=T(rt.CURSOR,this.options))&&this.markerManager.setCursor(new t),this.renderer.createDom(this.svgGroup_,this.getTheme()),this.svgGroup_}dispose(){if(this.rendered=!1,this.currentGesture_&&this.currentGesture_.cancel(),this.svgGroup_&&Ct(this.svgGroup_),this.toolbox_&&(this.toolbox_.dispose(),this.toolbox_=null),this.flyout&&(this.flyout.dispose(),this.flyout=null),this.trashcan&&(this.trashcan.dispose(),this.trashcan=null),this.scrollbar&&(this.scrollbar.dispose(),this.scrollbar=null),this.zoomControls_&&this.zoomControls_.dispose(),this.audioManager&&this.audioManager.dispose(),this.grid&&(this.grid=null),this.renderer.dispose(),this.markerManager&&this.markerManager.dispose(),super.dispose(),this.themeManager_&&(this.themeManager_.unsubscribeWorkspace(this),this.themeManager_.unsubscribe(this.svgBackground_),this.options.parentWorkspace||this.themeManager_.dispose()),this.connectionDBList.length=0,this.toolboxCategoryCallbacks.clear(),this.flyoutButtonCallbacks.clear(),!this.options.parentWorkspace){const t=this.getParentSvg();t&&t.parentNode&&Ct(t.parentNode)}this.resizeHandlerWrapper&&(N(this.resizeHandlerWrapper),this.resizeHandlerWrapper=null),this.dummyWheelListener&&(document.body.removeEventListener("wheel",this.dummyWheelListener),this.dummyWheelListener=null)}addTrashcan(){this.trashcan=Ss.newTrashcan(this);const t=this.trashcan.createDom();this.svgGroup_.insertBefore(t,this.getCanvas())}static newTrashcan(t){throw Error("The implementation of newTrashcan should be monkey-patched in by blockly.ts")}addZoomControls(){this.zoomControls_=new Wy(this);const t=this.zoomControls_.createDom();this.svgGroup_.appendChild(t)}addFlyout(t){const i=new hs({parentWorkspace:this,rtl:this.RTL,oneBasedIndex:this.options.oneBasedIndex,horizontalLayout:this.horizontalLayout,renderer:this.options.renderer,rendererOverrides:this.options.rendererOverrides,move:{scrollbars:!0}});return i.toolboxPosition=this.options.toolboxPosition,this.flyout=this.horizontalLayout?new(T(rt.FLYOUTS_HORIZONTAL_TOOLBOX,this.options,!0))(i):new(T(rt.FLYOUTS_VERTICAL_TOOLBOX,this.options,!0))(i),this.flyout.autoClose=!1,this.flyout.getWorkspace().setVisible(!0),this.flyout.createDom(t)}getFlyout(t){return this.flyout||t?this.flyout:this.toolbox_?this.toolbox_.getFlyout():null}getToolbox(){return this.toolbox_}updateScreenCalculations_(){this.updateInverseScreenCTM(),this.recordDragTargets()}resizeContents(){this.resizesEnabled&&this.rendered&&(this.scrollbar&&this.scrollbar.resize(),this.updateInverseScreenCTM())}resize(){this.toolbox_&&this.toolbox_.position(),this.flyout&&this.flyout.position();const t=this.componentManager.getComponents(je.Capability.POSITIONABLE,!0),i=this.getMetricsManager().getUiMetrics(),r=[];for(let c=0,u;u=t[c];c++){u.position(i,r);const f=u.getBoundingRectangle();f&&r.push(f)}this.scrollbar&&this.scrollbar.resize(),this.updateScreenCalculations_()}updateScreenCalculationsIfScrolled(){const t=O();pt.equals(this.lastRecordedPageScroll,t)||(this.lastRecordedPageScroll=t,this.updateScreenCalculations_())}getLayerManager(){return this.layerManager}getCanvas(){return this.layerManager.getBlockLayer()}setCachedParentSvgSize(t,i){const r=this.getParentSvg();t!=null&&(this.cachedParentSvgSize.width=t,r.setAttribute("data-cached-width",`${t}`)),i!=null&&(this.cachedParentSvgSize.height=i,r.setAttribute("data-cached-height",`${i}`))}getBubbleCanvas(){return this.layerManager.getBubbleLayer()}getParentSvg(){if(!this.cachedParentSvg){let t=this.svgGroup_;for(;t;){if(t.tagName==="svg"){this.cachedParentSvg=t;break}t=t.parentNode}}return this.cachedParentSvg}maybeFireViewportChangeEvent(){if(Lt()){var t=this.scale,i=-this.scrollY,r=-this.scrollX;if(!(t===this.oldScale&&1>Math.abs(i-this.oldTop)&&1>Math.abs(r-this.oldLeft))){var c=new(ut(pn))(i,r,t,this.id,this.oldScale);this.oldScale=t,this.oldTop=i,this.oldLeft=r,it(c)}}}translate(t,i){let r;(r=this.layerManager)==null||r.translateLayers(new pt(t,i),this.scale);let c;(c=this.grid)==null||c.moveTo(t,i),this.maybeFireViewportChangeEvent()}getWidth(){const t=this.getMetrics();return t?t.viewWidth/this.scale:0}setVisible(t){this.isVisible_=t,this.svgGroup_&&(this.scrollbar&&this.scrollbar.setContainerVisible(t),this.getFlyout()&&this.getFlyout().setContainerVisible(t),this.getParentSvg().style.display=t?"block":"none",this.toolbox_&&this.toolbox_.setVisible(t),t||this.hideChaff(!0))}render(){for(var t=this.getAllBlocks(!1),i=t.length-1;0<=i;i--)t[i].queueRender();if(this.currentGesture_)for(t=this.currentGesture_.getInsertionMarkers(),i=0;i<t.length;i++)t[i].queueRender();Pc().then(()=>void this.markerManager.updateMarkers())}highlightBlock(t,i){if(i===void 0){for(let r=0,c;c=this.highlightedBlocks[r];r++)c.setHighlighted(!1);this.highlightedBlocks.length=0}(t=t?this.getBlockById(t):null)&&((i=i===void 0||i)?this.highlightedBlocks.indexOf(t)===-1&&this.highlightedBlocks.push(t):ht(this.highlightedBlocks,t),t.setHighlighted(i))}paste(t){if(j("Blockly.WorkspaceSvg.prototype.paste","v10","v11","Blockly.clipboard.paste"),!this.rendered||!t.type&&!t.tagName)return null;this.currentGesture_&&this.currentGesture_.cancel();const i=s.getGroup$$module$build$src$core$events$utils();i||s.setGroup$$module$build$src$core$events$utils(!0);let r;try{r=t.type?this.pasteBlock_(null,t):t.tagName.toLowerCase()==="comment"?this.pasteWorkspaceComment_(t):this.pasteBlock_(t,null)}finally{s.setGroup$$module$build$src$core$events$utils(i)}return r}pasteBlock_(t,i){s.disable$$module$build$src$core$events$utils();let r;try{let c=0,u=0;if(t){r=nn(t,this);let f;c=parseInt((f=t.getAttribute("x"))!=null?f:"0"),this.RTL&&(c=-c);let E;u=parseInt((E=t.getAttribute("y"))!=null?E:"0")}else i&&(r=rn(i,this),c=i.x||10,this.RTL&&(c=this.getWidth()-c),u=i.y||10);if(!isNaN(c)&&!isNaN(u)){let f;do{f=!1;const E=this.getAllBlocks(!1);for(let S=0,W;W=E[S];S++){const bt=W.getRelativeToSurfaceXY();if(1>=Math.abs(c-bt.x)&&1>=Math.abs(u-bt.y)){f=!0;break}}if(!f){const S=r.getConnections_(!1);for(let W=0,bt;bt=S[W];W++)if(bt.closest(s.config$$module$build$src$core$config.snapRadius,new pt(c,u)).connection){f=!0;break}}f&&(c=this.RTL?c-s.config$$module$build$src$core$config.snapRadius:c+s.config$$module$build$src$core$config.snapRadius,u+=2*s.config$$module$build$src$core$config.snapRadius)}while(f);r.moveTo(new pt(c,u))}}finally{s.enable$$module$build$src$core$events$utils()}return Lt()&&!r.isShadow()&&it(new(ut(s.CREATE$$module$build$src$core$events$utils))(r)),r.select(),r}pasteWorkspaceComment_(t){s.disable$$module$build$src$core$events$utils();let i;try{i=oi.fromXmlRendered(t,this);let r,c=parseInt((r=t.getAttribute("x"))!=null?r:"0"),u,f=parseInt((u=t.getAttribute("y"))!=null?u:"0");isNaN(c)||isNaN(f)||(this.RTL&&(c=-c),i.moveBy(c+50,f+50))}finally{s.enable$$module$build$src$core$events$utils()}return Lt()&&Xs.fireCreateEvent(i),i.select(),i}refreshToolboxSelection(){const t=this.isFlyout?this.targetWorkspace:this;t&&!t.currentGesture_&&t.toolbox_&&t.toolbox_.getFlyout()&&t.toolbox_.refreshSelection()}renameVariableById(t,i){super.renameVariableById(t,i),this.refreshToolboxSelection()}deleteVariableById(t){super.deleteVariableById(t),this.refreshToolboxSelection()}createVariable(t,i,r){return t=super.createVariable(t,i,r),this.refreshToolboxSelection(),t}recordDragTargets(){const t=this.componentManager.getComponents(je.Capability.DRAG_TARGET,!0);this.dragTargetAreas=[];for(let i=0,r;r=t[i];i++){const c=r.getClientRect();c&&this.dragTargetAreas.push({component:r,clientRect:c})}}newBlock(t,i){throw Error("The implementation of newBlock should be monkey-patched in by blockly.ts")}getDragTarget(t){for(let i=0,r;r=this.dragTargetAreas[i];i++)if(r.clientRect.contains(t.clientX,t.clientY))return r.component;return null}onMouseDown_(t){const i=this.getGesture(t);i&&i.handleWsStart(t,this)}startDrag(t,i){t=Z(t,this.getParentSvg(),this.getInverseScreenCTM()),t.x/=this.scale,t.y/=this.scale,this.dragDeltaXY=pt.difference(i,t)}moveDrag(t){return t=Z(t,this.getParentSvg(),this.getInverseScreenCTM()),t.x/=this.scale,t.y/=this.scale,pt.sum(this.dragDeltaXY,t)}isDragging(){return this.currentGesture_!==null&&this.currentGesture_.isDragging()}isDraggable(){return this.options.moveOptions&&this.options.moveOptions.drag}isMovable(){return this.options.moveOptions&&!!this.options.moveOptions.scrollbars||this.options.moveOptions&&this.options.moveOptions.wheel||this.options.moveOptions&&this.options.moveOptions.drag||this.options.zoomOptions&&this.options.zoomOptions.wheel||this.options.zoomOptions&&this.options.zoomOptions.pinch}isMovableHorizontally(){const t=!!this.scrollbar;return this.isMovable()&&(!t||t&&this.scrollbar.canScrollHorizontally())}isMovableVertically(){const t=!!this.scrollbar;return this.isMovable()&&(!t||t&&this.scrollbar.canScrollVertically())}onMouseWheel_(t){if(Mo.inProgress())t.preventDefault(),t.stopPropagation();else{var i=this.options.zoomOptions&&this.options.zoomOptions.wheel,r=this.options.moveOptions&&this.options.moveOptions.wheel;if(i||r){var c=st(t);if(cm)var u=t.metaKey;i&&(t.ctrlKey||u||!r)?(c=-c.y/50,i=Z(t,this.getParentSvg(),this.getInverseScreenCTM()),this.zoom(i.x,i.y,c)):(i=this.scrollX-c.x,r=this.scrollY-c.y,t.shiftKey&&!c.x&&(i=this.scrollX-c.y,r=this.scrollY),this.scroll(i,r)),t.preventDefault()}}}getBlocksBoundingBox(){const t=this.getTopBoundedElements();if(!t.length)return new ve(0,0,0,0);const i=t[0].getBoundingRectangle();for(let c=1;c<t.length;c++){var r=t[c];r.isInsertionMarker&&r.isInsertionMarker()||(r=r.getBoundingRectangle(),r.top<i.top&&(i.top=r.top),r.bottom>i.bottom&&(i.bottom=r.bottom),r.left<i.left&&(i.left=r.left),r.right>i.right&&(i.right=r.right))}return i}cleanUp(){this.setResizesEnabled(!1),s.setGroup$$module$build$src$core$events$utils(!0);const t=this.getTopBlocks(!0);let i=0;for(let r=0,c;c=t[r];r++){if(!c.isMovable())continue;const u=c.getRelativeToSurfaceXY();c.moveBy(-u.x,i-u.y,["cleanup"]),c.snapToGrid(),i=c.getRelativeToSurfaceXY().y+c.getHeightWidth().height+this.renderer.getConstants().MIN_BLOCK_HEIGHT}s.setGroup$$module$build$src$core$events$utils(!1),this.setResizesEnabled(!0)}showContextMenu(t){if(!this.options.readOnly&&!this.isFlyout){var i=ne.registry.getContextMenuOptions(ne.ScopeType.WORKSPACE,{workspace:this});this.configureContextMenu&&this.configureContextMenu(i,t),Fc(t,i,this.RTL)}}updateToolbox(t){if(t=yo(t)){if(!this.options.languageTree)throw Error("Existing toolbox is null.  Can't create new toolbox.");if(Vh(t)){if(!this.toolbox_)throw Error("Existing toolbox has no categories.  Can't change mode.");this.options.languageTree=t,this.toolbox_.render(t)}else{if(!this.flyout)throw Error("Existing toolbox has categories.  Can't change mode.");this.options.languageTree=t,this.flyout.show(t)}}else if(this.options.languageTree)throw Error("Can't nullify an existing toolbox.")}markFocused(){this.options.parentWorkspace?this.options.parentWorkspace.markFocused():(F(this),this.getParentSvg().focus({preventScroll:!0}))}zoom(t,i,r){r=Math.pow(this.options.zoomOptions.scaleSpeed,r);const c=this.scale*r;if(this.scale!==c){c>this.options.zoomOptions.maxScale?r=this.options.zoomOptions.maxScale/this.scale:c<this.options.zoomOptions.minScale&&(r=this.options.zoomOptions.minScale/this.scale);var u=this.getCanvas().getCTM(),f=this.getParentSvg().createSVGPoint();f.x=t,f.y=i,f=f.matrixTransform(u.inverse()),t=f.x,i=f.y,u=u.translate(t*(1-r),i*(1-r)).scale(r),this.scrollX=u.e,this.scrollY=u.f,this.setScale(c)}}zoomCenter(t){var i=this.getMetrics();let r;this.flyout?(r=i.svgWidth?i.svgWidth/2:0,i=i.svgHeight?i.svgHeight/2:0):(r=i.viewWidth/2+i.absoluteLeft,i=i.viewHeight/2+i.absoluteTop),this.zoom(r,i,t)}zoomToFit(){if(this.isMovable()){var t=this.getMetrics(),i=t.viewWidth;t=t.viewHeight;var r=this.getBlocksBoundingBox(),c=2*ER,u=r.right-r.left+c;if(r=r.bottom-r.top+c,u){this.flyout&&(this.horizontalLayout?(t+=this.flyout.getHeight(),r+=this.flyout.getHeight()/this.scale):(i+=this.flyout.getWidth(),u+=this.flyout.getWidth()/this.scale)),i/=u,t/=r,s.disable$$module$build$src$core$events$utils();try{this.setScale(Math.min(i,t)),this.scrollCenter()}finally{s.enable$$module$build$src$core$events$utils()}this.maybeFireViewportChangeEvent()}}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")}beginCanvasTransition(){J(this.getCanvas(),"blocklyCanvasTransitioning"),J(this.getBubbleCanvas(),"blocklyCanvasTransitioning")}endCanvasTransition(){mt(this.getCanvas(),"blocklyCanvasTransitioning"),mt(this.getBubbleCanvas(),"blocklyCanvasTransitioning")}scrollCenter(){if(this.isMovable()){var t=this.getMetrics(),i=(t.scrollWidth-t.viewWidth)/2,r=(t.scrollHeight-t.viewHeight)/2;i=-i-t.scrollLeft,r=-r-t.scrollTop,this.scroll(i,r)}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")}centerOnBlock(t,i){if(this.isMovable()){var r=t?this.getBlockById(t):null;if(r){t=r.getRelativeToSurfaceXY(),r=i?{height:r.height,width:r.width}:r.getHeightWidth();var c=this.scale;i=(t.x+(this.RTL?-1:1)*r.width/2)*c,t=(t.y+r.height/2)*c,r=this.getMetrics(),this.scroll(-(i-r.viewWidth/2),-(t-r.viewHeight/2))}}else console.warn("Tried to move a non-movable workspace. This could result in blocks becoming inaccessible.")}setScale(t){this.options.zoomOptions.maxScale&&t>this.options.zoomOptions.maxScale?t=this.options.zoomOptions.maxScale:this.options.zoomOptions.minScale&&t<this.options.zoomOptions.minScale&&(t=this.options.zoomOptions.minScale),this.scale=t,this.hideChaff(!1),(t=this.getFlyout(!1))&&t.isVisible()&&(t.reflow(),this.recordDragTargets()),this.grid&&this.grid.update(this.scale),t=this.getMetrics(),this.scrollX-=t.absoluteLeft,this.scrollY-=t.absoluteTop,t.viewLeft+=t.absoluteLeft,t.viewTop+=t.absoluteTop,this.scroll(this.scrollX,this.scrollY),this.scrollbar&&(this.flyout?this.scrollbar.resizeView(t):this.scrollbar.resizeContent(t))}getScale(){return this.options.parentWorkspace?this.options.parentWorkspace.getScale():this.scale}scroll(t,i){this.hideChaff(!0);const r=this.getMetrics();t=Math.min(t,-r.scrollLeft),i=Math.min(i,-r.scrollTop);const c=r.scrollTop+Math.max(0,r.scrollHeight-r.viewHeight);t=Math.max(t,-(r.scrollLeft+Math.max(0,r.scrollWidth-r.viewWidth))),i=Math.max(i,-c),this.scrollX=t,this.scrollY=i,this.scrollbar&&this.scrollbar.set(-(t+r.scrollLeft),-(i+r.scrollTop),!1),t+=r.absoluteLeft,i+=r.absoluteTop,this.translate(t,i)}getBlockById(t){return super.getBlockById(t)}getAllBlocks(t=!1){return super.getAllBlocks(t)}getTopBlocks(t=!1){return super.getTopBlocks(t)}addTopBlock(t){this.addTopBoundedElement(t),super.addTopBlock(t)}removeTopBlock(t){this.removeTopBoundedElement(t),super.removeTopBlock(t)}addTopComment(t){this.addTopBoundedElement(t),super.addTopComment(t)}removeTopComment(t){this.removeTopBoundedElement(t),super.removeTopComment(t)}getRootWorkspace(){return super.getRootWorkspace()}addTopBoundedElement(t){this.topBoundedElements.push(t)}removeTopBoundedElement(t){ht(this.topBoundedElements,t)}getTopBoundedElements(){return[].concat(this.topBoundedElements)}setResizesEnabled(t){const i=!this.resizesEnabled&&t;this.resizesEnabled=t,i&&this.resizeContents()}clear(){this.setResizesEnabled(!1),super.clear(),this.topBoundedElements=[],this.setResizesEnabled(!0)}registerButtonCallback(t,i){if(typeof i!="function")throw TypeError("Button callbacks must be functions.");this.flyoutButtonCallbacks.set(t,i)}getButtonCallback(t){let i;return(i=this.flyoutButtonCallbacks.get(t))!=null?i:null}removeButtonCallback(t){this.flyoutButtonCallbacks.delete(t)}registerToolboxCategoryCallback(t,i){if(typeof i!="function")throw TypeError("Toolbox category callbacks must be functions.");this.toolboxCategoryCallbacks.set(t,i)}getToolboxCategoryCallback(t){return this.toolboxCategoryCallbacks.get(t)||null}removeToolboxCategoryCallback(t){this.toolboxCategoryCallbacks.delete(t)}getGesture(t){const i=t.type==="pointerdown",r=this.currentGesture_;return r?i&&r.hasStarted()?(console.warn("Tried to start the same gesture twice."),r.cancel(),null):r:i?this.currentGesture_=new Mo(t,this):null}clearGesture(){this.currentGesture_=null}cancelCurrentGesture(){this.currentGesture_&&this.currentGesture_.cancel()}getAudioManager(){return this.audioManager}getGrid(){return this.grid}hideChaff(t=!1){Io(),cs(),Es(),this.hideComponents(t)}hideComponents(t=!1){this.getComponentManager().getComponents(je.Capability.AUTOHIDEABLE,!0).forEach(i=>i.autoHide(t))}static setTopLevelWorkspaceMetrics_(t){const i=this.getMetrics();typeof t.x=="number"&&(this.scrollX=-(i.scrollLeft+(i.scrollWidth-i.viewWidth)*t.x)),typeof t.y=="number"&&(this.scrollY=-(i.scrollTop+(i.scrollHeight-i.viewHeight)*t.y)),this.translate(this.scrollX+i.absoluteLeft,this.scrollY+i.absoluteTop)}},p$=class extends Ws{constructor(t,i){super(i),this.type=ml,this.isOpen=t}toJson(){const t=super.toJson();if(this.isOpen===void 0)throw Error("Whether this is already open or not is undefined. Either pass a value to the constructor, or call fromJson");return t.isOpen=this.isOpen,t}static fromJson(t,i,r){return i=super.fromJson(t,i,r??new p$),i.isOpen=t.isOpen,i}};o(rt.EVENT,ml,p$);var f$=class extends fr{constructor(t){if(super(t),this.type=s.DELETE$$module$build$src$core$events$utils,t){if(t.getParent())throw Error("Connected blocks cannot be deleted.");t.isShadow()&&(this.recordUndo=!1),this.oldXml=Bc(t),this.ids=Ht(t),this.wasShadow=t.isShadow(),this.oldJson=Us(t,{addCoordinates:!0})}}toJson(){const t=super.toJson();if(!this.oldXml)throw Error("The old block XML is undefined. Either pass a block to the constructor, or call fromJson");if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(this.wasShadow===void 0)throw Error("Whether the block was a shadow is undefined. Either pass a block to the constructor, or call fromJson");if(!this.oldJson)throw Error("The old block JSON is undefined. Either pass a block to the constructor, or call fromJson");return t.oldXml=Fs(this.oldXml),t.ids=this.ids,t.wasShadow=this.wasShadow,t.oldJson=this.oldJson,this.recordUndo||(t.recordUndo=this.recordUndo),t}static fromJson(t,i,r){return i=super.fromJson(t,i,r??new f$),i.oldXml=s.textToDom$$module$build$src$core$utils$xml(t.oldXml),i.ids=t.ids,i.wasShadow=t.wasShadow||i.oldXml.tagName.toLowerCase()==="shadow",i.oldJson=t.oldJson,t.recordUndo!==void 0&&(i.recordUndo=t.recordUndo),i}run(t){const i=this.getEventWorkspace_();if(!this.ids)throw Error("The block IDs are undefined. Either pass a block to the constructor, or call fromJson");if(!this.oldJson)throw Error("The old block JSON is undefined. Either pass a block to the constructor, or call fromJson");if(t)for(t=0;t<this.ids.length;t++){const r=this.ids[t],c=i.getBlockById(r);c?c.dispose(!1):r===this.blockId&&console.warn("Can't delete non-existent block: "+r)}else rn(this.oldJson,i)}};o(rt.EVENT,s.DELETE$$module$build$src$core$events$utils,f$);var Bl=class{constructor(t,i,r){if(this.data=null,this.disposed=!1,this.hue_=null,this.colour_="#000000",this.styleName_="",this.suppressPrefixSuffix=!1,this.previousConnection=this.nextConnection=this.outputConnection=null,this.inputList=[],this.icons=[],this.disabled=!1,this.tooltip="",this.contextMenu=!0,this.parentBlock_=null,this.childBlocks_=[],this.editable_=this.movable_=this.deletable_=!0,this.collapsed_=this.isShadow_=!1,this.outputShape_=null,this.isInsertionMarker_=this.disposing=!1,this.onchangeWrapper_=this.helpUrl=this.rendered=null,this.statementInputCount=0,this.workspace=t,this.id=r&&!t.getBlockById(r)?r:ct(),t.setBlockById(this.id,this),this.xy_=new pt(0,0),this.isInFlyout=t.isFlyout,this.isInMutator=t.isMutator,this.RTL=t.RTL,i){if(this.type=i,r=Mi[i],!r||typeof r!="object")throw TypeError("Invalid block definition for type: "+i);Object.assign(this,r)}t.addTopBlock(this),t.addTypedBlock(this),new.target===Bl&&this.doInit_()}doInit_(){const t=s.getGroup$$module$build$src$core$events$utils();t||s.setGroup$$module$build$src$core$events$utils(!0);const i=vt();try{typeof this.init=="function"&&(gt(!1),this.init(),gt(i)),Lt()&&it(new(ut(s.CREATE$$module$build$src$core$events$utils))(this))}finally{s.setGroup$$module$build$src$core$events$utils(t),gt(i)}this.inputsInlineDefault=this.inputsInline,typeof this.onchange=="function"&&this.setOnChange(this.onchange)}dispose(t){this.isDeadOrDying()||(this.onchangeWrapper_&&this.workspace.removeChangeListener(this.onchangeWrapper_),this.unplug(t),Lt()&&it(new(ut(s.DELETE$$module$build$src$core$events$utils))(this)),this.workspace.removeTopBlock(this),this.disposeInternal())}disposeInternal(){this.isDeadOrDying()||(this.onchangeWrapper_&&this.workspace.removeChangeListener(this.onchangeWrapper_),this.workspace.removeTypedBlock(this),this.workspace.removeBlockById(this.id),this.disposing=!0,typeof this.destroy=="function"&&this.destroy(),this.childBlocks_.forEach(t=>t.disposeInternal()),this.inputList.forEach(t=>t.dispose()),this.inputList.length=0,this.getConnections_(!0).forEach(t=>t.dispose()),this.disposed=!0)}isDeadOrDying(){return this.disposing||this.disposed}initModel(){for(const t of this.inputList)for(const i of t.fieldRow)i.initModel&&i.initModel()}unplug(t){this.outputConnection&&this.unplugFromRow_(t),this.previousConnection&&this.unplugFromStack_(t)}unplugFromRow_(t){let i=null,r;(r=this.outputConnection)!=null&&r.isConnected()&&(i=this.outputConnection.targetConnection,this.outputConnection.disconnect()),i&&t&&(t=this.getOnlyValueConnection_())&&t.isConnected()&&!t.targetBlock().isShadow()&&(t=t.targetConnection,t==null||t.disconnect(),this.workspace.connectionChecker.canConnect(t,i,!1)?i.connect(t):t==null||t.onFailedConnect(i))}getOnlyValueConnection_(){let t=null;for(let i=0;i<this.inputList.length;i++){const r=this.inputList[i].connection;if(r&&r.type===wt.INPUT_VALUE&&r.targetConnection){if(t)return null;t=r}}return t}unplugFromStack_(t){let i=null;var r;if((r=this.previousConnection)!=null&&r.isConnected()&&(i=this.previousConnection.targetConnection,this.previousConnection.disconnect()),r=this.getNextBlock(),t&&r&&!r.isShadow()){let c,u;t=(u=(c=this.nextConnection)==null?void 0:c.targetConnection)!=null?u:null,t==null||t.disconnect(),i&&this.workspace.connectionChecker.canConnect(i,t,!1)&&i.connect(t)}}getConnections_(t){t=[],this.outputConnection&&t.push(this.outputConnection),this.previousConnection&&t.push(this.previousConnection),this.nextConnection&&t.push(this.nextConnection);for(let i=0,r;r=this.inputList[i];i++)r.connection&&t.push(r.connection);return t}lastConnectionInStack(t){let i=this.nextConnection;for(;i;){const r=i.targetBlock();if(!r||t&&r.isShadow())return i;i=r.nextConnection}return null}bumpNeighbours(){}getParent(){return this.parentBlock_}getInputWithBlock(t){for(let i=0,r;r=this.inputList[i];i++)if(r.connection&&r.connection.targetBlock()===t)return r;return null}getSurroundParent(){let t=this,i;do if(i=t,t=t.getParent(),!t)return null;while(t.getNextBlock()===i);return t}getNextBlock(){return this.nextConnection&&this.nextConnection.targetBlock()}getPreviousBlock(){return this.previousConnection&&this.previousConnection.targetBlock()}getRootBlock(){let t,i=this;do t=i,i=t.parentBlock_;while(i);return t}getTopStackBlock(){let t=this,i;do i=t.getPreviousBlock();while(i&&i.getNextBlock()===t&&(t=i));return t}getChildren(t){if(!t)return this.childBlocks_;t=[];for(let r=0,c;c=this.inputList[r];r++)if(c.connection){var i=c.connection.targetBlock();i&&t.push(i)}return(i=this.getNextBlock())&&t.push(i),t}setParent(t){if(t!==this.parentBlock_){var i=this.previousConnection&&this.previousConnection.targetBlock()||this.outputConnection&&this.outputConnection.targetBlock(),r=!!i;if(r&&t&&i!==t)throw Error("Block connected to superior one that is not new parent.");if(!r&&t)throw Error("Block not connected to new parent.");if(r&&!t)throw Error("Cannot set parent to null while block is still connected to superior block.");this.parentBlock_?ht(this.parentBlock_.childBlocks_,this):this.workspace.removeTopBlock(this),(this.parentBlock_=t)?t.childBlocks_.push(this):this.workspace.addTopBlock(this)}}getDescendants(t){const i=[this],r=this.getChildren(t);for(let c,u=0;c=r[u];u++)i.push(...c.getDescendants(t));return i}isDeletable(){return this.deletable_&&!this.isShadow_&&!this.isDeadOrDying()&&!this.workspace.options.readOnly}isOwnDeletable(){return this.deletable_}setDeletable(t){this.deletable_=t}isMovable(){return this.movable_&&!this.isShadow_&&!this.isDeadOrDying()&&!this.workspace.options.readOnly}isOwnMovable(){return this.movable_}setMovable(t){this.movable_=t}isDuplicatable(){return this.workspace.hasBlockLimits()?this.workspace.isCapacityAvailable(H(this,!0)):!0}isShadow(){return this.isShadow_}setShadow(t){this.isShadow_=t}isInsertionMarker(){return this.isInsertionMarker_}setInsertionMarker(t){this.isInsertionMarker_=t}isEditable(){return this.editable_&&!this.isDeadOrDying()&&!this.workspace.options.readOnly}isOwnEditable(){return this.editable_}setEditable(t){this.editable_=t;for(let i=0,r;r=this.inputList[i];i++)for(let c=0,u;u=r.fieldRow[c];c++)u.updateEditable()}isDisposed(){return this.disposed}isSimpleReporter(){if(!this.outputConnection)return!1;for(const t of this.inputList)if(t.connection||1<t.fieldRow.length)return!1;return!0}getMatchingConnection(t,i){const r=this.getConnections_(!0);if(t=t.getConnections_(!0),r.length!==t.length)throw Error("Connection lists did not match in length.");for(let c=0;c<t.length;c++)if(t[c]===i)return r[c];return null}setHelpUrl(t){this.helpUrl=t}setTooltip(t){this.tooltip=t}getTooltip(){return rl(this)}getColour(){return this.colour_}getStyleName(){return this.styleName_}getHue(){return this.hue_}setColour(t){t=cl(t),this.hue_=t.hue,this.colour_=t.hex}setStyle(t){this.styleName_=t}setOnChange(t){if(t&&typeof t!="function")throw Error("onchange must be a function.");this.onchangeWrapper_&&this.workspace.removeChangeListener(this.onchangeWrapper_),this.onchange=t,this.onchangeWrapper_=t.bind(this),this.workspace.addChangeListener(this.onchangeWrapper_)}getField(t){if(typeof t!="string")throw TypeError("Block.prototype.getField expects a string with the field name but received "+(t===void 0?"nothing":t+" of type "+typeof t)+" instead");for(let i=0,r;r=this.inputList[i];i++)for(let c=0,u;u=r.fieldRow[c];c++)if(u.name===t)return u;return null}getVars(){const t=[];for(let i=0,r;r=this.inputList[i];i++)for(let c=0,u;u=r.fieldRow[c];c++)u.referencesVariables()&&t.push(u.getValue());return t}getVarModels(){const t=[];for(let i=0,r;r=this.inputList[i];i++)for(let c=0,u;u=r.fieldRow[c];c++)if(u.referencesVariables()){const f=this.workspace.getVariableById(u.getValue());f&&t.push(f)}return t}updateVarName(t){for(let i=0,r;r=this.inputList[i];i++)for(let c=0,u;u=r.fieldRow[c];c++)u.referencesVariables()&&t.getId()===u.getValue()&&u.refreshVariableName()}renameVarById(t,i){for(let r=0,c;c=this.inputList[r];r++)for(let u=0,f;f=c.fieldRow[u];u++)f.referencesVariables()&&t===f.getValue()&&f.setValue(i)}getFieldValue(t){return(t=this.getField(t))?t.getValue():null}setFieldValue(t,i){const r=this.getField(i);if(!r)throw Error('Field "'+i+'" not found.');r.setValue(t)}setPreviousStatement(t,i){if(t)i===void 0&&(i=null),this.previousConnection||(this.previousConnection=this.makeConnection_(wt.PREVIOUS_STATEMENT)),this.previousConnection.setCheck(i);else if(this.previousConnection){if(this.previousConnection.isConnected())throw Error("Must disconnect previous statement before removing connection.");this.previousConnection.dispose(),this.previousConnection=null}}setNextStatement(t,i){if(t)i===void 0&&(i=null),this.nextConnection||(this.nextConnection=this.makeConnection_(wt.NEXT_STATEMENT)),this.nextConnection.setCheck(i);else if(this.nextConnection){if(this.nextConnection.isConnected())throw Error("Must disconnect next statement before removing connection.");this.nextConnection.dispose(),this.nextConnection=null}}setOutput(t,i){if(t)i===void 0&&(i=null),this.outputConnection||(this.outputConnection=this.makeConnection_(wt.OUTPUT_VALUE)),this.outputConnection.setCheck(i);else if(this.outputConnection){if(this.outputConnection.isConnected())throw Error("Must disconnect output value before removing connection.");this.outputConnection.dispose(),this.outputConnection=null}}setInputsInline(t){this.inputsInline!==t&&(it(new(ut(s.CHANGE$$module$build$src$core$events$utils))(this,"inline",null,this.inputsInline,t)),this.inputsInline=t)}getInputsInline(){if(this.inputsInline!==void 0)return this.inputsInline;for(var t=1;t<this.inputList.length;t++)if(this.inputList[t-1]instanceof Qs&&this.inputList[t]instanceof Qs)return!1;for(t=1;t<this.inputList.length;t++)if(this.inputList[t-1]instanceof s.ValueInput$$module$build$src$core$inputs$value_input&&this.inputList[t]instanceof Qs)return!0;for(t=0;t<this.inputList.length;t++)if(this.inputList[t]instanceof Po)return!0;return!1}setOutputShape(t){this.outputShape_=t}getOutputShape(){return this.outputShape_}isEnabled(){return!this.disabled}setEnabled(t){if(this.isEnabled()!==t){const i=this.disabled;this.disabled=!t,it(new(ut(s.CHANGE$$module$build$src$core$events$utils))(this,"disabled",null,i,!t))}}getInheritedDisabled(){let t=this.getSurroundParent();for(;t;){if(t.disabled)return!0;t=t.getSurroundParent()}return!1}isCollapsed(){return this.collapsed_}setCollapsed(t){this.collapsed_!==t&&(it(new(ut(s.CHANGE$$module$build$src$core$events$utils))(this,"collapsed",null,this.collapsed_,t)),this.collapsed_=t)}toString(t,i){i=this.toTokens(i);for(let c=2;c<i.length;c++)i[c-2]==="("&&i[c]===")"&&(i[c-2]=i[c-1],i.splice(c-1,2));let r="";return i=i.reduce((c,u)=>(c=c+(r==="("||u===")"?"":" ")+u,r=u[u.length-1],c),""),i=i.trim()||"???",t&&i.length>t&&(i=i.substring(0,t-3)+"..."),i}toTokens(t="?"){const i=[];for(const c of this.inputList)if(c.name!=Pl){for(const u of c.fieldRow)i.push(u.getText());if(c.connection){const u=c.connection.targetBlock();if(u){var r=c.connection;let f=r.getCheck();!f&&r.targetConnection&&(f=r.targetConnection.getCheck()),(r=!!f&&(f.indexOf("Boolean")!==-1||f.indexOf("Number")!==-1))&&i.push("("),i.push(...u.toTokens(t)),r&&i.push(")")}else i.push(t)}}return i}appendValueInput(t){return this.appendInput(new s.ValueInput$$module$build$src$core$inputs$value_input(t,this))}appendStatementInput(t){return this.statementInputCount++,this.appendInput(new Ji(t,this))}appendDummyInput(t=""){return this.appendInput(new Qs(t,this))}appendEndRowInput(t=""){return this.appendInput(new Po(t,this))}appendInput(t){return this.inputList.push(t),t}appendInputFromRegistry(t,i){return(t=p(rt.INPUT,t,!1))?this.appendInput(new t(i,this)):null}jsonInit(t){var i=t.type?'Block "'+t.type+'": ':"";if(t.output&&t.previousStatement)throw Error(i+"Must not have both an output and a previousStatement.");for(var r=0;t["args"+r];){if(t["message"+r]===void 0)throw Error(i+`args${r} must have a corresponding message (message${r}).`);r++}if(t.style&&t.style.hat&&(this.hat=t.style.hat,t.style=null),t.style&&t.colour)throw Error(i+"Must not have both a colour and a style.");for(t.style?this.jsonInitStyle_(t,i):this.jsonInitColour_(t,i),r=0;t["message"+r]!==void 0;)this.interpolate_(t["message"+r],t["args"+r]||[],t["implicitAlign"+r]||t["lastDummyAlign"+r],i),r++;if(t.inputsInline!==void 0&&(s.disable$$module$build$src$core$events$utils(),this.setInputsInline(t.inputsInline),s.enable$$module$build$src$core$events$utils()),t.output!==void 0&&this.setOutput(!0,t.output),t.outputShape!==void 0&&this.setOutputShape(t.outputShape),t.previousStatement!==void 0&&this.setPreviousStatement(!0,t.previousStatement),t.nextStatement!==void 0&&this.setNextStatement(!0,t.nextStatement),t.tooltip!==void 0&&(r=Fe(t.tooltip),this.setTooltip(r)),t.enableContextMenu!==void 0&&(this.contextMenu=!!t.enableContextMenu),t.suppressPrefixSuffix!==void 0&&(this.suppressPrefixSuffix=!!t.suppressPrefixSuffix),t.helpUrl!==void 0&&(r=Fe(t.helpUrl),this.setHelpUrl(r)),typeof t.extensions=="string"&&(console.warn(i+"JSON attribute 'extensions' should be an array of strings. Found raw string in JSON for '"+t.type+"' block."),t.extensions=[t.extensions]),t.mutator!==void 0&&_u(t.mutator,this,!0),t=t.extensions,Array.isArray(t))for(i=0;i<t.length;i++)_u(t[i],this,!1)}jsonInitColour_(t,i){if("colour"in t)if(t.colour===void 0)console.warn(i+"Undefined colour value.");else{t=t.colour;try{this.setColour(t)}catch{console.warn(i+"Illegal colour value: ",t)}}}jsonInitStyle_(t,i){t=t.style;try{this.setStyle(t)}catch{console.warn(i+"Style does not exist: ",t)}}mixin(t,i){if(i!==void 0&&typeof i!="boolean")throw Error("opt_disableCheck must be a boolean if provided");if(!i){i=[];for(const r in t)this[r]!==void 0&&i.push(r);if(i.length)throw Error("Mixin will overwrite block members: "+JSON.stringify(i))}Object.assign(this,t)}interpolate_(t,i,r,c){t=cg(t),this.validateTokens_(t,i.length),i=this.interpolateArguments_(t,i,r),r=[];for(let u=0,f;f=i[u];u++)if(this.isInputKeyword_(f.type)){if(t=this.inputFromJson_(f,c)){for(let E=0,S;S=r[E];E++)t.appendField(S[0],S[1]);r.length=0}}else(t=this.fieldFromJson_(f))&&r.push([t,f.name])}validateTokens_(t,i){const r=[];let c=0;for(let u=0;u<t.length;u++){const f=t[u];if(typeof f=="number"){if(1>f||f>i)throw Error('Block "'+this.type+'": Message index %'+f+" out of range.");if(r[f])throw Error('Block "'+this.type+'": Message index %'+f+" duplicated.");r[f]=!0,c++}}if(c!==i)throw Error('Block "'+this.type+'": Message does not reference all '+i+" arg(s).")}interpolateArguments_(t,i,r){const c=[];for(let f=0;f<t.length;f++){var u=t[f];if(typeof u=="number"&&(u=i[u-1]),typeof u=="string"){if(u===`
`)u={type:"input_end_row"},r&&(u.align=r);else if(u=this.stringToFieldJson_(u),!u)continue}c.push(u)}return(t=c.length)&&!this.isInputKeyword_(c[t-1].type)&&(t={type:"input_dummy"},r&&(t.align=r),c.push(t)),c}fieldFromJson_(t){const i=s.fromJson$$module$build$src$core$field_registry(t);return!i&&t.alt?typeof t.alt=="string"?(t=this.stringToFieldJson_(t.alt))?this.fieldFromJson_(t):null:this.fieldFromJson_(t.alt):i}inputFromJson_(t,i){var r={LEFT:s.Align$$module$build$src$core$inputs$align.LEFT,RIGHT:s.Align$$module$build$src$core$inputs$align.RIGHT,CENTRE:s.Align$$module$build$src$core$inputs$align.CENTRE,CENTER:s.Align$$module$build$src$core$inputs$align.CENTRE};let c;switch(t.type){case"input_value":c=this.appendValueInput(t.name);break;case"input_statement":c=this.appendStatementInput(t.name);break;case"input_dummy":c=this.appendDummyInput(t.name);break;case"input_end_row":c=this.appendEndRowInput(t.name);break;default:c=this.appendInputFromRegistry(t.type,t.name)}return c?(t.check&&c.setCheck(t.check),t.align&&(r=r[t.align.toUpperCase()],r===void 0?console.warn(i+"Illegal align value: ",t.align):c.setAlign(r)),c):null}isInputKeyword_(t){return t==="input_value"||t==="input_statement"||t==="input_dummy"||t==="input_end_row"||d(rt.INPUT,t)}stringToFieldJson_(t){return(t=t.trim())?{type:"field_label",text:t}:null}moveInputBefore(t,i){if(t!==i){var r=-1,c=i?-1:this.inputList.length;for(let u=0,f;f=this.inputList[u];u++)if(f.name===t){if(r=u,c!==-1)break}else if(i&&f.name===i&&(c=u,r!==-1))break;if(r===-1)throw Error('Named input "'+t+'" not found.');if(c===-1)throw Error('Reference input "'+i+'" not found.');this.moveNumberedInputBefore(r,c)}}moveNumberedInputBefore(t,i){if(t===i)throw Error("Can't move input to itself.");if(t>=this.inputList.length)throw RangeError("Input index "+t+" out of bounds.");if(i>this.inputList.length)throw RangeError("Reference input "+i+" out of bounds.");const r=this.inputList[t];this.inputList.splice(t,1),t<i&&i--,this.inputList.splice(i,0,r)}removeInput(t,i){for(let r=0,c;c=this.inputList[r];r++)if(c.name===t)return c instanceof Ji&&this.statementInputCount--,c.dispose(),this.inputList.splice(r,1),!0;if(i)return!1;throw Error("Input not found: "+t)}getInput(t){for(let i=0,r;r=this.inputList[i];i++)if(r.name===t)return r;return null}getInputTargetBlock(t){return(t=this.getInput(t))&&t.connection&&t.connection.targetBlock()}getCommentText(){let t,i;return(i=(t=this.getIcon(yi.TYPE))==null?void 0:t.getText())!=null?i:null}setCommentText(t){var i;let r;const c=(r=(i=this.getIcon(yi.TYPE))==null?void 0:i.getText())!=null?r:null;c!==t&&(t!==null?((i=this.getIcon(yi.TYPE))||(i=this.addIcon(new yi(this))),s.disable$$module$build$src$core$events$utils(),i.setText(t),s.enable$$module$build$src$core$events$utils()):this.removeIcon(yi.TYPE),it(new(ut(s.CHANGE$$module$build$src$core$events$utils))(this,"comment",null,c,t)))}setWarningText(t,i){}setMutator(t){}addIcon(t){if(this.hasIcon(t.getType()))throw new II(t);return this.icons.push(t),this.icons.sort((i,r)=>i.getWeight()-r.getWeight()),t}removeIcon(t){if(!this.hasIcon(t))return!1;let i;return(i=this.getIcon(t))==null||i.dispose(),this.icons=this.icons.filter(r=>!r.getType().equals(t)),!0}hasIcon(t){return this.icons.some(i=>i.getType().equals(t))}getIcon(t){return t instanceof xi?this.icons.find(i=>i.getType().equals(t)):this.icons.find(i=>i.getType().toString()===t)}getIcons(){return[...this.icons]}getRelativeToSurfaceXY(){return this.xy_}moveBy(t,i,r){if(this.parentBlock_)throw Error("Block has parent");const c=new(ut(s.MOVE$$module$build$src$core$events$utils))(this);r&&c.setReason(r),this.xy_.translate(t,i),c.recordNew(),it(c)}makeConnection_(t){return new re(this,t)}allInputsFilled(t){if(t===void 0&&(t=!0),!t&&this.isShadow())return!1;for(let r=0,c;c=this.inputList[r];r++)if(c.connection){var i=c.connection.targetBlock();if(!i||!i.allInputsFilled(t))return!1}return(i=this.getNextBlock())?i.allInputsFilled(t):!0}toDevString(){let t=this.type?'"'+this.type+'" block':"Block";return this.id&&(t+=' (id="'+this.id+'")'),t}};Bl.COLLAPSED_INPUT_NAME=Pl,Bl.COLLAPSED_FIELD_NAME=nd;var PI=class{constructor(){this.drawer=this.curNode=this.colour=null,this.type="marker"}setDrawer(t){this.drawer=t}getDrawer(){return this.drawer}getCurNode(){return this.curNode}setCurNode(t){const i=this.curNode;this.curNode=t,this.drawer&&this.drawer.draw(i,this.curNode)}draw(){this.drawer&&this.drawer.draw(this.curNode,this.curNode)}hide(){this.drawer&&this.drawer.hide()}dispose(){this.getDrawer()&&this.getDrawer().dispose()}},g$=class extends PI{constructor(){super(),this.type="cursor"}next(){var t=this.getCurNode();if(!t)return null;for(t=t.next();t&&t.next()&&(t.getType()===Q.types.NEXT||t.getType()===Q.types.BLOCK);)t=t.next();return t&&this.setCurNode(t),t}in(){var t=this.getCurNode();if(!t)return null;(t.getType()===Q.types.PREVIOUS||t.getType()===Q.types.OUTPUT)&&(t=t.next());let i,r;return(t=(r=(i=t)==null?void 0:i.in())!=null?r:null)&&this.setCurNode(t),t}prev(){var t=this.getCurNode();if(!t)return null;for(t=t.prev();t&&t.prev()&&(t.getType()===Q.types.NEXT||t.getType()===Q.types.BLOCK);)t=t.prev();return t&&this.setCurNode(t),t}out(){var t=this.getCurNode();return t?((t=t.out())&&t.getType()===Q.types.BLOCK&&(t=t.prev()||t),t&&this.setCurNode(t),t):null}};o(rt.CURSOR,Co,g$);var Ta=class extends g${constructor(){super()}next(){var t=this.getCurNode();return t?((t=this.getNextNode_(t,this.validNode_))&&this.setCurNode(t),t):null}in(){return this.next()}prev(){var t=this.getCurNode();return t?((t=this.getPreviousNode_(t,this.validNode_))&&this.setCurNode(t),t):null}out(){return this.prev()}getNextNode_(t,i){if(!t)return null;const r=t.in()||t.next();return i(r)?r:r?this.getNextNode_(r,i):(t=this.findSiblingOrParent(t.out()),i(t)?t:t?this.getNextNode_(t,i):null)}getPreviousNode_(t,i){if(!t)return null;let r=t.prev();return r=r?this.getRightMostChild(r):t.out(),i(r)?r:r?this.getPreviousNode_(r,i):null}validNode_(t){let i=!1;return t=t&&t.getType(),(t===Q.types.OUTPUT||t===Q.types.INPUT||t===Q.types.FIELD||t===Q.types.NEXT||t===Q.types.PREVIOUS||t===Q.types.WORKSPACE)&&(i=!0),i}findSiblingOrParent(t){if(!t)return null;const i=t.next();return i||this.findSiblingOrParent(t.out())}getRightMostChild(t){if(!t.in())return t;for(t=t.in();t&&t.next();)t=t.next();return this.getRightMostChild(t)}};Ta.registrationName="basicCursor",o(rt.CURSOR,Ta.registrationName,Ta);var BI=class extends Ta{validNode_(t){let i=!1;const r=t&&t.getType();return t&&(t=t.getLocation(),r===Q.types.FIELD&&t&&t.isTabNavigable()&&t.isClickable()&&(i=!0)),i}},m$=10,Si=class extends re{constructor(t,i){super(t,i),this.targetConnection=this.highlightPath=null,this.db=t.workspace.connectionDBList[i],this.dbOpposite=t.workspace.connectionDBList[_r[i]],this.offsetInBlock=new pt(0,0),this.trackedState=Si.TrackedState.WILL_TRACK}dispose(){super.dispose(),this.trackedState===Si.TrackedState.TRACKED&&this.db.removeConnection(this,this.y),this.highlightPath&&(Ct(this.highlightPath),this.highlightPath=null)}getSourceBlock(){return super.getSourceBlock()}targetBlock(){return super.targetBlock()}distanceFrom(t){const i=this.x-t.x;return t=this.y-t.y,Math.sqrt(i*i+t*t)}bumpAwayFrom(t){if(!this.sourceBlock_.workspace.isDragging()){var i=this.sourceBlock_.getRootBlock();if(!i.isInFlyout){var r=!1;if(!i.isMovable()){if(i=t.getSourceBlock().getRootBlock(),!i.isMovable())return;t=this,r=!0}var c=z()==i;c||i.addSelect();var u=t.x+s.config$$module$build$src$core$config.snapRadius+Math.floor(Math.random()*m$)-this.x,f=t.y+s.config$$module$build$src$core$config.snapRadius+Math.floor(Math.random()*m$)-this.y;r&&(f=-f),i.RTL&&(u=t.x-s.config$$module$build$src$core$config.snapRadius-Math.floor(Math.random()*m$)-this.x),i.moveBy(u,f,["bump"]),c||i.removeSelect()}}}moveTo(t,i){let r=!1;return this.trackedState===Si.TrackedState.WILL_TRACK?(this.db.addConnection(this,i),this.trackedState=Si.TrackedState.TRACKED,r=!0):this.trackedState===Si.TrackedState.TRACKED&&(this.db.removeConnection(this,this.y),this.db.addConnection(this,i),r=!0),this.x=t,this.y=i,r}moveBy(t,i){return this.moveTo(this.x+t,this.y+i)}moveToOffset(t){return this.moveTo(t.x+this.offsetInBlock.x,t.y+this.offsetInBlock.y)}setOffsetInBlock(t,i){this.offsetInBlock.x=t,this.offsetInBlock.y=i}getOffsetInBlock(){return this.offsetInBlock}tightenEfficiently(){var t=this.targetConnection;const i=this.targetBlock();t&&i&&(t=pt.difference(this.offsetInBlock,t.offsetInBlock),i.translate(t.x,t.y))}closest(t,i){return this.dbOpposite.searchForClosest(this,t,i)}highlight(){if(!this.highlightPath){var t=this.sourceBlock_.workspace.getRenderer().getConstants(),i=t.shapeFor(this);this.type===wt.INPUT_VALUE||this.type===wt.OUTPUT_VALUE?(t=t.TAB_OFFSET_FROM_TOP,i=Ne(0,-t)+It("v",t)+i.pathDown+It("v",t)):(t=t.NOTCH_OFFSET_LEFT-t.CORNER_RADIUS,i=Ne(-t,0)+It("h",t)+i.pathLeft+It("h",t)),t=this.offsetInBlock,this.highlightPath=R(D.PATH,{class:"blocklyHighlightedConnectionPath",d:i,transform:`translate(${t.x}, ${t.y})`+(this.sourceBlock_.RTL?" scale(-1 1)":"")},this.sourceBlock_.getSvgRoot())}}unhighlight(){this.highlightPath&&(Ct(this.highlightPath),this.highlightPath=null)}setTracking(t){t&&this.trackedState===Si.TrackedState.TRACKED||!t&&this.trackedState===Si.TrackedState.UNTRACKED||this.sourceBlock_.isInFlyout||(t?(this.db.addConnection(this,this.y),this.trackedState=Si.TrackedState.TRACKED):(this.trackedState===Si.TrackedState.TRACKED&&this.db.removeConnection(this,this.y),this.trackedState=Si.TrackedState.UNTRACKED))}stopTrackingAll(){if(this.setTracking(!1),this.targetConnection){const t=this.targetBlock().getDescendants(!1);for(let i=0;i<t.length;i++){const r=t[i],c=r.getConnections_(!0);for(let u=0;u<c.length;u++)c[u].setTracking(!1);for(const u of r.getIcons())ln(u)&&u.setBubbleVisible(!1)}}}startTrackingAll(){this.setTracking(!0);let t=[];if(this.type!==wt.INPUT_VALUE&&this.type!==wt.NEXT_STATEMENT)return t;const i=this.targetBlock();if(i){let r;i.isCollapsed()?(r=[],i.outputConnection&&r.push(i.outputConnection),i.nextConnection&&r.push(i.nextConnection),i.previousConnection&&r.push(i.previousConnection)):r=i.getConnections_(!0);for(let c=0;c<r.length;c++)t.push(...r[c].startTrackingAll());t.length||(t=[i])}return t}onFailedConnect(t){const i=this.getSourceBlock();if(vt()){const r=s.getGroup$$module$build$src$core$events$utils();setTimeout((function(){i.isDisposed()||i.getParent()||(s.setGroup$$module$build$src$core$events$utils(r),this.bumpAwayFrom(t),s.setGroup$$module$build$src$core$events$utils(!1))}).bind(this),s.config$$module$build$src$core$config.bumpDelay)}}disconnectInternal(t=!0){const{parentConnection:i,childConnection:r}=this.getParentAndChildConnections();if(i&&r){var c=i.getSourceBlock(),u=r.getSourceBlock();super.disconnectInternal(t),c.rendered&&c.queueRender(),u.rendered&&(u.updateDisabled(),u.queueRender(),u.getSvgRoot().style.display="block")}}respawnShadow_(){super.respawnShadow_();const t=this.targetBlock();t&&(t.initSvg(),t.queueRender())}neighbours(t){return this.dbOpposite.getNeighbours(this,t)}connect_(t){super.connect_(t);var i=this.getSourceBlock();t=t.getSourceBlock();const r=i.rendered,c=t.rendered;r&&i.updateDisabled(),c&&t.updateDisabled(),r&&c&&(this.type===wt.NEXT_STATEMENT||this.type===wt.PREVIOUS_STATEMENT?t.queueRender():i.queueRender()),(i=i.getInputWithBlock(t))&&(i=i.isVisible(),t.getSvgRoot().style.display=i?"block":"none")}onCheckChanged_(){!this.isConnected()||this.targetConnection&&this.getConnectionChecker().canConnect(this,this.targetConnection,!1)||((this.isSuperior()?this.targetBlock():this.sourceBlock_).unplug(),this.sourceBlock_.bumpNeighbours())}setCheck(t){return super.setCheck(t),this.sourceBlock_.rendered&&this.sourceBlock_.queueRender(),this}};(function(t){t=t.TrackedState||(t.TrackedState={}),t[t.WILL_TRACK=-1]="WILL_TRACK",t[t.UNTRACKED=0]="UNTRACKED",t[t.TRACKED=1]="TRACKED"})(Si||(Si={})),Si.TrackedState;var to=class extends Bl{constructor(t,i,r){super(t,i,r),this.width=this.height=0,this.warningTextDb=new Map,this.warning=this.mutator=null,this.eventsInit_=this.renderIsInProgress_=this.visuallyDisabled=this.rendered=!1,this.translation="",this.bumpNeighboursPid=0,this.dragging=!1,this.relativeCoords=new pt(0,0),this.workspace=t,this.svgGroup_=R(D.G,{}),this.style=t.getRenderer().getConstants().getBlockStyle(null),this.pathObject=t.getRenderer().makePathObject(this.svgGroup_,this.style),t=this.pathObject.svgPath,t.tooltip=this,ll(t),this.svgGroup_.setAttribute("data-id",this.id),this.doInit_()}initSvg(){if(!this.workspace.rendered)throw TypeError("Workspace is headless.");for(let i=0,r;r=this.inputList[i];i++)r.init();for(var t of this.getIcons())t.initView(this.createIconPointerDownListener(t)),t.updateEditable();this.applyColour(),this.pathObject.updateMovable(this.isMovable()),t=this.getSvgRoot(),this.workspace.options.readOnly||this.eventsInit_||!t||yt(t,"pointerdown",this,this.onMouseDown_),this.eventsInit_=!0,t.parentNode||this.workspace.getCanvas().appendChild(t)}getColourSecondary(){return this.style.colourSecondary}getColourTertiary(){return this.style.colourTertiary}select(){if(this.isShadow()&&this.getParent())this.getParent().select();else if(z()!==this){var t=null;if(z()){t=z().id,s.disable$$module$build$src$core$events$utils();try{z().unselect()}finally{s.enable$$module$build$src$core$events$utils()}}t=new(ut(ko))(t,this.id,this.workspace.id),it(t),X(this),this.addSelect()}}unselect(){if(z()===this){var t=new(ut(ko))(this.id,null,this.workspace.id);t.workspaceId=this.workspace.id,it(t),X(null),this.removeSelect()}}setParent(t){const i=this.parentBlock_;if(t!==i){I(),super.setParent(t),M();var r=this.getSvgRoot();if(!this.workspace.isClearing&&r){var c=this.getRelativeToSurfaceXY();t?t.getSvgRoot().appendChild(r):i&&((t=this.workspace.getCanvas().querySelector(".blocklyDragging"))?this.workspace.getCanvas().insertBefore(r,t):this.workspace.getCanvas().appendChild(r),this.translate(c.x,c.y)),this.applyColour()}}}getRelativeToSurfaceXY(){const t=this.workspace.getLayerManager();if(!t)throw Error("Cannot calculate position because the workspace has not been appended");let i=0,r=0,c=this.getSvgRoot();if(c)do{const u=ls(c);i+=u.x,r+=u.y,c=c.parentNode}while(c&&!t.hasLayer(c));return new pt(i,r)}moveBy(t,i,r){if(this.parentBlock_)throw Error("Block has parent");const c=Lt();let u=null;c&&(u=new(ut(s.MOVE$$module$build$src$core$events$utils))(this),r&&u.setReason(r)),t=new pt(t,i),i=this.getRelativeToSurfaceXY(),t=pt.sum(i,t),this.translate(t.x,t.y),this.updateComponentLocations(t),c&&u&&(u.recordNew(),it(u)),this.workspace.resizeContents()}translate(t,i){this.translation=`translate(${t}, ${i})`,this.relativeCoords=new pt(t,i),this.getSvgRoot().setAttribute("transform",this.getTranslation())}getTranslation(){return this.translation}moveTo(t,i){const r=this.getRelativeToSurfaceXY();this.moveBy(t.x-r.x,t.y-r.y,i)}moveDuringDrag(t){this.translate(t.x,t.y),this.getSvgRoot().setAttribute("transform",this.getTranslation()),this.updateComponentLocations(t)}snapToGrid(){if(!(this.isDeadOrDying()||this.workspace.isDragging()||this.getParent()||this.isInFlyout)){var t=this.workspace.getGrid();if(t&&t.shouldSnap()){var i=t.getSpacing(),r=i/2,c=this.getRelativeToSurfaceXY();t=Math.round(Math.round((c.x-r)/i)*i+r-c.x),i=Math.round(Math.round((c.y-r)/i)*i+r-c.y),(t||i)&&this.moveBy(t,i,["snap"])}}}getBoundingRectangle(){const t=this.getRelativeToSurfaceXY(),i=this.getHeightWidth();let r,c;return this.RTL?(r=t.x-i.width,c=t.x):(r=t.x,c=t.x+i.width),new ve(t.y,t.y+i.height,r,c)}markDirty(){this.pathObject.constants=this.workspace.getRenderer().getConstants();for(let t=0,i;i=this.inputList[t];t++)i.markDirty()}setCollapsed(t){this.collapsed_!==t&&(super.setCollapsed(t),this.updateCollapsed_())}updateCollapsed_(){var t=this.isCollapsed();const i=Pl,r=nd;for(let u=0,f;f=this.inputList[u];u++)f.name!==i&&f.setVisible(!t);for(var c of this.getIcons())c.updateCollapsed();t?(t=this.toString(hI),(c=this.getField(r))?c.setValue(t):(this.getInput(i)||this.appendDummyInput(i)).appendField(new Ir(t),r)):(this.updateDisabled(),this.removeInput(i))}tab(t,i){const r=new BI;r.setCurNode(Q.createFieldNode(t)),t=r.getCurNode(),i?r.next():r.prev(),(i=r.getCurNode())&&i!==t&&(i.getLocation().showEditor(),this.workspace.keyboardAccessibilityMode&&this.workspace.getCursor().setCurNode(i))}onMouseDown_(t){const i=this.workspace.getGesture(t);i&&i.handleBlockStart(t,this)}showHelp(){const t=typeof this.helpUrl=="function"?this.helpUrl():this.helpUrl;t&&window.open(t)}generateContextMenu(){if(this.workspace.options.readOnly||!this.contextMenu)return null;const t=ne.registry.getContextMenuOptions(ne.ScopeType.BLOCK,{block:this});return this.customContextMenu&&this.customContextMenu(t),t}showContextMenu(t){const i=this.generateContextMenu();i&&i.length&&(Fc(t,i,this.RTL),kf(this))}updateComponentLocations(t){if(this.rendered){this.dragging||this.updateConnectionLocations(t),this.updateIconLocations(t),this.updateFieldLocations(t);for(const i of this.getChildren(!1))i.updateComponentLocations(pt.sum(t,i.relativeCoords))}}updateConnectionLocations(t){for(const i of this.getConnections_(!1))i.moveToOffset(t)}updateIconLocations(t){for(const i of this.getIcons())i.onLocationChange(t)}updateFieldLocations(t){for(const i of this.inputList)for(const r of i.fieldRow)r.onLocationChange(t)}setDragging(t){(this.dragging=t)?(this.translation="",dl.push(...this.getConnections_(!0)),J(this.svgGroup_,"blocklyDragging")):(dl.length=0,mt(this.svgGroup_,"blocklyDragging"));for(let i=0;i<this.childBlocks_.length;i++)this.childBlocks_[i].setDragging(t)}setMovable(t){super.setMovable(t),this.pathObject.updateMovable(t)}setEditable(t){super.setEditable(t),t=this.getIcons();for(let i=0;i<t.length;i++)t[i].updateEditable()}setShadow(t){super.setShadow(t),this.applyColour()}setInsertionMarker(t){this.isInsertionMarker_!==t&&(this.isInsertionMarker_=t)&&(this.setColour(this.workspace.getRenderer().getConstants().INSERTION_MARKER_COLOUR),this.pathObject.updateInsertionMarker(!0))}getSvgRoot(){return this.svgGroup_}dispose(t,i){this.isDeadOrDying()||(ig(),Uc(),i&&this.rendered&&(this.unplug(t),zf(this)),super.dispose(!!t),Ct(this.svgGroup_))}disposeInternal(){this.isDeadOrDying()||(super.disposeInternal(),this.rendered=!1,z()===this&&(this.unselect(),this.workspace.cancelCurrentGesture()),[...this.warningTextDb.values()].forEach(t=>clearTimeout(t)),this.warningTextDb.clear(),this.getIcons().forEach(t=>t.dispose()))}checkAndDelete(){this.workspace.isFlyout||(s.setGroup$$module$build$src$core$events$utils(!0),this.workspace.hideChaff(),this.outputConnection?this.dispose(!1,!0):this.dispose(!0,!0),s.setGroup$$module$build$src$core$events$utils(!1))}toCopyData(){return this.isInsertionMarker_?null:{paster:ia.TYPE,blockState:Us(this,{addCoordinates:!0,addNextBlocks:!1}),typeCounts:H(this,!0)}}applyColour(){this.pathObject.applyColour(this);const t=this.getIcons();for(let i=0;i<t.length;i++)t[i].applyColour();for(let i=0,r;r=this.inputList[i];i++)for(let c=0,u;u=r.fieldRow[c];c++)u.applyColour()}updateDisabled(){const t=!this.isEnabled()||this.getInheritedDisabled();if(this.visuallyDisabled===t){let i;(i=this.getNextBlock())==null||i.updateDisabled()}else{this.applyColour(),this.visuallyDisabled=t;for(const i of this.getChildren(!1))i.updateDisabled()}}getCommentIcon(){j("getCommentIcon","v10","v11","getIcon");let t;return(t=this.getIcon(yi.TYPE))!=null?t:null}setWarningText(t,i=""){if(i)this.warningTextDb.has(i)&&(clearTimeout(this.warningTextDb.get(i)),this.warningTextDb.delete(i));else{for(var r of this.warningTextDb.values())clearTimeout(r);this.warningTextDb.clear()}if(this.workspace.isDragging())this.warningTextDb.set(i,setTimeout(()=>{this.isDeadOrDying()||(this.warningTextDb.delete(i),this.setWarningText(t,i))},100));else if(this.isInFlyout&&(t=null),r=this.getIcon(Is.TYPE),t){let c=this.getSurroundParent(),u=null;for(;c;)c.isCollapsed()&&(u=c),c=c.getSurroundParent();u&&u.setWarningText(s.Msg$$module$build$src$core$msg.COLLAPSED_WARNINGS_WARNING,to.COLLAPSED_WARNING_ID),r?r.addMessage(t,i):this.addIcon(new Is(this).addMessage(t,i))}else r&&(i?(r.addMessage("",i),r.getText()||this.removeIcon(Is.TYPE)):this.removeIcon(Is.TYPE))}setMutator(t){this.removeIcon(s.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE),t&&this.addIcon(t)}addIcon(t){return super.addIcon(t),t instanceof Is&&(this.warning=t),t instanceof s.MutatorIcon$$module$build$src$core$icons$mutator_icon&&(this.mutator=t),this.rendered&&(t.initView(this.createIconPointerDownListener(t)),t.applyColour(),t.updateEditable(),this.queueRender(),Bs(),this.bumpNeighbours()),t}createIconPointerDownListener(t){return i=>{this.isDeadOrDying()||(i=this.workspace.getGesture(i))&&i.setStartIcon(t)}}removeIcon(t){const i=super.removeIcon(t);return t.equals(Is.TYPE)&&(this.warning=null),t.equals(s.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE)&&(this.mutator=null),this.rendered&&(this.queueRender(),Bs(),this.bumpNeighbours()),i}setEnabled(t){this.isEnabled()!==t&&(super.setEnabled(t),this.rendered&&!this.getInheritedDisabled()&&this.updateDisabled())}setHighlighted(t){this.rendered&&this.pathObject.updateHighlighted(t)}addSelect(){this.pathObject.updateSelected(!0)}removeSelect(){this.pathObject.updateSelected(!1)}setDeleteStyle(t){this.pathObject.updateDraggingDelete(t)}getColour(){return this.style.colourPrimary}setColour(t){super.setColour(t),t=this.workspace.getRenderer().getConstants().getBlockStyleForColour(this.colour_),this.pathObject.setStyle(t.style),this.style=t.style,this.styleName_=t.name,this.applyColour()}setStyle(t){const i=this.workspace.getRenderer().getConstants().getBlockStyle(t);if(this.styleName_=t,i)this.hat=i.hat,this.pathObject.setStyle(i),this.colour_=i.colourPrimary,this.style=i,this.applyColour();else throw Error("Invalid style name: "+t)}bringToFront(t=!1){let i=this;if(!i.isDeadOrDying())do{const r=i.getSvgRoot(),c=r.parentNode,u=c.childNodes;if(u[u.length-1]!==r&&c.appendChild(r),t)break;i=i.getParent()}while(i)}setPreviousStatement(t,i){super.setPreviousStatement(t,i),this.rendered&&(this.queueRender(),this.bumpNeighbours())}setNextStatement(t,i){super.setNextStatement(t,i),this.rendered&&(this.queueRender(),this.bumpNeighbours())}setOutput(t,i){super.setOutput(t,i),this.rendered&&(this.queueRender(),this.bumpNeighbours())}setInputsInline(t){super.setInputsInline(t),this.rendered&&(this.queueRender(),this.bumpNeighbours())}removeInput(t,i){return t=super.removeInput(t,i),this.rendered&&(this.queueRender(),this.bumpNeighbours()),t}moveNumberedInputBefore(t,i){super.moveNumberedInputBefore(t,i),this.rendered&&(this.queueRender(),this.bumpNeighbours())}appendInput(t){return super.appendInput(t),this.rendered&&(this.queueRender(),this.bumpNeighbours()),t}setConnectionTracking(t){if(this.previousConnection&&this.previousConnection.setTracking(t),this.outputConnection&&this.outputConnection.setTracking(t),this.nextConnection){this.nextConnection.setTracking(t);var i=this.nextConnection.targetBlock();i&&i.setConnectionTracking(t)}if(!this.collapsed_)for(i=0;i<this.inputList.length;i++){var r=this.inputList[i].connection;r&&(r.setTracking(t),(r=r.targetBlock())&&r.setConnectionTracking(t))}}getConnections_(t){const i=[];if((t||this.rendered)&&(this.outputConnection&&i.push(this.outputConnection),this.previousConnection&&i.push(this.previousConnection),this.nextConnection&&i.push(this.nextConnection),t||!this.collapsed_))for(let r=0,c;c=this.inputList[r];r++)c.connection&&i.push(c.connection);return i}lastConnectionInStack(t){return super.lastConnectionInStack(t)}getMatchingConnection(t,i){return super.getMatchingConnection(t,i)}makeConnection_(t){return new Si(this,t)}getNextBlock(){return super.getNextBlock()}getPreviousBlock(){return super.getPreviousBlock()}bumpNeighbours(){if(!this.bumpNeighboursPid){var t=s.getGroup$$module$build$src$core$events$utils();this.bumpNeighboursPid=setTimeout(()=>{const i=s.getGroup$$module$build$src$core$events$utils();s.setGroup$$module$build$src$core$events$utils(t),this.getRootBlock().bumpNeighboursInternal(),s.setGroup$$module$build$src$core$events$utils(i),this.bumpNeighboursPid=0},s.config$$module$build$src$core$config.bumpDelay)}}bumpNeighboursInternal(){const t=this.getRootBlock();if(!(this.isDeadOrDying()||this.workspace.isDragging()||t.isInFlyout))for(const i of this.getConnections_(!1)){if(i.isSuperior()){let r;(r=i.targetBlock())==null||r.bumpNeighboursInternal()}for(const r of i.neighbours(s.config$$module$build$src$core$config.snapRadius))r.getSourceBlock().getRootBlock()!==t&&(i.isConnected()&&r.isConnected()||(i.isSuperior()?r.bumpAwayFrom(i):i.bumpAwayFrom(r)))}}scheduleSnapAndBump(){const t=s.getGroup$$module$build$src$core$events$utils();setTimeout(()=>{s.setGroup$$module$build$src$core$events$utils(t),this.snapToGrid(),s.setGroup$$module$build$src$core$events$utils(!1)},s.config$$module$build$src$core$config.bumpDelay/2),this.bumpNeighbours()}positionNearConnection(t,i,r){if(t.type===wt.NEXT_STATEMENT||t.type===wt.INPUT_VALUE){let c=i.x;i=i.y,c+=r.x-t.getOffsetInBlock().x,i+=r.y-t.getOffsetInBlock().y,this.moveBy(c,i)}}getChildren(t){return super.getChildren(t)}queueRender(){return hf(this)}render(){this.queueRender(),Bs()}renderEfficiently(){this.rendered=!0,I(),this.isCollapsed()&&this.updateCollapsed_(),this.isEnabled()||this.updateDisabled(),this.workspace.getRenderer().render(this),this.tightenChildrenEfficiently(),M(),this.updateMarkers_()}tightenChildrenEfficiently(){for(const t of this.inputList){const i=t.connection;i&&i.tightenEfficiently()}this.nextConnection&&this.nextConnection.tightenEfficiently()}updateMarkers_(){this.workspace.keyboardAccessibilityMode&&this.pathObject.cursorSvg&&this.workspace.getCursor().draw(),this.workspace.keyboardAccessibilityMode&&this.pathObject.markerSvg&&this.workspace.getMarker(aa.LOCAL_MARKER).draw();for(const t of this.inputList)for(const i of t.fieldRow)i.updateMarkers_()}setCursorSvg(t){this.pathObject.setCursorSvg(t)}setMarkerSvg(t){this.pathObject.setMarkerSvg(t)}getHeightWidth(){let t=this.height,i=this.width;var r=this.getNextBlock();if(r){r=r.getHeightWidth();const c=this.workspace.getRenderer().getConstants().NOTCH_HEIGHT;t+=r.height-c,i=Math.max(i,r.width)}return{height:t,width:i}}fadeForReplacement(t){this.pathObject.updateReplacementFade(t)}highlightShapeForInput(t,i){this.pathObject.updateShapeForInputHighlight(t,i)}};to.INLINE=-1,to.COLLAPSED_WARNING_ID="TEMP_COLLAPSED_WARNING_";var FI=class{constructor(){}onDragEnter(t){}onDragOver(t){}onDragExit(t){}onDrop(t){}getClientRect(){return null}shouldPreventMove(t){return!1}},rd=class extends FI{constructor(){super(),this.wouldDelete_=!1}wouldDelete(t,i){return t instanceof to?(t=!t.getParent()&&t.isDeletable(),this.updateWouldDelete_(t&&!i)):this.updateWouldDelete_(t.isDeletable()),this.wouldDelete_}updateWouldDelete_(t){this.wouldDelete_=t}},UI=class extends rd{constructor(t){super(),this.workspace=t,this.id="trashcan",this.contents=[],this.flyout=null,this.isLidOpen=!1,this.minOpenness=0,this.lidTask=this.svgLid=this.svgGroup=null,this.top=this.left=this.lidOpen=0,this.initialized=!1,0>=this.workspace.options.maxTrashcanContents||(t=new hs({scrollbars:!0,parentWorkspace:this.workspace,rtl:this.workspace.RTL,oneBasedIndex:this.workspace.options.oneBasedIndex,renderer:this.workspace.options.renderer,rendererOverrides:this.workspace.options.rendererOverrides,move:{scrollbars:!0}}),this.workspace.horizontalLayout?(t.toolboxPosition=this.workspace.toolboxPosition===Wt.TOP?Wt.BOTTOM:Wt.TOP,this.flyout=new(T(rt.FLYOUTS_HORIZONTAL_TOOLBOX,this.workspace.options,!0))(t)):(t.toolboxPosition=this.workspace.toolboxPosition===Wt.RIGHT?Wt.LEFT:Wt.RIGHT,this.flyout=new(T(rt.FLYOUTS_VERTICAL_TOOLBOX,this.workspace.options,!0))(t)),this.workspace.addChangeListener(this.onDelete.bind(this)))}createDom(){this.svgGroup=R(D.G,{class:"blocklyTrash"});let t;const i=String(Math.random()).substring(2);t=R(D.CLIPPATH,{id:"blocklyTrashBodyClipPath"+i},this.svgGroup),R(D.RECT,{width:Fl,height:ld,y:Ul},t);const r=R(D.IMAGE,{width:vi.width,x:-$$,height:vi.height,y:-_$,"clip-path":"url(#blocklyTrashBodyClipPath"+i+")"},this.svgGroup);return r.setAttributeNS(Xi,"xlink:href",this.workspace.options.pathToMedia+vi.url),t=R(D.CLIPPATH,{id:"blocklyTrashLidClipPath"+i},this.svgGroup),R(D.RECT,{width:Fl,height:Ul},t),this.svgLid=R(D.IMAGE,{width:vi.width,x:-$$,height:vi.height,y:-_$,"clip-path":"url(#blocklyTrashLidClipPath"+i+")"},this.svgGroup),this.svgLid.setAttributeNS(Xi,"xlink:href",this.workspace.options.pathToMedia+vi.url),w(this.svgGroup,"pointerdown",this,this.blockMouseDownWhenOpenable),w(this.svgGroup,"pointerup",this,this.click),w(r,"pointerover",this,this.mouseOver),w(r,"pointerout",this,this.mouseOut),this.animateLid(),this.svgGroup}init(){0<this.workspace.options.maxTrashcanContents&&(Qt(this.flyout.createDom(D.SVG),this.workspace.getParentSvg()),this.flyout.init(this.workspace)),this.workspace.getComponentManager().addComponent({component:this,weight:1,capabilities:[je.Capability.AUTOHIDEABLE,je.Capability.DELETE_AREA,je.Capability.DRAG_TARGET,je.Capability.POSITIONABLE]}),this.initialized=!0,this.setLidOpen(!1)}dispose(){this.workspace.getComponentManager().removeComponent("trashcan"),this.svgGroup&&Ct(this.svgGroup),this.lidTask&&clearTimeout(this.lidTask)}hasContents(){return!!this.contents.length}contentsIsOpen(){return!!this.flyout&&this.flyout.isVisible()}openFlyout(){if(!this.contentsIsOpen()){var t=this.contents.map(function(r){return JSON.parse(r)}),i=this.workspace.getParentSvg().style;i.cursor="wait",setTimeout(()=>{let r;(r=this.flyout)==null||r.show(t),i.cursor="";let c;(c=this.workspace.scrollbar)==null||c.setVisible(!1)},10),this.fireUiEvent(!0)}}closeFlyout(){if(this.contentsIsOpen()){var t;(t=this.flyout)==null||t.hide();var i;(i=this.workspace.scrollbar)==null||i.setVisible(!0),this.fireUiEvent(!1),this.workspace.recordDragTargets()}}autoHide(t){!t&&this.flyout&&this.closeFlyout()}emptyContents(){this.hasContents()&&(this.contents.length=0,this.setMinOpenness(0),this.closeFlyout())}position(t,i){if(this.initialized){var r=Xh(this.workspace,t);t=zh(r,new Ce(Fl,ld+Ul),vR,HI,t,this.workspace),i=Yh(t,HI,r.vertical===Lo.TOP?$n.DOWN:$n.UP,i),this.top=i.top,this.left=i.left;var c;(c=this.svgGroup)==null||c.setAttribute("transform","translate("+this.left+","+this.top+")")}}getBoundingRectangle(){return new ve(this.top,this.top+ld+Ul,this.left,this.left+Fl)}getClientRect(){if(!this.svgGroup)return null;var t=this.svgGroup.getBoundingClientRect();const i=t.top+_$-cd;return t=t.left+$$-cd,new ve(i,i+Ul+ld+2*cd,t,t+Fl+2*cd)}onDragOver(t){this.setLidOpen(this.wouldDelete_)}onDragExit(t){this.setLidOpen(!1)}onDrop(t){setTimeout(this.setLidOpen.bind(this,!1),100)}setLidOpen(t){this.isLidOpen!==t&&(this.lidTask&&clearTimeout(this.lidTask),this.isLidOpen=t,this.animateLid())}animateLid(){const t=SR;var i=1/(t+1);this.lidOpen+=this.isLidOpen?i:-i,this.lidOpen=Math.min(Math.max(this.lidOpen,this.minOpenness),1),this.setLidAngle(this.lidOpen*GI),i=VI+this.lidOpen*(CR-VI),this.svgGroup&&(this.svgGroup.style.opacity=`${i}`),this.lidOpen>this.minOpenness&&1>this.lidOpen&&(this.lidTask=setTimeout(this.animateLid.bind(this),IR/t))}setLidAngle(t){const i=this.workspace.toolboxPosition===Wt.RIGHT||this.workspace.horizontalLayout&&this.workspace.RTL;let r;(r=this.svgLid)==null||r.setAttribute("transform","rotate("+(i?-t:t)+","+(i?4:Fl-4)+","+(Ul-2)+")")}setMinOpenness(t){this.minOpenness=t,this.isLidOpen||this.setLidAngle(t*GI)}closeLid(){this.setLidOpen(!1)}click(){this.hasContents()&&!this.workspace.isDragging()&&this.openFlyout()}fireUiEvent(t){t=new(ut(ml))(t,this.workspace.id),it(t)}blockMouseDownWhenOpenable(t){!this.contentsIsOpen()&&this.hasContents()&&t.stopPropagation()}mouseOver(){this.hasContents()&&this.setLidOpen(!0)}mouseOut(){this.setLidOpen(!1)}onDelete(t){if(!(0>=this.workspace.options.maxTrashcanContents||t.type!==s.DELETE$$module$build$src$core$events$utils||t.type!==s.DELETE$$module$build$src$core$events$utils||t.wasShadow)){if(!t.oldJson)throw Error("Encountered a delete event without proper oldJson");if(t=JSON.stringify(this.cleanBlockJson(t.oldJson)),this.contents.indexOf(t)===-1){for(this.contents.unshift(t);this.contents.length>this.workspace.options.maxTrashcanContents;)this.contents.pop();this.setMinOpenness(yR)}}}cleanBlockJson(t){function i(r){if(r){if(delete r.id,delete r.x,delete r.y,delete r.enabled,r.icons&&r.icons.comment){var c=r.icons.comment;delete c.height,delete c.width,delete c.pinned}c=r.inputs;for(var u in c){var f=c[u];const E=f.block;f=f.shadow,E&&i(E),f&&i(f)}r.next&&(u=r.next,r=u.block,u=u.shadow,r&&i(r),u&&i(u))}}return t=JSON.parse(JSON.stringify(t)),i(t),Object.assign({},{kind:"BLOCK"},t)}},Fl=47,ld=44,Ul=16,HI=20,vR=20,cd=10,$$=0,_$=32,yR=.1,IR=80,SR=4,VI=.4,CR=.8,GI=45,ae=class{constructor(){this.shortcuts=new Map,this.keyMap=new Map,this.reset()}reset(){this.shortcuts.clear(),this.keyMap.clear()}register(t,i){if(this.shortcuts.get(t.name)&&!i)throw Error(`Shortcut named "${t.name}" already exists.`);if(this.shortcuts.set(t.name,t),(i=t.keyCodes)&&0<i.length)for(let r=0;r<i.length;r++)this.addKeyMapping(i[r],t.name,!!t.allowCollision)}unregister(t){return this.shortcuts.get(t)?(this.removeAllKeyMappings(t),this.shortcuts.delete(t),!0):(console.warn(`Keyboard shortcut named "${t}" not found.`),!1)}addKeyMapping(t,i,r){t=`${t}`;const c=this.keyMap.get(t);if(c&&!r)throw Error(`Shortcut named "${i}" collides with shortcuts "${c}"`);c&&r?c.unshift(i):this.keyMap.set(t,[i])}removeKeyMapping(t,i,r){const c=this.keyMap.get(t);if(!c)return r||console.warn(`No keyboard shortcut named "${i}" registered with key code "${t}"`),!1;const u=c.indexOf(i);return-1<u?(c.splice(u,1),c.length===0&&this.keyMap.delete(t),!0):(r||console.warn(`No keyboard shortcut named "${i}" registered with key code "${t}"`),!1)}removeAllKeyMappings(t){for(const i of this.keyMap.keys())this.removeKeyMapping(i,t,!0)}setKeyMap(t){this.keyMap.clear();for(const i in t)this.keyMap.set(i,t[i])}getKeyMap(){const t=Object.create(null);for(const[i,r]of this.keyMap)t[i]=r;return t}getRegistry(){const t=Object.create(null);for(const[i,r]of this.shortcuts)t[i]=r;return So(Object.create(null),t)}onKeyDown(t,i){var r=this.serializeKeyEvent_(i);if(r=this.getShortcutNamesByKeyCode(r),!r)return!1;for(let c=0,u;u=r[c];c++){const f=this.shortcuts.get(u);let E,S;if((E=f)==null||!E.preconditionFn||(S=f)!=null&&S.preconditionFn(t)){let W,bt;if((W=f)!=null&&W.callback&&((bt=f)!=null&&bt.callback(t,i,f)))return!0}}return!1}getShortcutNamesByKeyCode(t){return this.keyMap.get(t)||[]}getKeyCodesByShortcutName(t){const i=[];for(const[r,c]of this.keyMap)-1<c.indexOf(t)&&i.push(r);return i}serializeKeyEvent_(t){let i="";for(const r in ae.modifierKeys)t.getModifierState(r)&&(i!==""&&(i+="+"),i+=r);return i!==""&&t.keyCode?i=i+"+"+t.keyCode:t.keyCode&&(i=String(t.keyCode)),i}checkModifiers_(t){for(let i=0,r;r=t[i];i++)if(!(r in ae.modifierKeys))throw Error(r+" is not a valid modifier key.")}createSerializedKey(t,i){let r="";if(i){this.checkModifiers_(i);for(const c in ae.modifierKeys)-1<i.indexOf(ae.modifierKeys[c])&&(r!==""&&(r+="+"),r+=c)}return r!==""&&t?r=r+"+"+t:t&&(r=`${t}`),r}};ae.registry=new ae,function(t){t=t.modifierKeys||(t.modifierKeys={}),t[t.Shift=16]="Shift",t[t.Control=17]="Control",t[t.Alt=18]="Alt",t[t.Meta=91]="Meta"}(ae||(ae={}));var eo;(function(t){t.ESCAPE="escape",t.DELETE="delete",t.COPY="copy",t.CUT="cut",t.PASTE="paste",t.UNDO="undo",t.REDO="redo"})(eo||(eo={}));var ba=null,ad=null;Ng();var io={};io.names=eo,io.registerCopy=wg,io.registerCut=kg,io.registerDefaultShortcuts=Ng,io.registerDelete=Cg,io.registerEscape=Sg,io.registerPaste=Og,io.registerRedo=Rg,io.registerUndo=Ag;var wR=class{constructor(t,i){this.procedureModelClass=t,this.parameterModelClass=i,this.priority=sI}save(t){return t=t.getProcedureMap().getProcedures().map(i=>Lg(i)),t.length?t:null}load(t,i){const r=i.getProcedureMap();for(const c of t)r.add(xg(this.procedureModelClass,this.parameterModelClass,c,i))}clear(t){t.getProcedureMap().clear()}},Hl={};Hl.ProcedureSerializer=wR,Hl.loadParameter=Dg,Hl.loadProcedure=xg,Hl.saveParameter=Mg,Hl.saveProcedure=Lg;var WI=class{constructor(){this.priority=iI}save(t){const i=[];for(const r of t.getAllVariables())t={name:r.name,id:r.getId()},r.type&&(t.type=r.type),i.push(t);return i.length?i:null}load(t,i){for(const r of t)i.createVariable(r.name,r.type,r.id)}clear(t){t.getVariableMap().clear()}};ou("variables",new WI);var zI={};zI.VariableSerializer=WI;var T$={};T$.load=oy,T$.save=sy;var kR={blocks:ea,exceptions:pr,priorities:sR,procedures:Hl,registry:Im,variables:zI,workspaces:T$},b$=class{constructor(t,i,r,c,u){this.workspace=t,this.oldHostMetrics_=this.corner_=this.vScroll=this.hScroll=null,i=i===void 0?!0:i,r=r===void 0?!0:r;const f=i&&r;i&&(this.hScroll=new Ge(t,!0,f,c,u)),r&&(this.vScroll=new Ge(t,!1,f,c,u)),f&&(this.corner_=R(D.RECT,{height:Ge.scrollbarThickness,width:Ge.scrollbarThickness,class:"blocklyScrollbarBackground"}),Qt(this.corner_,t.getBubbleCanvas()))}dispose(){Ct(this.corner_),this.oldHostMetrics_=this.corner_=null,this.hScroll&&(this.hScroll.dispose(),this.hScroll=null),this.vScroll&&(this.vScroll.dispose(),this.vScroll=null)}resize(){const t=this.workspace.getMetrics();if(t){var i=!1,r=!1;if(this.oldHostMetrics_&&this.oldHostMetrics_.viewWidth===t.viewWidth&&this.oldHostMetrics_.viewHeight===t.viewHeight&&this.oldHostMetrics_.absoluteTop===t.absoluteTop&&this.oldHostMetrics_.absoluteLeft===t.absoluteLeft?(this.oldHostMetrics_&&this.oldHostMetrics_.scrollWidth===t.scrollWidth&&this.oldHostMetrics_.viewLeft===t.viewLeft&&this.oldHostMetrics_.scrollLeft===t.scrollLeft||(i=!0),this.oldHostMetrics_&&this.oldHostMetrics_.scrollHeight===t.scrollHeight&&this.oldHostMetrics_.viewTop===t.viewTop&&this.oldHostMetrics_.scrollTop===t.scrollTop||(r=!0)):r=i=!0,i||r){try{s.disable$$module$build$src$core$events$utils(),this.hScroll&&i&&this.hScroll.resize(t),this.vScroll&&r&&this.vScroll.resize(t)}finally{s.enable$$module$build$src$core$events$utils()}this.workspace.maybeFireViewportChangeEvent()}if(this.hScroll&&this.vScroll){if(!this.oldHostMetrics_||this.oldHostMetrics_.viewWidth!==t.viewWidth||this.oldHostMetrics_.absoluteLeft!==t.absoluteLeft){let c;(c=this.corner_)==null||c.setAttribute("x",String(this.vScroll.position.x))}if(!this.oldHostMetrics_||this.oldHostMetrics_.viewHeight!==t.viewHeight||this.oldHostMetrics_.absoluteTop!==t.absoluteTop){let c;(c=this.corner_)==null||c.setAttribute("y",String(this.hScroll.position.y))}}this.oldHostMetrics_=t}}canScrollHorizontally(){return!!this.hScroll}canScrollVertically(){return!!this.vScroll}setOrigin(t,i){this.hScroll&&this.hScroll.setOrigin(t,i),this.vScroll&&this.vScroll.setOrigin(t,i)}set(t,i,r){this.hScroll&&this.hScroll.set(t,!1),this.vScroll&&this.vScroll.set(i,!1),(r||r===void 0)&&(t={},this.hScroll&&(t.x=this.hScroll.getRatio_()),this.vScroll&&(t.y=this.vScroll.getRatio_()),this.workspace.setMetrics(t))}setX(t){this.hScroll&&this.hScroll.set(t,!0)}setY(t){this.vScroll&&this.vScroll.set(t,!0)}setContainerVisible(t){this.hScroll&&this.hScroll.setContainerVisible(t),this.vScroll&&this.vScroll.setContainerVisible(t)}isVisible(){let t=!1;return this.hScroll&&(t=this.hScroll.isVisible()),this.vScroll&&(t=t||this.vScroll.isVisible()),t}setVisible(t){this.hScroll&&this.hScroll.setVisibleInternal(t),this.vScroll&&this.vScroll.setVisibleInternal(t)}resizeContent(t){this.hScroll&&this.hScroll.resizeContentHorizontal(t),this.vScroll&&this.vScroll.resizeContentVertical(t)}resizeView(t){this.hScroll&&this.hScroll.resizeViewHorizontal(t),this.vScroll&&this.vScroll.resizeViewVertical(t)}},E$=class{constructor(t){this.workspace_=t}getDimensionsPx_(t){let i=0,r=0;return t&&(i=t.getWidth(),r=t.getHeight()),new Ce(i,r)}getFlyoutMetrics(t){return t=this.getDimensionsPx_(this.workspace_.getFlyout(t)),{width:t.width,height:t.height,position:this.workspace_.toolboxPosition}}getToolboxMetrics(){const t=this.getDimensionsPx_(this.workspace_.getToolbox());return{width:t.width,height:t.height,position:this.workspace_.toolboxPosition}}getSvgMetrics(){return this.workspace_.getCachedParentSvgSize()}getAbsoluteMetrics(){let t=0,i=0;const r=this.getToolboxMetrics(),c=this.getFlyoutMetrics(),u=!!this.workspace_.getToolbox();var f;const E=!((f=this.workspace_.getFlyout())!=null&&f.autoClose);f=u?r.position:c.position;const S=f===Wt.TOP;return f===Wt.LEFT&&(u&&(t+=r.width),E&&(t+=c.width)),S&&(u&&(i+=r.height),E&&(i+=c.height)),{top:i,left:t}}getViewMetrics(t){t=t?this.workspace_.scale:1;const i=this.getSvgMetrics(),r=this.getToolboxMetrics(),c=this.getFlyoutMetrics(),u=!!this.workspace_.getToolbox();var f;const E=!((f=this.workspace_.getFlyout())!=null&&f.autoClose);f=u?r.position:c.position;const S=f===Wt.LEFT||f===Wt.RIGHT;return(f===Wt.TOP||f===Wt.BOTTOM)&&(u&&(i.height-=r.height),E&&(i.height-=c.height)),S&&(u&&(i.width-=r.width),E&&(i.width-=c.width)),{height:i.height/t,width:i.width/t,top:-this.workspace_.scrollY/t,left:-this.workspace_.scrollX/t}}getContentMetrics(t){t=t?1:this.workspace_.scale;const i=this.workspace_.getBlocksBoundingBox();return{height:(i.bottom-i.top)*t,width:(i.right-i.left)*t,top:i.top*t,left:i.left*t}}hasFixedEdges(){return!this.workspace_.isMovableHorizontally()||!this.workspace_.isMovableVertically()}getComputedFixedEdges_(t){if(!this.hasFixedEdges())return{};const i=this.workspace_.isMovableHorizontally(),r=this.workspace_.isMovableVertically();t=t||this.getViewMetrics(!1);const c={};return r||(c.top=t.top,c.bottom=t.top+t.height),i||(c.left=t.left,c.right=t.left+t.width),c}getPaddedContent_(t,i){const r=i.top+i.height,c=i.left+i.width,u=t.width;t=t.height;const f=u/2,E=t/2;return{top:Math.min(i.top-E,r-t),bottom:Math.max(r+E,i.top+t),left:Math.min(i.left-f,c-u),right:Math.max(c+f,i.left+u)}}getScrollMetrics(t,i,r){t=t?this.workspace_.scale:1,i=i||this.getViewMetrics(!1);var c=r||this.getContentMetrics();r=this.getComputedFixedEdges_(i),i=this.getPaddedContent_(i,c),c=r.top!==void 0?r.top:i.top;const u=r.left!==void 0?r.left:i.left;return{top:c/t,left:u/t,width:((r.right!==void 0?r.right:i.right)-u)/t,height:((r.bottom!==void 0?r.bottom:i.bottom)-c)/t}}getUiMetrics(){return{viewMetrics:this.getViewMetrics(),absoluteMetrics:this.getAbsoluteMetrics(),toolboxMetrics:this.getToolboxMetrics()}}getMetrics(){const t=this.getToolboxMetrics(),i=this.getFlyoutMetrics(!0),r=this.getSvgMetrics(),c=this.getAbsoluteMetrics(),u=this.getViewMetrics(),f=this.getContentMetrics(),E=this.getScrollMetrics(!1,u,f);return{contentHeight:f.height,contentWidth:f.width,contentTop:f.top,contentLeft:f.left,scrollHeight:E.height,scrollWidth:E.width,scrollTop:E.top,scrollLeft:E.left,viewHeight:u.height,viewWidth:u.width,viewTop:u.top,viewLeft:u.left,absoluteTop:c.top,absoluteLeft:c.left,svgHeight:r.height,svgWidth:r.width,toolboxWidth:t.width,toolboxHeight:t.height,toolboxPosition:t.position,flyoutWidth:i.width,flyoutHeight:i.height}}};o(rt.METRICS_MANAGER,Co,E$);var XI=class extends bl{constructor(t){super(),this.isBlank=!0,this.recordUndo=!1,this.type=rr,this.isBlank=!!t,t&&(this.workspaceId=t.id)}};o(rt.EVENT,rr,XI);var v$=class extends Ws{constructor(t,i,r){super(t?t.workspace.id:void 0),this.type=or,t&&(this.blockId=t.id,this.isStart=i,this.blocks=r)}toJson(){const t=super.toJson();if(this.isStart===void 0)throw Error("Whether this event is the start of a drag is undefined. Either pass the value to the constructor, or call fromJson");if(this.blockId===void 0)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");return t.isStart=this.isStart,t.blockId=this.blockId,t.blocks=this.blocks,t}static fromJson(t,i,r){return i=super.fromJson(t,i,r??new v$),i.isStart=t.isStart,i.blockId=t.blockId,i.blocks=t.blocks,i}};o(rt.EVENT,or,v$);var hd={};hd.bumpIntoBounds=ul,hd.bumpIntoBoundsHandler=Pg,hd.bumpTopObjectsIntoBounds=Iu;var YI=class{constructor(t,i){this.dragTarget_=null,this.wouldDeleteBlock_=!1,this.dragIconData_=[],this.draggingBlock_=t,this.draggedConnectionManager_=new qi(this.draggingBlock_),this.workspace_=i,this.startXY_=this.draggingBlock_.getRelativeToSurfaceXY(),this.dragIconData_=Bg(t,this.startXY_)}dispose(){this.dragIconData_.length=0,this.draggedConnectionManager_&&this.draggedConnectionManager_.dispose()}startDrag(t,i){s.getGroup$$module$build$src$core$events$utils()||s.setGroup$$module$build$src$core$events$utils(!0),this.fireDragStartEvent_(),this.draggingBlock_.bringToFront(!0),I(),this.workspace_.setResizesEnabled(!1),nl(),this.shouldDisconnect_(i)&&this.disconnectBlock_(i,t),this.draggingBlock_.setDragging(!0);let r;(r=this.workspace_.getLayerManager())==null||r.moveToDragLayer(this.draggingBlock_)}shouldDisconnect_(t){return!!(this.draggingBlock_.getParent()||t&&this.draggingBlock_.nextConnection&&this.draggingBlock_.nextConnection.targetBlock())}disconnectBlock_(t,i){this.draggingBlock_.unplug(t),t=this.pixelsToWorkspaceUnits_(i),t=pt.sum(this.startXY_,t),this.draggingBlock_.translate(t.x,t.y),Kf(this.draggingBlock_),this.draggedConnectionManager_.updateAvailableConnections()}fireDragStartEvent_(){const t=new(ut(or))(this.draggingBlock_,!0,this.draggingBlock_.getDescendants(!1));it(t)}drag(t,i){i=this.pixelsToWorkspaceUnits_(i);var r=pt.sum(this.startXY_,i);this.draggingBlock_.moveDuringDrag(r),r=this.dragTarget_,this.dragTarget_=this.workspace_.getDragTarget(t),this.draggedConnectionManager_.update(i,this.dragTarget_),t=this.wouldDeleteBlock_,this.wouldDeleteBlock_=this.draggedConnectionManager_.wouldDeleteBlock,t!==this.wouldDeleteBlock_&&this.updateCursorDuringBlockDrag_(),this.dragTarget_!==r&&(r&&r.onDragExit(this.draggingBlock_),this.dragTarget_&&this.dragTarget_.onDragEnter(this.draggingBlock_)),this.dragTarget_&&this.dragTarget_.onDragOver(this.draggingBlock_)}endDrag(t,i){if(this.drag(t,i),this.fireDragEndEvent_(),M(),nl(),t=null,this.dragTarget_&&this.dragTarget_.shouldPreventMove(this.draggingBlock_)||(t=this.getNewLocationAfterDrag_(i).delta),this.dragTarget_&&this.dragTarget_.onDrop(this.draggingBlock_),!this.maybeDeleteBlock_()){let r;(r=this.workspace_.getLayerManager())==null||r.moveOffDragLayer(this.draggingBlock_,Um),this.draggingBlock_.setDragging(!1),t?this.updateBlockAfterMove_():ul(this.draggingBlock_.workspace,this.workspace_.getMetricsManager().getScrollMetrics(!0),this.draggingBlock_)}this.workspace_.setResizesEnabled(!0),s.setGroup$$module$build$src$core$events$utils(!1)}getNewLocationAfterDrag_(t){t=this.pixelsToWorkspaceUnits_(t);const i=pt.sum(this.startXY_,t);return{delta:t,newLocation:i}}maybeDeleteBlock_(){return this.wouldDeleteBlock_?(this.fireMoveEvent_(),this.draggingBlock_.dispose(!1,!0),dl.length=0,!0):!1}updateBlockAfterMove_(){this.fireMoveEvent_(),this.draggedConnectionManager_.wouldConnectBlock()?this.draggedConnectionManager_.applyConnections():this.draggingBlock_.queueRender(),this.draggingBlock_.scheduleSnapAndBump()}fireDragEndEvent_(){const t=new(ut(or))(this.draggingBlock_,!1,this.draggingBlock_.getDescendants(!1));it(t)}updateToolboxStyle_(t){const i=this.workspace_.getToolbox();if(i){const r=this.draggingBlock_.isDeletable()?"blocklyToolboxDelete":"blocklyToolboxGrab";t&&typeof i.removeStyle=="function"?i.removeStyle(r):t||typeof i.addStyle!="function"||i.addStyle(r)}}fireMoveEvent_(){if(!this.draggingBlock_.isDeadOrDying()){var t=new(ut(s.MOVE$$module$build$src$core$events$utils))(this.draggingBlock_);t.setReason(["drag"]),t.oldCoordinate=this.startXY_,t.recordNew(),it(t)}}updateCursorDuringBlockDrag_(){this.draggingBlock_.setDeleteStyle(this.wouldDeleteBlock_)}pixelsToWorkspaceUnits_(t){return t=new pt(t.x/this.workspace_.scale,t.y/this.workspace_.scale),this.workspace_.isMutator&&t.scale(1/this.workspace_.options.parentWorkspace.scale),t}dragIcons_(){j("Blockly.BlockDragger.prototype.dragIcons_","v10","v11")}getInsertionMarkers(){return this.draggedConnectionManager_&&this.draggedConnectionManager_.getInsertionMarkers?this.draggedConnectionManager_.getInsertionMarkers():[]}};o(rt.BLOCK_DRAGGER,Co,YI);var Ea={};Ea.Bubble=ce,Ea.MiniWorkspaceBubble=xo,Ea.TextBubble=Zm,Ea.TextInputBubble=EI;var y$=class extends fr{constructor(t,i,r,c){super(t),this.type=un,this.recordUndo=!1,t&&(this.name=i,this.oldValue=r,this.newValue=c)}toJson(){const t=super.toJson();if(!this.name)throw Error("The changed field name is undefined. Either pass a name to the constructor, or call fromJson.");return t.name=this.name,t.oldValue=this.oldValue,t.newValue=this.newValue,t}static fromJson(t,i,r){return i=super.fromJson(t,i,r??new y$),i.name=t.name,i.oldValue=t.oldValue,i.newValue=t.newValue,i}isNull(){return this.oldValue===this.newValue}run(t){var i=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");if(i=i.getBlockById(this.blockId),!i)throw Error("The associated block is undefined. Either pass a block to the constructor, or call fromJson");t=t?this.newValue:this.oldValue,(i=i.getField(this.name))?i.setValue(t):console.warn("Can't set non-existent field: "+this.name)}};o(rt.EVENT,un,y$);var I$=class extends fr{constructor(t){super(t),this.type=s.MOVE$$module$build$src$core$events$utils,t&&(t.isShadow()&&(this.recordUndo=!1),t=this.currentLocation_(),this.oldParentId=t.parentId,this.oldInputName=t.inputName,this.oldCoordinate=t.coordinate)}toJson(){const t=super.toJson();return t.oldParentId=this.oldParentId,t.oldInputName=this.oldInputName,this.oldCoordinate&&(t.oldCoordinate=`${Math.round(this.oldCoordinate.x)}, ${Math.round(this.oldCoordinate.y)}`),t.newParentId=this.newParentId,t.newInputName=this.newInputName,this.newCoordinate&&(t.newCoordinate=`${Math.round(this.newCoordinate.x)}, ${Math.round(this.newCoordinate.y)}`),this.reason&&(t.reason=this.reason),this.recordUndo||(t.recordUndo=this.recordUndo),t}static fromJson(t,i,r){return i=super.fromJson(t,i,r??new I$),i.oldParentId=t.oldParentId,i.oldInputName=t.oldInputName,t.oldCoordinate&&(r=t.oldCoordinate.split(","),i.oldCoordinate=new pt(Number(r[0]),Number(r[1]))),i.newParentId=t.newParentId,i.newInputName=t.newInputName,t.newCoordinate&&(r=t.newCoordinate.split(","),i.newCoordinate=new pt(Number(r[0]),Number(r[1]))),t.reason!==void 0&&(i.reason=t.reason),t.recordUndo!==void 0&&(i.recordUndo=t.recordUndo),i}recordNew(){const t=this.currentLocation_();this.newParentId=t.parentId,this.newInputName=t.inputName,this.newCoordinate=t.coordinate}setReason(t){this.reason=t}currentLocation_(){var t=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");var i=t.getBlockById(this.blockId);if(!i)throw Error("The block associated with the block move event could not be found");t={};const r=i.getParent();return r?(t.parentId=r.id,(i=r.getInputWithBlock(i))&&(t.inputName=i.name)):t.coordinate=i.getRelativeToSurfaceXY(),t}isNull(){return this.oldParentId===this.newParentId&&this.oldInputName===this.newInputName&&pt.equals(this.oldCoordinate,this.newCoordinate)}run(t){var i=this.getEventWorkspace_();if(!this.blockId)throw Error("The block ID is undefined. Either pass a block to the constructor, or call fromJson");var r=i.getBlockById(this.blockId);if(r){var c=t?this.newParentId:this.oldParentId,u=t?this.newInputName:this.oldInputName;if(t=t?this.newCoordinate:this.oldCoordinate,c){var f=i.getBlockById(c);if(!f){console.warn("Can't connect to non-existent block: "+c);return}}if(r.getParent()&&r.unplug(),t)u=r.getRelativeToSurfaceXY(),r.moveBy(t.x-u.x,t.y-u.y,this.reason);else{i=r.outputConnection,(!i||r.previousConnection&&r.previousConnection.isConnected())&&(i=r.previousConnection);let E,S;r=(S=i)==null?void 0:S.type,u?(r=f.getInput(u))&&(E=r.connection):r===wt.PREVIOUS_STATEMENT&&(E=f.nextConnection),E&&i?i.connect(E):console.warn("Can't connect to non-existent input: "+u)}}else console.warn("Can't move non-existent block: "+this.blockId)}};o(rt.EVENT,s.MOVE$$module$build$src$core$events$utils,I$);var S$=class extends Ws{constructor(t,i,r){super(t?t.workspace.id:void 0),this.type=Vs,t&&(this.blockId=t.id,this.isOpen=i,this.bubbleType=r)}toJson(){const t=super.toJson();if(this.isOpen===void 0)throw Error("Whether this event is for opening the bubble is undefined. Either pass the value to the constructor, or call fromJson");if(!this.bubbleType)throw Error("The type of bubble is undefined. Either pass the value to the constructor, or call fromJson");return t.isOpen=this.isOpen,t.bubbleType=this.bubbleType,t.blockId=this.blockId||"",t}static fromJson(t,i,r){return i=super.fromJson(t,i,r??new S$),i.isOpen=t.isOpen,i.bubbleType=t.bubbleType,i.blockId=t.blockId,i}},C$;(function(t){t.MUTATOR="mutator",t.COMMENT="comment",t.WARNING="warning"})(C$||(C$={})),o(rt.EVENT,Vs,S$);var En=class extends bl{constructor(t){super(),this.isBlank=!t,t&&(this.commentId=t.id,this.workspaceId=t.workspace.id,this.group=s.getGroup$$module$build$src$core$events$utils(),this.recordUndo=vt())}toJson(){const t=super.toJson();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");return t.commentId=this.commentId,t}static fromJson(t,i,r){return i=super.fromJson(t,i,r??new En),i.commentId=t.commentId,i}static CommentCreateDeleteHelper(t,i){var r=t.getEventWorkspace_();if(i){if(i=s.createElement$$module$build$src$core$utils$xml("xml"),!t.xml)throw Error("Ecountered a comment event without proper xml");i.appendChild(t.xml),s.domToWorkspace$$module$build$src$core$xml(i,r)}else{if(!t.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");(r=r.getCommentById(t.commentId))?r.dispose():console.warn("Can't uncreate non-existent comment: "+t.commentId)}}},w$=class extends En{constructor(t,i,r){super(t),this.type=Tl,t&&(this.oldContents_=typeof i>"u"?"":i,this.newContents_=typeof r>"u"?"":r)}toJson(){const t=super.toJson();if(!this.oldContents_)throw Error("The old contents is undefined. Either pass a value to the constructor, or call fromJson");if(!this.newContents_)throw Error("The new contents is undefined. Either pass a value to the constructor, or call fromJson");return t.oldContents=this.oldContents_,t.newContents=this.newContents_,t}static fromJson(t,i,r){return i=super.fromJson(t,i,r??new w$),i.oldContents_=t.oldContents,i.newContents_=t.newContents,i}isNull(){return this.oldContents_===this.newContents_}run(t){var i=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");if(i=i.getCommentById(this.commentId)){var r=t?this.newContents_:this.oldContents_;if(!r)throw Error(t?"The new contents is undefined. Either pass a value to the constructor, or call fromJson":"The old contents is undefined. Either pass a value to the constructor, or call fromJson");i.setContent(r)}else console.warn("Can't change non-existent comment: "+this.commentId)}};o(rt.EVENT,Tl,w$);var k$=class extends En{constructor(t){super(t),this.type=fn,t&&(this.xml=t.toXmlWithXY())}toJson(){const t=super.toJson();if(!this.xml)throw Error("The comment XML is undefined. Either pass a comment to the constructor, or call fromJson");return t.xml=Fs(this.xml),t}static fromJson(t,i,r){return i=super.fromJson(t,i,r??new k$),i.xml=s.textToDom$$module$build$src$core$utils$xml(t.xml),i}run(t){En.CommentCreateDeleteHelper(this,t)}};o(rt.EVENT,fn,k$);var O$=class extends En{constructor(t){super(t),this.type=nr,t&&(this.xml=t.toXmlWithXY())}run(t){En.CommentCreateDeleteHelper(this,!t)}toJson(){const t=super.toJson();if(!this.xml)throw Error("The comment XML is undefined. Either pass a comment to the constructor, or call fromJson");return t.xml=Fs(this.xml),t}static fromJson(t,i,r){return i=super.fromJson(t,i,r??new O$),i.xml=s.textToDom$$module$build$src$core$utils$xml(t.xml),i}};o(rt.EVENT,nr,O$);var A$=class extends En{constructor(t){super(t),this.type=Gs,t&&(this.comment_=t,this.oldCoordinate_=t.getRelativeToSurfaceXY())}recordNew(){if(this.newCoordinate_)throw Error("Tried to record the new position of a comment on the same event twice.");if(!this.comment_)throw Error("The comment is undefined. Pass a comment to the constructor if you want to use the record functionality");this.newCoordinate_=this.comment_.getRelativeToSurfaceXY()}setOldCoordinate(t){this.oldCoordinate_=t}toJson(){const t=super.toJson();if(!this.oldCoordinate_)throw Error("The old comment position is undefined. Either pass a comment to the constructor, or call fromJson");if(!this.newCoordinate_)throw Error("The new comment position is undefined. Either call recordNew, or call fromJson");return t.oldCoordinate=`${Math.round(this.oldCoordinate_.x)}, ${Math.round(this.oldCoordinate_.y)}`,t.newCoordinate=Math.round(this.newCoordinate_.x)+","+Math.round(this.newCoordinate_.y),t}static fromJson(t,i,r){return i=super.fromJson(t,i,r??new A$),r=t.oldCoordinate.split(","),i.oldCoordinate_=new pt(Number(r[0]),Number(r[1])),r=t.newCoordinate.split(","),i.newCoordinate_=new pt(Number(r[0]),Number(r[1])),i}isNull(){return pt.equals(this.oldCoordinate_,this.newCoordinate_)}run(t){var i=this.getEventWorkspace_();if(!this.commentId)throw Error("The comment ID is undefined. Either pass a comment to the constructor, or call fromJson");if(i=i.getCommentById(this.commentId)){if(t=t?this.newCoordinate_:this.oldCoordinate_,!t)throw Error("Either oldCoordinate_ or newCoordinate_ is undefined. Either pass a comment to the constructor and call recordNew, or call fromJson");var r=i.getRelativeToSurfaceXY();i.moveBy(t.x-r.x,t.y-r.y)}else console.warn("Can't move non-existent comment: "+this.commentId)}};o(rt.EVENT,Gs,A$);var R$=class extends Ws{constructor(t,i,r){super(r),this.type=$l,this.oldItem=t??void 0,this.newItem=i??void 0}toJson(){const t=super.toJson();return t.oldItem=this.oldItem,t.newItem=this.newItem,t}static fromJson(t,i,r){return i=super.fromJson(t,i,r??new R$),i.oldItem=t.oldItem,i.newItem=t.newItem,i}};o(rt.EVENT,$l,R$),s.CHANGE$$module$build$src$core$events$utils,s.CREATE$$module$build$src$core$events$utils,s.DELETE$$module$build$src$core$events$utils,s.MOVE$$module$build$src$core$events$utils,s.CHANGE$$module$build$src$core$events$utils,s.CREATE$$module$build$src$core$events$utils,s.DELETE$$module$build$src$core$events$utils,s.MOVE$$module$build$src$core$events$utils,s.disable$$module$build$src$core$events$utils,s.enable$$module$build$src$core$events$utils,s.getGroup$$module$build$src$core$events$utils,s.setGroup$$module$build$src$core$events$utils;var St={};St.Abstract=bl,St.BLOCK_CHANGE=s.CHANGE$$module$build$src$core$events$utils,St.BLOCK_CREATE=s.CREATE$$module$build$src$core$events$utils,St.BLOCK_DELETE=s.DELETE$$module$build$src$core$events$utils,St.BLOCK_DRAG=or,St.BLOCK_FIELD_INTERMEDIATE_CHANGE=un,St.BLOCK_MOVE=s.MOVE$$module$build$src$core$events$utils,St.BUBBLE_OPEN=Vs,St.BUMP_EVENTS=Ou,St.BlockBase=fr,St.BlockChange=vr,St.BlockCreate=Sm,St.BlockDelete=f$,St.BlockDrag=v$,St.BlockFieldIntermediateChange=y$,St.BlockMove=I$,St.BubbleOpen=S$,St.BubbleType=C$,St.CHANGE=s.CHANGE$$module$build$src$core$events$utils,St.CLICK=Oo,St.COMMENT_CHANGE=Tl,St.COMMENT_CREATE=fn,St.COMMENT_DELETE=nr,St.COMMENT_MOVE=Gs,St.CREATE=s.CREATE$$module$build$src$core$events$utils,St.Click=sm,St.ClickTarget=om,St.CommentBase=En,St.CommentChange=w$,St.CommentCreate=k$,St.CommentDelete=O$,St.CommentMove=A$,St.DELETE=s.DELETE$$module$build$src$core$events$utils,St.FINISHED_LOADING=rr,St.FinishedLoading=XI,St.MARKER_MOVE=gl,St.MOVE=s.MOVE$$module$build$src$core$events$utils,St.MarkerMove=l$,St.SELECTED=ko,St.Selected=bm,St.THEME_CHANGE=_l,St.TOOLBOX_ITEM_SELECT=$l,St.TRASHCAN_OPEN=ml,St.ThemeChange=Cm,St.ToolboxItemSelect=R$,St.TrashcanOpen=p$,St.UI=ku,St.UiBase=Ws,St.VAR_CREATE=dn,St.VAR_DELETE=sr,St.VAR_RENAME=fl,St.VIEWPORT_CHANGE=pn,St.VarBase=Zc,St.VarCreate=$m,St.VarDelete=h$,St.VarRename=u$,St.ViewportChange=wm,St.clearPendingUndo=me,St.disable=s.disable$$module$build$src$core$events$utils,St.disableOrphans=be,St.enable=s.enable$$module$build$src$core$events$utils,St.filter=Nt,St.fire=it,St.fromJson=fe,St.get=ut,St.getDescendantIds=Ht,St.getGroup=s.getGroup$$module$build$src$core$events$utils,St.getRecordUndo=vt,St.isEnabled=Lt,St.setGroup=s.setGroup$$module$build$src$core$events$utils,St.setRecordUndo=gt;var KI=class extends ga{constructor(){super(),this.GRID_UNIT=4,this.CURSOR_COLOUR="#ffa200",this.CURSOR_RADIUS=5,this.JAGGED_TEETH_WIDTH=this.JAGGED_TEETH_HEIGHT=0,this.START_HAT_HEIGHT=22,this.START_HAT_WIDTH=96,this.SHAPES={HEXAGONAL:1,ROUND:2,SQUARE:3,PUZZLE:4,NOTCH:5},this.SHAPE_IN_SHAPE_PADDING={1:{0:5*this.GRID_UNIT,1:2*this.GRID_UNIT,2:5*this.GRID_UNIT,3:5*this.GRID_UNIT},2:{0:3*this.GRID_UNIT,1:3*this.GRID_UNIT,2:1*this.GRID_UNIT,3:2*this.GRID_UNIT},3:{0:2*this.GRID_UNIT,1:2*this.GRID_UNIT,2:2*this.GRID_UNIT,3:2*this.GRID_UNIT}},this.FULL_BLOCK_FIELDS=!0,this.FIELD_TEXT_FONTWEIGHT="bold",this.FIELD_TEXT_FONTFAMILY='"Helvetica Neue", "Segoe UI", Helvetica, sans-serif',this.FIELD_COLOUR_FULL_BLOCK=this.FIELD_TEXTINPUT_BOX_SHADOW=this.FIELD_DROPDOWN_SVG_ARROW=this.FIELD_DROPDOWN_COLOURED_DIV=this.FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW=!0,this.SELECTED_GLOW_COLOUR="#fff200",this.SELECTED_GLOW_SIZE=.5,this.REPLACEMENT_GLOW_COLOUR="#fff200",this.REPLACEMENT_GLOW_SIZE=2,this.selectedGlowFilterId="",this.selectedGlowFilter=null,this.replacementGlowFilterId="",this.SQUARED=this.ROUNDED=this.HEXAGONAL=this.replacementGlowFilter=null,this.SMALL_PADDING=this.GRID_UNIT,this.MEDIUM_PADDING=2*this.GRID_UNIT,this.MEDIUM_LARGE_PADDING=3*this.GRID_UNIT,this.LARGE_PADDING=4*this.GRID_UNIT,this.CORNER_RADIUS=1*this.GRID_UNIT,this.NOTCH_WIDTH=9*this.GRID_UNIT,this.NOTCH_HEIGHT=2*this.GRID_UNIT,this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT=3*this.GRID_UNIT,this.MIN_BLOCK_WIDTH=2*this.GRID_UNIT,this.MIN_BLOCK_HEIGHT=12*this.GRID_UNIT,this.EMPTY_STATEMENT_INPUT_HEIGHT=6*this.GRID_UNIT,this.TOP_ROW_MIN_HEIGHT=this.CORNER_RADIUS,this.TOP_ROW_PRECEDES_STATEMENT_MIN_HEIGHT=this.LARGE_PADDING,this.BOTTOM_ROW_MIN_HEIGHT=this.CORNER_RADIUS,this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT=6*this.GRID_UNIT,this.STATEMENT_BOTTOM_SPACER=-this.NOTCH_HEIGHT,this.STATEMENT_INPUT_SPACER_MIN_WIDTH=40*this.GRID_UNIT,this.STATEMENT_INPUT_PADDING_LEFT=4*this.GRID_UNIT,this.EMPTY_INLINE_INPUT_PADDING=4*this.GRID_UNIT,this.EMPTY_INLINE_INPUT_HEIGHT=8*this.GRID_UNIT,this.DUMMY_INPUT_MIN_HEIGHT=8*this.GRID_UNIT,this.DUMMY_INPUT_SHADOW_MIN_HEIGHT=6*this.GRID_UNIT,this.CURSOR_WS_WIDTH=20*this.GRID_UNIT,this.FIELD_TEXT_FONTSIZE=3*this.GRID_UNIT,this.FIELD_BORDER_RECT_RADIUS=this.CORNER_RADIUS,this.FIELD_BORDER_RECT_X_PADDING=2*this.GRID_UNIT,this.FIELD_BORDER_RECT_Y_PADDING=1.625*this.GRID_UNIT,this.FIELD_BORDER_RECT_HEIGHT=8*this.GRID_UNIT,this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=8*this.GRID_UNIT,this.FIELD_DROPDOWN_SVG_ARROW_PADDING=this.FIELD_BORDER_RECT_X_PADDING,this.FIELD_COLOUR_DEFAULT_WIDTH=6*this.GRID_UNIT,this.FIELD_COLOUR_DEFAULT_HEIGHT=8*this.GRID_UNIT,this.FIELD_CHECKBOX_X_OFFSET=1*this.GRID_UNIT,this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH=12*this.GRID_UNIT}setFontConstants_(t){super.setFontConstants_(t),this.FIELD_DROPDOWN_BORDER_RECT_HEIGHT=this.FIELD_BORDER_RECT_HEIGHT=this.FIELD_TEXT_HEIGHT+2*this.FIELD_BORDER_RECT_Y_PADDING}init(){super.init(),this.HEXAGONAL=this.makeHexagonal(),this.ROUNDED=this.makeRounded(),this.SQUARED=this.makeSquared(),this.STATEMENT_INPUT_NOTCH_OFFSET=this.NOTCH_OFFSET_LEFT+this.INSIDE_CORNERS.rightWidth}setDynamicProperties_(t){super.setDynamicProperties_(t),this.SELECTED_GLOW_COLOUR=t.getComponentStyle("selectedGlowColour")||this.SELECTED_GLOW_COLOUR;const i=Number(t.getComponentStyle("selectedGlowSize"));this.SELECTED_GLOW_SIZE=i&&!isNaN(i)?i:this.SELECTED_GLOW_SIZE,this.REPLACEMENT_GLOW_COLOUR=t.getComponentStyle("replacementGlowColour")||this.REPLACEMENT_GLOW_COLOUR,this.REPLACEMENT_GLOW_SIZE=(t=Number(t.getComponentStyle("replacementGlowSize")))&&!isNaN(t)?t:this.REPLACEMENT_GLOW_SIZE}dispose(){super.dispose(),this.selectedGlowFilter&&Ct(this.selectedGlowFilter),this.replacementGlowFilter&&Ct(this.replacementGlowFilter)}makeStartHat(){const t=this.START_HAT_HEIGHT,i=this.START_HAT_WIDTH,r=Li("c",[Ot(25,-t),Ot(71,-t),Ot(i,0)]);return{height:t,width:i,path:r}}makeHexagonal(){function t(r,c,u){var f=r/2;return f=f>i?i:f,u=u?-1:1,r=(c?-1:1)*r/2,Hs(-u*f,r)+Hs(u*f,r)}const i=this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH;return{type:this.SHAPES.HEXAGONAL,isDynamic:!0,width(r){return r/=2,r>i?i:r},height(r){return r},connectionOffsetY(r){return r/2},connectionOffsetX(r){return-r},pathDown(r){return t(r,!1,!1)},pathUp(r){return t(r,!0,!1)},pathRightDown(r){return t(r,!1,!0)},pathRightUp(r){return t(r,!1,!0)}}}makeRounded(){function t(c,u,f){const E=c>r?c-r:0;return c=(c>r?r:c)/2,Ve("a","0 0,1",c,Ot((u?-1:1)*c,(u?-1:1)*c))+It("v",(f?1:-1)*E)+Ve("a","0 0,1",c,Ot((u?1:-1)*c,(u?-1:1)*c))}const i=this.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH,r=2*i;return{type:this.SHAPES.ROUND,isDynamic:!0,width(c){return c/=2,c>i?i:c},height(c){return c},connectionOffsetY(c){return c/2},connectionOffsetX(c){return-c},pathDown(c){return t(c,!1,!1)},pathUp(c){return t(c,!0,!1)},pathRightDown(c){return t(c,!1,!0)},pathRightUp(c){return t(c,!1,!0)}}}makeSquared(){function t(r,c,u){return r-=2*i,Ve("a","0 0,1",i,Ot((c?-1:1)*i,(c?-1:1)*i))+It("v",(u?1:-1)*r)+Ve("a","0 0,1",i,Ot((c?1:-1)*i,(c?-1:1)*i))}const i=this.CORNER_RADIUS;return{type:this.SHAPES.SQUARE,isDynamic:!0,width(r){return i},height(r){return r},connectionOffsetY(r){return r/2},connectionOffsetX(r){return-r},pathDown(r){return t(r,!1,!1)},pathUp(r){return t(r,!0,!1)},pathRightDown(r){return t(r,!1,!0)},pathRightUp(r){return t(r,!1,!0)}}}shapeFor(t){let i=t.getCheck();switch(!i&&t.targetConnection&&(i=t.targetConnection.getCheck()),t.type){case wt.INPUT_VALUE:case wt.OUTPUT_VALUE:if(t=t.getSourceBlock().getOutputShape(),t!==null)switch(t){case this.SHAPES.HEXAGONAL:return this.HEXAGONAL;case this.SHAPES.ROUND:return this.ROUNDED;case this.SHAPES.SQUARE:return this.SQUARED}return i&&i.indexOf("Boolean")!==-1?this.HEXAGONAL:i&&i.indexOf("Number")!==-1?this.ROUNDED:(i&&i.indexOf("String"),this.ROUNDED);case wt.PREVIOUS_STATEMENT:case wt.NEXT_STATEMENT:return this.NOTCH;default:throw Error("Unknown type")}}makeNotch(){function t(bt){return Li("c",[Ot(bt*u/2,0),Ot(bt*u*3/4,E/2),Ot(bt*u,E)])+al([Ot(bt*u,f)])+Li("c",[Ot(bt*u/4,E/2),Ot(bt*u/2,E),Ot(bt*u,E)])+It("h",bt*c)+Li("c",[Ot(bt*u/2,0),Ot(bt*u*3/4,-(E/2)),Ot(bt*u,-E)])+al([Ot(bt*u,-f)])+Li("c",[Ot(bt*u/4,-(E/2)),Ot(bt*u/2,-E),Ot(bt*u,-E)])}const i=this.NOTCH_WIDTH,r=this.NOTCH_HEIGHT,c=i/3,u=c/3,f=r/2,E=f/2,S=t(1),W=t(-1);return{type:this.SHAPES.NOTCH,width:i,height:r,pathLeft:S,pathRight:W}}makeInsideCorners(){const t=this.CORNER_RADIUS,i=Ve("a","0 0,0",t,Ot(-t,t)),r=Ve("a","0 0,1",t,Ot(-t,t)),c=Ve("a","0 0,0",t,Ot(t,t)),u=Ve("a","0 0,1",t,Ot(t,t));return{width:t,height:t,pathTop:i,pathBottom:c,rightWidth:t,rightHeight:t,pathTopRight:r,pathBottomRight:u}}generateSecondaryColour_(t){return ir("#000",t,.15)||t}generateTertiaryColour_(t){return ir("#000",t,.25)||t}createDom(t,i,r){super.createDom(t,i,r),t=R(D.DEFS,{},t),i=R(D.FILTER,{id:"blocklySelectedGlowFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},t),R(D.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:this.SELECTED_GLOW_SIZE},i),r=R(D.FECOMPONENTTRANSFER,{result:"outBlur"},i),R(D.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},r),R(D.FEFLOOD,{"flood-color":this.SELECTED_GLOW_COLOUR,"flood-opacity":1,result:"outColor"},i),R(D.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},i),this.selectedGlowFilterId=i.id,this.selectedGlowFilter=i,t=R(D.FILTER,{id:"blocklyReplacementGlowFilter"+this.randomIdentifier,height:"160%",width:"180%",y:"-30%",x:"-40%"},t),R(D.FEGAUSSIANBLUR,{in:"SourceGraphic",stdDeviation:this.REPLACEMENT_GLOW_SIZE},t),i=R(D.FECOMPONENTTRANSFER,{result:"outBlur"},t),R(D.FEFUNCA,{type:"table",tableValues:"0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1"},i),R(D.FEFLOOD,{"flood-color":this.REPLACEMENT_GLOW_COLOUR,"flood-opacity":1,result:"outColor"},t),R(D.FECOMPOSITE,{in:"outColor",in2:"outBlur",operator:"in",result:"outGlow"},t),R(D.FECOMPOSITE,{in:"SourceGraphic",in2:"outGlow",operator:"over"},t),this.replacementGlowFilterId=t.id,this.replacementGlowFilter=t}getCSS_(t){return[`${t} .blocklyText,`,`${t} .blocklyFlyoutLabelText {`,`font: ${this.FIELD_TEXT_FONTWEIGHT} ${this.FIELD_TEXT_FONTSIZE}pt ${this.FIELD_TEXT_FONTFAMILY};`,"}",`${t} .blocklyText {`,"fill: #fff;","}",`${t} .blocklyNonEditableText>rect:not(.blocklyDropdownRect),`,`${t} .blocklyEditableText>rect:not(.blocklyDropdownRect) {`,`fill: ${this.FIELD_BORDER_RECT_COLOUR};`,"}",`${t} .blocklyNonEditableText>text,`,`${t} .blocklyEditableText>text,`,`${t} .blocklyNonEditableText>g>text,`,`${t} .blocklyEditableText>g>text {`,"fill: #575E75;","}",`${t} .blocklyFlyoutLabelText {`,"fill: #575E75;","}",`${t} .blocklyText.blocklyBubbleText {`,"fill: #575E75;","}",`${t} .blocklyDraggable:not(.blocklyDisabled)`," .blocklyEditableText:not(.editing):hover>rect,",`${t} .blocklyDraggable:not(.blocklyDisabled)`," .blocklyEditableText:not(.editing):hover>.blocklyPath {","stroke: #fff;","stroke-width: 2;","}",`${t} .blocklyHtmlInput {`,`font-family: ${this.FIELD_TEXT_FONTFAMILY};`,`font-weight: ${this.FIELD_TEXT_FONTWEIGHT};`,"color: #575E75;","}",`${t} .blocklyDropdownText {`,"fill: #fff !important;","}",`${t}.blocklyWidgetDiv .goog-menuitem,`,`${t}.blocklyDropDownDiv .goog-menuitem {`,`font-family: ${this.FIELD_TEXT_FONTFAMILY};`,"}",`${t}.blocklyDropDownDiv .goog-menuitem-content {`,"color: #fff;","}",`${t} .blocklyHighlightedConnectionPath {`,`stroke: ${this.SELECTED_GLOW_COLOUR};`,"}",`${t} .blocklyDisabled > .blocklyOutlinePath {`,`fill: url(#blocklyDisabledPattern${this.randomIdentifier})`,"}",`${t} .blocklyInsertionMarker>.blocklyPath {`,`fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,"stroke: none;","}"]}},jI=class extends ma{constructor(t,i){super(t,i)}draw(){const t=this.block_.pathObject;t.beginDrawing(),this.drawOutline_(),this.drawInternals_(),t.setPath(this.outlinePath_+`
`+this.inlinePath_),this.info_.RTL&&t.flipRTL(),this.recordSizeOnBlock_(),this.info_.outputConnection&&(t.outputShapeType=this.info_.outputConnection.shape.type),t.endDrawing()}drawOutline_(){this.info_.outputConnection&&this.info_.outputConnection.isDynamicShape&&!this.info_.hasStatementInput&&!this.info_.bottomRow.hasNextConnection?(this.drawFlatTop_(),this.drawRightDynamicConnection_(),this.drawFlatBottom_(),this.drawLeftDynamicConnection_()):super.drawOutline_()}drawLeft_(){this.info_.outputConnection&&this.info_.outputConnection.isDynamicShape?this.drawLeftDynamicConnection_():super.drawLeft_()}drawRightSideRow_(t){if(!(0>=t.height)){if(x.isSpacer(t)){const c=t.precedesStatement;var i=t.followsStatement;if(c||i){const u=this.constants_.INSIDE_CORNERS;var r=u.rightHeight;r=t.height-(c?r:0),i=i?u.pathBottomRight:"",t=0<r?It("V",t.yPos+r):"",this.outlinePath_+=i+t+(c?u.pathTopRight:"");return}}this.outlinePath_+=It("V",t.yPos+t.height)}}drawRightDynamicConnection_(){if(!this.info_.outputConnection)throw Error("Cannot draw the output connection of a block that doesn't have one");this.outlinePath_+=this.info_.outputConnection.shape.pathRightDown(this.info_.outputConnection.height)}drawLeftDynamicConnection_(){if(!this.info_.outputConnection)throw Error("Cannot draw the output connection of a block that doesn't have one");this.positionOutputConnection_(),this.outlinePath_+=this.info_.outputConnection.shape.pathUp(this.info_.outputConnection.height),this.outlinePath_+="z"}drawFlatTop_(){const t=this.info_.topRow;this.positionPreviousConnection_(),this.outlinePath_+=Ne(t.xPos,this.info_.startY),this.outlinePath_+=It("h",t.width)}drawFlatBottom_(){const t=this.info_.bottomRow;this.positionNextConnection_(),this.outlinePath_+=It("V",t.baseline),this.outlinePath_+=It("h",-t.width)}drawInlineInput_(t){this.positionInlineInputConnection_(t);const i=t.input.name;if(!t.connectedBlock&&!this.info_.isInsertionMarker){var r=t.width-2*t.connectionWidth;t=ei(t.xPos+t.connectionWidth,t.centerline-t.height/2)+It("h",r)+t.shape.pathRightDown(t.height)+It("h",-r)+t.shape.pathUp(t.height)+"z",this.block_.pathObject.setOutlinePath(i,t)}}drawStatementInput_(t){var i=t.getLastInput();const r=i.xPos+i.notchOffset+i.shape.width,c=this.constants_.INSIDE_CORNERS,u=i.shape.pathRight+It("h",-(i.notchOffset-c.width))+c.pathTop,f=t.height-2*c.height;i=c.pathBottom+It("h",i.notchOffset-c.width)+(i.connectedBottomNextConnection?"":i.shape.pathLeft),this.outlinePath_+=It("H",r)+u+It("v",f)+i+It("H",t.xPos+t.width),this.positionStatementInputConnection_(t)}},Cr=class extends qt{constructor(t,i,r,c,u,f,E){if(super(qt.SKIP_SETUP),this.imageElement=this.clickHandler=null,this.flipRtl=this.isDirty_=this.EDITABLE=!1,this.altText="",r=Number(Fe(r)),i=Number(Fe(i)),isNaN(r)||isNaN(i))throw Error("Height and width values of an image field must cast to numbers.");if(0>=r||0>=i)throw Error("Height and width values of an image field must be greater than 0.");this.size_=new Ce(i,r+Cr.Y_PADDING),this.imageHeight=r,typeof u=="function"&&(this.clickHandler=u),t!==qt.SKIP_SETUP&&(E?this.configure_(E):(this.flipRtl=!!f,this.altText=Fe(c)||""),this.setValue(Fe(t)))}configure_(t){super.configure_(t),t.flipRtl&&(this.flipRtl=t.flipRtl),t.alt&&(this.altText=Fe(t.alt))}initView(){this.imageElement=R(D.IMAGE,{height:this.imageHeight+"px",width:this.size_.width+"px",alt:this.altText},this.fieldGroup_),this.imageElement.setAttributeNS(Xi,"xlink:href",this.value_),this.clickHandler&&(this.imageElement.style.cursor="pointer")}updateSize_(){}doClassValidation_(t){return typeof t!="string"?null:t}doValueUpdate_(t){this.value_=t,this.imageElement&&this.imageElement.setAttributeNS(Xi,"xlink:href",this.value_)}getFlipRtl(){return this.flipRtl}setAlt(t){t!==this.altText&&(this.altText=t||"",this.imageElement&&this.imageElement.setAttribute("alt",this.altText))}showEditor_(){this.clickHandler&&this.clickHandler(this)}setOnClickHandler(t){this.clickHandler=t}getText_(){return this.altText}static fromJson(t){if(!t.src||!t.width||!t.height)throw Error("src, width, and height values for an image field arerequired. The width and height must be non-zero.");return new this(t.src,t.width,t.height,void 0,void 0,void 0,t)}};Cr.Y_PADDING=1,zi("field_image",Cr),Cr.prototype.DEFAULT_VALUE="";var va=class extends qt{constructor(t,i,r){super(qt.SKIP_SETUP),this.spellcheck_=!0,this.htmlInput_=null,this.isTextValid_=this.isBeingEdited_=!1,this.onKeyInputWrapper_=this.onKeyDownWrapper_=this.valueWhenEditorWasOpened_=null,this.fullBlockClickTarget_=!1,this.workspace_=null,this.SERIALIZABLE=!0,this.CURSOR="text",t!==qt.SKIP_SETUP&&(r&&this.configure_(r),this.setValue(t),i&&this.setValidator(i))}configure_(t){super.configure_(t),t.spellcheck!==void 0&&(this.spellcheck_=t.spellcheck)}initView(){if(!this.getSourceBlock())throw new ye;super.initView(),this.isFullBlockField()&&(this.clickTarget_=this.sourceBlock_.getSvgRoot())}isFullBlockField(){const t=this.getSourceBlock();if(!t)throw new ye;let i;return this.fullBlockClickTarget_=!((i=this.getConstants())==null||!i.FULL_BLOCK_FIELDS)&&t.isSimpleReporter()}doValueInvalid_(t){this.isBeingEdited_&&(this.isDirty_=!0,this.isTextValid_=!1,t=this.value_,this.value_=this.htmlInput_.getAttribute("data-untyped-default-value"),this.sourceBlock_&&Lt()&&it(new(ut(s.CHANGE$$module$build$src$core$events$utils))(this.sourceBlock_,"field",this.name||null,t,this.value_)))}doValueUpdate_(t){this.isTextValid_=this.isDirty_=!0,this.value_=t}applyColour(){const t=this.getSourceBlock();if(!t)throw new ye;this.getConstants().FULL_BLOCK_FIELDS&&this.fieldGroup_&&(!this.isFullBlockField()&&this.borderRect_?(this.borderRect_.style.display="block",this.borderRect_.setAttribute("stroke",t.style.colourTertiary)):(this.borderRect_.style.display="none",t.pathObject.svgPath.setAttribute("fill",this.getConstants().FIELD_BORDER_RECT_COLOUR)))}getSize(){let t;return(t=this.getConstants())!=null&&t.FULL_BLOCK_FIELDS&&(this.render_(),this.isDirty_=!1),super.getSize()}onLocationChange(){this.isBeingEdited_&&this.resizeEditor_()}render_(){if(super.render_(),this.isBeingEdited_){var t=this.htmlInput_;this.isTextValid_?(mt(t,"blocklyInvalidInput"),Re(t,we.INVALID,!1)):(J(t,"blocklyInvalidInput"),Re(t,we.INVALID,!0))}if(t=this.getSourceBlock(),!t)throw new ye;this.getConstants().FULL_BLOCK_FIELDS&&t.applyColour()}setSpellcheck(t){t!==this.spellcheck_&&(this.spellcheck_=t,this.htmlInput_&&this.htmlInput_.setAttribute("spellcheck",this.spellcheck_))}showEditor_(t,i=!1){this.workspace_=this.sourceBlock_.workspace,!i&&this.workspace_.options.modalInputs&&(am||xu||El)?this.showPromptEditor_():this.showInlineEditor_(i)}showPromptEditor_(){jh(s.Msg$$module$build$src$core$msg.CHANGE_VALUE_TITLE,this.getText(),t=>{t!==null&&this.setValue(this.getValueFromEditorText_(t)),this.onFinishEditing_(this.value_)})}showInlineEditor_(t){const i=this.getSourceBlock();if(!i)throw new ye;nu(this,i.RTL,this.widgetDispose_.bind(this)),this.htmlInput_=this.widgetCreate_(),this.isBeingEdited_=!0,this.valueWhenEditorWasOpened_=this.value_,t||(this.htmlInput_.focus({preventScroll:!0}),this.htmlInput_.select())}widgetCreate_(){var t=this.getSourceBlock();if(!t)throw new ye;s.setGroup$$module$build$src$core$events$utils(!0);const i=er();var r=this.getClickTarget_();if(!r)throw Error("A click target has not been set.");J(r,"editing"),r=document.createElement("input"),r.className="blocklyHtmlInput",r.setAttribute("spellcheck",this.spellcheck_);const c=this.workspace_.getScale();var u=this.getConstants().FIELD_TEXT_FONTSIZE*c+"pt";return i.style.fontSize=u,r.style.fontSize=u,u=va.BORDERRADIUS*c+"px",this.isFullBlockField()&&(u=this.getScaledBBox(),u=(u.bottom-u.top)/2+"px",t=t.getParent()?t.getParent().style.colourTertiary:this.sourceBlock_.style.colourTertiary,r.style.border=1*c+"px solid "+t,i.style.borderRadius=u,i.style.transition="box-shadow 0.25s ease 0s",this.getConstants().FIELD_TEXTINPUT_BOX_SHADOW&&(i.style.boxShadow="rgba(255, 255, 255, 0.3) 0 0 0 "+4*c+"px")),r.style.borderRadius=u,i.appendChild(r),r.value=r.defaultValue=this.getEditorText_(this.value_),r.setAttribute("data-untyped-default-value",String(this.value_)),this.resizeEditor_(),this.bindInputEvents_(r),r}widgetDispose_(){this.isBeingEdited_=!1,this.isTextValid_=!0,this.forceRerender(),this.onFinishEditing_(this.value_),this.sourceBlock_&&Lt()&&this.valueWhenEditorWasOpened_!==null&&this.valueWhenEditorWasOpened_!==this.value_&&(it(new(ut(s.CHANGE$$module$build$src$core$events$utils))(this.sourceBlock_,"field",this.name||null,this.valueWhenEditorWasOpened_,this.value_)),this.valueWhenEditorWasOpened_=null),s.setGroup$$module$build$src$core$events$utils(!1),this.unbindInputEvents_();var t=er().style;if(t.width="auto",t.height="auto",t.fontSize="",t.transition="",t.boxShadow="",this.htmlInput_=null,t=this.getClickTarget_(),!t)throw Error("A click target has not been set.");mt(t,"editing")}onFinishEditing_(t){}bindInputEvents_(t){this.onKeyDownWrapper_=yt(t,"keydown",this,this.onHtmlInputKeyDown_),this.onKeyInputWrapper_=yt(t,"input",this,this.onHtmlInputChange_)}unbindInputEvents_(){this.onKeyDownWrapper_&&(N(this.onKeyDownWrapper_),this.onKeyDownWrapper_=null),this.onKeyInputWrapper_&&(N(this.onKeyInputWrapper_),this.onKeyInputWrapper_=null)}onHtmlInputKeyDown_(t){t.key==="Enter"?(cs(),Es()):t.key==="Escape"?(this.setValue(this.htmlInput_.getAttribute("data-untyped-default-value")),cs(),Es()):t.key==="Tab"&&(cs(),Es(),this.sourceBlock_.tab(this,!t.shiftKey),t.preventDefault())}onHtmlInputChange_(t){t=this.value_,this.setValue(this.getValueFromEditorText_(this.htmlInput_.value),!1),this.sourceBlock_&&Lt()&&this.value_!==t&&it(new(ut(un))(this.sourceBlock_,this.name||null,t,this.value_))}setEditorValue_(t,i=!0){this.isDirty_=!0,this.isBeingEdited_&&(this.htmlInput_.value=this.getEditorText_(t)),this.setValue(t,i)}resizeEditor_(){var t=this.getSourceBlock();if(!t)throw new ye;const i=er(),r=this.getScaledBBox();i.style.width=r.right-r.left+"px",i.style.height=r.bottom-r.top+"px",t=new pt(t.RTL?r.right-i.offsetWidth:r.left,r.top),i.style.left=t.x+"px",i.style.top=t.y+"px"}repositionForWindowResize(){const t=this.getSourceBlock();return t instanceof to?(ul(this.workspace_,this.workspace_.getMetricsManager().getViewMetrics(!0),t)||this.resizeEditor_(),!0):!1}isTabNavigable(){return!0}getText_(){return this.isBeingEdited_&&this.htmlInput_?this.htmlInput_.value:null}getEditorText_(t){return`${t}`}getValueFromEditorText_(t){return t}};va.BORDERRADIUS=4;var Vl=class extends va{constructor(t,i,r){super(t,i,r)}doClassValidation_(t){return t===void 0?null:`${t}`}static fromJson(t){return new this(Fe(t.text),void 0,t)}};zi("field_input",Vl),Vl.prototype.DEFAULT_VALUE="";var JI=class extends e${constructor(t){super(t)}endsWithElemSpacer(){return!1}hasLeftSquareCorner(t){return!!t.outputConnection}hasRightSquareCorner(t){return!!t.outputConnection&&!t.statementInputCount&&!t.nextConnection}},ud=class extends da{constructor(t,i){if(super(t,i),this.connectedBottomNextConnection=!1,this.connectedBlock){for(t=this.connectedBlock;i=t.getNextBlock();)t=i;t.nextConnection||(this.height=this.connectedBlockHeight,this.connectedBottomNextConnection=!0)}}},qI=class extends qs{constructor(t){super(t),this.width=this.height=0,this.type|=x.getType("RIGHT_CONNECTION")}},ZI=class extends r${constructor(t){super(t)}endsWithElemSpacer(){return!1}hasLeftSquareCorner(t){const i=(t.hat?t.hat==="cap":this.constants_.ADD_START_HATS)&&!t.outputConnection&&!t.previousConnection;return!!t.outputConnection||i}hasRightSquareCorner(t){return!!t.outputConnection&&!t.statementInputCount&&!t.nextConnection}},QI=class extends Dl{constructor(t,i){super(t,i),this.isInline=!0,this.renderer_=t,this.constants_=this.renderer_.getConstants(),this.topRow=new ZI(this.constants_),this.bottomRow=new JI(this.constants_),this.isMultiRow=!i.getInputsInline()||i.isCollapsed(),this.hasStatementInput=0<i.statementInputCount,this.rightSide=this.outputConnection?new qI(this.constants_):null,this.rightAlignedDummyInputs=new WeakMap}getRenderer(){return this.renderer_}measure(){this.createRows_(),this.addElemSpacing_(),this.addRowSpacing_(),this.adjustXPosition_(),this.computeBounds_(),this.alignRowElements_(),this.finalize_()}shouldStartNewRow_(t,i){return i?i instanceof Po||t instanceof Ji||i instanceof Ji?!0:t instanceof s.ValueInput$$module$build$src$core$inputs$value_input||t instanceof Qs||t instanceof Po?!this.isInline||this.isMultiRow:!1:!1}getDesiredRowWidth_(t){return t.hasStatement?this.width-this.startX-(this.constants_.INSIDE_CORNERS.rightWidth||0):super.getDesiredRowWidth_(t)}getInRowSpacing_(t,i){return t&&i||!this.outputConnection||!this.outputConnection.isDynamicShape||this.hasStatementInput||this.bottomRow.hasNextConnection?!t&&i&&x.isStatementInput(i)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:t&&x.isLeftRoundedCorner(t)&&i&&(x.isPreviousConnection(i)||x.isNextConnection(i))?i.notchOffset-this.constants_.CORNER_RADIUS:t&&x.isLeftSquareCorner(t)&&i&&x.isHat(i)?this.constants_.NO_PADDING:this.constants_.MEDIUM_PADDING:this.constants_.NO_PADDING}getSpacerRowHeight_(t,i){if(x.isTopRow(t)&&x.isBottomRow(i))return this.constants_.EMPTY_BLOCK_SPACER_HEIGHT;const r=x.isInputRow(t)&&t.hasStatement,c=x.isInputRow(i)&&i.hasStatement;return c||r?(t=Math.max(this.constants_.NOTCH_HEIGHT,this.constants_.INSIDE_CORNERS.rightHeight||0),c&&r?Math.max(t,this.constants_.DUMMY_INPUT_MIN_HEIGHT):t):x.isTopRow(t)?t.hasPreviousConnection||this.outputConnection&&!this.hasStatementInput?this.constants_.NO_PADDING:Math.abs(this.constants_.NOTCH_HEIGHT-this.constants_.CORNER_RADIUS):x.isBottomRow(i)?this.outputConnection?!i.hasNextConnection&&this.hasStatementInput?Math.abs(this.constants_.NOTCH_HEIGHT-this.constants_.CORNER_RADIUS):this.constants_.NO_PADDING:Math.max(this.topRow.minHeight,Math.max(this.constants_.NOTCH_HEIGHT,this.constants_.CORNER_RADIUS))-this.constants_.CORNER_RADIUS:this.constants_.MEDIUM_PADDING}getSpacerRowWidth_(t,i){const r=this.width-this.startX;return x.isInputRow(t)&&t.hasStatement||x.isInputRow(i)&&i.hasStatement?Math.max(r,this.constants_.STATEMENT_INPUT_SPACER_MIN_WIDTH):r}getElemCenterline_(t,i){if(t.hasStatement&&!x.isSpacer(i)&&!x.isStatementInput(i))return t.yPos+this.constants_.EMPTY_STATEMENT_INPUT_HEIGHT/2;if(x.isInlineInput(i)&&i instanceof bn){const r=i.connectedBlock;if(r&&r.outputConnection&&r.nextConnection)return t.yPos+r.height/2}return super.getElemCenterline_(t,i)}addInput_(t,i){if((t instanceof Qs||t instanceof Po)&&i.hasDummyInput&&i.align===s.Align$$module$build$src$core$inputs$align.LEFT&&t.align===s.Align$$module$build$src$core$inputs$align.RIGHT)this.rightAlignedDummyInputs.set(i,t);else if(t instanceof Ji){i.elements.push(new ud(this.constants_,t)),i.hasStatement=!0,i.align===null&&(i.align=t.align);return}super.addInput_(t,i)}addAlignmentPadding_(t,i){if(this.rightAlignedDummyInputs.get(t)){let r;for(let c=0;c<t.elements.length;c++){const u=t.elements[c];if(x.isSpacer(u)&&(r=u),x.isField(u)&&u instanceof xl&&u.parentInput===this.rightAlignedDummyInputs.get(t))break}if(r){r.width+=i,t.width+=i;return}}super.addAlignmentPadding_(t,i)}adjustXPosition_(){const t=this.constants_.NOTCH_OFFSET_LEFT+this.constants_.NOTCH_WIDTH;let i=t;for(let u=2;u<this.rows.length-1;u+=2){var r=this.rows[u-1];const f=this.rows[u];var c=this.rows[u+1];if(r=u===2?!!this.topRow.hasPreviousConnection:!!r.followsStatement,c=u+2>=this.rows.length-1?!!this.bottomRow.hasNextConnection:!!c.precedesStatement,x.isInputRow(f)&&f.hasStatement){f.measure();let E,S;i=f.width-((S=(E=f.getLastInput())==null?void 0:E.width)!=null?S:0)+t}else if(r&&(u===2||c)&&x.isInputRow(f)&&!f.hasStatement){c=f.xPos,r=null;for(let E=0;E<f.elements.length;E++){const S=f.elements[E];x.isSpacer(S)&&(r=S),r&&(x.isField(S)||x.isInput(S))&&c<i&&!(x.isField(S)&&S instanceof xl&&(S.field instanceof Ir||S.field instanceof Cr))&&(r.width+=i-c),c+=S.width}}}}finalizeOutputConnection_(){if(this.outputConnection&&this.outputConnection.isDynamicShape){var t=this.outputConnection.shape;if("isDynamic"in t&&t.isDynamic){for(var i=0,r=0;r<this.rows.length;r++){const c=this.rows[r];c.yPos=i,i+=c.height}this.height=i,r=this.bottomRow.hasNextConnection?this.height-this.bottomRow.descenderHeight:this.height,i=t.height(r),r=t.width(r),this.outputConnection.height=i,this.outputConnection.width=r,this.outputConnection.startX=r,this.outputConnection.connectionOffsetY=t.connectionOffsetY(i),this.outputConnection.connectionOffsetX=t.connectionOffsetX(r),t=0,this.hasStatementInput||this.bottomRow.hasNextConnection||(t=r,this.rightSide.height=i,this.rightSide.width=t,this.rightSide.centerline=i/2,this.rightSide.xPos=this.width+t),this.startX=r,this.width+=r+t,this.widthWithChildren+=r+t}}}finalizeHorizontalAlignment_(){if(this.outputConnection&&!this.hasStatementInput&&!this.bottomRow.hasNextConnection){for(var t=0,i=0;i<this.rows.length;i++){var r=this.rows[i];if(!x.isInputRow(r))continue;t=r.elements[r.elements.length-2];let c=this.getNegativeSpacing_(r.elements[1]),u=this.getNegativeSpacing_(t);t=c+u;const f=this.constants_.MIN_BLOCK_WIDTH+2*this.outputConnection.width;this.width-t<f&&(t=this.width-f,c=t/2,u=t/2),r.elements.unshift(new ji(this.constants_,-c)),r.elements.push(new ji(this.constants_,-u))}if(t)for(this.width-=t,this.widthWithChildren-=t,this.rightSide.xPos-=t,i=0;i<this.rows.length;i++)r=this.rows[i],x.isTopOrBottomRow(r)&&(r.elements[1].width-=t),r.width-=t,r.widthWithConnectedBlocks-=t}}getNegativeSpacing_(t){if(!t||!this.outputConnection)return 0;const i=this.outputConnection.width;var r=this.outputConnection.shape.type;const c=this.constants_;if(1<this.inputRows.length)switch(r){case c.SHAPES.ROUND:return r=this.constants_.MAX_DYNAMIC_CONNECTION_SHAPE_WIDTH,r=this.height/2>r?r:this.height/2,i-r*(1-Math.sin(Math.acos((r-this.constants_.SMALL_PADDING)/r)));default:return 0}if(x.isInlineInput(t)&&t instanceof bn){const u=t.connectedBlock;return t=u?u.pathObject.outputShapeType:t.shape.type,t==null||u&&u.outputConnection&&(u.statementInputCount||u.nextConnection)||r===c.SHAPES.HEXAGONAL&&r!==t?0:i-this.constants_.SHAPE_IN_SHAPE_PADDING[r][t]}return x.isField(t)&&t instanceof xl?r===c.SHAPES.ROUND&&t.field instanceof Vl?i-2.75*c.GRID_UNIT:i-this.constants_.SHAPE_IN_SHAPE_PADDING[r][0]:x.isIcon(t)?this.constants_.SMALL_PADDING:0}finalizeVerticalAlignment_(){if(!this.outputConnection)for(let c=2;c<this.rows.length-1;c+=2){const u=this.rows[c-1],f=this.rows[c],E=this.rows[c+1];var t=c===2,i=c+2>=this.rows.length-1?!!this.bottomRow.hasNextConnection:!!E.precedesStatement;if(t?this.topRow.hasPreviousConnection:u.followsStatement){var r=f.elements[1];if(r=f.elements.length===3&&r instanceof xl&&(r.field instanceof Ir||r.field instanceof Cr),!t&&r)u.height-=this.constants_.SMALL_PADDING,E.height-=this.constants_.SMALL_PADDING,f.height-=this.constants_.MEDIUM_PADDING;else if(!t&&!i)u.height+=this.constants_.SMALL_PADDING;else if(i){for(t=!1,i=0;i<f.elements.length;i++)if(r=f.elements[i],r instanceof bn&&x.isInlineInput(r)&&r.connectedBlock&&!r.connectedBlock.isShadow()&&40<=r.connectedBlock.getHeightWidth().height){t=!0;break}t&&(u.height-=this.constants_.SMALL_PADDING,E.height-=this.constants_.SMALL_PADDING)}}}}finalize_(){this.finalizeOutputConnection_(),this.finalizeHorizontalAlignment_(),this.finalizeVerticalAlignment_(),super.finalize_(),this.rightSide&&(this.widthWithChildren+=this.rightSide.width)}},tS=class extends c${constructor(t,i,r){super(t,i,r),this.markerCircle=null}showWithInputOutput(t){const i=t.getSourceBlock();t=t.getLocation().getOffsetInBlock(),this.positionCircle(t.x,t.y),this.setParent_(i),this.showCurrent_()}showWithOutput_(t){this.showWithInputOutput(t)}showWithInput_(t){this.showWithInputOutput(t)}showWithBlock_(t){t=t.getLocation();const i=t.getHeightWidth();this.positionRect_(0,0,i.width,i.height),this.setParent_(t),this.showCurrent_()}positionCircle(t,i){let r;(r=this.markerCircle)==null||r.setAttribute("cx",`${t}`);let c;(c=this.markerCircle)==null||c.setAttribute("cy",`${i}`),this.currentMarkerSvg=this.markerCircle}hide(){super.hide(),this.markerCircle&&(this.markerCircle.style.display="none")}createDomInternal_(){if(super.createDomInternal_(),this.markerCircle=R(D.CIRCLE,{r:this.constants_.CURSOR_RADIUS,"stroke-width":this.constants_.CURSOR_STROKE_WIDTH},this.markerSvg_),this.hide(),this.isCursor()){const t=this.getBlinkProperties_();R(D.ANIMATE,t,this.markerCircle)}return this.markerSvg_}applyColour_(t){super.applyColour_(t);let i;(i=this.markerCircle)==null||i.setAttribute("fill",this.colour_);let r;if((r=this.markerCircle)==null||r.setAttribute("stroke",this.colour_),this.isCursor()){t=this.colour_+";transparent;transparent;";let c;(c=this.markerCircle)==null||c.firstElementChild.setAttribute("values",t)}}},eS=class extends od{constructor(t,i,r){super(t,i,r),this.svgPathSelected=null,this.outlines=new Map,this.remainingOutlines=new Set,this.outputShapeType=null,this.constants=r}setPath(t){super.setPath(t),this.svgPathSelected&&this.svgPathSelected.setAttribute("d",t)}applyColour(t){super.applyColour(t);const i=t.getParent();t.isShadow()&&i&&this.svgPath.setAttribute("stroke",i.style.colourTertiary);for(const r of this.outlines.values())r.setAttribute("fill",this.style.colourTertiary)}flipRTL(){super.flipRTL();for(const t of this.outlines.values())t.setAttribute("transform","scale(-1 1)")}updateSelected(t){this.setClass_("blocklySelected",t),t?this.svgPathSelected||(this.svgPathSelected=this.svgPath.cloneNode(!0),this.svgPathSelected.setAttribute("fill","none"),this.svgPathSelected.setAttribute("filter","url(#"+this.constants.selectedGlowFilterId+")"),this.svgRoot.appendChild(this.svgPathSelected)):this.svgPathSelected&&(this.svgRoot.removeChild(this.svgPathSelected),this.svgPathSelected=null)}updateReplacementFade(t){this.setClass_("blocklyReplaceable",t),t?this.svgPath.setAttribute("filter","url(#"+this.constants.replacementGlowFilterId+")"):this.svgPath.removeAttribute("filter")}updateShapeForInputHighlight(t,i){t=t.getParentInput().name,(t=this.getOutlinePath(t))&&(i?t.setAttribute("filter","url(#"+this.constants.replacementGlowFilterId+")"):t.removeAttribute("filter"))}beginDrawing(){this.remainingOutlines.clear();for(const t of this.outlines.keys())this.remainingOutlines.add(t)}endDrawing(){if(this.remainingOutlines.size)for(const t of this.remainingOutlines)this.removeOutlinePath(t);this.remainingOutlines.clear()}setOutlinePath(t,i){t=this.getOutlinePath(t),t.setAttribute("d",i),t.setAttribute("fill",this.style.colourTertiary)}getOutlinePath(t){return this.outlines.has(t)||this.outlines.set(t,R(D.PATH,{class:"blocklyOutlinePath",d:""},this.svgRoot)),this.remainingOutlines.delete(t),this.outlines.get(t)}removeOutlinePath(t){let i,r;(i=this.outlines.get(t))==null||(r=i.parentNode)==null||r.removeChild(this.outlines.get(t)),this.outlines.delete(t)}},iS=class extends $a{constructor(t){super(t)}makeConstants_(){return new KI}makeRenderInfo_(t){return new QI(this,t)}makeDrawer_(t,i){return new jI(t,i)}makeMarkerDrawer(t,i){return new tS(t,this.getConstants(),i)}makePathObject(t,i){return new eS(t,i,this.getConstants())}getConstants(){return this.constants_}shouldHighlightConnection(t){return t.type!==wt.INPUT_VALUE&&t.type!==wt.OUTPUT_VALUE}getConnectionPreviewMethod(t,i,r){return i.type===wt.OUTPUT_VALUE?t.isConnected()?qi.PREVIEW_TYPE.REPLACEMENT_FADE:qi.PREVIEW_TYPE.INPUT_OUTLINE:super.getConnectionPreviewMethod(t,i,r)}};hl("zelos",iS);var Cs={};Cs.BottomRow=JI,Cs.ConstantProvider=KI,Cs.Drawer=jI,Cs.MarkerSvg=tS,Cs.PathObject=eS,Cs.RenderInfo=QI,Cs.Renderer=iS,Cs.RightConnectionShape=qI,Cs.StatementInput=ud,Cs.TopRow=ZI,tm();var Ci={};Ci.registerCleanup=Hg,Ci.registerCollapse=Gg,Ci.registerCollapseExpandBlock=Jg,Ci.registerComment=Kg,Ci.registerDefaultOptions=tm,Ci.registerDelete=Zg,Ci.registerDeleteAll=Xg,Ci.registerDisable=qg,Ci.registerDuplicate=Yg,Ci.registerExpand=Wg,Ci.registerHelp=Qg,Ci.registerInline=jg,Ci.registerRedo=Ug,Ci.registerUndo=Fg;var jt=class extends va{constructor(t,i,r){super(qt.SKIP_SETUP),this.clockwise=jt.CLOCKWISE,this.offset=jt.OFFSET,this.wrap=jt.WRAP,this.round=jt.ROUND,this.boundEvents=[],this.symbol_=this.gauge=this.line=null,t!==qt.SKIP_SETUP&&(r&&this.configure_(r),this.setValue(t),i&&this.setValidator(i))}configure_(t){switch(super.configure_(t),t.mode){case dd.COMPASS:this.clockwise=!0,this.offset=90;break;case dd.PROTRACTOR:this.clockwise=!1,this.offset=0}t.clockwise&&(this.clockwise=t.clockwise),t.offset&&(this.offset=t.offset),t.wrap&&(this.wrap=t.wrap),t.round&&(this.round=t.round)}initView(){super.initView(),this.symbol_=R(D.TSPAN,{}),this.symbol_.appendChild(document.createTextNode("")),this.getTextElement().appendChild(this.symbol_)}render_(){super.render_(),this.updateGraph()}showEditor_(t){super.showEditor_(t,am||xu||El),t=this.dropdownCreate(),sl().appendChild(t),this.sourceBlock_ instanceof to&&cu(this.sourceBlock_.style.colourPrimary,this.sourceBlock_.style.colourTertiary),Hc(this,this.dropdownDispose.bind(this)),this.updateGraph()}dropdownCreate(){const t=R(D.SVG,{xmlns:jc,"xmlns:html":zs,"xmlns:xlink":Xi,version:"1.1",height:2*jt.HALF+"px",width:2*jt.HALF+"px"});t.style.touchAction="none";const i=R(D.CIRCLE,{cx:jt.HALF,cy:jt.HALF,r:jt.RADIUS,class:"blocklyAngleCircle"},t);this.gauge=R(D.PATH,{class:"blocklyAngleGauge"},t),this.line=R(D.LINE,{x1:jt.HALF,y1:jt.HALF,class:"blocklyAngleLine"},t);for(let r=0;360>r;r+=15)R(D.LINE,{x1:jt.HALF+jt.RADIUS,y1:jt.HALF,x2:jt.HALF+jt.RADIUS-(r%45===0?10:5),y2:jt.HALF,class:"blocklyAngleMarks",transform:"rotate("+r+","+jt.HALF+","+jt.HALF+")"},t);return this.boundEvents.push(yt(t,"click",this,this.hide)),this.boundEvents.push(yt(i,"pointerdown",this,this.onMouseMove_,!0)),this.boundEvents.push(yt(i,"pointermove",this,this.onMouseMove_,!0)),t}dropdownDispose(){for(const t of this.boundEvents)N(t);this.boundEvents.length=0,this.line=this.gauge=null}hide(){ol(this),cs()}onMouseMove_(t){var i=this.gauge.ownerSVGElement.getBoundingClientRect();const r=t.clientX-i.left-jt.HALF;t=t.clientY-i.top-jt.HALF,i=Math.atan(-t/r),isNaN(i)||(i=Nf(i),0>r?i+=180:0<t&&(i+=360),i=this.clockwise?this.offset+360-i:360-(this.offset-i),this.displayMouseOrKeyboardValue(i))}displayMouseOrKeyboardValue(t){if(this.round&&(t=Math.round(t/this.round)*this.round),t=this.wrapValue(t),t!==this.value_){const i=this.value_;this.setEditorValue_(t,!1),this.sourceBlock_&&Lt()&&this.value_!==i&&it(new(ut(un))(this.sourceBlock_,this.name||null,i,this.value_))}}updateGraph(){if(this.gauge&&this.line){var t=Number(this.getText())+this.offset,i=el(t%360);t=["M ",jt.HALF,",",jt.HALF];var r=jt.HALF,c=jt.HALF;if(!isNaN(i)){const u=Number(this.clockwise),f=el(this.offset),E=Math.cos(f)*jt.RADIUS,S=Math.sin(f)*-jt.RADIUS;u&&(i=2*f-i),r+=Math.cos(i)*jt.RADIUS,c-=Math.sin(i)*jt.RADIUS,i=Math.abs(Math.floor((i-f)/Math.PI)%2),u&&(i=1-i),t.push(" l ",E,",",S," A ",jt.RADIUS,",",jt.RADIUS," 0 ",i," ",u," ",r,",",c," z")}this.gauge.setAttribute("d",t.join("")),this.line.setAttribute("x2",`${r}`),this.line.setAttribute("y2",`${c}`)}}onHtmlInputKeyDown_(t){super.onHtmlInputKeyDown_(t);var i=this.getSourceBlock();if(!i)throw new ye;let r=0;switch(t.key){case"ArrowLeft":r=i.RTL?1:-1;break;case"ArrowRight":r=i.RTL?-1:1;break;case"ArrowDown":r=-1;break;case"ArrowUp":r=1}r&&(i=this.getValue(),this.displayMouseOrKeyboardValue(i+r*this.round),t.preventDefault(),t.stopPropagation())}doClassValidation_(t){return t=Number(t),isNaN(t)||!isFinite(t)?null:this.wrapValue(t)}wrapValue(t){return t%=360,0>t&&(t+=360),t>this.wrap&&(t-=360),t}static fromJson(t){return new this(t.angle,void 0,t)}};jt.HALF=50,jt.RADIUS=jt.HALF-1,jt.CLOCKWISE=!1,jt.OFFSET=0,jt.WRAP=360,jt.ROUND=15,zi("field_angle",jt),jt.prototype.DEFAULT_VALUE=0,et(`
.blocklyAngleCircle {
  stroke: #444;
  stroke-width: 1;
  fill: #ddd;
  fill-opacity: 0.8;
}

.blocklyAngleMarks {
  stroke: #444;
  stroke-width: 1;
}

.blocklyAngleGauge {
  fill: #f88;
  fill-opacity: 0.8;
  pointer-events: none;
}

.blocklyAngleLine {
  stroke: #f00;
  stroke-width: 2;
  stroke-linecap: round;
  pointer-events: none;
}
`);var dd;(function(t){t.COMPASS="compass",t.PROTRACTOR="protractor"})(dd||(dd={}));var wr=class extends qt{constructor(t,i,r){super(qt.SKIP_SETUP),this.SERIALIZABLE=!0,this.CURSOR="default",this.value_=this.value_,this.checkChar=wr.CHECK_CHAR,t!==qt.SKIP_SETUP&&(r&&this.configure_(r),this.setValue(t),i&&this.setValidator(i))}configure_(t){super.configure_(t),t.checkCharacter&&(this.checkChar=t.checkCharacter)}saveState(){const t=this.saveLegacyState(wr);return t!==null?t:this.getValueBoolean()}initView(){super.initView();const t=this.getTextElement();J(t,"blocklyCheckbox"),t.style.display=this.value_?"block":"none"}render_(){this.textContent_&&(this.textContent_.nodeValue=this.getDisplayText_()),this.updateSize_(this.getConstants().FIELD_CHECKBOX_X_OFFSET)}getDisplayText_(){return this.checkChar}setCheckCharacter(t){this.checkChar=t||wr.CHECK_CHAR,this.forceRerender()}showEditor_(){this.setValue(!this.value_)}doClassValidation_(t){return t===!0||t==="TRUE"?"TRUE":t===!1||t==="FALSE"?"FALSE":null}doValueUpdate_(t){this.value_=this.convertValueToBool_(t),this.textElement_&&(this.textElement_.style.display=this.value_?"block":"none")}getValue(){return this.value_?"TRUE":"FALSE"}getValueBoolean(){return this.value_}getText(){return String(this.convertValueToBool_(this.value_))}convertValueToBool_(t){return typeof t=="string"?t==="TRUE":!!t}static fromJson(t){return new this(t.checked,void 0,t)}};wr.CHECK_CHAR="",zi("field_checkbox",wr),wr.prototype.DEFAULT_VALUE=!1;var Zi=class extends qt{constructor(t,i,r){super(qt.SKIP_SETUP),this.highlightedIndex=this.picker=null,this.boundEvents=[],this.SERIALIZABLE=!0,this.CURSOR="default",this.isDirty_=!1,this.titles=this.colours=null,this.columns=0,t!==qt.SKIP_SETUP&&(r&&this.configure_(r),this.setValue(t),i&&this.setValidator(i))}configure_(t){super.configure_(t),t.colourOptions&&(this.colours=t.colourOptions),t.colourTitles&&(this.titles=t.colourTitles),t.columns&&(this.columns=t.columns)}initView(){this.size_=new Ce(this.getConstants().FIELD_COLOUR_DEFAULT_WIDTH,this.getConstants().FIELD_COLOUR_DEFAULT_HEIGHT),this.createBorderRect_(),this.getBorderRect().style.fillOpacity="1",this.getBorderRect().setAttribute("stroke","#fff"),this.isFullBlockField()&&(this.clickTarget_=this.sourceBlock_.getSvgRoot())}isFullBlockField(){const t=this.getSourceBlock();if(!t)throw new ye;const i=this.getConstants();return t.isSimpleReporter()&&!(i==null||!i.FIELD_COLOUR_FULL_BLOCK)}applyColour(){const t=this.getSourceBlock();if(!t)throw new ye;if(this.fieldGroup_){var i=this.borderRect_;if(!i)throw Error("The border rect has not been initialized");this.isFullBlockField()?(i.style.display="none",t.pathObject.svgPath.setAttribute("fill",this.getValue()),t.pathObject.svgPath.setAttribute("stroke","#fff")):(i.style.display="block",i.style.fill=this.getValue())}}getSize(){let t;return(t=this.getConstants())!=null&&t.FIELD_COLOUR_FULL_BLOCK&&(this.render_(),this.isDirty_=!1),super.getSize()}render_(){super.render_();const t=this.getSourceBlock();if(!t)throw new ye;t.applyColour()}updateSize_(t){var i=this.getConstants();this.isFullBlockField()?(t=2*(t??0),i=i.FIELD_TEXT_HEIGHT):(t=i.FIELD_COLOUR_DEFAULT_WIDTH,i=i.FIELD_COLOUR_DEFAULT_HEIGHT),this.size_.height=i,this.size_.width=t,this.positionBorderRect_()}doClassValidation_(t){return typeof t!="string"?null:cn(t)}getText(){let t=this.value_;return/^#(.)\1(.)\2(.)\3$/.test(t)&&(t="#"+t[1]+t[3]+t[5]),t}setColours(t,i){return this.colours=t,i&&(this.titles=i),this}setColumns(t){return this.columns=t,this}showEditor_(){this.dropdownCreate(),sl().appendChild(this.picker),Hc(this,this.dropdownDispose.bind(this)),this.picker.focus({preventScroll:!0})}onClick(t){t=(t=t.target)&&t.getAttribute("data-colour"),t!==null&&(this.setValue(t),ol(this))}onKeyDown(t){let i=!0;var r;switch(t.key){case"ArrowUp":this.moveHighlightBy(0,-1);break;case"ArrowDown":this.moveHighlightBy(0,1);break;case"ArrowLeft":this.moveHighlightBy(-1,0);break;case"ArrowRight":this.moveHighlightBy(1,0);break;case"Enter":(r=this.getHighlighted())&&(r=r.getAttribute("data-colour"),r!==null&&this.setValue(r)),Es();break;default:i=!1}i&&t.stopPropagation()}moveHighlightBy(t,i){if(this.highlightedIndex){var r=this.colours||Zi.COLOURS,c=this.columns||Zi.COLUMNS,u=this.highlightedIndex%c,f=Math.floor(this.highlightedIndex/c);u+=t,f+=i,0>t?0>u&&0<f?(u=c-1,f--):0>u&&(u=0):0<t?u>c-1&&f<Math.floor(r.length/c)-1?(u=0,f++):u>c-1&&u--:0>i?0>f&&(f=0):0<i&&f>Math.floor(r.length/c)-1&&(f=Math.floor(r.length/c)-1),this.setHighlightedCell(this.picker.childNodes[f].childNodes[u],f*c+u)}}onMouseMove(t){const i=(t=t.target)&&Number(t.getAttribute("data-index"));i!==null&&i!==this.highlightedIndex&&this.setHighlightedCell(t,i)}onMouseEnter(){let t;(t=this.picker)==null||t.focus({preventScroll:!0})}onMouseLeave(){var t;(t=this.picker)==null||t.blur(),(t=this.getHighlighted())&&mt(t,"blocklyColourHighlighted")}getHighlighted(){if(!this.highlightedIndex)return null;const t=this.columns||Zi.COLUMNS,i=this.picker.childNodes[Math.floor(this.highlightedIndex/t)];return i?i.childNodes[this.highlightedIndex%t]:null}setHighlightedCell(t,i){const r=this.getHighlighted();r&&mt(r,"blocklyColourHighlighted"),J(t,"blocklyColourHighlighted"),this.highlightedIndex=i,(t=t.getAttribute("id"))&&this.picker&&Re(this.picker,we.ACTIVEDESCENDANT,t)}dropdownCreate(){const t=this.columns||Zi.COLUMNS,i=this.colours||Zi.COLOURS,r=this.titles||Zi.TITLES,c=this.getValue(),u=document.createElement("table");u.className="blocklyColourTable",u.tabIndex=0,u.dir="ltr",bs(u,Pi.GRID),Re(u,we.EXPANDED,!0),Re(u,we.ROWCOUNT,Math.floor(i.length/t)),Re(u,we.COLCOUNT,t);let f;for(let E=0;E<i.length;E++){E%t===0&&(f=document.createElement("tr"),bs(f,Pi.ROW),u.appendChild(f));const S=document.createElement("td");f.appendChild(S),S.setAttribute("data-colour",i[E]),S.title=r[E]||i[E],S.id=ot(),S.setAttribute("data-index",`${E}`),bs(S,Pi.GRIDCELL),Re(S,we.LABEL,i[E]),Re(S,we.SELECTED,i[E]===c),S.style.backgroundColor=i[E],i[E]===c&&(S.className="blocklyColourSelected",this.highlightedIndex=E)}this.boundEvents.push(yt(u,"pointerdown",this,this.onClick,!0)),this.boundEvents.push(yt(u,"pointermove",this,this.onMouseMove,!0)),this.boundEvents.push(yt(u,"pointerenter",this,this.onMouseEnter,!0)),this.boundEvents.push(yt(u,"pointerleave",this,this.onMouseLeave,!0)),this.boundEvents.push(yt(u,"keydown",this,this.onKeyDown,!1)),this.picker=u}dropdownDispose(){for(const t of this.boundEvents)N(t);this.boundEvents.length=0,this.highlightedIndex=this.picker=null}static fromJson(t){return new this(t.colour,void 0,t)}};Zi.COLOURS="#ffffff #cccccc #c0c0c0 #999999 #666666 #333333 #000000 #ffcccc #ff6666 #ff0000 #cc0000 #990000 #660000 #330000 #ffcc99 #ff9966 #ff9900 #ff6600 #cc6600 #993300 #663300 #ffff99 #ffff66 #ffcc66 #ffcc33 #cc9933 #996633 #663333 #ffffcc #ffff33 #ffff00 #ffcc00 #999900 #666600 #333300 #99ff99 #66ff99 #33ff33 #33cc00 #009900 #006600 #003300 #99ffff #33ffff #66cccc #00cccc #339999 #336666 #003333 #ccffff #66ffff #33ccff #3366ff #3333ff #000099 #000066 #ccccff #9999ff #6666cc #6633ff #6600cc #333399 #330099 #ffccff #ff99ff #cc66cc #cc33cc #993399 #663366 #330033".split(" "),Zi.TITLES=[],Zi.COLUMNS=7,Zi.prototype.DEFAULT_VALUE=Zi.COLOURS[0],zi("field_colour",Zi),et(`
.blocklyColourTable {
  border-collapse: collapse;
  display: block;
  outline: none;
  padding: 1px;
}

.blocklyColourTable>tr>td {
  border: 0.5px solid #888;
  box-sizing: border-box;
  cursor: pointer;
  display: inline-block;
  height: 20px;
  padding: 0;
  width: 20px;
}

.blocklyColourTable>tr>td.blocklyColourHighlighted {
  border-color: #eee;
  box-shadow: 2px 2px 7px 2px rgba(0, 0, 0, 0.3);
  position: relative;
}

.blocklyColourSelected, .blocklyColourSelected:hover {
  border-color: #eee !important;
  outline: 1px solid #333;
  position: relative;
}
`);var sS=class extends Ir{constructor(t,i,r){super(String(t??""),i,r),this.EDITABLE=!1,this.SERIALIZABLE=!0}static fromJson(t){return new this(Fe(t.text),void 0,t)}};zi("field_label_serializable",sS);var N$=class extends Vl{constructor(t,i,r){super(qt.SKIP_SETUP),this.textGroup=null,this.maxLines_=1/0,this.isOverflowedY_=!1,t!==qt.SKIP_SETUP&&(r&&this.configure_(r),this.setValue(t),i&&this.setValidator(i))}configure_(t){super.configure_(t),t.maxLines&&this.setMaxLines(t.maxLines)}toXml(t){return t.textContent=this.getValue().replace(/\n/g,"&#10;"),t}fromXml(t){this.setValue(t.textContent.replace(/&#10;/g,`
`))}saveState(){const t=this.saveLegacyState(N$);return t!==null?t:this.getValue()}loadState(t){this.loadLegacyState(qt,t)||this.setValue(t)}initView(){this.createBorderRect_(),this.textGroup=R(D.G,{class:"blocklyEditableText"},this.fieldGroup_)}getDisplayText_(){const t=this.getSourceBlock();if(!t)throw new ye;let i=this.getText();if(!i)return qt.NBSP;const r=i.split(`
`);i="";const c=this.isOverflowedY_?this.maxLines_:r.length;for(let u=0;u<c;u++){let f=r[u];f.length>this.maxDisplayLength?f=f.substring(0,this.maxDisplayLength-4)+"...":this.isOverflowedY_&&u===c-1&&(f=f.substring(0,f.length-3)+"..."),f=f.replace(/\s/g,qt.NBSP),i+=f,u!==c-1&&(i+=`
`)}return t.RTL&&(i+=""),i}doValueUpdate_(t){super.doValueUpdate_(t),this.value_!==null&&(this.isOverflowedY_=this.value_.split(`
`).length>this.maxLines_)}render_(){var t=this.getSourceBlock();if(!t)throw new ye;for(var i,r=this.textGroup;i=r.firstChild;)r.removeChild(i);i=this.getDisplayText_().split(`
`);let c=0;for(let u=0;u<i.length;u++){const f=this.getConstants().FIELD_TEXT_HEIGHT+this.getConstants().FIELD_BORDER_RECT_Y_PADDING;R(D.TEXT,{class:"blocklyText blocklyMultilineText",x:this.getConstants().FIELD_BORDER_RECT_X_PADDING,y:c+this.getConstants().FIELD_BORDER_RECT_Y_PADDING,dy:this.getConstants().FIELD_TEXT_BASELINE},r).appendChild(document.createTextNode(i[u])),c+=f}this.isBeingEdited_&&(r=this.htmlInput_,this.isOverflowedY_?J(r,"blocklyHtmlTextAreaInputOverflowedY"):mt(r,"blocklyHtmlTextAreaInputOverflowedY")),this.updateSize_(),this.isBeingEdited_&&(t.RTL?setTimeout(this.resizeEditor_.bind(this),0):this.resizeEditor_(),t=this.htmlInput_,this.isTextValid_?(mt(t,"blocklyInvalidInput"),Re(t,we.INVALID,!1)):(J(t,"blocklyInvalidInput"),Re(t,we.INVALID,!0)))}updateSize_(){var t=this.textGroup.childNodes;const i=this.getConstants().FIELD_TEXT_FONTSIZE,r=this.getConstants().FIELD_TEXT_FONTWEIGHT,c=this.getConstants().FIELD_TEXT_FONTFAMILY;let u=0,f=0;for(var E=0;E<t.length;E++){var S=nt(t[E],i,r,c);S>u&&(u=S),f+=this.getConstants().FIELD_TEXT_HEIGHT+(0<E?this.getConstants().FIELD_BORDER_RECT_Y_PADDING:0)}if(this.isBeingEdited_){for(t=String(this.value_).split(`
`),E=R(D.TEXT,{class:"blocklyText blocklyMultilineText"}),S=0;S<t.length;S++){t[S].length>this.maxDisplayLength&&(t[S]=t[S].substring(0,this.maxDisplayLength)),E.textContent=t[S];const W=nt(E,i,r,c);W>u&&(u=W)}u+=this.htmlInput_.offsetWidth-this.htmlInput_.clientWidth}this.borderRect_&&(f+=2*this.getConstants().FIELD_BORDER_RECT_Y_PADDING,u+=2*this.getConstants().FIELD_BORDER_RECT_X_PADDING,this.borderRect_.setAttribute("width",`${u}`),this.borderRect_.setAttribute("height",`${f}`)),this.size_.width=u,this.size_.height=f,this.positionBorderRect_()}showEditor_(t,i){super.showEditor_(t,i),this.forceRerender()}widgetCreate_(){const t=er(),i=this.workspace_.getScale(),r=document.createElement("textarea");r.className="blocklyHtmlInput blocklyHtmlTextAreaInput",r.setAttribute("spellcheck",String(this.spellcheck_));var c=this.getConstants().FIELD_TEXT_FONTSIZE*i+"pt";t.style.fontSize=c,r.style.fontSize=c,r.style.borderRadius=Vl.BORDERRADIUS*i+"px",c=this.getConstants().FIELD_BORDER_RECT_X_PADDING*i;const u=this.getConstants().FIELD_BORDER_RECT_Y_PADDING*i/2;return r.style.padding=u+"px "+c+"px "+u+"px "+c+"px",c=this.getConstants().FIELD_TEXT_HEIGHT+this.getConstants().FIELD_BORDER_RECT_Y_PADDING,r.style.lineHeight=c*i+"px",t.appendChild(r),r.value=r.defaultValue=this.getEditorText_(this.value_),r.setAttribute("data-untyped-default-value",String(this.value_)),r.setAttribute("data-old-value",""),lm?setTimeout(this.resizeEditor_.bind(this),0):this.resizeEditor_(),this.bindInputEvents_(r),r}setMaxLines(t){typeof t=="number"&&0<t&&t!==this.maxLines_&&(this.maxLines_=t,this.forceRerender())}getMaxLines(){return this.maxLines_}onHtmlInputKeyDown_(t){t.key!=="Enter"&&super.onHtmlInputKeyDown_(t)}static fromJson(t){return new this(Fe(t.text),void 0,t)}};zi("field_multilinetext",N$),et(`
.blocklyHtmlTextAreaInput {
  font-family: monospace;
  resize: none;
  overflow: hidden;
  height: 100%;
  text-align: left;
}

.blocklyHtmlTextAreaInputOverflowedY {
  overflow-y: scroll;
}
`);var L$=class extends va{constructor(t,i,r,c,u,f){super(qt.SKIP_SETUP),this.min_=-1/0,this.max_=1/0,this.precision_=0,this.decimalPlaces=null,this.spellcheck_=!1,t!==qt.SKIP_SETUP&&(f?this.configure_(f):this.setConstraints(i,r,c),this.setValue(t),u&&this.setValidator(u))}configure_(t){super.configure_(t),this.setMinInternal(t.min),this.setMaxInternal(t.max),this.setPrecisionInternal(t.precision)}setConstraints(t,i,r){this.setMinInternal(t),this.setMaxInternal(i),this.setPrecisionInternal(r),this.setValue(this.getValue())}setMin(t){this.setMinInternal(t),this.setValue(this.getValue())}setMinInternal(t){t==null?this.min_=-1/0:(t=Number(t),isNaN(t)||(this.min_=t))}getMin(){return this.min_}setMax(t){this.setMaxInternal(t),this.setValue(this.getValue())}setMaxInternal(t){t==null?this.max_=1/0:(t=Number(t),isNaN(t)||(this.max_=t))}getMax(){return this.max_}setPrecision(t){this.setPrecisionInternal(t),this.setValue(this.getValue())}setPrecisionInternal(t){this.precision_=Number(t)||0;let i=String(this.precision_);i.indexOf("e")!==-1&&(i=this.precision_.toLocaleString("en-US",{maximumFractionDigits:20}));const r=i.indexOf(".");this.decimalPlaces=r===-1?t?0:null:i.length-r-1}getPrecision(){return this.precision_}doClassValidation_(t){return t===null||(t=`${t}`.replace(/O/gi,"0"),t=t.replace(/,/g,""),t=t.replace(/infinity/i,"Infinity"),t=Number(t||0),isNaN(t))?null:(t=Math.min(Math.max(t,this.min_),this.max_),this.precision_&&isFinite(t)&&(t=Math.round(t/this.precision_)*this.precision_),this.decimalPlaces!==null&&(t=Number(t.toFixed(this.decimalPlaces))),t)}widgetCreate_(){const t=super.widgetCreate_();return-1/0<this.min_&&(t.min=`${this.min_}`,Re(t,we.VALUEMIN,this.min_)),1/0>this.max_&&(t.max=`${this.max_}`,Re(t,we.VALUEMAX,this.max_)),t}static fromJson(t){return new this(t.value,void 0,void 0,void 0,void 0,t)}};zi("field_number",L$),L$.prototype.DEFAULT_VALUE=0;var ya=class extends Js{constructor(t,i,r,c,u){super(qt.SKIP_SETUP),this.defaultType="",this.variableTypes=[],this.variable=null,this.SERIALIZABLE=!0,this.menuGenerator_=ya.dropdownCreate,this.defaultVariableName=typeof t=="string"?t:"",this.size_=new Ce(0,0),t!==qt.SKIP_SETUP&&(u?this.configure_(u):this.setTypes(r,c),i&&this.setValidator(i))}configure_(t){super.configure_(t),this.setTypes(t.variableTypes,t.defaultType)}initModel(){var t=this.getSourceBlock();if(!t)throw new ye;this.variable||(t=s.getOrCreateVariablePackage$$module$build$src$core$variables(t.workspace,null,this.defaultVariableName,this.defaultType),this.doValueUpdate_(t.getId()))}shouldAddBorderRect_(){const t=this.getSourceBlock();if(!t)throw new ye;return super.shouldAddBorderRect_()&&(!this.getConstants().FIELD_DROPDOWN_NO_BORDER_RECT_SHADOW||t.type!=="variables_get")}fromXml(t){var i=this.getSourceBlock();if(!i)throw new ye;const r=t.getAttribute("id"),c=t.textContent,u=t.getAttribute("variabletype")||t.getAttribute("variableType")||"";if(i=s.getOrCreateVariablePackage$$module$build$src$core$variables(i.workspace,r,c,u),u!==null&&u!==i.type)throw Error("Serialized variable type with id '"+i.getId()+"' had type "+i.type+", and does not match variable field that references it: "+Fs(t)+".");this.setValue(i.getId())}toXml(t){return this.initModel(),t.id=this.variable.getId(),t.textContent=this.variable.name,this.variable.type&&t.setAttribute("variabletype",this.variable.type),t}saveState(t){var i=this.saveLegacyState(ya);return i!==null||(this.initModel(),i={id:this.variable.getId()},t&&(i.name=this.variable.name,i.type=this.variable.type)),i}loadState(t){const i=this.getSourceBlock();if(!i)throw new ye;this.loadLegacyState(ya,t)||(t=s.getOrCreateVariablePackage$$module$build$src$core$variables(i.workspace,t.id||null,t.name,t.type||""),this.setValue(t.getId()))}setSourceBlock(t){if(t.isShadow())throw Error("Variable fields are not allowed to exist on shadow blocks.");super.setSourceBlock(t)}getValue(){return this.variable?this.variable.getId():null}getText(){return this.variable?this.variable.name:""}getVariable(){return this.variable}getValidator(){return this.variable?this.validator_:null}doClassValidation_(t){if(t===null)return null;var i=this.getSourceBlock();if(!i)throw new ye;return i=s.getVariable$$module$build$src$core$variables(i.workspace,t),i?(i=i.type,this.typeIsAllowed(i)?t:(console.warn("Variable type doesn't match this field!  Type was "+i),null)):(console.warn("Variable id doesn't point to a real variable! ID was "+t),null)}doValueUpdate_(t){const i=this.getSourceBlock();if(!i)throw new ye;this.variable=s.getVariable$$module$build$src$core$variables(i.workspace,t),super.doValueUpdate_(t)}typeIsAllowed(t){const i=this.getVariableTypes();if(!i)return!0;for(let r=0;r<i.length;r++)if(t===i[r])return!0;return!1}getVariableTypes(){var t=this.variableTypes;if(t===null&&this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying())return this.sourceBlock_.workspace.getVariableTypes();if(t=t||[""],t.length===0)throw t=this.getText(),Error("'variableTypes' of field variable "+t+" was an empty list");return t}setTypes(t=null,i=""){if(Array.isArray(t)){let r=!1;for(let c=0;c<t.length;c++)t[c]===i&&(r=!0);if(!r)throw Error("Invalid default type '"+i+"' in the definition of a FieldVariable")}else if(t!==null)throw Error("'variableTypes' was not an array in the definition of a FieldVariable");this.defaultType=i,this.variableTypes=t}refreshVariableName(){this.forceRerender()}onItemSelected_(t,i){if(t=i.getValue(),this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying()){if(t===Vm){s.renameVariable$$module$build$src$core$variables(this.sourceBlock_.workspace,this.variable);return}if(t===Gm){this.sourceBlock_.workspace.deleteVariableById(this.variable.getId());return}}this.setValue(t)}referencesVariables(){return!0}static fromJson(t){return new this(Fe(t.variable),void 0,void 0,void 0,t)}static dropdownCreate(){if(!this.variable)throw Error("Tried to call dropdownCreate on a variable field with no variable selected.");const t=this.getText();let i=[];if(this.sourceBlock_&&!this.sourceBlock_.isDeadOrDying())for(var r=this.getVariableTypes(),c=0;c<r.length;c++){const u=this.sourceBlock_.workspace.getVariablesOfType(r[c]);i=i.concat(u)}for(i.sort(Qc.compareByName),r=[],c=0;c<i.length;c++)r[c]=[i[c].name,i[c].getId()];return r.push([s.Msg$$module$build$src$core$msg.RENAME_VARIABLE,Vm]),s.Msg$$module$build$src$core$msg.DELETE_VARIABLE&&r.push([s.Msg$$module$build$src$core$msg.DELETE_VARIABLE.replace("%1",t),Gm]),r}};zi("field_variable",ya);var ws=class{constructor(t,i,r,c){this.workspace=t,this.targetWorkspace=i,this.isLabel_=c,this.onMouseUpWrapper=null,this.height=this.width=0,this.svgText=this.svgGroup=null,this.text=r.text,this.position=new pt(0,0),this.callbackKey=r.callbackKey||r.callbackkey,this.cssClass=r["web-class"]||null,this.info=r}createDom(){var t=this.isLabel_?"blocklyFlyoutLabel":"blocklyFlyoutButton";this.cssClass&&(t+=" "+this.cssClass),this.svgGroup=R(D.G,{class:t},this.workspace.getCanvas());let i;this.isLabel_||(i=R(D.RECT,{class:"blocklyFlyoutButtonShadow",rx:ws.BORDER_RADIUS,ry:ws.BORDER_RADIUS,x:1,y:1},this.svgGroup)),t=R(D.RECT,{class:this.isLabel_?"blocklyFlyoutLabelBackground":"blocklyFlyoutButtonBackground",rx:ws.BORDER_RADIUS,ry:ws.BORDER_RADIUS},this.svgGroup);const r=R(D.TEXT,{class:this.isLabel_?"blocklyFlyoutLabelText":"blocklyText",x:0,y:0,"text-anchor":"middle"},this.svgGroup);var c=Fe(this.text);this.workspace.RTL&&(c+=""),r.textContent=c,this.isLabel_&&(this.svgText=r,this.workspace.getThemeManager().subscribe(this.svgText,"flyoutForegroundColour","fill"));const u=Gi(r,"fontSize"),f=Gi(r,"fontWeight"),E=Gi(r,"fontFamily");if(this.width=Pt(r,u,f,E),c=te(c,u,f,E),this.height=c.height,!this.isLabel_){this.width+=2*ws.TEXT_MARGIN_X,this.height+=2*ws.TEXT_MARGIN_Y;let S;(S=i)==null||S.setAttribute("width",String(this.width));let W;(W=i)==null||W.setAttribute("height",String(this.height))}return t.setAttribute("width",String(this.width)),t.setAttribute("height",String(this.height)),r.setAttribute("x",String(this.width/2)),r.setAttribute("y",String(this.height/2-c.height/2+c.baseline)),this.updateTransform(),this.onMouseUpWrapper=yt(this.svgGroup,"pointerup",this,this.onMouseUp),this.svgGroup}show(){this.updateTransform(),this.svgGroup.setAttribute("display","block")}updateTransform(){this.svgGroup.setAttribute("transform","translate("+this.position.x+","+this.position.y+")")}moveTo(t,i){this.position.x=t,this.position.y=i,this.updateTransform()}isLabel(){return this.isLabel_}getPosition(){return this.position}getButtonText(){return this.text}getTargetWorkspace(){return this.targetWorkspace}dispose(){this.onMouseUpWrapper&&N(this.onMouseUpWrapper),this.svgGroup&&Ct(this.svgGroup),this.svgText&&this.workspace.getThemeManager().unsubscribe(this.svgText)}onMouseUp(t){(t=this.targetWorkspace.getGesture(t))&&t.cancel(),this.isLabel_&&this.callbackKey?console.warn("Labels should not have callbacks. Label text: "+this.text):this.isLabel_||this.callbackKey&&this.targetWorkspace.getButtonCallback(this.callbackKey)?this.isLabel_||(t=this.targetWorkspace.getButtonCallback(this.callbackKey))&&t(this):console.warn("Buttons should have callbacks. Button text: "+this.text)}};ws.TEXT_MARGIN_X=5,ws.TEXT_MARGIN_Y=2,ws.BORDER_RADIUS=4,et(`
.blocklyFlyoutButton {
  fill: #888;
  cursor: default;
}

.blocklyFlyoutButtonShadow {
  fill: #666;
}

.blocklyFlyoutButton:hover {
  fill: #aaa;
}

.blocklyFlyoutLabel {
  cursor: default;
}

.blocklyFlyoutLabelBackground {
  opacity: 0;
}
`);var oS=class extends E${constructor(t,i){super(t),this.flyout_=i}getBoundingBox_(){let t;try{t=this.workspace_.getCanvas().getBBox()}catch{t={height:0,y:0,width:0,x:0}}return t}getContentMetrics(t){const i=this.getBoundingBox_();return t=t?1:this.workspace_.scale,{height:i.height*t,width:i.width*t,top:i.y*t,left:i.x*t}}getScrollMetrics(t,i,r){return i=r||this.getContentMetrics(),r=this.flyout_.MARGIN*this.workspace_.scale,t=t?this.workspace_.scale:1,{height:(i.height+2*r)/t,width:(i.width+i.left+r)/t,top:0,left:0}}},Gl;(function(t){t.BLOCK="block",t.BUTTON="button"})(Gl||(Gl={}));var pd=class extends rd{constructor(t){super(),this.horizontalLayout=!1,this.boundEvents=[],this.filterWrapper=this.reflowWrapper=null,this.mats=[],this.buttons_=[],this.listeners=[],this.permanentlyDisabled=[],this.recycledBlocks=[],this.autoClose=!0,this.isVisible_=!1,this.containerVisible=!0,this.CORNER_RADIUS=8,this.SCROLLBAR_MARGIN=2.5,this.height_=this.width_=0,this.dragAngleRange_=70,this.svgGroup_=this.svgBackground_=null,t.setMetrics=this.setMetrics_.bind(this),this.workspace_=new Ss(t),this.workspace_.setMetricsManager(new oS(this.workspace_,this)),this.workspace_.internalIsFlyout=!0,this.workspace_.setVisible(this.isVisible_),this.id=ct(),this.RTL=!!t.RTL,this.toolboxPosition_=t.toolboxPosition,this.tabWidth_=this.workspace_.getRenderer().getConstants().TAB_WIDTH,this.rectMap_=new WeakMap,this.MARGIN=this.CORNER_RADIUS,this.GAP_X=3*this.MARGIN,this.GAP_Y=3*this.MARGIN}createDom(t){return this.svgGroup_=R(t,{class:"blocklyFlyout"}),this.svgGroup_.style.display="none",this.svgBackground_=R(D.PATH,{class:"blocklyFlyoutBackground"},this.svgGroup_),this.svgGroup_.appendChild(this.workspace_.createDom()),this.workspace_.getThemeManager().subscribe(this.svgBackground_,"flyoutBackgroundColour","fill"),this.workspace_.getThemeManager().subscribe(this.svgBackground_,"flyoutOpacity","fill-opacity"),this.svgGroup_}init(t){this.targetWorkspace=t,this.workspace_.targetWorkspace=t,this.workspace_.scrollbar=new b$(this.workspace_,this.horizontalLayout,!this.horizontalLayout,"blocklyFlyoutScrollbar",this.SCROLLBAR_MARGIN),this.hide(),this.boundEvents.push(yt(this.svgGroup_,"wheel",this,this.wheel_)),this.filterWrapper=this.filterForCapacity.bind(this),this.targetWorkspace.addChangeListener(this.filterWrapper),this.boundEvents.push(yt(this.svgBackground_,"pointerdown",this,this.onMouseDown)),this.workspace_.getGesture=this.targetWorkspace.getGesture.bind(this.targetWorkspace),this.workspace_.setVariableMap(this.targetWorkspace.getVariableMap()),this.workspace_.createPotentialVariableMap(),t.getComponentManager().addComponent({component:this,weight:1,capabilities:[je.Capability.AUTOHIDEABLE,je.Capability.DELETE_AREA,je.Capability.DRAG_TARGET]})}dispose(){this.hide(),this.targetWorkspace.getComponentManager().removeComponent(this.id);for(const t of this.boundEvents)N(t);this.boundEvents.length=0,this.filterWrapper&&this.targetWorkspace.removeChangeListener(this.filterWrapper),this.workspace_&&(this.workspace_.getThemeManager().unsubscribe(this.svgBackground_),this.workspace_.dispose()),this.svgGroup_&&Ct(this.svgGroup_)}getWidth(){return this.width_}getHeight(){return this.height_}getFlyoutScale(){return this.targetWorkspace.scale}getWorkspace(){return this.workspace_}setAutoClose(t){this.autoClose=t,this.targetWorkspace.recordDragTargets(),this.targetWorkspace.resizeContents()}autoHide(t){!t&&this.targetWorkspace.getFlyout(!0)===this&&this.autoClose&&this.hide()}isVisible(){return this.isVisible_}setVisible(t){const i=t!==this.isVisible();this.isVisible_=t,i&&(this.autoClose||this.targetWorkspace.recordDragTargets(),this.updateDisplay())}setContainerVisible(t){const i=t!==this.containerVisible;this.containerVisible=t,i&&this.updateDisplay()}updateDisplay(){let t;t=this.containerVisible?this.isVisible():!1,this.svgGroup_&&(this.svgGroup_.style.display=t?"block":"none");let i;(i=this.workspace_.scrollbar)==null||i.setContainerVisible(t)}positionAt_(t,i,r,c){let u;(u=this.svgGroup_)==null||u.setAttribute("width",`${t}`);let f;(f=this.svgGroup_)==null||f.setAttribute("height",`${i}`),this.workspace_.setCachedParentSvgSize(t,i),this.svgGroup_&&_(this.svgGroup_,"translate("+r+"px,"+c+"px)"),(t=this.workspace_.scrollbar)&&(t.setOrigin(r,c),t.resize(),t.hScroll&&t.hScroll.setPosition(t.hScroll.position.x,t.hScroll.position.y),t.vScroll&&t.vScroll.setPosition(t.vScroll.position.x,t.vScroll.position.y))}hide(){if(this.isVisible()){this.setVisible(!1);for(const t of this.listeners)N(t);this.listeners.length=0,this.reflowWrapper&&(this.workspace_.removeChangeListener(this.reflowWrapper),this.reflowWrapper=null)}}show(t){this.workspace_.setResizesEnabled(!1),this.hide(),this.clearOldBlocks(),typeof t=="string"&&(t=this.getDynamicCategoryContents(t)),this.setVisible(!0),t=Ps(t),t=this.createFlyoutInfo(t),Bs(this.workspace_),this.layout_(t.contents,t.gaps),this.horizontalLayout?this.height_=0:this.width_=0,this.workspace_.setResizesEnabled(!0),this.reflow(),this.filterForCapacity(),this.position(),this.reflowWrapper=this.reflow.bind(this),this.workspace_.addChangeListener(this.reflowWrapper),this.emptyRecycledBlocks()}createFlyoutInfo(t){const i=[],r=[];this.permanentlyDisabled.length=0;const c=this.horizontalLayout?this.GAP_X:this.GAP_Y;for(const u of t){if("custom"in u){t=this.getDynamicCategoryContents(u.custom),t=Ps(t);const{contents:f,gaps:E}=this.createFlyoutInfo(t);i.push(...f),r.push(...E)}switch(u.kind.toUpperCase()){case"BLOCK":t=u;const f=this.createFlyoutBlock(t);i.push({type:Gl.BLOCK,block:f}),this.addBlockGap(t,r,c);break;case"SEP":this.addSeparatorGap(u,r,c);break;case"LABEL":t=this.createButton(u,!0),i.push({type:Gl.BUTTON,button:t}),r.push(c);break;case"BUTTON":t=this.createButton(u,!1),i.push({type:Gl.BUTTON,button:t}),r.push(c)}}return{contents:i,gaps:r}}getDynamicCategoryContents(t){if(t=this.workspace_.targetWorkspace.getToolboxCategoryCallback(t),typeof t!="function")throw TypeError("Couldn't find a callback function when opening a toolbox category.");return t(this.workspace_.targetWorkspace)}createButton(t,i){return new ws(this.workspace_,this.targetWorkspace,t,i)}createFlyoutBlock(t){let i;return t.blockxml?(t=typeof t.blockxml=="string"?s.textToDom$$module$build$src$core$utils$xml(t.blockxml):t.blockxml,(i=this.getRecycledBlock(t.getAttribute("type")))||(i=nn(t,this.workspace_))):(i=this.getRecycledBlock(t.type),i||(t.enabled===void 0&&(t.enabled=t.disabled!=="true"&&t.disabled!==!0),i=Qr(t,this.workspace_))),i.isEnabled()||this.permanentlyDisabled.push(i),i}getRecycledBlock(t){let i=-1;for(let r=0;r<this.recycledBlocks.length;r++)if(this.recycledBlocks[r].type===t){i=r;break}return i===-1?void 0:this.recycledBlocks.splice(i,1)[0]}addBlockGap(t,i,r){let c;t.gap?c=parseInt(String(t.gap)):t.blockxml&&(t=typeof t.blockxml=="string"?s.textToDom$$module$build$src$core$utils$xml(t.blockxml):t.blockxml,c=parseInt(t.getAttribute("gap"))),i.push(!c||isNaN(c)?r:c)}addSeparatorGap(t,i,r){t=parseInt(String(t.gap)),!isNaN(t)&&0<i.length?i[i.length-1]=t:i.push(r)}clearOldBlocks(){var t=this.workspace_.getTopBlocks(!1);for(let r=0,c;c=t[r];r++)this.blockIsRecyclable_(c)?this.recycleBlock(c):c.dispose(!1,!1);for(t=0;t<this.mats.length;t++){const r=this.mats[t];r&&(uu(r),Ct(r))}this.mats.length=0;for(let r=0,c;c=this.buttons_[r];r++)c.dispose();this.buttons_.length=0;let i;(i=this.workspace_.getPotentialVariableMap())==null||i.clear()}emptyRecycledBlocks(){for(let t=0;t<this.recycledBlocks.length;t++)this.recycledBlocks[t].dispose();this.recycledBlocks=[]}blockIsRecyclable_(t){return!1}recycleBlock(t){const i=t.getRelativeToSurfaceXY();t.moveBy(-i.x,-i.y),this.recycledBlocks.push(t)}addBlockListeners_(t,i,r){this.listeners.push(yt(t,"pointerdown",null,this.blockMouseDown(i))),this.listeners.push(yt(r,"pointerdown",null,this.blockMouseDown(i))),this.listeners.push(w(t,"pointerenter",i,i.addSelect)),this.listeners.push(w(t,"pointerleave",i,i.removeSelect)),this.listeners.push(w(r,"pointerenter",i,i.addSelect)),this.listeners.push(w(r,"pointerleave",i,i.removeSelect))}blockMouseDown(t){return i=>{const r=this.targetWorkspace.getGesture(i);r&&(r.setStartBlock(t),r.handleFlyoutStart(i,this))}}onMouseDown(t){const i=this.targetWorkspace.getGesture(t);i&&i.handleFlyoutStart(t,this)}isBlockCreatable(t){return t.isEnabled()}createBlock(t){let i=null;s.disable$$module$build$src$core$events$utils();var r=this.targetWorkspace.getAllVariables();this.targetWorkspace.setResizesEnabled(!1);try{i=this.placeNewBlock(t)}finally{s.enable$$module$build$src$core$events$utils()}if(this.targetWorkspace.hideChaff(),t=Qh(this.targetWorkspace,r),Lt()){for(s.setGroup$$module$build$src$core$events$utils(!0),r=0;r<t.length;r++){const c=t[r];it(new(ut(dn))(c))}it(new(ut(s.CREATE$$module$build$src$core$events$utils))(i))}return this.autoClose?this.hide():this.filterForCapacity(),i}initFlyoutButton_(t,i,r){const c=t.createDom();t.moveTo(i,r),t.show(),this.listeners.push(yt(c,"pointerdown",this,this.onMouseDown)),this.buttons_.push(t)}createRect_(t,i,r,c,u){return i=R(D.RECT,{"fill-opacity":0,x:i,y:r,height:c.height,width:c.width}),i.tooltip=t,ll(i),this.workspace_.getCanvas().insertBefore(i,t.getSvgRoot()),this.rectMap_.set(t,i),this.mats[u]=i}moveRectToBlock_(t,i){const r=i.getHeightWidth();t.setAttribute("width",String(r.width)),t.setAttribute("height",String(r.height)),i=i.getRelativeToSurfaceXY(),t.setAttribute("y",String(i.y)),t.setAttribute("x",String(this.RTL?i.x-r.width:i.x))}filterForCapacity(){const t=this.workspace_.getTopBlocks(!1);for(let i=0,r;r=t[i];i++)if(this.permanentlyDisabled.indexOf(r)===-1){const c=this.targetWorkspace.isCapacityAvailable(H(r));for(;r;)r.setEnabled(c),r=r.getNextBlock()}}reflow(){this.reflowWrapper&&this.workspace_.removeChangeListener(this.reflowWrapper),this.reflowInternal_(),this.reflowWrapper&&this.workspace_.addChangeListener(this.reflowWrapper)}isScrollable(){return this.workspace_.scrollbar?this.workspace_.scrollbar.isVisible():!1}placeNewBlock(t){var i=this.targetWorkspace;if(!t.getSvgRoot())throw Error("oldBlock is not rendered");const r=Us(t);return i.setResizesEnabled(!1),i=rn(r,i),this.positionNewBlock(t,i),i}positionNewBlock(t,i){const r=this.targetWorkspace;var c=r.getOriginOffsetInPixels(),u=this.workspace_.getOriginOffsetInPixels();t=t.getRelativeToSurfaceXY(),t.scale(this.workspace_.scale),u=pt.sum(u,t),c=pt.difference(u,c),c.scale(1/r.scale),i.moveTo(new pt(c.x,c.y))}};pd.FlyoutItemType=Gl;var nS=class extends pd{constructor(t){super(t),this.horizontalLayout=!0}setMetrics_(t){if(this.isVisible()){var i=this.workspace_.getMetricsManager(),r=i.getScrollMetrics(),c=i.getViewMetrics();i=i.getAbsoluteMetrics(),typeof t.x=="number"&&(this.workspace_.scrollX=-(r.left+(r.width-c.width)*t.x)),this.workspace_.translate(this.workspace_.scrollX+i.left,this.workspace_.scrollY+i.top)}}getX(){return 0}getY(){if(!this.isVisible())return 0;var t=this.targetWorkspace.getMetricsManager();const i=t.getAbsoluteMetrics(),r=t.getViewMetrics();t=t.getToolboxMetrics();const c=this.toolboxPosition_===Wt.TOP;return this.targetWorkspace.toolboxPosition===this.toolboxPosition_?this.targetWorkspace.getToolbox()?c?t.height:r.height-this.height_:c?0:r.height:c?0:r.height+i.top-this.height_}position(){if(this.isVisible()&&this.targetWorkspace.isVisible()){var t=this.targetWorkspace.getMetricsManager().getViewMetrics();this.width_=t.width,this.setBackgroundPath(t.width-2*this.CORNER_RADIUS,this.height_-this.CORNER_RADIUS),t=this.getX();var i=this.getY();this.positionAt_(this.width_,this.height_,t,i)}}setBackgroundPath(t,i){const r=this.toolboxPosition_===Wt.TOP,c=["M 0,"+(r?0:this.CORNER_RADIUS)];r?(c.push("h",t+2*this.CORNER_RADIUS),c.push("v",i),c.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,this.CORNER_RADIUS),c.push("h",-t),c.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,-this.CORNER_RADIUS,-this.CORNER_RADIUS)):(c.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,-this.CORNER_RADIUS),c.push("h",t),c.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,1,this.CORNER_RADIUS,this.CORNER_RADIUS),c.push("v",i),c.push("h",-t-2*this.CORNER_RADIUS)),c.push("z"),this.svgBackground_.setAttribute("d",c.join(" "))}scrollToStart(){let t;(t=this.workspace_.scrollbar)==null||t.setX(this.RTL?1/0:0)}wheel_(t){var i=st(t);if(i=i.x||i.y){const r=this.workspace_.getMetricsManager(),c=r.getScrollMetrics();i=r.getViewMetrics().left-c.left+i;let u;(u=this.workspace_.scrollbar)==null||u.setX(i),cs(),Es()}t.preventDefault(),t.stopPropagation()}layout_(t,i){this.workspace_.scale=this.targetWorkspace.scale;const r=this.MARGIN;let c=r+this.tabWidth_;this.RTL&&(t=t.reverse());for(let S=0,W;W=t[S];S++)if(W.type==="block"){var u=W.block,f=u.getDescendants(!1);for(let ke=0,Ie;Ie=f[ke];ke++)Ie.isInFlyout=!0;f=u.getSvgRoot();const bt=u.getHeightWidth();var E=u.outputConnection?this.tabWidth_:0;E=this.RTL?c+bt.width:c-E,u.moveBy(E,r),E=this.createRect_(u,E,r,bt,S),c+=bt.width+i[S],this.addBlockListeners_(f,u,E)}else W.type==="button"&&(u=W.button,this.initFlyoutButton_(u,c,r),c+=u.width+i[S])}isDragTowardWorkspace(t){t=Math.atan2(t.y,t.x)/Math.PI*180;const i=this.dragAngleRange_;return t<90+i&&t>90-i||t>-90-i&&t<-90+i}getClientRect(){if(!this.svgGroup_||this.autoClose||!this.isVisible())return null;const t=this.svgGroup_.getBoundingClientRect(),i=t.top;return this.toolboxPosition_===Wt.TOP?new ve(-1e9,i+t.height,-1e9,1e9):new ve(i,1e9,-1e9,1e9)}reflowInternal_(){this.workspace_.scale=this.getFlyoutScale();let t=0;const i=this.workspace_.getTopBlocks(!1);for(let c=0,u;u=i[c];c++)t=Math.max(t,u.getHeightWidth().height);const r=this.buttons_;for(let c=0,u;u=r[c];c++)t=Math.max(t,u.height);if(t+=1.5*this.MARGIN,t*=this.workspace_.scale,t+=Ge.scrollbarThickness,this.height_!==t){for(let c=0,u;u=i[c];c++)this.rectMap_.has(u)&&this.moveRectToBlock_(this.rectMap_.get(u),u);this.targetWorkspace.scrollbar||this.autoClose||this.targetWorkspace.getFlyout()!==this||this.toolboxPosition_!==Wt.TOP||this.targetWorkspace.translate(this.targetWorkspace.scrollX,this.targetWorkspace.scrollY+t),this.height_=t,this.position(),this.targetWorkspace.resizeContents(),this.targetWorkspace.recordDragTargets()}}};o(rt.FLYOUTS_HORIZONTAL_TOOLBOX,Co,nS);var M$=class extends pd{constructor(t){super(t)}setMetrics_(t){if(this.isVisible()){var i=this.workspace_.getMetricsManager(),r=i.getScrollMetrics(),c=i.getViewMetrics();i=i.getAbsoluteMetrics(),typeof t.y=="number"&&(this.workspace_.scrollY=-(r.top+(r.height-c.height)*t.y)),this.workspace_.translate(this.workspace_.scrollX+i.left,this.workspace_.scrollY+i.top)}}getX(){if(!this.isVisible())return 0;var t=this.targetWorkspace.getMetricsManager();const i=t.getAbsoluteMetrics(),r=t.getViewMetrics();return t=t.getToolboxMetrics(),this.targetWorkspace.toolboxPosition===this.toolboxPosition_?this.targetWorkspace.getToolbox()?this.toolboxPosition_===Wt.LEFT?t.width:r.width-this.width_:this.toolboxPosition_===Wt.LEFT?0:r.width:this.toolboxPosition_===Wt.LEFT?0:r.width+i.left-this.width_}getY(){return 0}position(){if(this.isVisible()&&this.targetWorkspace.isVisible()){var t=this.targetWorkspace.getMetricsManager().getViewMetrics();this.height_=t.height,this.setBackgroundPath(this.width_-this.CORNER_RADIUS,t.height-2*this.CORNER_RADIUS),t=this.getX();var i=this.getY();this.positionAt_(this.width_,this.height_,t,i)}}setBackgroundPath(t,i){const r=this.toolboxPosition_===Wt.RIGHT;var c=t+this.CORNER_RADIUS;c=["M "+(r?c:0)+",0"],c.push("h",r?-t:t),c.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,r?0:1,r?-this.CORNER_RADIUS:this.CORNER_RADIUS,this.CORNER_RADIUS),c.push("v",Math.max(0,i)),c.push("a",this.CORNER_RADIUS,this.CORNER_RADIUS,0,0,r?0:1,r?this.CORNER_RADIUS:-this.CORNER_RADIUS,this.CORNER_RADIUS),c.push("h",r?t:-t),c.push("z"),this.svgBackground_.setAttribute("d",c.join(" "))}scrollToStart(){let t;(t=this.workspace_.scrollbar)==null||t.setY(0)}wheel_(t){var i=st(t);if(i.y){const r=this.workspace_.getMetricsManager(),c=r.getScrollMetrics();i=r.getViewMetrics().top-c.top+i.y;let u;(u=this.workspace_.scrollbar)==null||u.setY(i),cs(),Es()}t.preventDefault(),t.stopPropagation()}layout_(t,i){this.workspace_.scale=this.targetWorkspace.scale;var r=this.MARGIN;const c=this.RTL?r:r+this.tabWidth_;for(let S=0,W;W=t[S];S++)if(W.type==="block"){var u=W.block,f=u.getDescendants(!1);for(let ke=0,Ie;Ie=f[ke];ke++)Ie.isInFlyout=!0;f=u.getSvgRoot();const bt=u.getHeightWidth();var E=u.outputConnection?c-this.tabWidth_:c;u.moveBy(E,r),E=this.createRect_(u,this.RTL?E-bt.width:E,r,bt,S),this.addBlockListeners_(f,u,E),r+=bt.height+i[S]}else W.type==="button"&&(u=W.button,this.initFlyoutButton_(u,c,r),r+=u.height+i[S])}isDragTowardWorkspace(t){t=Math.atan2(t.y,t.x)/Math.PI*180;const i=this.dragAngleRange_;return t<i&&t>-i||t<-180+i||t>180-i}getClientRect(){if(!this.svgGroup_||this.autoClose||!this.isVisible())return null;const t=this.svgGroup_.getBoundingClientRect(),i=t.left;return this.toolboxPosition_===Wt.LEFT?new ve(-1e9,1e9,-1e9,i+t.width):new ve(-1e9,1e9,i,1e9)}reflowInternal_(){this.workspace_.scale=this.getFlyoutScale();let t=0;var i=this.workspace_.getTopBlocks(!1);for(let c=0,u;u=i[c];c++){var r=u.getHeightWidth().width;u.outputConnection&&(r-=this.tabWidth_),t=Math.max(t,r)}for(let c=0,u;u=this.buttons_[c];c++)t=Math.max(t,u.width);if(t+=1.5*this.MARGIN+this.tabWidth_,t*=this.workspace_.scale,t+=Ge.scrollbarThickness,this.width_!==t){for(let c=0,u;u=i[c];c++){if(this.RTL){r=u.getRelativeToSurfaceXY().x;let f=t/this.workspace_.scale-this.MARGIN;u.outputConnection||(f-=this.tabWidth_),u.moveBy(f-r,0)}this.rectMap_.has(u)&&this.moveRectToBlock_(this.rectMap_.get(u),u)}if(this.RTL)for(let c=0,u;u=this.buttons_[c];c++)i=u.getPosition().y,u.moveTo(t/this.workspace_.scale-u.width-this.MARGIN-this.tabWidth_,i);this.targetWorkspace.scrollbar||this.autoClose||this.targetWorkspace.getFlyout()!==this||this.toolboxPosition_!==Wt.LEFT||this.targetWorkspace.translate(this.targetWorkspace.scrollX+t,this.targetWorkspace.scrollY),this.width_=t,this.position(),this.targetWorkspace.resizeContents(),this.targetWorkspace.recordDragTargets()}}};M$.registryName="verticalFlyout",o(rt.FLYOUTS_VERTICAL_TOOLBOX,Co,M$);var rS;s.CodeGenerator$$module$build$src$core$generator=class{constructor(t){this.forBlock=Object.create(null),this.FUNCTION_NAME_PLACEHOLDER_="{leCUI8hutHZI4480Dc}",this.STATEMENT_SUFFIX=this.STATEMENT_PREFIX=this.INFINITE_LOOP_TRAP=null,this.INDENT="  ",this.COMMENT_WRAP=60,this.ORDER_OVERRIDES=[],this.isInitialized=null,this.RESERVED_WORDS_="",this.definitions_=Object.create(null),this.functionNames_=Object.create(null),this.nameDB_=void 0,this.name_=t,this.FUNCTION_NAME_PLACEHOLDER_REGEXP_=new RegExp(this.FUNCTION_NAME_PLACEHOLDER_,"g")}workspaceToCode(t){t||(console.warn("No workspace specified in workspaceToCode call.  Guessing."),t=A());var i=[];this.init(t),t=t.getTopBlocks(!0);for(let r=0,c;c=t[r];r++){let u=this.blockToCode(c);Array.isArray(u)&&(u=u[0]),u&&(c.outputConnection&&(u=this.scrubNakedValue(u),this.STATEMENT_PREFIX&&!c.suppressPrefixSuffix&&(u=this.injectId(this.STATEMENT_PREFIX,c)+u),this.STATEMENT_SUFFIX&&!c.suppressPrefixSuffix&&(u+=this.injectId(this.STATEMENT_SUFFIX,c))),i.push(u))}return i=i.join(`
`),i=this.finish(i),i=i.replace(/^\s+\n/,""),i=i.replace(/\n\s+$/,`
`),i=i.replace(/[ \t]+\n/g,`
`)}prefixLines(t,i){return i+t.replace(/(?!\n$)\n/g,`
`+i)}allNestedComments(t){const i=[];t=t.getDescendants(!0);for(let r=0;r<t.length;r++){const c=t[r].getCommentText();c&&i.push(c)}return i.length&&i.push(""),i.join(`
`)}blockToCode(t,i){if(this.isInitialized===!1&&console.warn("CodeGenerator init was not called before blockToCode was called."),!t)return"";if(!t.isEnabled())return i?"":this.blockToCode(t.getNextBlock());if(t.isInsertionMarker())return i?"":this.blockToCode(t.getChildren(!1)[0]);var r=this.forBlock[t.type];if(!r&&this[t.type]&&(j("block generator functions on CodeGenerator objects","10.0","11.0","the .forBlock[blockType] dictionary"),r=this[t.type]),typeof r!="function")throw Error(`${this.name_} generator does not know how to generate code for block type "${t.type}".`);if(r=r.call(t,t,this),Array.isArray(r)){if(!t.outputConnection)throw TypeError("Expecting string from statement block: "+t.type);return[this.scrub_(t,r[0],i),r[1]]}if(typeof r=="string")return this.STATEMENT_PREFIX&&!t.suppressPrefixSuffix&&(r=this.injectId(this.STATEMENT_PREFIX,t)+r),this.STATEMENT_SUFFIX&&!t.suppressPrefixSuffix&&(r+=this.injectId(this.STATEMENT_SUFFIX,t)),this.scrub_(t,r,i);if(r===null)return"";throw SyntaxError("Invalid code generated: "+r)}valueToCode(t,i,r){if(isNaN(r))throw TypeError("Expecting valid order from block: "+t.type);var c=t.getInputTargetBlock(i);if(!c||(i=this.blockToCode(c),i===""))return"";if(!Array.isArray(i))throw TypeError(`Expecting tuple from value block: ${c.type} See developers.google.com/blockly/guides/create-custom-blocks/generating-code for more information`);if(t=i[0],i=i[1],isNaN(i))throw TypeError("Expecting valid order from value block: "+c.type);if(!t)return"";c=!1;var u=Math.floor(r);const f=Math.floor(i);if(u<=f&&(u!==f||u!==0&&u!==99)){for(c=!0,u=0;u<this.ORDER_OVERRIDES.length;u++)if(this.ORDER_OVERRIDES[u][0]===r&&this.ORDER_OVERRIDES[u][1]===i){c=!1;break}}return c&&(t="("+t+")"),t}statementToCode(t,i){if(t=t.getInputTargetBlock(i),i=this.blockToCode(t),typeof i!="string")throw TypeError("Expecting code from statement block: "+(t&&t.type));return i&&(i=this.prefixLines(i,this.INDENT)),i}addLoopTrap(t,i){return this.INFINITE_LOOP_TRAP&&(t=this.prefixLines(this.injectId(this.INFINITE_LOOP_TRAP,i),this.INDENT)+t),this.STATEMENT_SUFFIX&&!i.suppressPrefixSuffix&&(t=this.prefixLines(this.injectId(this.STATEMENT_SUFFIX,i),this.INDENT)+t),this.STATEMENT_PREFIX&&!i.suppressPrefixSuffix&&(t+=this.prefixLines(this.injectId(this.STATEMENT_PREFIX,i),this.INDENT)),t}injectId(t,i){return i=i.id.replace(/\$/g,"$$$$"),t.replace(/%1/g,"'"+i+"'")}addReservedWords(t){this.RESERVED_WORDS_+=t+","}provideFunction_(t,i){if(!this.definitions_[t]){const r=this.nameDB_.getDistinctName(t,s.NameType$$module$build$src$core$names.PROCEDURE);this.functionNames_[t]=r,Array.isArray(i)&&(i=i.join(`
`)),i=i.trim().replace(this.FUNCTION_NAME_PLACEHOLDER_REGEXP_,r);let c;for(;c!==i;)c=i,i=i.replace(/^(( {2})*) {2}/gm,"$1\0");i=i.replace(/\0/g,this.INDENT),this.definitions_[t]=i}return this.functionNames_[t]}getVariableName(t){return this.getName(t,s.NameType$$module$build$src$core$names.VARIABLE)}getProcedureName(t){return this.getName(t,s.NameType$$module$build$src$core$names.PROCEDURE)}getName(t,i){if(!this.nameDB_)throw Error("Name database is not defined. You must initialize `nameDB_` in your generator class and call `init` first.");return this.nameDB_.getName(t,i)}init(t){this.definitions_=Object.create(null),this.functionNames_=Object.create(null)}scrub_(t,i,r){return i}finish(t){return this.definitions_=Object.create(null),this.functionNames_=Object.create(null),t}scrubNakedValue(t){return t}},rS={},rS.CodeGenerator=s.CodeGenerator$$module$build$src$core$generator;var lS=!1,vn={};vn.Align=s.Align$$module$build$src$core$inputs$align,vn.DummyInput=Qs,vn.EndRowInput=Po,vn.Input=Zs,vn.StatementInput=Ji,vn.ValueInput=s.ValueInput$$module$build$src$core$inputs$value_input,vn.inputTypes=s.inputTypes$$module$build$src$core$inputs$input_types;var cS=class extends ga{constructor(){super(),this.FIELD_TEXT_BASELINE_CENTER=!1,this.DARK_PATH_OFFSET=1,this.MAX_BOTTOM_WIDTH=30,this.STATEMENT_BOTTOM_SPACER=-this.NOTCH_HEIGHT/2}getCSS_(t){return super.getCSS_(t).concat([`${t} .blocklyInsertionMarker>.blocklyPathLight,`,`${t} .blocklyInsertionMarker>.blocklyPathDark {`,`fill-opacity: ${this.INSERTION_MARKER_OPACITY};`,"stroke: none;","}"])}},aS=class{constructor(t){this.inlineSteps_=this.steps_="",this.info_=t,this.RTL_=this.info_.RTL,t=t.getRenderer(),this.constants_=t.getConstants(),this.highlightConstants_=t.getHighlightConstants(),this.highlightOffset=this.highlightConstants_.OFFSET,this.outsideCornerPaths_=this.highlightConstants_.OUTSIDE_CORNER,this.insideCornerPaths_=this.highlightConstants_.INSIDE_CORNER,this.puzzleTabPaths_=this.highlightConstants_.PUZZLE_TAB,this.notchPaths_=this.highlightConstants_.NOTCH,this.startPaths_=this.highlightConstants_.START_HAT,this.jaggedTeethPaths_=this.highlightConstants_.JAGGED_TEETH}getPath(){return this.steps_+`
`+this.inlineSteps_}drawTopCorner(t){this.steps_+=Ne(t.xPos,this.info_.startY);for(let i=0,r;r=t.elements[i];i++)x.isLeftSquareCorner(r)?this.steps_+=this.highlightConstants_.START_POINT:x.isLeftRoundedCorner(r)?this.steps_+=this.outsideCornerPaths_.topLeft(this.RTL_):x.isPreviousConnection(r)?this.steps_+=this.notchPaths_.pathLeft:x.isHat(r)?this.steps_+=this.startPaths_.path(this.RTL_):x.isSpacer(r)&&r.width!==0&&(this.steps_+=It("H",r.xPos+r.width-this.highlightOffset));this.steps_+=It("H",t.xPos+t.width-this.highlightOffset)}drawJaggedEdge_(t){this.info_.RTL&&(this.steps_+=this.jaggedTeethPaths_.pathLeft+It("v",t.height-this.jaggedTeethPaths_.height-this.highlightOffset))}drawValueInput(t){const i=t.getLastInput();if(this.RTL_){const r=t.height-i.connectionHeight;this.steps_+=ei(i.xPos+i.width-this.highlightOffset,t.yPos)+this.puzzleTabPaths_.pathDown(this.RTL_)+It("v",r)}else this.steps_+=ei(i.xPos+i.width,t.yPos)+this.puzzleTabPaths_.pathDown(this.RTL_)}drawStatementInput(t){const i=t.getLastInput();if(i)if(this.RTL_){const r=t.height-2*this.insideCornerPaths_.height;this.steps_+=ei(i.xPos,t.yPos)+this.insideCornerPaths_.pathTop(this.RTL_)+It("v",r)+this.insideCornerPaths_.pathBottom(this.RTL_)+Hs(t.width-i.xPos-this.insideCornerPaths_.width,0)}else this.steps_+=ei(i.xPos,t.yPos+t.height)+this.insideCornerPaths_.pathBottom(this.RTL_)+Hs(t.width-i.xPos-this.insideCornerPaths_.width,0)}drawRightSideRow(t){const i=t.xPos+t.width-this.highlightOffset;t instanceof n$&&t.followsStatement&&(this.steps_+=It("H",i)),this.RTL_&&(this.steps_+=It("H",i),t.height>this.highlightOffset&&(this.steps_+=It("V",t.yPos+t.height-this.highlightOffset)))}drawBottomRow(t){if(this.RTL_)this.steps_+=It("V",t.baseline-this.highlightOffset);else{const i=this.info_.bottomRow.elements[0];x.isLeftSquareCorner(i)?this.steps_+=ei(t.xPos+this.highlightOffset,t.baseline-this.highlightOffset):x.isLeftRoundedCorner(i)&&(this.steps_+=ei(t.xPos,t.baseline),this.steps_+=this.outsideCornerPaths_.bottomLeft())}}drawLeft(){var t=this.info_.outputConnection;t&&(t=t.connectionOffsetY+t.height,this.RTL_?this.steps_+=ei(this.info_.startX,t):(this.steps_+=ei(this.info_.startX+this.highlightOffset,this.info_.bottomRow.baseline-this.highlightOffset),this.steps_+=It("V",t)),this.steps_+=this.puzzleTabPaths_.pathUp(this.RTL_)),this.RTL_||(t=this.info_.topRow,x.isLeftRoundedCorner(t.elements[0])?this.steps_+=It("V",this.outsideCornerPaths_.height):this.steps_+=It("V",t.capline+this.highlightOffset))}drawInlineInput(t){const i=this.highlightOffset,r=t.xPos+t.connectionWidth;var c=t.centerline-t.height/2;const u=t.width-t.connectionWidth,f=c+i;this.RTL_?(c=t.connectionOffsetY-i,t=t.height-(t.connectionOffsetY+t.connectionHeight)+i,this.inlineSteps_+=ei(r-i,f)+It("v",c)+this.puzzleTabPaths_.pathDown(this.RTL_)+It("v",t)+It("h",u)):this.inlineSteps_+=ei(t.xPos+t.width+i,f)+It("v",t.height)+It("h",-u)+ei(r,c+t.connectionOffsetY)+this.puzzleTabPaths_.pathDown(this.RTL_)}},hS=class extends ma{constructor(t,i){super(t,i),this.highlighter_=new aS(i)}draw(){this.drawOutline_(),this.drawInternals_();const t=this.block_.pathObject;t.setPath(this.outlinePath_+`
`+this.inlinePath_),t.setHighlightPath(this.highlighter_.getPath()),this.info_.RTL&&t.flipRTL(),this.recordSizeOnBlock_()}drawTop_(){this.highlighter_.drawTopCorner(this.info_.topRow),this.highlighter_.drawRightSideRow(this.info_.topRow),super.drawTop_()}drawJaggedEdge_(t){this.highlighter_.drawJaggedEdge_(t),super.drawJaggedEdge_(t)}drawValueInput_(t){this.highlighter_.drawValueInput(t),super.drawValueInput_(t)}drawStatementInput_(t){this.highlighter_.drawStatementInput(t),super.drawStatementInput_(t)}drawRightSideRow_(t){this.highlighter_.drawRightSideRow(t),this.outlinePath_+=It("H",t.xPos+t.width)+It("V",t.yPos+t.height)}drawBottom_(){this.highlighter_.drawBottomRow(this.info_.bottomRow),super.drawBottom_()}drawLeft_(){this.highlighter_.drawLeft(),super.drawLeft_()}drawInlineInput_(t){this.highlighter_.drawInlineInput(t),super.drawInlineInput_(t)}positionInlineInputConnection_(t){const i=t.centerline-t.height/2;if(t.connectionModel){let r=t.xPos+t.connectionWidth+this.constants_.DARK_PATH_OFFSET;this.info_.RTL&&(r*=-1),t.connectionModel.setOffsetInBlock(r,i+t.connectionOffsetY+this.constants_.DARK_PATH_OFFSET)}}positionStatementInputConnection_(t){const i=t.getLastInput();if(i!=null&&i.connectionModel){let r=t.xPos+t.statementEdge+i.notchOffset;r=this.info_.RTL?-1*r:r+this.constants_.DARK_PATH_OFFSET,i.connectionModel.setOffsetInBlock(r,t.yPos+this.constants_.DARK_PATH_OFFSET)}}positionExternalValueConnection_(t){const i=t.getLastInput();if(i&&i.connectionModel){let r=t.xPos+t.width+this.constants_.DARK_PATH_OFFSET;this.info_.RTL&&(r*=-1),i.connectionModel.setOffsetInBlock(r,t.yPos)}}positionNextConnection_(){const t=this.info_.bottomRow;if(t.connection){const i=t.connection,r=i.xPos;i.connectionModel.setOffsetInBlock((this.info_.RTL?-r:r)+this.constants_.DARK_PATH_OFFSET/2,t.baseline+this.constants_.DARK_PATH_OFFSET)}}},uS=class{constructor(t){this.OFFSET=.5,this.constantProvider=t,this.START_POINT=Ne(this.OFFSET,this.OFFSET)}init(){this.INSIDE_CORNER=this.makeInsideCorner(),this.OUTSIDE_CORNER=this.makeOutsideCorner(),this.PUZZLE_TAB=this.makePuzzleTab(),this.NOTCH=this.makeNotch(),this.JAGGED_TEETH=this.makeJaggedTeeth(),this.START_HAT=this.makeStartHat()}makeInsideCorner(){const t=this.constantProvider.CORNER_RADIUS,i=this.OFFSET,r=(1-Math.SQRT1_2)*(t+i)-i,c=Ne(r,r)+Ve("a","0 0,0",t,Ot(-r-i,t-r)),u=Ve("a","0 0,0",t+i,Ot(t+i,t+i)),f=Ne(r,-r)+Ve("a","0 0,0",t+i,Ot(t-r,r+i));return{width:t+i,height:t,pathTop(E){return E?c:""},pathBottom(E){return E?u:f}}}makeOutsideCorner(){const t=this.constantProvider.CORNER_RADIUS,i=this.OFFSET,r=(1-Math.SQRT1_2)*(t-i)+i,c=Ne(r,r)+Ve("a","0 0,1",t-i,Ot(t-r,-r+i)),u=Ne(i,t)+Ve("a","0 0,1",t-i,Ot(t,-t+i)),f=-r,E=Ne(r,f)+Ve("a","0 0,1",t-i,Ot(-r+i,-f-t));return{height:t,topLeft(S){return S?c:u},bottomLeft(){return E}}}makePuzzleTab(){const t=this.constantProvider.TAB_WIDTH,i=this.constantProvider.TAB_HEIGHT,r=Ne(-2,-i+3.4)+Hs(-.45*t,-2.1),c=It("v",2.5)+Ne(.97*-t,2.5)+Li("q",[Ot(.05*-t,10),Ot(.3*t,9.5)])+Ne(.67*t,-1.9)+It("v",2.5),u=It("v",-1.5)+Ne(-.92*t,-.5)+Li("q",[Ot(-.19*t,-5.5),Ot(0,-11)])+Ne(.92*t,1),f=Ne(-5,i-.7)+Hs(.46*t,-2.1);return{width:t,height:i,pathUp(E){return E?r:u},pathDown(E){return E?c:f}}}makeNotch(){return{pathLeft:It("h",this.OFFSET)+this.constantProvider.NOTCH.pathLeft}}makeJaggedTeeth(){return{pathLeft:Hs(5.1,2.6)+Ne(-10.2,6.8)+Hs(5.1,2.6),height:12,width:10.2}}makeStartHat(){const t=this.constantProvider.START_HAT.height,i=Ne(25,-8.7)+Li("c",[Ot(29.7,-6.2),Ot(57.2,-.5),Ot(75,8.7)]),r=Li("c",[Ot(17.8,-9.2),Ot(45.3,-14.9),Ot(75,-8.7)])+ei(100.5,t+.5);return{path(c){return c?i:r}}}},dS=class extends s${constructor(t,i){super(t,i),this.constants_=t,this.connectedBlock&&(this.width+=this.constants_.DARK_PATH_OFFSET,this.height+=this.constants_.DARK_PATH_OFFSET)}},pS=class extends da{constructor(t,i){super(t,i),this.constants_=t,this.connectedBlock&&(this.height+=this.constants_.DARK_PATH_OFFSET)}},fS=class extends Dl{constructor(t,i){super(t,i),this.renderer_=t}getRenderer(){return this.renderer_}populateBottomRow_(){super.populateBottomRow_(),this.block_.inputList.length&&this.block_.inputList[this.block_.inputList.length-1]instanceof Ji||(this.bottomRow.minHeight=this.constants_.MEDIUM_PADDING-this.constants_.DARK_PATH_OFFSET)}addInput_(t,i){this.isInline&&t instanceof s.ValueInput$$module$build$src$core$inputs$value_input?(i.elements.push(new dS(this.constants_,t)),i.hasInlineInput=!0):t instanceof Ji?(i.elements.push(new pS(this.constants_,t)),i.hasStatement=!0):t instanceof s.ValueInput$$module$build$src$core$inputs$value_input?(i.elements.push(new sd(this.constants_,t)),i.hasExternalInput=!0):(t instanceof Qs||t instanceof Po)&&(i.minHeight=Math.max(i.minHeight,this.constants_.DUMMY_INPUT_MIN_HEIGHT),i.hasDummyInput=!0),this.isInline||i.align!==null||(i.align=t.align)}addElemSpacing_(){let t=!1;for(let r=0,c;c=this.rows[r];r++)c.hasExternalInput&&(t=!0);for(let r=0,c;c=this.rows[r];r++){var i=c.elements;if(c.elements=[],c.startsWithElemSpacer()&&c.elements.push(new ji(this.constants_,this.getInRowSpacing_(null,i[0]))),i.length){for(let u=0;u<i.length-1;u++){c.elements.push(i[u]);const f=this.getInRowSpacing_(i[u],i[u+1]);c.elements.push(new ji(this.constants_,f))}c.elements.push(i[i.length-1]),c.endsWithElemSpacer()&&(i=this.getInRowSpacing_(i[i.length-1],null),t&&c.hasDummyInput&&(i+=this.constants_.TAB_WIDTH),c.elements.push(new ji(this.constants_,i)))}}}getInRowSpacing_(t,i){if(!t)return i&&x.isField(i)&&i.isEditable?this.constants_.MEDIUM_PADDING:i&&x.isInlineInput(i)?this.constants_.MEDIUM_LARGE_PADDING:i&&x.isStatementInput(i)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:this.constants_.LARGE_PADDING;if(!x.isInput(t)&&(!i||x.isStatementInput(i)))return x.isField(t)&&t.isEditable?this.constants_.MEDIUM_PADDING:x.isIcon(t)?2*this.constants_.LARGE_PADDING+1:x.isHat(t)?this.constants_.NO_PADDING:x.isPreviousOrNextConnection(t)?this.constants_.LARGE_PADDING:x.isLeftRoundedCorner(t)?this.constants_.MIN_BLOCK_WIDTH:x.isJaggedEdge(t)?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING;if(x.isInput(t)&&!i){if(x.isExternalInput(t))return this.constants_.NO_PADDING;if(x.isInlineInput(t))return this.constants_.LARGE_PADDING;if(x.isStatementInput(t))return this.constants_.NO_PADDING}if(!x.isInput(t)&&i&&x.isInput(i)){if(x.isField(t)&&t.isEditable){if(x.isInlineInput(i)||x.isExternalInput(i))return this.constants_.SMALL_PADDING}else{if(x.isInlineInput(i)||x.isExternalInput(i))return this.constants_.MEDIUM_LARGE_PADDING;if(x.isStatementInput(i))return this.constants_.LARGE_PADDING}return this.constants_.LARGE_PADDING-1}if(x.isIcon(t)&&i&&!x.isInput(i))return this.constants_.LARGE_PADDING;if(x.isInlineInput(t)&&i&&x.isField(i))return i.isEditable?this.constants_.MEDIUM_PADDING:this.constants_.LARGE_PADDING;if(x.isLeftSquareCorner(t)&&i){if(x.isHat(i))return this.constants_.NO_PADDING;if(x.isPreviousConnection(i))return i.notchOffset;if(x.isNextConnection(i))return i.notchOffset+(this.RTL?1:-1)*this.constants_.DARK_PATH_OFFSET/2}if(x.isLeftRoundedCorner(t)&&i){if(x.isPreviousConnection(i))return i.notchOffset-this.constants_.CORNER_RADIUS;if(x.isNextConnection(i))return i.notchOffset-this.constants_.CORNER_RADIUS+(this.RTL?1:-1)*this.constants_.DARK_PATH_OFFSET/2}return x.isField(t)&&i&&x.isField(i)&&t.isEditable===i.isEditable||i&&x.isJaggedEdge(i)?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getSpacerRowHeight_(t,i){return x.isTopRow(t)&&x.isBottomRow(i)?this.constants_.EMPTY_BLOCK_SPACER_HEIGHT:x.isTopRow(t)||x.isBottomRow(i)?this.constants_.NO_PADDING:t.hasExternalInput&&i.hasExternalInput?this.constants_.LARGE_PADDING:!t.hasStatement&&i.hasStatement?this.constants_.BETWEEN_STATEMENT_PADDING_Y:t.hasStatement&&i.hasStatement||!t.hasStatement&&i.hasDummyInput||t.hasDummyInput?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getElemCenterline_(t,i){if(x.isSpacer(i))return t.yPos+i.height/2;if(x.isBottomRow(t))return t=t.yPos+t.height-t.descenderHeight,x.isNextConnection(i)?t+i.height/2:t-i.height/2;if(x.isTopRow(t))return x.isHat(i)?t.capline-i.height/2:t.capline+i.height/2;let r=t.yPos;return x.isField(i)||x.isIcon(i)?(r+=i.height/2,(t.hasInlineInput||t.hasStatement)&&i.height+this.constants_.TALL_INPUT_FIELD_OFFSET_Y<=t.height&&(r+=this.constants_.TALL_INPUT_FIELD_OFFSET_Y)):r=x.isInlineInput(i)?r+i.height/2:r+t.height/2,r}alignRowElements_(){if(this.isInline){var t=0,i=new WeakMap,r=null;for(let c=this.rows.length-1,u;u=this.rows[c];c--)i.set(u,t),x.isInputRow(u)&&(u.hasStatement&&this.alignStatementRow_(u),r&&r.hasStatement&&u.width<r.width?i.set(u,r.width):t=u.hasStatement?u.width:Math.max(t,u.width),r=u);t=0;for(let c=0,u;u=this.rows[c];c++)u.hasStatement?t=this.getDesiredRowWidth_(u):x.isSpacer(u)?u.width=Math.max(t,i.get(u)):(r=u.width,t=Math.max(t,i.get(u))-r,0<t&&this.addAlignmentPadding_(u,t),t=u.width)}else super.alignRowElements_()}getDesiredRowWidth_(t){return this.isInline&&t.hasStatement?this.statementEdge+this.constants_.MAX_BOTTOM_WIDTH+this.startX:super.getDesiredRowWidth_(t)}finalize_(){let t=0,i=0;for(let c=0,u;u=this.rows[c];c++){u.yPos=i,u.xPos=this.startX,i+=u.height,t=Math.max(t,u.widthWithConnectedBlocks);var r=i-this.topRow.ascenderHeight;u===this.bottomRow&&r<this.constants_.MIN_BLOCK_HEIGHT&&(r=this.constants_.MIN_BLOCK_HEIGHT-r,this.bottomRow.height+=r,i+=r),this.recordElemPositions_(u)}this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(r=this.block_.nextConnection.targetBlock())&&(t=Math.max(t,r.getHeightWidth().width-this.constants_.DARK_PATH_OFFSET)),this.bottomRow.baseline=i-this.bottomRow.descenderHeight,this.widthWithChildren=t+this.startX+this.constants_.DARK_PATH_OFFSET,this.width+=this.constants_.DARK_PATH_OFFSET,this.height=i+this.constants_.DARK_PATH_OFFSET,this.startY=this.topRow.capline}},gS=class extends od{constructor(t,i,r){super(t,i,r),this.constants=r,this.colourDark="#000000",this.svgPathDark=R(D.PATH,{class:"blocklyPathDark",transform:"translate(1,1)"}),this.svgRoot.insertBefore(this.svgPathDark,this.svgPath),this.svgPathLight=R(D.PATH,{class:"blocklyPathLight"},this.svgRoot)}setPath(t){this.svgPath.setAttribute("d",t),this.svgPathDark.setAttribute("d",t)}setHighlightPath(t){this.svgPathLight.setAttribute("d",t)}flipRTL(){this.svgPath.setAttribute("transform","scale(-1 1)"),this.svgPathLight.setAttribute("transform","scale(-1 1)"),this.svgPathDark.setAttribute("transform","translate(1,1) scale(-1 1)")}applyColour(t){if(this.svgPathLight.style.display="",this.svgPathDark.style.display="",!this.style.colourTertiary)throw Error("The renderer did not properly initialize the tertiary colour of the block style");this.svgPathLight.setAttribute("stroke",this.style.colourTertiary),this.svgPathDark.setAttribute("fill",this.colourDark),super.applyColour(t),this.svgPath.setAttribute("stroke","none")}setStyle(t){this.style=t,this.colourDark=ir("#000",this.style.colourPrimary,.2)||this.colourDark}updateHighlighted(t){t?(this.svgPath.setAttribute("filter","url(#"+this.constants.embossFilterId+")"),this.svgPathLight.style.display="none"):(this.svgPath.setAttribute("filter","none"),this.svgPathLight.style.display="inline")}updateShadow_(t){if(t){if(this.svgPathLight.style.display="none",!this.style.colourSecondary)throw Error("The renderer did not properly initialize the secondary colour of the block style block style");this.svgPathDark.setAttribute("fill",this.style.colourSecondary),this.svgPath.setAttribute("stroke","none"),this.svgPath.setAttribute("fill",this.style.colourSecondary)}}updateDisabled_(t){super.updateDisabled_(t),t&&this.svgPath.setAttribute("stroke","none")}},mS=class extends $a{constructor(t){super(t),this.highlightConstants=null}init(t,i){super.init(t,i),this.highlightConstants=this.makeHighlightConstants_(),this.highlightConstants.init()}refreshDom(t,i){super.refreshDom(t,i),this.getHighlightConstants().init()}makeConstants_(){return new cS}makeRenderInfo_(t){return new fS(this,t)}makeDrawer_(t,i){return new hS(t,i)}makePathObject(t,i){return new gS(t,i,this.getConstants())}makeHighlightConstants_(){return new uS(this.getConstants())}getHighlightConstants(){if(!this.highlightConstants)throw Error("Cannot access the highlight constants because init has not been called");return this.highlightConstants}};hl("geras",mS);var so={};so.ConstantProvider=cS,so.Drawer=hS,so.HighlightConstantProvider=uS,so.Highlighter=aS,so.InlineInput=dS,so.PathObject=gS,so.RenderInfo=fS,so.Renderer=mS,so.StatementInput=pS;var $S=class extends ga{constructor(){super(),j("Blockly.minimalist.ConstantProvider","v10","v11","Blockly.blockRendering.ConstantProvider")}},_S=class extends ma{constructor(t,i){super(t,i),j("Blockly.minimalist.Drawer","v10","v11","Blockly.blockRendering.Drawer")}},TS=class extends Dl{constructor(t,i){super(t,i),j("Blockly.minimalist.RenderInfo","v10","v11","Blockly.blockRendering.RenderInfo")}getRenderer(){return this.renderer_}},bS=class extends $a{constructor(t){super(t),j("Blockly.minimalist.Renderer","v10","v11","Blockly.blockRendering.Renderer")}makeConstants_(){return new $S}makeRenderInfo_(t){return new TS(this,t)}makeDrawer_(t,i){return new _S(t,i)}};hl("minimalist",bS);var Ia={};Ia.ConstantProvider=$S,Ia.Drawer=_S,Ia.RenderInfo=TS,Ia.Renderer=bS;var ES=class extends Dl{constructor(t,i){super(t,i)}getRenderer(){return this.renderer_}addElemSpacing_(){let t=!1;for(var i=0;i<this.rows.length;i++)if(this.rows[i].hasExternalInput){t=!0;break}for(i=0;i<this.rows.length;i++){const c=this.rows[i];var r=c.elements;if(c.elements=[],c.startsWithElemSpacer()&&c.elements.push(new ji(this.constants_,this.getInRowSpacing_(null,r[0]))),r.length){for(let u=0;u<r.length-1;u++){c.elements.push(r[u]);const f=this.getInRowSpacing_(r[u],r[u+1]);c.elements.push(new ji(this.constants_,f))}c.elements.push(r[r.length-1]),c.endsWithElemSpacer()&&(r=this.getInRowSpacing_(r[r.length-1],null),t&&c.hasDummyInput&&(r+=this.constants_.TAB_WIDTH),c.elements.push(new ji(this.constants_,r)))}}}getInRowSpacing_(t,i){if(!t)return i&&x.isField(i)&&i.isEditable?this.constants_.MEDIUM_PADDING:i&&x.isInlineInput(i)?this.constants_.MEDIUM_LARGE_PADDING:i&&x.isStatementInput(i)?this.constants_.STATEMENT_INPUT_PADDING_LEFT:this.constants_.LARGE_PADDING;if(!x.isInput(t)&&!i)return x.isField(t)&&t.isEditable?this.constants_.MEDIUM_PADDING:x.isIcon(t)?2*this.constants_.LARGE_PADDING+1:x.isHat(t)?this.constants_.NO_PADDING:x.isPreviousOrNextConnection(t)?this.constants_.LARGE_PADDING:x.isLeftRoundedCorner(t)?this.constants_.MIN_BLOCK_WIDTH:x.isJaggedEdge(t)?this.constants_.NO_PADDING:this.constants_.LARGE_PADDING;if(x.isInput(t)&&!i){if(x.isExternalInput(t))return this.constants_.NO_PADDING;if(x.isInlineInput(t))return this.constants_.LARGE_PADDING;if(x.isStatementInput(t))return this.constants_.NO_PADDING}if(!x.isInput(t)&&i&&x.isInput(i)){if(x.isField(t)&&t.isEditable){if(x.isInlineInput(i)||x.isExternalInput(i))return this.constants_.SMALL_PADDING}else{if(x.isInlineInput(i)||x.isExternalInput(i))return this.constants_.MEDIUM_LARGE_PADDING;if(x.isStatementInput(i))return this.constants_.LARGE_PADDING}return this.constants_.LARGE_PADDING-1}if(x.isIcon(t)&&i&&!x.isInput(i))return this.constants_.LARGE_PADDING;if(x.isInlineInput(t)&&i&&x.isField(i))return i.isEditable?this.constants_.MEDIUM_PADDING:this.constants_.LARGE_PADDING;if(x.isLeftSquareCorner(t)&&i){if(x.isHat(i))return this.constants_.NO_PADDING;if(x.isPreviousConnection(i)||x.isNextConnection(i))return i.notchOffset}return x.isLeftRoundedCorner(t)&&i?i.notchOffset-this.constants_.CORNER_RADIUS:x.isField(t)&&i&&x.isField(i)&&t.isEditable===i.isEditable||i&&x.isJaggedEdge(i)?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getSpacerRowHeight_(t,i){return x.isTopRow(t)&&x.isBottomRow(i)?this.constants_.EMPTY_BLOCK_SPACER_HEIGHT:x.isTopRow(t)||x.isBottomRow(i)?this.constants_.NO_PADDING:t.hasExternalInput&&i.hasExternalInput?this.constants_.LARGE_PADDING:!t.hasStatement&&i.hasStatement?this.constants_.BETWEEN_STATEMENT_PADDING_Y:t.hasStatement&&i.hasStatement||t.hasDummyInput||i.hasDummyInput?this.constants_.LARGE_PADDING:this.constants_.MEDIUM_PADDING}getElemCenterline_(t,i){if(x.isSpacer(i))return t.yPos+i.height/2;if(x.isBottomRow(t))return t=t.yPos+t.height-t.descenderHeight,x.isNextConnection(i)?t+i.height/2:t-i.height/2;if(x.isTopRow(t))return x.isHat(i)?t.capline-i.height/2:t.capline+i.height/2;let r=t.yPos;return r=x.isField(i)&&t.hasStatement?r+(this.constants_.TALL_INPUT_FIELD_OFFSET_Y+i.height/2):r+t.height/2}finalize_(){let t=0,i=0;for(var r=0;r<this.rows.length;r++){const u=this.rows[r];u.yPos=i,u.xPos=this.startX,i+=u.height,t=Math.max(t,u.widthWithConnectedBlocks);var c=i-this.topRow.ascenderHeight;u===this.bottomRow&&c<this.constants_.MIN_BLOCK_HEIGHT&&(c=this.constants_.MIN_BLOCK_HEIGHT-c,this.bottomRow.height+=c,i+=c),this.recordElemPositions_(u)}this.outputConnection&&this.block_.nextConnection&&this.block_.nextConnection.isConnected()&&(r=this.block_.nextConnection.targetBlock())&&(t=Math.max(t,r.getHeightWidth().width)),this.bottomRow.baseline=i-this.bottomRow.descenderHeight,this.widthWithChildren=t+this.startX,this.height=i,this.startY=this.topRow.capline}},vS=class extends $a{constructor(t){super(t)}makeRenderInfo_(t){return new ES(this,t)}};hl("thrasos",vS);var x$={};x$.RenderInfo=ES,x$.Renderer=vS;var OR={colour_blocks:{colourPrimary:"#CF63CF",colourSecondary:"#C94FC9",colourTertiary:"#BD42BD"},list_blocks:{colourPrimary:"#9966FF",colourSecondary:"#855CD6",colourTertiary:"#774DCB"},logic_blocks:{colourPrimary:"#4C97FF",colourSecondary:"#4280D7",colourTertiary:"#3373CC"},loop_blocks:{colourPrimary:"#0fBD8C",colourSecondary:"#0DA57A",colourTertiary:"#0B8E69"},math_blocks:{colourPrimary:"#59C059",colourSecondary:"#46B946",colourTertiary:"#389438"},procedure_blocks:{colourPrimary:"#FF6680",colourSecondary:"#FF4D6A",colourTertiary:"#FF3355"},text_blocks:{colourPrimary:"#FFBF00",colourSecondary:"#E6AC00",colourTertiary:"#CC9900"},variable_blocks:{colourPrimary:"#FF8C1A",colourSecondary:"#FF8000",colourTertiary:"#DB6E00"},variable_dynamic_blocks:{colourPrimary:"#FF8C1A",colourSecondary:"#FF8000",colourTertiary:"#DB6E00"},hat_blocks:{colourPrimary:"#4C97FF",colourSecondary:"#4280D7",colourTertiary:"#3373CC",hat:"cap"}},AR={colour_category:{colour:"#CF63CF"},list_category:{colour:"#9966FF"},logic_category:{colour:"#4C97FF"},loop_category:{colour:"#0fBD8C"},math_category:{colour:"#59C059"},procedure_category:{colour:"#FF6680"},text_category:{colour:"#FFBF00"},variable_category:{colour:"#FF8C1A"},variable_dynamic_category:{colour:"#FF8C1A"}},RR=new Er("zelos",OR,AR),NR={Classic:qu,Zelos:RR},D$=class{constructor(t,i,r){this.id_=t.toolboxitemid||ot(),this.level_=(this.parent_=r||null)?this.parent_.getLevel()+1:0,this.toolboxItemDef_=t,this.parentToolbox_=i,this.workspace_=this.parentToolbox_.getWorkspace()}init(){}getDiv(){return null}getClickTarget(){return null}getId(){return this.id_}getParent(){return null}getLevel(){return this.level_}isSelectable(){return!1}isCollapsible(){return!1}dispose(){}setVisible_(t){}},ks=class extends D${constructor(t,i,r){super(t,i,r),this.colour_=this.name_="",this.labelDom_=this.iconDom_=this.rowContents_=this.rowDiv_=this.htmlDiv_=null,this.isDisabled_=this.isHidden_=!1,this.flyoutItems_=[],this.cssConfig_=this.makeDefaultCssConfig_()}init(){this.parseCategoryDef_(this.toolboxItemDef_),this.parseContents_(this.toolboxItemDef_),this.createDom_(),this.toolboxItemDef_.hidden==="true"&&this.hide()}makeDefaultCssConfig_(){return{container:"blocklyToolboxCategory",row:"blocklyTreeRow",rowcontentcontainer:"blocklyTreeRowContentContainer",icon:"blocklyTreeIcon",label:"blocklyTreeLabel",contents:"blocklyToolboxContents",selected:"blocklyTreeSelected",openicon:"blocklyTreeIconOpen",closedicon:"blocklyTreeIconClosed"}}parseContents_(t){if("custom"in t)this.flyoutItems_=t.custom;else if(t=t.contents)for(let i=0;i<t.length;i++){const r=t[i];Array.isArray(this.flyoutItems_)&&this.flyoutItems_.push(r)}}parseCategoryDef_(t){this.name_="name"in t?Fe(t.name):"",this.colour_=this.getColour_(t),Object.assign(this.cssConfig_,t.cssconfig||t.cssConfig)}createDom_(){this.htmlDiv_=this.createContainer_(),bs(this.htmlDiv_,Pi.TREEITEM),Re(this.htmlDiv_,we.SELECTED,!1),Re(this.htmlDiv_,we.LEVEL,this.level_+1),this.rowDiv_=this.createRowContainer_(),this.rowDiv_.style.pointerEvents="auto",this.htmlDiv_.appendChild(this.rowDiv_),this.rowContents_=this.createRowContentsContainer_(),this.rowContents_.style.pointerEvents="none",this.rowDiv_.appendChild(this.rowContents_),this.iconDom_=this.createIconDom_(),bs(this.iconDom_,Pi.PRESENTATION),this.rowContents_.appendChild(this.iconDom_),this.labelDom_=this.createLabelDom_(this.name_),this.rowContents_.appendChild(this.labelDom_);const t=this.labelDom_.getAttribute("id");return t&&Re(this.htmlDiv_,we.LABELLEDBY,t),this.addColourBorder_(this.colour_),this.htmlDiv_}createContainer_(){const t=document.createElement("div"),i=this.cssConfig_.container;return i&&J(t,i),t}createRowContainer_(){const t=document.createElement("div");var i=this.cssConfig_.row;return i&&J(t,i),i=`${ks.nestedPadding*this.getLevel()}px`,this.workspace_.RTL?t.style.paddingRight=i:t.style.paddingLeft=i,t}createRowContentsContainer_(){const t=document.createElement("div"),i=this.cssConfig_.rowcontentcontainer;return i&&J(t,i),t}createIconDom_(){const t=document.createElement("span");if(!this.parentToolbox_.isHorizontal()){const i=this.cssConfig_.icon;i&&J(t,i)}return t.style.display="inline-block",t}createLabelDom_(t){const i=document.createElement("span");return i.setAttribute("id",this.getId()+".label"),i.textContent=t,(t=this.cssConfig_.label)&&J(i,t),i}refreshTheme(){this.colour_=this.getColour_(this.toolboxItemDef_),this.addColourBorder_(this.colour_)}addColourBorder_(t){t&&(t=ks.borderWidth+"px solid "+(t||"#ddd"),this.workspace_.RTL?this.rowDiv_.style.borderRight=t:this.rowDiv_.style.borderLeft=t)}getColour_(t){const i=t.categorystyle||t.categoryStyle;if((t=t.colour)&&i)console.warn('Toolbox category "'+this.name_+'" must not have both a style and a colour');else{if(i)return this.getColourfromStyle_(i);if(t)return this.parseColour_(t)}return""}getColourfromStyle_(t){var i=this.workspace_.getTheme();if(t&&i){if((i=i.categoryStyles[t])&&i.colour)return this.parseColour_(i.colour);console.warn('Style "'+t+'" must exist and contain a colour value')}return""}getClickTarget(){return this.rowDiv_}parseColour_(t){if(t=Fe(t),t==null||t==="")return"";var i=Number(t);return isNaN(i)?(i=cn(t))?i:(console.warn('Toolbox category "'+this.name_+'" has unrecognized colour attribute: '+t),""):lg(i)}openIcon_(t){if(t){var i=this.cssConfig_.closedicon;i&&kt(t,i),(i=this.cssConfig_.openicon)&&J(t,i)}}closeIcon_(t){if(t){var i=this.cssConfig_.openicon;i&&kt(t,i),(i=this.cssConfig_.closedicon)&&J(t,i)}}setVisible_(t){this.htmlDiv_.style.display=t?"block":"none",this.isHidden_=!t,this.parentToolbox_.getSelectedItem()===this&&this.parentToolbox_.clearSelection()}hide(){this.setVisible_(!1)}show(){this.setVisible_(!0)}isVisible(){return!this.isHidden_&&this.allAncestorsExpanded_()}allAncestorsExpanded_(){let t=this;for(;t.getParent();)if(t=t.getParent(),!t.isExpanded())return!1;return!0}isSelectable(){return this.isVisible()&&!this.isDisabled_}onClick(t){}setSelected(t){if(this.rowDiv_){var i=this.cssConfig_.selected;if(t){const r=this.parseColour_(ks.defaultBackgroundColour);this.rowDiv_.style.backgroundColor=this.colour_||r,i&&J(this.rowDiv_,i)}else this.rowDiv_.style.backgroundColor="",i&&mt(this.rowDiv_,i);Re(this.htmlDiv_,we.SELECTED,t)}}setDisabled(t){this.isDisabled_=t,this.getDiv().setAttribute("disabled",`${t}`),t?this.getDiv().setAttribute("disabled","true"):this.getDiv().removeAttribute("disabled")}getName(){return this.name_}getParent(){return this.parent_}getDiv(){return this.htmlDiv_}getContents(){return this.flyoutItems_}updateFlyoutContents(t){this.flyoutItems_=[],this.toolboxItemDef_=typeof t=="string"?{kind:this.toolboxItemDef_.kind,custom:t,id:this.toolboxItemDef_.id,categorystyle:this.toolboxItemDef_.categorystyle,colour:this.toolboxItemDef_.colour,cssconfig:this.toolboxItemDef_.cssconfig,hidden:this.toolboxItemDef_.hidden}:{kind:this.toolboxItemDef_.kind,name:"name"in this.toolboxItemDef_?this.toolboxItemDef_.name:"",contents:Ps(t),id:this.toolboxItemDef_.id,categorystyle:this.toolboxItemDef_.categorystyle,colour:this.toolboxItemDef_.colour,cssconfig:this.toolboxItemDef_.cssconfig,hidden:this.toolboxItemDef_.hidden},this.parseContents_(this.toolboxItemDef_)}dispose(){Ct(this.htmlDiv_)}};ks.registrationName="category",ks.nestedPadding=19,ks.borderWidth=8,ks.defaultBackgroundColour="#57e",et(`
.blocklyTreeRow:not(.blocklyTreeSelected):hover {
  background-color: rgba(255, 255, 255, .2);
}

.blocklyToolboxDiv[layout="h"] .blocklyToolboxCategory {
  margin: 1px 5px 1px 0;
}

.blocklyToolboxDiv[dir="RTL"][layout="h"] .blocklyToolboxCategory {
  margin: 1px 0 1px 5px;
}

.blocklyTreeRow {
  height: 22px;
  line-height: 22px;
  margin-bottom: 3px;
  padding-right: 8px;
  white-space: nowrap;
}

.blocklyToolboxDiv[dir="RTL"] .blocklyTreeRow {
  margin-left: 8px;
  padding-right: 0;
}

.blocklyTreeIcon {
  background-image: url(<<<PATH>>>/sprites.png);
  height: 16px;
  vertical-align: middle;
  visibility: hidden;
  width: 16px;
}

.blocklyTreeIconClosed {
  background-position: -32px -1px;
}

.blocklyToolboxDiv[dir="RTL"] .blocklyTreeIconClosed {
  background-position: 0 -1px;
}

.blocklyTreeSelected>.blocklyTreeIconClosed {
  background-position: -32px -17px;
}

.blocklyToolboxDiv[dir="RTL"] .blocklyTreeSelected>.blocklyTreeIconClosed {
  background-position: 0 -17px;
}

.blocklyTreeIconOpen {
  background-position: -16px -1px;
}

.blocklyTreeSelected>.blocklyTreeIconOpen {
  background-position: -16px -17px;
}

.blocklyTreeLabel {
  cursor: default;
  font: 16px sans-serif;
  padding: 0 3px;
  vertical-align: middle;
}

.blocklyToolboxDelete .blocklyTreeLabel {
  cursor: url("<<<PATH>>>/handdelete.cur"), auto;
}

.blocklyTreeSelected .blocklyTreeLabel {
  color: #fff;
}
`),o(rt.TOOLBOX_ITEM,ks.registrationName,ks);var Sa=class extends D${constructor(t,i){super(t,i),this.cssConfig_={container:"blocklyTreeSeparator"},this.htmlDiv_=null,Object.assign(this.cssConfig_,t.cssconfig||t.cssConfig)}init(){this.createDom_()}createDom_(){const t=document.createElement("div"),i=this.cssConfig_.container;return i&&J(t,i),this.htmlDiv_=t}getDiv(){return this.htmlDiv_}dispose(){Ct(this.htmlDiv_)}};Sa.registrationName="sep",et(`
.blocklyTreeSeparator {
  border-bottom: solid #e5e5e5 1px;
  height: 0;
  margin: 5px 0;
}

.blocklyToolboxDiv[layout="h"] .blocklyTreeSeparator {
  border-right: solid #e5e5e5 1px;
  border-bottom: none;
  height: auto;
  margin: 0 5px 0 5px;
  padding: 5px 0;
  width: 0;
}
`),o(rt.TOOLBOX_ITEM,Sa.registrationName,Sa);var Wl=class extends ks{constructor(t,i,r){super(t,i,r),this.subcategoriesDiv_=null,this.expanded_=!1,this.toolboxItems_=[]}makeDefaultCssConfig_(){const t=super.makeDefaultCssConfig_();return t.contents="blocklyToolboxContents",t}parseContents_(t){if("custom"in t)this.flyoutItems_=t.custom;else{const i=t.contents;if(i){this.flyoutItems_=[],t=!0;for(let r=0;r<i.length;r++){const c=i[r];!d(rt.TOOLBOX_ITEM,c.kind)||c.kind.toLowerCase()===Sa.registrationName&&t?(this.flyoutItems_.push(c),t=!0):(this.createToolboxItem_(c),t=!1)}}}}createToolboxItem_(t){let i=t.kind;i.toUpperCase()==="CATEGORY"&&Gh(t)&&(i=Wl.registrationName),t=new(p(rt.TOOLBOX_ITEM,i))(t,this.parentToolbox_,this),this.toolboxItems_.push(t)}init(){super.init(),this.setExpanded(this.toolboxItemDef_.expanded==="true"||this.toolboxItemDef_.expanded===!0)}createDom_(){super.createDom_();const t=this.getChildToolboxItems();return this.subcategoriesDiv_=this.createSubCategoriesDom_(t),bs(this.subcategoriesDiv_,Pi.GROUP),this.htmlDiv_.appendChild(this.subcategoriesDiv_),this.closeIcon_(this.iconDom_),Re(this.htmlDiv_,we.EXPANDED,!1),this.htmlDiv_}createIconDom_(){const t=document.createElement("span");if(!this.parentToolbox_.isHorizontal()){const i=this.cssConfig_.icon;i&&J(t,i),t.style.visibility="visible"}return t.style.display="inline-block",t}createSubCategoriesDom_(t){const i=document.createElement("div");i.style.display="none";var r=this.cssConfig_.contents;for(r&&J(i,r),r=0;r<t.length;r++){const c=t[r];c.init();const u=c.getDiv();if(i.appendChild(u),c.getClickTarget){let f;(f=c.getClickTarget())==null||f.setAttribute("id",c.getId())}}return i}setExpanded(t){if(this.expanded_!==t){if(this.expanded_=t)this.subcategoriesDiv_.style.display="block",this.openIcon_(this.iconDom_);else{let i;(i=this.parentToolbox_.getFlyout())==null||i.setVisible(!1),this.subcategoriesDiv_.style.display="none",this.closeIcon_(this.iconDom_)}Re(this.htmlDiv_,we.EXPANDED,t),this.parentToolbox_.handleToolboxItemResize()}}setVisible_(t){this.htmlDiv_.style.display=t?"block":"none";const i=this.getChildToolboxItems();for(let r=0;r<i.length;r++)i[r].setVisible_(t);this.isHidden_=!t,this.parentToolbox_.getSelectedItem()===this&&this.parentToolbox_.clearSelection()}isExpanded(){return this.expanded_}isCollapsible(){return!0}onClick(t){this.toggleExpanded()}toggleExpanded(){this.setExpanded(!this.expanded_)}getDiv(){return this.htmlDiv_}getChildToolboxItems(){return this.toolboxItems_}};Wl.registrationName="collapsibleCategory",o(rt.TOOLBOX_ITEM,Wl.registrationName,Wl);var yS=class extends rd{constructor(t){super(),this.id="toolbox",this.contentsDiv_=this.HtmlDiv=null,this.isVisible_=!1,this.contents_=[],this.height_=this.width_=0,this.previouslySelectedItem_=this.selectedItem_=this.flyout_=null,this.boundEvents_=[],this.workspace_=t,this.toolboxDef_=t.options.languageTree||{contents:[]},this.horizontalLayout_=t.options.horizontalLayout,this.RTL=t.options.RTL,this.contentMap_=Object.create(null),this.toolboxPosition=t.options.toolboxPosition}onShortcut(t){return!1}init(){var t=this.workspace_;const i=t.getParentSvg();this.flyout_=this.createFlyout_(),this.HtmlDiv=this.createDom_(this.workspace_),Qt(this.flyout_.createDom("svg"),i),this.setVisible(!0),this.flyout_.init(t),this.render(this.toolboxDef_),t=t.getThemeManager(),t.subscribe(this.HtmlDiv,"toolboxBackgroundColour","background-color"),t.subscribe(this.HtmlDiv,"toolboxForegroundColour","color"),this.workspace_.getComponentManager().addComponent({component:this,weight:1,capabilities:[je.Capability.AUTOHIDEABLE,je.Capability.DELETE_AREA,je.Capability.DRAG_TARGET]})}createDom_(t){t=t.getParentSvg();const i=this.createContainer_();return this.contentsDiv_=this.createContentsContainer_(),this.contentsDiv_.tabIndex=0,bs(this.contentsDiv_,Pi.TREE),i.appendChild(this.contentsDiv_),t.parentNode.insertBefore(i,t),this.attachEvents_(i,this.contentsDiv_),i}createContainer_(){const t=document.createElement("div");return t.setAttribute("layout",this.isHorizontal()?"h":"v"),J(t,"blocklyToolboxDiv"),J(t,"blocklyNonSelectable"),t.setAttribute("dir",this.RTL?"RTL":"LTR"),t}createContentsContainer_(){const t=document.createElement("div");return J(t,"blocklyToolboxContents"),this.isHorizontal()&&(t.style.flexDirection="row"),t}attachEvents_(t,i){t=yt(t,"pointerdown",this,this.onClick_,!1),this.boundEvents_.push(t),i=yt(i,"keydown",this,this.onKeyDown_,!1),this.boundEvents_.push(i)}onClick_(t){if(q(t)||t.target===this.HtmlDiv)A().hideChaff(!1);else{var i=t.target.getAttribute("id");i&&(i=this.getToolboxItemById(i),i.isSelectable()&&(this.setSelectedItem(i),i.onClick(t))),A().hideChaff(!0)}Ee()}onKeyDown_(t){let i=!1;switch(t.key){case"ArrowDown":i=this.selectNext_();break;case"ArrowUp":i=this.selectPrevious_();break;case"ArrowLeft":i=this.selectParent_();break;case"ArrowRight":i=this.selectChild_();break;case"Enter":case" ":this.selectedItem_&&this.selectedItem_.isCollapsible()&&(this.selectedItem_.toggleExpanded(),i=!0);break;default:i=!1}!i&&this.selectedItem_&&this.selectedItem_.onKeyDown&&(i=this.selectedItem_.onKeyDown(t)),i&&t.preventDefault()}createFlyout_(){const t=this.workspace_,i=new hs({parentWorkspace:t,rtl:t.RTL,oneBasedIndex:t.options.oneBasedIndex,horizontalLayout:t.horizontalLayout,renderer:t.options.renderer,rendererOverrides:t.options.rendererOverrides,move:{scrollbars:!0}});return i.toolboxPosition=t.options.toolboxPosition,new(t.horizontalLayout?T(rt.FLYOUTS_HORIZONTAL_TOOLBOX,t.options,!0):T(rt.FLYOUTS_VERTICAL_TOOLBOX,t.options,!0))(i)}render(t){this.toolboxDef_=t;for(let i=0;i<this.contents_.length;i++){const r=this.contents_[i];r&&r.dispose()}this.contents_=[],this.contentMap_=Object.create(null),this.renderContents_(t.contents),this.position(),this.handleToolboxItemResize()}renderContents_(t){const i=document.createDocumentFragment();for(let r=0;r<t.length;r++)this.createToolboxItem_(t[r],i);this.contentsDiv_.appendChild(i)}createToolboxItem_(t,i){var r=t.kind;r.toUpperCase()==="CATEGORY"&&Gh(t)&&(r=Wl.registrationName),(r=p(rt.TOOLBOX_ITEM,r.toLowerCase()))&&(t=new r(t,this),t.init(),this.addToolboxItem_(t),(r=t.getDiv())&&i.appendChild(r),t.getClickTarget()&&t.getClickTarget().setAttribute("id",t.getId()))}addToolboxItem_(t){if(this.contents_.push(t),this.contentMap_[t.getId()]=t,t.isCollapsible()){t=t.getChildToolboxItems();for(let i=0;i<t.length;i++)this.addToolboxItem_(t[i])}}getToolboxItems(){return this.contents_}addStyle(t){t&&this.HtmlDiv&&J(this.HtmlDiv,t)}removeStyle(t){t&&this.HtmlDiv&&mt(this.HtmlDiv,t)}getClientRect(){if(!this.HtmlDiv||!this.isVisible_)return null;var t=this.HtmlDiv.getBoundingClientRect();const i=t.top,r=i+t.height,c=t.left;return t=c+t.width,this.toolboxPosition===Wt.TOP?new ve(-1e7,r,-1e7,1e7):this.toolboxPosition===Wt.BOTTOM?new ve(i,1e7,-1e7,1e7):this.toolboxPosition===Wt.LEFT?new ve(-1e7,1e7,-1e7,t):new ve(-1e7,1e7,c,1e7)}wouldDelete(t,i){return t instanceof to?this.updateWouldDelete_(!t.getParent()&&t.isDeletable()):this.updateWouldDelete_(t.isDeletable()),this.wouldDelete_}onDragEnter(t){this.updateCursorDeleteStyle_(!0)}onDragExit(t){this.updateCursorDeleteStyle_(!1)}onDrop(t){this.updateCursorDeleteStyle_(!1)}updateWouldDelete_(t){t!==this.wouldDelete_&&(this.updateCursorDeleteStyle_(!1),this.wouldDelete_=t,this.updateCursorDeleteStyle_(!0))}updateCursorDeleteStyle_(t){const i=this.wouldDelete_?"blocklyToolboxDelete":"blocklyToolboxGrab";t?this.addStyle(i):this.removeStyle(i)}getToolboxItemById(t){return this.contentMap_[t]||null}getWidth(){return this.width_}getHeight(){return this.height_}getFlyout(){return this.flyout_}getWorkspace(){return this.workspace_}getSelectedItem(){return this.selectedItem_}getPreviouslySelectedItem(){return this.previouslySelectedItem_}isHorizontal(){return this.horizontalLayout_}position(){const t=this.workspace_.getMetrics(),i=this.HtmlDiv;i&&(this.horizontalLayout_?(i.style.left="0",i.style.height="auto",i.style.width="100%",this.height_=i.offsetHeight,this.width_=t.viewWidth,this.toolboxPosition===Wt.TOP?i.style.top="0":i.style.bottom="0"):(this.toolboxPosition===Wt.RIGHT?i.style.right="0":i.style.left="0",i.style.height="100%",this.width_=i.offsetWidth,this.height_=t.viewHeight),this.flyout_.position())}handleToolboxItemResize(){const t=this.workspace_,i=this.HtmlDiv.getBoundingClientRect();t.translate(this.toolboxPosition===Wt.LEFT?t.scrollX+i.width:t.scrollX,this.toolboxPosition===Wt.TOP?t.scrollY+i.height:t.scrollY),V(t)}clearSelection(){this.setSelectedItem(null)}refreshTheme(){for(let t=0;t<this.contents_.length;t++){const i=this.contents_[t];i.refreshTheme&&i.refreshTheme()}}refreshSelection(){this.selectedItem_&&this.selectedItem_.isSelectable()&&this.selectedItem_.getContents().length&&this.flyout_.show(this.selectedItem_.getContents())}setVisible(t){this.isVisible_!==t&&(this.HtmlDiv.style.display=t?"block":"none",this.isVisible_=t,this.workspace_.recordDragTargets())}autoHide(t){!t&&this.flyout_&&this.flyout_.autoClose&&this.clearSelection()}setSelectedItem(t){const i=this.selectedItem_;!t&&!i||t&&!$y(t)||(this.shouldDeselectItem_(i,t)&&i!==null&&this.deselectItem_(i),this.shouldSelectItem_(i,t)&&t!==null&&this.selectItem_(i,t),this.updateFlyout_(i,t),this.fireSelectEvent_(i,t))}shouldDeselectItem_(t,i){return t!==null&&(!t.isCollapsible()||t!==i)}shouldSelectItem_(t,i){return i!==null&&i!==t}deselectItem_(t){this.selectedItem_=null,this.previouslySelectedItem_=t,t.setSelected(!1),Re(this.contentsDiv_,we.ACTIVEDESCENDANT,"")}selectItem_(t,i){this.selectedItem_=i,this.previouslySelectedItem_=t,i.setSelected(!0),Re(this.contentsDiv_,we.ACTIVEDESCENDANT,i.getId())}selectItemByPosition(t){-1<t&&t<this.contents_.length&&(t=this.contents_[t],t.isSelectable()&&this.setSelectedItem(t))}updateFlyout_(t,i){i&&(t!==i||i.isCollapsible())&&i.getContents().length?(this.flyout_.show(i.getContents()),this.flyout_.scrollToStart()):this.flyout_.hide()}fireSelectEvent_(t,i){const r=t&&t.getName();let c=i&&i.getName();t===i&&(c=null),t=new(ut($l))(r,c,this.workspace_.id),it(t)}selectParent_(){return this.selectedItem_?this.selectedItem_.isCollapsible()&&this.selectedItem_.isExpanded()?(this.selectedItem_.toggleExpanded(),!0):this.selectedItem_.getParent()&&this.selectedItem_.getParent().isSelectable()?(this.setSelectedItem(this.selectedItem_.getParent()),!0):!1:!1}selectChild_(){if(!this.selectedItem_||!this.selectedItem_.isCollapsible())return!1;const t=this.selectedItem_;return t.isExpanded()?this.selectNext_():t.toggleExpanded(),!0}selectNext_(){if(!this.selectedItem_)return!1;let t=this.contents_.indexOf(this.selectedItem_)+1;if(-1<t&&t<this.contents_.length){let i=this.contents_[t];for(;i&&!i.isSelectable();)i=this.contents_[++t];if(i&&i.isSelectable())return this.setSelectedItem(i),!0}return!1}selectPrevious_(){if(!this.selectedItem_)return!1;let t=this.contents_.indexOf(this.selectedItem_)-1;if(-1<t&&t<this.contents_.length){let i=this.contents_[t];for(;i&&!i.isSelectable();)i=this.contents_[--t];if(i&&i.isSelectable())return this.setSelectedItem(i),!0}return!1}dispose(){this.workspace_.getComponentManager().removeComponent("toolbox"),this.flyout_.dispose();for(var t=0;t<this.contents_.length;t++)this.contents_[t].dispose();for(t=0;t<this.boundEvents_.length;t++)N(this.boundEvents_[t]);this.boundEvents_=[],this.contents_=[],this.HtmlDiv&&(this.workspace_.getThemeManager().unsubscribe(this.HtmlDiv),Ct(this.HtmlDiv))}};et(`
.blocklyToolboxDelete {
  cursor: url("<<<PATH>>>/handdelete.cur"), auto;
}

.blocklyToolboxGrab {
  cursor: url("<<<PATH>>>/handclosed.cur"), auto;
  cursor: grabbing;
  cursor: -webkit-grabbing;
}

/* Category tree in Toolbox. */
.blocklyToolboxDiv {
  background-color: #ddd;
  overflow-x: visible;
  overflow-y: auto;
  padding: 4px 0 4px 0;
  position: absolute;
  z-index: 70;  /* so blocks go under toolbox when dragging */
  -webkit-tap-highlight-color: transparent;  /* issue #1345 */
}

.blocklyToolboxContents {
  display: flex;
  flex-wrap: wrap;
  flex-direction: column;
}

.blocklyToolboxContents:focus {
  outline: none;
}
`),o(rt.TOOLBOX,Co,yS);var LR="10.3.1",MR=s.Align$$module$build$src$core$inputs$align.LEFT,xR=s.Align$$module$build$src$core$inputs$align.CENTRE,DR=s.Align$$module$build$src$core$inputs$align.RIGHT,PR=wt.INPUT_VALUE,BR=wt.OUTPUT_VALUE,FR=wt.NEXT_STATEMENT,UR=wt.PREVIOUS_STATEMENT,HR=s.inputTypes$$module$build$src$core$inputs$input_types.DUMMY,VR=Wt.TOP,GR=Wt.BOTTOM,WR=Wt.LEFT,zR=Wt.RIGHT;_a.prototype.newBlock=function(t,i){return new Bl(this,t,i)},Ss.prototype.newBlock=function(t,i){return new to(this,t,i)},Ss.newTrashcan=function(t){return new UI(t)},oi.prototype.showContextMenu=function(t){if(!this.workspace.options.readOnly){var i=[];this.isDeletable()&&this.isMovable()&&(i.push(Rf(this)),i.push(Af(this))),Fc(t,i,this.RTL)}},xo.prototype.newWorkspaceSvg=function(t){return new Ss(t)},s.Names$$module$build$src$core$names.prototype.populateProcedures=function(t){t=Eu(t),t=t[0].concat(t[1]);for(let i=0;i<t.length;i++)this.getName(t[i][0],s.Names$$module$build$src$core$names.NameType.PROCEDURE)};var XR=wt,U={ALIGN_CENTRE:xR,ALIGN_LEFT:MR,ALIGN_RIGHT:DR};return U.ASTNode=Q,U.BasicCursor=Ta,U.Block=Bl,U.BlockDragger=YI,U.BlockSvg=to,U.Blocks=Mi,U.Bubble=ce,U.BubbleDragger=aI,U.COLLAPSED_FIELD_NAME=nd,U.COLLAPSED_INPUT_NAME=Pl,U.COLLAPSE_CHARS=hI,U.CodeGenerator=s.CodeGenerator$$module$build$src$core$generator,U.CollapsibleToolboxCategory=Wl,U.ComponentManager=je,U.Connection=re,U.ConnectionChecker=xI,U.ConnectionDB=Cl,U.ConnectionType=wt,U.ContextMenu=js,U.ContextMenuItems=Ci,U.ContextMenuRegistry=ne,U.Css=dm,U.Cursor=g$,U.DELETE_VARIABLE_ID=Gm,U.DRAG_STACK=uI,U.DUMMY_INPUT=HR,U.DeleteArea=rd,U.DragTarget=FI,U.DropDownDiv=ui,U.Events=St,U.Extensions=ys,U.Field=qt,U.FieldAngle=jt,U.FieldCheckbox=wr,U.FieldColour=Zi,U.FieldDropdown=Js,U.FieldImage=Cr,U.FieldLabel=Ir,U.FieldLabelSerializable=sS,U.FieldMultilineInput=N$,U.FieldNumber=L$,U.FieldTextInput=Vl,U.FieldVariable=ya,U.Flyout=pd,U.FlyoutButton=ws,U.FlyoutMetricsManager=oS,U.Generator=s.CodeGenerator$$module$build$src$core$generator,U.Gesture=Mo,U.Grid=Km,U.HorizontalFlyout=nS,U.INPUT_VALUE=PR,U.Input=Zs,U.InsertionMarkerManager=qi,U.Marker=PI,U.MarkerManager=aa,U.Menu=Nm,U.MenuItem=Lm,U.MetricsManager=E$,U.Msg=s.Msg$$module$build$src$core$msg,U.NEXT_STATEMENT=FR,U.Names=s.Names$$module$build$src$core$names,U.OPPOSITE_TYPE=_r,U.OUTPUT_VALUE=BR,U.Options=hs,U.PREVIOUS_STATEMENT=UR,U.PROCEDURE_CATEGORY_NAME=id,U.Procedures=Ii,U.RENAME_VARIABLE_ID=Vm,U.RenderedConnection=Si,U.Scrollbar=Ge,U.ScrollbarPair=b$,U.ShortcutItems=io,U.ShortcutRegistry=ae,U.TOOLBOX_AT_BOTTOM=GR,U.TOOLBOX_AT_LEFT=WR,U.TOOLBOX_AT_RIGHT=zR,U.TOOLBOX_AT_TOP=VR,U.TabNavigateCursor=BI,U.Theme=Er,U.ThemeManager=MI,U.Themes=NR,U.Toolbox=yS,U.ToolboxCategory=ks,U.ToolboxItem=D$,U.ToolboxSeparator=Sa,U.Tooltip=Yi,U.Touch=ar,U.Trashcan=UI,U.UnattachedFieldError=ye,U.VARIABLE_CATEGORY_NAME=_m,U.VARIABLE_DYNAMIC_CATEGORY_NAME=a$,U.VERSION=LR,U.VariableMap=d$,U.VariableModel=Qc,U.Variables=si,U.VariablesDynamic=Sr,U.VerticalFlyout=M$,U.WidgetDiv=Ks,U.Workspace=_a,U.WorkspaceAudio=DI,U.WorkspaceComment=Xs,U.WorkspaceCommentSvg=oi,U.WorkspaceDragger=mI,U.WorkspaceSvg=Ss,U.Xml=Di,U.ZoomControls=Wy,U.blockAnimations=ra,U.blockRendering=de,U.browserEvents=Ao,U.bubbles=Ea,U.bumpObjects=hd,U.clipboard=gr,U.common=ii,U.config=s.config$$module$build$src$core$config,U.connectionTypes=XR,U.constants=_R,U.defineBlocksWithJsonArray=$t,U.dialog=dr,U.fieldRegistry=Qu,U.geras=so,U.getMainWorkspace=A,U.getSelected=z,U.hasBubble=ln,U.hideChaff=_y,U.icons=Tn,U.inject=cy,U.inputTypes=s.inputTypes$$module$build$src$core$inputs$input_types,U.inputs=vn,U.isCopyable=Xc,U.isIcon=gy,U.isObservable=$u,U.isPaster=my,U.isSerializable=su,U.isVariableBackedParameterModel=nf,U.minimalist=Ia,U.procedures=Ii,U.registry=wo,U.renderManagement=Vu,U.serialization=kR,U.setLocale=mm,U.setParentContainer=Y,U.svgResize=V,U.thrasos=x$,U.uiPosition=ur,U.utils=De,U.zelos=Cs,Object.defineProperties(U,{HSV_SATURATION:{get:function(){return j("Blockly.HSV_SATURATION","version 10","version 11","Blockly.utils.colour.getHsvSaturation()"),du()},set:function(t){j("Blockly.HSV_SATURATION","version 10","version 11","Blockly.utils.colour.setHsvSaturation()"),ng(t)}},HSV_VALUE:{get:function(){return j("Blockly.HSV_VALUE","version 10","version 11","Blockly.utils.colour.getHsvValue()"),pu()},set:function(t){j("Blockly.HSV_VALUE","version 10","version 11","Blockly.utils.colour.setHsvValue()"),rg(t)}}}),"Blockly"in globalThis||(globalThis.Blockly={Msg:jy}),U.__namespace__=s,U})}(j$)),j$.exports}var rC;function sx(){return rC||(rC=1,function(n,e){(function(s,o){n.exports=o(kb())})(ps,function(s){/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */return s})}(K$)),K$.exports}var lC;function Ob(){return lC||(lC=1,function(n,e){(function(s,o){n.exports=o(sx())})(ps,function(s){return s})}(Y$)),Y$.exports}var J$={exports:{}},cC;function ox(){return cC||(cC=1,function(n,e){(function(s,o){n.exports=o()})(ps,function(){var s=s||{Msg:Object.create(null)};return s.Msg.ADD_COMMENT="Add Comment",s.Msg.CANNOT_DELETE_VARIABLE_PROCEDURE="Can't delete the variable '%1' because it's part of the definition of the function '%2'",s.Msg.CHANGE_VALUE_TITLE="Change value:",s.Msg.CLEAN_UP="Clean up Blocks",s.Msg.COLLAPSED_WARNINGS_WARNING="Collapsed blocks contain warnings.",s.Msg.COLLAPSE_ALL="Collapse Blocks",s.Msg.COLLAPSE_BLOCK="Collapse Block",s.Msg.COLOUR_BLEND_COLOUR1="colour 1",s.Msg.COLOUR_BLEND_COLOUR2="colour 2",s.Msg.COLOUR_BLEND_HELPURL="https://meyerweb.com/eric/tools/color-blend/#:::rgbp",s.Msg.COLOUR_BLEND_RATIO="ratio",s.Msg.COLOUR_BLEND_TITLE="blend",s.Msg.COLOUR_BLEND_TOOLTIP="Blends two colours together with a given ratio (0.0 - 1.0).",s.Msg.COLOUR_PICKER_HELPURL="https://en.wikipedia.org/wiki/Color",s.Msg.COLOUR_PICKER_TOOLTIP="Choose a colour from the palette.",s.Msg.COLOUR_RANDOM_HELPURL="http://randomcolour.com",s.Msg.COLOUR_RANDOM_TITLE="random colour",s.Msg.COLOUR_RANDOM_TOOLTIP="Choose a colour at random.",s.Msg.COLOUR_RGB_BLUE="blue",s.Msg.COLOUR_RGB_GREEN="green",s.Msg.COLOUR_RGB_HELPURL="https://www.december.com/html/spec/colorpercompact.html",s.Msg.COLOUR_RGB_RED="red",s.Msg.COLOUR_RGB_TITLE="colour with",s.Msg.COLOUR_RGB_TOOLTIP="Create a colour with the specified amount of red, green, and blue. All values must be between 0 and 100.",s.Msg.CONTROLS_FLOW_STATEMENTS_HELPURL="https://github.com/google/blockly/wiki/Loops#loop-termination-blocks",s.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK="break out of loop",s.Msg.CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE="continue with next iteration of loop",s.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK="Break out of the containing loop.",s.Msg.CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE="Skip the rest of this loop, and continue with the next iteration.",s.Msg.CONTROLS_FLOW_STATEMENTS_WARNING="Warning: This block may only be used within a loop.",s.Msg.CONTROLS_FOREACH_HELPURL="https://github.com/google/blockly/wiki/Loops#for-each",s.Msg.CONTROLS_FOREACH_TITLE="for each item %1 in list %2",s.Msg.CONTROLS_FOREACH_TOOLTIP="For each item in a list, set the variable '%1' to the item, and then do some statements.",s.Msg.CONTROLS_FOR_HELPURL="https://github.com/google/blockly/wiki/Loops#count-with",s.Msg.CONTROLS_FOR_TITLE="count with %1 from %2 to %3 by %4",s.Msg.CONTROLS_FOR_TOOLTIP="Have the variable '%1' take on the values from the start number to the end number, counting by the specified interval, and do the specified blocks.",s.Msg.CONTROLS_IF_ELSEIF_TOOLTIP="Add a condition to the if block.",s.Msg.CONTROLS_IF_ELSE_TOOLTIP="Add a final, catch-all condition to the if block.",s.Msg.CONTROLS_IF_HELPURL="https://github.com/google/blockly/wiki/IfElse",s.Msg.CONTROLS_IF_IF_TOOLTIP="Add, remove, or reorder sections to reconfigure this if block.",s.Msg.CONTROLS_IF_MSG_ELSE="else",s.Msg.CONTROLS_IF_MSG_ELSEIF="else if",s.Msg.CONTROLS_IF_MSG_IF="if",s.Msg.CONTROLS_IF_TOOLTIP_1="If a value is true, then do some statements.",s.Msg.CONTROLS_IF_TOOLTIP_2="If a value is true, then do the first block of statements. Otherwise, do the second block of statements.",s.Msg.CONTROLS_IF_TOOLTIP_3="If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements.",s.Msg.CONTROLS_IF_TOOLTIP_4="If the first value is true, then do the first block of statements. Otherwise, if the second value is true, do the second block of statements. If none of the values are true, do the last block of statements.",s.Msg.CONTROLS_REPEAT_HELPURL="https://en.wikipedia.org/wiki/For_loop",s.Msg.CONTROLS_REPEAT_INPUT_DO="do",s.Msg.CONTROLS_REPEAT_TITLE="repeat %1 times",s.Msg.CONTROLS_REPEAT_TOOLTIP="Do some statements several times.",s.Msg.CONTROLS_WHILEUNTIL_HELPURL="https://github.com/google/blockly/wiki/Loops#repeat",s.Msg.CONTROLS_WHILEUNTIL_OPERATOR_UNTIL="repeat until",s.Msg.CONTROLS_WHILEUNTIL_OPERATOR_WHILE="repeat while",s.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL="While a value is false, then do some statements.",s.Msg.CONTROLS_WHILEUNTIL_TOOLTIP_WHILE="While a value is true, then do some statements.",s.Msg.DELETE_ALL_BLOCKS="Delete all %1 blocks?",s.Msg.DELETE_BLOCK="Delete Block",s.Msg.DELETE_VARIABLE="Delete the '%1' variable",s.Msg.DELETE_VARIABLE_CONFIRMATION="Delete %1 uses of the '%2' variable?",s.Msg.DELETE_X_BLOCKS="Delete %1 Blocks",s.Msg.DIALOG_CANCEL="Cancel",s.Msg.DIALOG_OK="OK",s.Msg.DISABLE_BLOCK="Disable Block",s.Msg.DUPLICATE_BLOCK="Duplicate",s.Msg.DUPLICATE_COMMENT="Duplicate Comment",s.Msg.ENABLE_BLOCK="Enable Block",s.Msg.EXPAND_ALL="Expand Blocks",s.Msg.EXPAND_BLOCK="Expand Block",s.Msg.EXTERNAL_INPUTS="External Inputs",s.Msg.HELP="Help",s.Msg.INLINE_INPUTS="Inline Inputs",s.Msg.LISTS_CREATE_EMPTY_HELPURL="https://github.com/google/blockly/wiki/Lists#create-empty-list",s.Msg.LISTS_CREATE_EMPTY_TITLE="create empty list",s.Msg.LISTS_CREATE_EMPTY_TOOLTIP="Returns a list, of length 0, containing no data records",s.Msg.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD="list",s.Msg.LISTS_CREATE_WITH_CONTAINER_TOOLTIP="Add, remove, or reorder sections to reconfigure this list block.",s.Msg.LISTS_CREATE_WITH_HELPURL="https://github.com/google/blockly/wiki/Lists#create-list-with",s.Msg.LISTS_CREATE_WITH_INPUT_WITH="create list with",s.Msg.LISTS_CREATE_WITH_ITEM_TOOLTIP="Add an item to the list.",s.Msg.LISTS_CREATE_WITH_TOOLTIP="Create a list with any number of items.",s.Msg.LISTS_GET_INDEX_FIRST="first",s.Msg.LISTS_GET_INDEX_FROM_END="# from end",s.Msg.LISTS_GET_INDEX_FROM_START="#",s.Msg.LISTS_GET_INDEX_GET="get",s.Msg.LISTS_GET_INDEX_GET_REMOVE="get and remove",s.Msg.LISTS_GET_INDEX_LAST="last",s.Msg.LISTS_GET_INDEX_RANDOM="random",s.Msg.LISTS_GET_INDEX_REMOVE="remove",s.Msg.LISTS_GET_INDEX_TAIL="",s.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FIRST="Returns the first item in a list.",s.Msg.LISTS_GET_INDEX_TOOLTIP_GET_FROM="Returns the item at the specified position in a list.",s.Msg.LISTS_GET_INDEX_TOOLTIP_GET_LAST="Returns the last item in a list.",s.Msg.LISTS_GET_INDEX_TOOLTIP_GET_RANDOM="Returns a random item in a list.",s.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST="Removes and returns the first item in a list.",s.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM="Removes and returns the item at the specified position in a list.",s.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST="Removes and returns the last item in a list.",s.Msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM="Removes and returns a random item in a list.",s.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST="Removes the first item in a list.",s.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM="Removes the item at the specified position in a list.",s.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST="Removes the last item in a list.",s.Msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM="Removes a random item in a list.",s.Msg.LISTS_GET_SUBLIST_END_FROM_END="to # from end",s.Msg.LISTS_GET_SUBLIST_END_FROM_START="to #",s.Msg.LISTS_GET_SUBLIST_END_LAST="to last",s.Msg.LISTS_GET_SUBLIST_HELPURL="https://github.com/google/blockly/wiki/Lists#getting-a-sublist",s.Msg.LISTS_GET_SUBLIST_START_FIRST="get sub-list from first",s.Msg.LISTS_GET_SUBLIST_START_FROM_END="get sub-list from # from end",s.Msg.LISTS_GET_SUBLIST_START_FROM_START="get sub-list from #",s.Msg.LISTS_GET_SUBLIST_TAIL="",s.Msg.LISTS_GET_SUBLIST_TOOLTIP="Creates a copy of the specified portion of a list.",s.Msg.LISTS_INDEX_FROM_END_TOOLTIP="%1 is the last item.",s.Msg.LISTS_INDEX_FROM_START_TOOLTIP="%1 is the first item.",s.Msg.LISTS_INDEX_OF_FIRST="find first occurrence of item",s.Msg.LISTS_INDEX_OF_HELPURL="https://github.com/google/blockly/wiki/Lists#getting-items-from-a-list",s.Msg.LISTS_INDEX_OF_LAST="find last occurrence of item",s.Msg.LISTS_INDEX_OF_TOOLTIP="Returns the index of the first/last occurrence of the item in the list. Returns %1 if item is not found.",s.Msg.LISTS_INLIST="in list",s.Msg.LISTS_ISEMPTY_HELPURL="https://github.com/google/blockly/wiki/Lists#is-empty",s.Msg.LISTS_ISEMPTY_TITLE="%1 is empty",s.Msg.LISTS_ISEMPTY_TOOLTIP="Returns true if the list is empty.",s.Msg.LISTS_LENGTH_HELPURL="https://github.com/google/blockly/wiki/Lists#length-of",s.Msg.LISTS_LENGTH_TITLE="length of %1",s.Msg.LISTS_LENGTH_TOOLTIP="Returns the length of a list.",s.Msg.LISTS_REPEAT_HELPURL="https://github.com/google/blockly/wiki/Lists#create-list-with",s.Msg.LISTS_REPEAT_TITLE="create list with item %1 repeated %2 times",s.Msg.LISTS_REPEAT_TOOLTIP="Creates a list consisting of the given value repeated the specified number of times.",s.Msg.LISTS_REVERSE_HELPURL="https://github.com/google/blockly/wiki/Lists#reversing-a-list",s.Msg.LISTS_REVERSE_MESSAGE0="reverse %1",s.Msg.LISTS_REVERSE_TOOLTIP="Reverse a copy of a list.",s.Msg.LISTS_SET_INDEX_HELPURL="https://github.com/google/blockly/wiki/Lists#in-list--set",s.Msg.LISTS_SET_INDEX_INPUT_TO="as",s.Msg.LISTS_SET_INDEX_INSERT="insert at",s.Msg.LISTS_SET_INDEX_SET="set",s.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST="Inserts the item at the start of a list.",s.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FROM="Inserts the item at the specified position in a list.",s.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_LAST="Append the item to the end of a list.",s.Msg.LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM="Inserts the item randomly in a list.",s.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FIRST="Sets the first item in a list.",s.Msg.LISTS_SET_INDEX_TOOLTIP_SET_FROM="Sets the item at the specified position in a list.",s.Msg.LISTS_SET_INDEX_TOOLTIP_SET_LAST="Sets the last item in a list.",s.Msg.LISTS_SET_INDEX_TOOLTIP_SET_RANDOM="Sets a random item in a list.",s.Msg.LISTS_SORT_HELPURL="https://github.com/google/blockly/wiki/Lists#sorting-a-list",s.Msg.LISTS_SORT_ORDER_ASCENDING="ascending",s.Msg.LISTS_SORT_ORDER_DESCENDING="descending",s.Msg.LISTS_SORT_TITLE="sort %1 %2 %3",s.Msg.LISTS_SORT_TOOLTIP="Sort a copy of a list.",s.Msg.LISTS_SORT_TYPE_IGNORECASE="alphabetic, ignore case",s.Msg.LISTS_SORT_TYPE_NUMERIC="numeric",s.Msg.LISTS_SORT_TYPE_TEXT="alphabetic",s.Msg.LISTS_SPLIT_HELPURL="https://github.com/google/blockly/wiki/Lists#splitting-strings-and-joining-lists",s.Msg.LISTS_SPLIT_LIST_FROM_TEXT="make list from text",s.Msg.LISTS_SPLIT_TEXT_FROM_LIST="make text from list",s.Msg.LISTS_SPLIT_TOOLTIP_JOIN="Join a list of texts into one text, separated by a delimiter.",s.Msg.LISTS_SPLIT_TOOLTIP_SPLIT="Split text into a list of texts, breaking at each delimiter.",s.Msg.LISTS_SPLIT_WITH_DELIMITER="with delimiter",s.Msg.LOGIC_BOOLEAN_FALSE="false",s.Msg.LOGIC_BOOLEAN_HELPURL="https://github.com/google/blockly/wiki/Logic#values",s.Msg.LOGIC_BOOLEAN_TOOLTIP="Returns either true or false.",s.Msg.LOGIC_BOOLEAN_TRUE="true",s.Msg.LOGIC_COMPARE_HELPURL="https://en.wikipedia.org/wiki/Inequality_(mathematics)",s.Msg.LOGIC_COMPARE_TOOLTIP_EQ="Return true if both inputs equal each other.",s.Msg.LOGIC_COMPARE_TOOLTIP_GT="Return true if the first input is greater than the second input.",s.Msg.LOGIC_COMPARE_TOOLTIP_GTE="Return true if the first input is greater than or equal to the second input.",s.Msg.LOGIC_COMPARE_TOOLTIP_LT="Return true if the first input is smaller than the second input.",s.Msg.LOGIC_COMPARE_TOOLTIP_LTE="Return true if the first input is smaller than or equal to the second input.",s.Msg.LOGIC_COMPARE_TOOLTIP_NEQ="Return true if both inputs are not equal to each other.",s.Msg.LOGIC_NEGATE_HELPURL="https://github.com/google/blockly/wiki/Logic#not",s.Msg.LOGIC_NEGATE_TITLE="not %1",s.Msg.LOGIC_NEGATE_TOOLTIP="Returns true if the input is false. Returns false if the input is true.",s.Msg.LOGIC_NULL="null",s.Msg.LOGIC_NULL_HELPURL="https://en.wikipedia.org/wiki/Nullable_type",s.Msg.LOGIC_NULL_TOOLTIP="Returns null.",s.Msg.LOGIC_OPERATION_AND="and",s.Msg.LOGIC_OPERATION_HELPURL="https://github.com/google/blockly/wiki/Logic#logical-operations",s.Msg.LOGIC_OPERATION_OR="or",s.Msg.LOGIC_OPERATION_TOOLTIP_AND="Return true if both inputs are true.",s.Msg.LOGIC_OPERATION_TOOLTIP_OR="Return true if at least one of the inputs is true.",s.Msg.LOGIC_TERNARY_CONDITION="test",s.Msg.LOGIC_TERNARY_HELPURL="https://en.wikipedia.org/wiki/%3F:",s.Msg.LOGIC_TERNARY_IF_FALSE="if false",s.Msg.LOGIC_TERNARY_IF_TRUE="if true",s.Msg.LOGIC_TERNARY_TOOLTIP="Check the condition in 'test'. If the condition is true, returns the 'if true' value; otherwise returns the 'if false' value.",s.Msg.MATH_ADDITION_SYMBOL="+",s.Msg.MATH_ARITHMETIC_HELPURL="https://en.wikipedia.org/wiki/Arithmetic",s.Msg.MATH_ARITHMETIC_TOOLTIP_ADD="Return the sum of the two numbers.",s.Msg.MATH_ARITHMETIC_TOOLTIP_DIVIDE="Return the quotient of the two numbers.",s.Msg.MATH_ARITHMETIC_TOOLTIP_MINUS="Return the difference of the two numbers.",s.Msg.MATH_ARITHMETIC_TOOLTIP_MULTIPLY="Return the product of the two numbers.",s.Msg.MATH_ARITHMETIC_TOOLTIP_POWER="Return the first number raised to the power of the second number.",s.Msg.MATH_ATAN2_HELPURL="https://en.wikipedia.org/wiki/Atan2",s.Msg.MATH_ATAN2_TITLE="atan2 of X:%1 Y:%2",s.Msg.MATH_ATAN2_TOOLTIP="Return the arctangent of point (X, Y) in degrees from -180 to 180.",s.Msg.MATH_CHANGE_HELPURL="https://en.wikipedia.org/wiki/Programming_idiom#Incrementing_a_counter",s.Msg.MATH_CHANGE_TITLE="change %1 by %2",s.Msg.MATH_CHANGE_TOOLTIP="Add a number to variable '%1'.",s.Msg.MATH_CONSTANT_HELPURL="https://en.wikipedia.org/wiki/Mathematical_constant",s.Msg.MATH_CONSTANT_TOOLTIP="Return one of the common constants:  (3.141), e (2.718),  (1.618), sqrt(2) (1.414), sqrt() (0.707), or  (infinity).",s.Msg.MATH_CONSTRAIN_HELPURL="https://en.wikipedia.org/wiki/Clamping_(graphics)",s.Msg.MATH_CONSTRAIN_TITLE="constrain %1 low %2 high %3",s.Msg.MATH_CONSTRAIN_TOOLTIP="Constrain a number to be between the specified limits (inclusive).",s.Msg.MATH_DIVISION_SYMBOL="",s.Msg.MATH_IS_DIVISIBLE_BY="is divisible by",s.Msg.MATH_IS_EVEN="is even",s.Msg.MATH_IS_NEGATIVE="is negative",s.Msg.MATH_IS_ODD="is odd",s.Msg.MATH_IS_POSITIVE="is positive",s.Msg.MATH_IS_PRIME="is prime",s.Msg.MATH_IS_TOOLTIP="Check if a number is an even, odd, prime, whole, positive, negative, or if it is divisible by certain number. Returns true or false.",s.Msg.MATH_IS_WHOLE="is whole",s.Msg.MATH_MODULO_HELPURL="https://en.wikipedia.org/wiki/Modulo_operation",s.Msg.MATH_MODULO_TITLE="remainder of %1  %2",s.Msg.MATH_MODULO_TOOLTIP="Return the remainder from dividing the two numbers.",s.Msg.MATH_MULTIPLICATION_SYMBOL="",s.Msg.MATH_NUMBER_HELPURL="https://en.wikipedia.org/wiki/Number",s.Msg.MATH_NUMBER_TOOLTIP="A number.",s.Msg.MATH_ONLIST_HELPURL="",s.Msg.MATH_ONLIST_OPERATOR_AVERAGE="average of list",s.Msg.MATH_ONLIST_OPERATOR_MAX="max of list",s.Msg.MATH_ONLIST_OPERATOR_MEDIAN="median of list",s.Msg.MATH_ONLIST_OPERATOR_MIN="min of list",s.Msg.MATH_ONLIST_OPERATOR_MODE="modes of list",s.Msg.MATH_ONLIST_OPERATOR_RANDOM="random item of list",s.Msg.MATH_ONLIST_OPERATOR_STD_DEV="standard deviation of list",s.Msg.MATH_ONLIST_OPERATOR_SUM="sum of list",s.Msg.MATH_ONLIST_TOOLTIP_AVERAGE="Return the average (arithmetic mean) of the numeric values in the list.",s.Msg.MATH_ONLIST_TOOLTIP_MAX="Return the largest number in the list.",s.Msg.MATH_ONLIST_TOOLTIP_MEDIAN="Return the median number in the list.",s.Msg.MATH_ONLIST_TOOLTIP_MIN="Return the smallest number in the list.",s.Msg.MATH_ONLIST_TOOLTIP_MODE="Return a list of the most common item(s) in the list.",s.Msg.MATH_ONLIST_TOOLTIP_RANDOM="Return a random element from the list.",s.Msg.MATH_ONLIST_TOOLTIP_STD_DEV="Return the standard deviation of the list.",s.Msg.MATH_ONLIST_TOOLTIP_SUM="Return the sum of all the numbers in the list.",s.Msg.MATH_POWER_SYMBOL="^",s.Msg.MATH_RANDOM_FLOAT_HELPURL="https://en.wikipedia.org/wiki/Random_number_generation",s.Msg.MATH_RANDOM_FLOAT_TITLE_RANDOM="random fraction",s.Msg.MATH_RANDOM_FLOAT_TOOLTIP="Return a random fraction between 0.0 (inclusive) and 1.0 (exclusive).",s.Msg.MATH_RANDOM_INT_HELPURL="https://en.wikipedia.org/wiki/Random_number_generation",s.Msg.MATH_RANDOM_INT_TITLE="random integer from %1 to %2",s.Msg.MATH_RANDOM_INT_TOOLTIP="Return a random integer between the two specified limits, inclusive.",s.Msg.MATH_ROUND_HELPURL="https://en.wikipedia.org/wiki/Rounding",s.Msg.MATH_ROUND_OPERATOR_ROUND="round",s.Msg.MATH_ROUND_OPERATOR_ROUNDDOWN="round down",s.Msg.MATH_ROUND_OPERATOR_ROUNDUP="round up",s.Msg.MATH_ROUND_TOOLTIP="Round a number up or down.",s.Msg.MATH_SINGLE_HELPURL="https://en.wikipedia.org/wiki/Square_root",s.Msg.MATH_SINGLE_OP_ABSOLUTE="absolute",s.Msg.MATH_SINGLE_OP_ROOT="square root",s.Msg.MATH_SINGLE_TOOLTIP_ABS="Return the absolute value of a number.",s.Msg.MATH_SINGLE_TOOLTIP_EXP="Return e to the power of a number.",s.Msg.MATH_SINGLE_TOOLTIP_LN="Return the natural logarithm of a number.",s.Msg.MATH_SINGLE_TOOLTIP_LOG10="Return the base 10 logarithm of a number.",s.Msg.MATH_SINGLE_TOOLTIP_NEG="Return the negation of a number.",s.Msg.MATH_SINGLE_TOOLTIP_POW10="Return 10 to the power of a number.",s.Msg.MATH_SINGLE_TOOLTIP_ROOT="Return the square root of a number.",s.Msg.MATH_SUBTRACTION_SYMBOL="-",s.Msg.MATH_TRIG_ACOS="acos",s.Msg.MATH_TRIG_ASIN="asin",s.Msg.MATH_TRIG_ATAN="atan",s.Msg.MATH_TRIG_COS="cos",s.Msg.MATH_TRIG_HELPURL="https://en.wikipedia.org/wiki/Trigonometric_functions",s.Msg.MATH_TRIG_SIN="sin",s.Msg.MATH_TRIG_TAN="tan",s.Msg.MATH_TRIG_TOOLTIP_ACOS="Return the arccosine of a number.",s.Msg.MATH_TRIG_TOOLTIP_ASIN="Return the arcsine of a number.",s.Msg.MATH_TRIG_TOOLTIP_ATAN="Return the arctangent of a number.",s.Msg.MATH_TRIG_TOOLTIP_COS="Return the cosine of a degree (not radian).",s.Msg.MATH_TRIG_TOOLTIP_SIN="Return the sine of a degree (not radian).",s.Msg.MATH_TRIG_TOOLTIP_TAN="Return the tangent of a degree (not radian).",s.Msg.NEW_COLOUR_VARIABLE="Create colour variable...",s.Msg.NEW_NUMBER_VARIABLE="Create number variable...",s.Msg.NEW_STRING_VARIABLE="Create string variable...",s.Msg.NEW_VARIABLE="Create variable...",s.Msg.NEW_VARIABLE_TITLE="New variable name:",s.Msg.NEW_VARIABLE_TYPE_TITLE="New variable type:",s.Msg.ORDINAL_NUMBER_SUFFIX="",s.Msg.PROCEDURES_ALLOW_STATEMENTS="allow statements",s.Msg.PROCEDURES_BEFORE_PARAMS="with:",s.Msg.PROCEDURES_CALLNORETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",s.Msg.PROCEDURES_CALLNORETURN_TOOLTIP="Run the user-defined function '%1'.",s.Msg.PROCEDURES_CALLRETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",s.Msg.PROCEDURES_CALLRETURN_TOOLTIP="Run the user-defined function '%1' and use its output.",s.Msg.PROCEDURES_CALL_BEFORE_PARAMS="with:",s.Msg.PROCEDURES_CREATE_DO="Create '%1'",s.Msg.PROCEDURES_DEFNORETURN_COMMENT="Describe this function...",s.Msg.PROCEDURES_DEFNORETURN_DO="",s.Msg.PROCEDURES_DEFNORETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",s.Msg.PROCEDURES_DEFNORETURN_PROCEDURE="do something",s.Msg.PROCEDURES_DEFNORETURN_TITLE="to",s.Msg.PROCEDURES_DEFNORETURN_TOOLTIP="Creates a function with no output.",s.Msg.PROCEDURES_DEFRETURN_HELPURL="https://en.wikipedia.org/wiki/Subroutine",s.Msg.PROCEDURES_DEFRETURN_RETURN="return",s.Msg.PROCEDURES_DEFRETURN_TOOLTIP="Creates a function with an output.",s.Msg.PROCEDURES_DEF_DUPLICATE_WARNING="Warning: This function has duplicate parameters.",s.Msg.PROCEDURES_HIGHLIGHT_DEF="Highlight function definition",s.Msg.PROCEDURES_IFRETURN_HELPURL="https://c2.com/cgi/wiki?GuardClause",s.Msg.PROCEDURES_IFRETURN_TOOLTIP="If a value is true, then return a second value.",s.Msg.PROCEDURES_IFRETURN_WARNING="Warning: This block may be used only within a function definition.",s.Msg.PROCEDURES_MUTATORARG_TITLE="input name:",s.Msg.PROCEDURES_MUTATORARG_TOOLTIP="Add an input to the function.",s.Msg.PROCEDURES_MUTATORCONTAINER_TITLE="inputs",s.Msg.PROCEDURES_MUTATORCONTAINER_TOOLTIP="Add, remove, or reorder inputs to this function.",s.Msg.REDO="Redo",s.Msg.REMOVE_COMMENT="Remove Comment",s.Msg.RENAME_VARIABLE="Rename variable...",s.Msg.RENAME_VARIABLE_TITLE="Rename all '%1' variables to:",s.Msg.TEXT_APPEND_HELPURL="https://github.com/google/blockly/wiki/Text#text-modification",s.Msg.TEXT_APPEND_TITLE="to %1 append text %2",s.Msg.TEXT_APPEND_TOOLTIP="Append some text to variable '%1'.",s.Msg.TEXT_CHANGECASE_HELPURL="https://github.com/google/blockly/wiki/Text#adjusting-text-case",s.Msg.TEXT_CHANGECASE_OPERATOR_LOWERCASE="to lower case",s.Msg.TEXT_CHANGECASE_OPERATOR_TITLECASE="to Title Case",s.Msg.TEXT_CHANGECASE_OPERATOR_UPPERCASE="to UPPER CASE",s.Msg.TEXT_CHANGECASE_TOOLTIP="Return a copy of the text in a different case.",s.Msg.TEXT_CHARAT_FIRST="get first letter",s.Msg.TEXT_CHARAT_FROM_END="get letter # from end",s.Msg.TEXT_CHARAT_FROM_START="get letter #",s.Msg.TEXT_CHARAT_HELPURL="https://github.com/google/blockly/wiki/Text#extracting-text",s.Msg.TEXT_CHARAT_LAST="get last letter",s.Msg.TEXT_CHARAT_RANDOM="get random letter",s.Msg.TEXT_CHARAT_TAIL="",s.Msg.TEXT_CHARAT_TITLE="in text %1 %2",s.Msg.TEXT_CHARAT_TOOLTIP="Returns the letter at the specified position.",s.Msg.TEXT_COUNT_HELPURL="https://github.com/google/blockly/wiki/Text#counting-substrings",s.Msg.TEXT_COUNT_MESSAGE0="count %1 in %2",s.Msg.TEXT_COUNT_TOOLTIP="Count how many times some text occurs within some other text.",s.Msg.TEXT_CREATE_JOIN_ITEM_TOOLTIP="Add an item to the text.",s.Msg.TEXT_CREATE_JOIN_TITLE_JOIN="join",s.Msg.TEXT_CREATE_JOIN_TOOLTIP="Add, remove, or reorder sections to reconfigure this text block.",s.Msg.TEXT_GET_SUBSTRING_END_FROM_END="to letter # from end",s.Msg.TEXT_GET_SUBSTRING_END_FROM_START="to letter #",s.Msg.TEXT_GET_SUBSTRING_END_LAST="to last letter",s.Msg.TEXT_GET_SUBSTRING_HELPURL="https://github.com/google/blockly/wiki/Text#extracting-a-region-of-text",s.Msg.TEXT_GET_SUBSTRING_INPUT_IN_TEXT="in text",s.Msg.TEXT_GET_SUBSTRING_START_FIRST="get substring from first letter",s.Msg.TEXT_GET_SUBSTRING_START_FROM_END="get substring from letter # from end",s.Msg.TEXT_GET_SUBSTRING_START_FROM_START="get substring from letter #",s.Msg.TEXT_GET_SUBSTRING_TAIL="",s.Msg.TEXT_GET_SUBSTRING_TOOLTIP="Returns a specified portion of the text.",s.Msg.TEXT_INDEXOF_HELPURL="https://github.com/google/blockly/wiki/Text#finding-text",s.Msg.TEXT_INDEXOF_OPERATOR_FIRST="find first occurrence of text",s.Msg.TEXT_INDEXOF_OPERATOR_LAST="find last occurrence of text",s.Msg.TEXT_INDEXOF_TITLE="in text %1 %2 %3",s.Msg.TEXT_INDEXOF_TOOLTIP="Returns the index of the first/last occurrence of the first text in the second text. Returns %1 if text is not found.",s.Msg.TEXT_ISEMPTY_HELPURL="https://github.com/google/blockly/wiki/Text#checking-for-empty-text",s.Msg.TEXT_ISEMPTY_TITLE="%1 is empty",s.Msg.TEXT_ISEMPTY_TOOLTIP="Returns true if the provided text is empty.",s.Msg.TEXT_JOIN_HELPURL="https://github.com/google/blockly/wiki/Text#text-creation",s.Msg.TEXT_JOIN_TITLE_CREATEWITH="create text with",s.Msg.TEXT_JOIN_TOOLTIP="Create a piece of text by joining together any number of items.",s.Msg.TEXT_LENGTH_HELPURL="https://github.com/google/blockly/wiki/Text#text-modification",s.Msg.TEXT_LENGTH_TITLE="length of %1",s.Msg.TEXT_LENGTH_TOOLTIP="Returns the number of letters (including spaces) in the provided text.",s.Msg.TEXT_PRINT_HELPURL="https://github.com/google/blockly/wiki/Text#printing-text",s.Msg.TEXT_PRINT_TITLE="print %1",s.Msg.TEXT_PRINT_TOOLTIP="Print the specified text, number or other value.",s.Msg.TEXT_PROMPT_HELPURL="https://github.com/google/blockly/wiki/Text#getting-input-from-the-user",s.Msg.TEXT_PROMPT_TOOLTIP_NUMBER="Prompt for user for a number.",s.Msg.TEXT_PROMPT_TOOLTIP_TEXT="Prompt for user for some text.",s.Msg.TEXT_PROMPT_TYPE_NUMBER="prompt for number with message",s.Msg.TEXT_PROMPT_TYPE_TEXT="prompt for text with message",s.Msg.TEXT_REPLACE_HELPURL="https://github.com/google/blockly/wiki/Text#replacing-substrings",s.Msg.TEXT_REPLACE_MESSAGE0="replace %1 with %2 in %3",s.Msg.TEXT_REPLACE_TOOLTIP="Replace all occurances of some text within some other text.",s.Msg.TEXT_REVERSE_HELPURL="https://github.com/google/blockly/wiki/Text#reversing-text",s.Msg.TEXT_REVERSE_MESSAGE0="reverse %1",s.Msg.TEXT_REVERSE_TOOLTIP="Reverses the order of the characters in the text.",s.Msg.TEXT_TEXT_HELPURL="https://en.wikipedia.org/wiki/String_(computer_science)",s.Msg.TEXT_TEXT_TOOLTIP="A letter, word, or line of text.",s.Msg.TEXT_TRIM_HELPURL="https://github.com/google/blockly/wiki/Text#trimming-removing-spaces",s.Msg.TEXT_TRIM_OPERATOR_BOTH="trim spaces from both sides of",s.Msg.TEXT_TRIM_OPERATOR_LEFT="trim spaces from left side of",s.Msg.TEXT_TRIM_OPERATOR_RIGHT="trim spaces from right side of",s.Msg.TEXT_TRIM_TOOLTIP="Return a copy of the text with spaces removed from one or both ends.",s.Msg.TODAY="Today",s.Msg.UNDO="Undo",s.Msg.UNNAMED_KEY="unnamed",s.Msg.VARIABLES_DEFAULT_NAME="item",s.Msg.VARIABLES_GET_CREATE_SET="Create 'set %1'",s.Msg.VARIABLES_GET_HELPURL="https://github.com/google/blockly/wiki/Variables#get",s.Msg.VARIABLES_GET_TOOLTIP="Returns the value of this variable.",s.Msg.VARIABLES_SET="set %1 to %2",s.Msg.VARIABLES_SET_CREATE_GET="Create 'get %1'",s.Msg.VARIABLES_SET_HELPURL="https://github.com/google/blockly/wiki/Variables#set",s.Msg.VARIABLES_SET_TOOLTIP="Sets this variable to be equal to the input.",s.Msg.VARIABLE_ALREADY_EXISTS="A variable named '%1' already exists.",s.Msg.VARIABLE_ALREADY_EXISTS_FOR_ANOTHER_TYPE="A variable named '%1' already exists for another type: '%2'.",s.Msg.WORKSPACE_ARIA_LABEL="Blockly Workspace",s.Msg.WORKSPACE_COMMENT_DEFAULT_TEXT="Say something...",s.Msg.CONTROLS_FOREACH_INPUT_DO=s.Msg.CONTROLS_REPEAT_INPUT_DO,s.Msg.CONTROLS_FOR_INPUT_DO=s.Msg.CONTROLS_REPEAT_INPUT_DO,s.Msg.CONTROLS_IF_ELSEIF_TITLE_ELSEIF=s.Msg.CONTROLS_IF_MSG_ELSEIF,s.Msg.CONTROLS_IF_ELSE_TITLE_ELSE=s.Msg.CONTROLS_IF_MSG_ELSE,s.Msg.CONTROLS_IF_IF_TITLE_IF=s.Msg.CONTROLS_IF_MSG_IF,s.Msg.CONTROLS_IF_MSG_THEN=s.Msg.CONTROLS_REPEAT_INPUT_DO,s.Msg.CONTROLS_WHILEUNTIL_INPUT_DO=s.Msg.CONTROLS_REPEAT_INPUT_DO,s.Msg.LISTS_CREATE_WITH_ITEM_TITLE=s.Msg.VARIABLES_DEFAULT_NAME,s.Msg.LISTS_GET_INDEX_HELPURL=s.Msg.LISTS_INDEX_OF_HELPURL,s.Msg.LISTS_GET_INDEX_INPUT_IN_LIST=s.Msg.LISTS_INLIST,s.Msg.LISTS_GET_SUBLIST_INPUT_IN_LIST=s.Msg.LISTS_INLIST,s.Msg.LISTS_INDEX_OF_INPUT_IN_LIST=s.Msg.LISTS_INLIST,s.Msg.LISTS_SET_INDEX_INPUT_IN_LIST=s.Msg.LISTS_INLIST,s.Msg.MATH_CHANGE_TITLE_ITEM=s.Msg.VARIABLES_DEFAULT_NAME,s.Msg.PROCEDURES_DEFRETURN_COMMENT=s.Msg.PROCEDURES_DEFNORETURN_COMMENT,s.Msg.PROCEDURES_DEFRETURN_DO=s.Msg.PROCEDURES_DEFNORETURN_DO,s.Msg.PROCEDURES_DEFRETURN_PROCEDURE=s.Msg.PROCEDURES_DEFNORETURN_PROCEDURE,s.Msg.PROCEDURES_DEFRETURN_TITLE=s.Msg.PROCEDURES_DEFNORETURN_TITLE,s.Msg.TEXT_APPEND_VARIABLE=s.Msg.VARIABLES_DEFAULT_NAME,s.Msg.TEXT_CREATE_JOIN_ITEM_TITLE_ITEM=s.Msg.VARIABLES_DEFAULT_NAME,s.Msg.MATH_HUE="230",s.Msg.LOOPS_HUE="120",s.Msg.LISTS_HUE="260",s.Msg.LOGIC_HUE="210",s.Msg.VARIABLES_HUE="330",s.Msg.TEXTS_HUE="160",s.Msg.PROCEDURES_HUE="290",s.Msg.COLOUR_HUE="20",s.Msg.VARIABLES_DYNAMIC_HUE="310",s.Msg})}(J$)),J$.exports}var q$={exports:{}},Z$={exports:{}},aC;function nx(){return aC||(aC=1,function(n,e){(function(s,o){n.exports=o(kb())})(ps,function(s){var o=s.__namespace__,l=o.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"variables_get_dynamic",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"}],output:null,style:"variable_dynamic_blocks",helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableDynamicSetterGetter"]},{type:"variables_set_dynamic",message0:"%{BKY_VARIABLES_SET}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"},{type:"input_value",name:"VALUE"}],previousStatement:null,nextStatement:null,style:"variable_dynamic_blocks",tooltip:"%{BKY_VARIABLES_SET_TOOLTIP}",helpUrl:"%{BKY_VARIABLES_SET_HELPURL}",extensions:["contextMenu_variableDynamicSetterGetter"]}]),a={customContextMenu:function(_){if(this.isInFlyout)(this.type==="variables_get_dynamic"||this.type==="variables_get_reporter_dynamic")&&(M={text:o.Msg$$module$build$src$core$msg.RENAME_VARIABLE,enabled:!0,callback:h(this)},P=this.getField("VAR").getText(),P={text:o.Msg$$module$build$src$core$msg.DELETE_VARIABLE.replace("%1",P),enabled:!0,callback:d(this)},_.unshift(M),_.unshift(P));else{if(this.type==="variables_get_dynamic")var I="variables_set_dynamic",M=o.Msg$$module$build$src$core$msg.VARIABLES_GET_CREATE_SET;else I="variables_get_dynamic",M=o.Msg$$module$build$src$core$msg.VARIABLES_SET_CREATE_GET;var P=this.getField("VAR");I={type:I,fields:{VAR:P.saveState(!0)}},_.push({enabled:0<this.workspace.remainingCapacity(),text:M.replace("%1",P.getText()),callback:o.callbackFactory$$module$build$src$core$contextmenu(this,I)})}},onchange:function(_){_=this.getFieldValue("VAR"),_=o.getVariable$$module$build$src$core$variables(this.workspace,_),this.type==="variables_get_dynamic"?this.outputConnection.setCheck(_.type):this.getInput("VALUE").connection.setCheck(_.type)}},h=function(_){return function(){const I=_.workspace,M=_.getField("VAR").getVariable();o.renameVariable$$module$build$src$core$variables(I,M)}},d=function(_){return function(){const I=_.workspace,M=_.getField("VAR").getVariable();I.deleteVariableById(M.getId()),I.refreshToolboxSelection()}};o.registerMixin$$module$build$src$core$extensions("contextMenu_variableDynamicSetterGetter",a),o.defineBlocks$$module$build$src$core$common(l);var p={blocks:l},g=o.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"variables_get",message0:"%1",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"}],output:null,style:"variable_blocks",helpUrl:"%{BKY_VARIABLES_GET_HELPURL}",tooltip:"%{BKY_VARIABLES_GET_TOOLTIP}",extensions:["contextMenu_variableSetterGetter"]},{type:"variables_set",message0:"%{BKY_VARIABLES_SET}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_VARIABLES_DEFAULT_NAME}"},{type:"input_value",name:"VALUE"}],previousStatement:null,nextStatement:null,style:"variable_blocks",tooltip:"%{BKY_VARIABLES_SET_TOOLTIP}",helpUrl:"%{BKY_VARIABLES_SET_HELPURL}",extensions:["contextMenu_variableSetterGetter"]}]),m={customContextMenu:function(_){if(this.isInFlyout)(this.type==="variables_get"||this.type==="variables_get_reporter")&&(M={text:o.Msg$$module$build$src$core$msg.RENAME_VARIABLE,enabled:!0,callback:T(this)},P=this.getField("VAR").getText(),P={text:o.Msg$$module$build$src$core$msg.DELETE_VARIABLE.replace("%1",P),enabled:!0,callback:b(this)},_.unshift(M),_.unshift(P));else{if(this.type==="variables_get")var I="variables_set",M=o.Msg$$module$build$src$core$msg.VARIABLES_GET_CREATE_SET;else I="variables_get",M=o.Msg$$module$build$src$core$msg.VARIABLES_SET_CREATE_GET;var P=this.getField("VAR");I={type:I,fields:{VAR:P.saveState(!0)}},_.push({enabled:0<this.workspace.remainingCapacity(),text:M.replace("%1",P.getText()),callback:o.callbackFactory$$module$build$src$core$contextmenu(this,I)})}}},T=function(_){return function(){const I=_.workspace,M=_.getField("VAR").getVariable();o.renameVariable$$module$build$src$core$variables(I,M)}},b=function(_){return function(){const I=_.workspace,M=_.getField("VAR").getVariable();I.deleteVariableById(M.getId()),I.refreshToolboxSelection()}};o.registerMixin$$module$build$src$core$extensions("contextMenu_variableSetterGetter",m),o.defineBlocks$$module$build$src$core$common(g);var y={blocks:g},C=o.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"text",message0:"%1",args0:[{type:"field_input",name:"TEXT",text:""}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_TEXT_HELPURL}",tooltip:"%{BKY_TEXT_TEXT_TOOLTIP}",extensions:["text_quotes","parent_tooltip_when_inline"]},{type:"text_multiline",message0:"%1 %2",args0:[{type:"field_image",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAARCAYAAADpPU2iAAAABGdBTUEAALGPC/xhBQAAAAlwSFlzAAAdhgAAHYYBXaITgQAAABh0RVh0U29mdHdhcmUAcGFpbnQubmV0IDQuMS42/U4J6AAAAP1JREFUOE+Vks0KQUEYhjmRIja4ABtZ2dm5A3t3Ia6AUm7CylYuQRaUhZSlLZJiQbFAyRnPN33y01HOW08z8873zpwzM4F3GWOCruvGIE4/rLaV+Nq1hVGMBqzhqlxgCys4wJA65xnogMHsQ5lujnYHTejBBCK2mE4abjCgMGhNxHgDFWjDSG07kdfVa2pZMf4ZyMAdWmpZMfYOsLiDMYMjlMB+K613QISRhTnITnsYg5yUd0DETmEoMlkFOeIT/A58iyK5E18BuTBfgYXfwNJv4P9/oEBerLylOnRhygmGdPpTTBZAPkde61lbQe4moWUvYUZYLfUNftIY4zwA5X2Z9AYnQrEAAAAASUVORK5CYII=",width:12,height:17,alt:""},{type:"field_multilinetext",name:"TEXT",text:""}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_TEXT_HELPURL}",tooltip:"%{BKY_TEXT_TEXT_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"text_join",message0:"",output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_JOIN_HELPURL}",tooltip:"%{BKY_TEXT_JOIN_TOOLTIP}",mutator:"text_join_mutator"},{type:"text_create_join_container",message0:"%{BKY_TEXT_CREATE_JOIN_TITLE_JOIN} %1 %2",args0:[{type:"input_dummy"},{type:"input_statement",name:"STACK"}],style:"text_blocks",tooltip:"%{BKY_TEXT_CREATE_JOIN_TOOLTIP}",enableContextMenu:!1},{type:"text_create_join_item",message0:"%{BKY_TEXT_CREATE_JOIN_ITEM_TITLE_ITEM}",previousStatement:null,nextStatement:null,style:"text_blocks",tooltip:"%{BKY_TEXT_CREATE_JOIN_ITEM_TOOLTIP}",enableContextMenu:!1},{type:"text_append",message0:"%{BKY_TEXT_APPEND_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_TEXT_APPEND_VARIABLE}"},{type:"input_value",name:"TEXT"}],previousStatement:null,nextStatement:null,style:"text_blocks",extensions:["text_append_tooltip"]},{type:"text_length",message0:"%{BKY_TEXT_LENGTH_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Number",style:"text_blocks",tooltip:"%{BKY_TEXT_LENGTH_TOOLTIP}",helpUrl:"%{BKY_TEXT_LENGTH_HELPURL}"},{type:"text_isEmpty",message0:"%{BKY_TEXT_ISEMPTY_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Boolean",style:"text_blocks",tooltip:"%{BKY_TEXT_ISEMPTY_TOOLTIP}",helpUrl:"%{BKY_TEXT_ISEMPTY_HELPURL}"},{type:"text_indexOf",message0:"%{BKY_TEXT_INDEXOF_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"String"},{type:"field_dropdown",name:"END",options:[["%{BKY_TEXT_INDEXOF_OPERATOR_FIRST}","FIRST"],["%{BKY_TEXT_INDEXOF_OPERATOR_LAST}","LAST"]]},{type:"input_value",name:"FIND",check:"String"}],output:"Number",style:"text_blocks",helpUrl:"%{BKY_TEXT_INDEXOF_HELPURL}",inputsInline:!0,extensions:["text_indexOf_tooltip"]},{type:"text_charAt",message0:"%{BKY_TEXT_CHARAT_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"String"},{type:"field_dropdown",name:"WHERE",options:[["%{BKY_TEXT_CHARAT_FROM_START}","FROM_START"],["%{BKY_TEXT_CHARAT_FROM_END}","FROM_END"],["%{BKY_TEXT_CHARAT_FIRST}","FIRST"],["%{BKY_TEXT_CHARAT_LAST}","LAST"],["%{BKY_TEXT_CHARAT_RANDOM}","RANDOM"]]}],output:"String",style:"text_blocks",helpUrl:"%{BKY_TEXT_CHARAT_HELPURL}",inputsInline:!0,mutator:"text_charAt_mutator"}]),L={init:function(){this.WHERE_OPTIONS_1=[[o.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_START_FROM_START,"FROM_START"],[o.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_START_FROM_END,"FROM_END"],[o.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_START_FIRST,"FIRST"]],this.WHERE_OPTIONS_2=[[o.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_END_FROM_START,"FROM_START"],[o.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_END_FROM_END,"FROM_END"],[o.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_END_LAST,"LAST"]],this.setHelpUrl(o.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("STRING").setCheck("String").appendField(o.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_INPUT_IN_TEXT),this.appendDummyInput("AT1"),this.appendDummyInput("AT2"),o.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TAIL&&this.appendDummyInput("TAIL").appendField(o.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TAIL),this.setInputsInline(!0),this.setOutput(!0,"String"),this.updateAt_(1,!0),this.updateAt_(2,!0),this.setTooltip(o.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TOOLTIP)},mutationToDom:function(){const _=o.createElement$$module$build$src$core$utils$xml("mutation");var I=this.getInput("AT1")instanceof o.ValueInput$$module$build$src$core$inputs$value_input;return _.setAttribute("at1",`${I}`),I=this.getInput("AT2")instanceof o.ValueInput$$module$build$src$core$inputs$value_input,_.setAttribute("at2",`${I}`),_},domToMutation:function(_){const I=_.getAttribute("at1")==="true";_=_.getAttribute("at2")==="true",this.updateAt_(1,I),this.updateAt_(2,_)},updateAt_:function(_,I){this.removeInput("AT"+_),this.removeInput("ORDINAL"+_,!0),I?(this.appendValueInput("AT"+_).setCheck("Number"),o.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL"+_).appendField(o.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"+_),_===2&&o.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TAIL&&(this.removeInput("TAIL",!0),this.appendDummyInput("TAIL").appendField(o.Msg$$module$build$src$core$msg.TEXT_GET_SUBSTRING_TAIL));const M=o.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:this["WHERE_OPTIONS_"+_]});M.setValidator(function(P){const nt=P==="FROM_START"||P==="FROM_END";if(nt!==I){const Pt=this.getSourceBlock();return Pt.updateAt_(_,nt),Pt.setFieldValue(P,"WHERE"+_),null}}),this.getInput("AT"+_).appendField(M,"WHERE"+_),_===1&&(this.moveInputBefore("AT1","AT2"),this.getInput("ORDINAL1")&&this.moveInputBefore("ORDINAL1","AT2"))}};C.text_getSubstring=L,C.text_changeCase={init:function(){const _=[[o.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_OPERATOR_UPPERCASE,"UPPERCASE"],[o.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_OPERATOR_LOWERCASE,"LOWERCASE"],[o.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_OPERATOR_TITLECASE,"TITLECASE"]];this.setHelpUrl(o.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("TEXT").setCheck("String").appendField(o.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:_}),"CASE"),this.setOutput(!0,"String"),this.setTooltip(o.Msg$$module$build$src$core$msg.TEXT_CHANGECASE_TOOLTIP)}},C.text_trim={init:function(){const _=[[o.Msg$$module$build$src$core$msg.TEXT_TRIM_OPERATOR_BOTH,"BOTH"],[o.Msg$$module$build$src$core$msg.TEXT_TRIM_OPERATOR_LEFT,"LEFT"],[o.Msg$$module$build$src$core$msg.TEXT_TRIM_OPERATOR_RIGHT,"RIGHT"]];this.setHelpUrl(o.Msg$$module$build$src$core$msg.TEXT_TRIM_HELPURL),this.setStyle("text_blocks"),this.appendValueInput("TEXT").setCheck("String").appendField(o.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:_}),"MODE"),this.setOutput(!0,"String"),this.setTooltip(o.Msg$$module$build$src$core$msg.TEXT_TRIM_TOOLTIP)}},C.text_print={init:function(){this.jsonInit({message0:o.Msg$$module$build$src$core$msg.TEXT_PRINT_TITLE,args0:[{type:"input_value",name:"TEXT"}],previousStatement:null,nextStatement:null,style:"text_blocks",tooltip:o.Msg$$module$build$src$core$msg.TEXT_PRINT_TOOLTIP,helpUrl:o.Msg$$module$build$src$core$msg.TEXT_PRINT_HELPURL})}};var A={updateType_:function(_){this.outputConnection.setCheck(_==="NUMBER"?"Number":"String")},mutationToDom:function(){const _=o.createElement$$module$build$src$core$utils$xml("mutation");return _.setAttribute("type",this.getFieldValue("TYPE")),_},domToMutation:function(_){this.updateType_(_.getAttribute("type"))}};C.text_prompt_ext=Object.assign({},A,{init:function(){var _=[[o.Msg$$module$build$src$core$msg.TEXT_PROMPT_TYPE_TEXT,"TEXT"],[o.Msg$$module$build$src$core$msg.TEXT_PROMPT_TYPE_NUMBER,"NUMBER"]];this.setHelpUrl(o.Msg$$module$build$src$core$msg.TEXT_PROMPT_HELPURL),this.setStyle("text_blocks"),_=o.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:_}),_.setValidator(I=>{this.updateType_(I)}),this.appendValueInput("TEXT").appendField(_,"TYPE"),this.setOutput(!0,"String"),this.setTooltip(()=>this.getFieldValue("TYPE")==="TEXT"?o.Msg$$module$build$src$core$msg.TEXT_PROMPT_TOOLTIP_TEXT:o.Msg$$module$build$src$core$msg.TEXT_PROMPT_TOOLTIP_NUMBER)}});var F=Object.assign({},A,{init:function(){this.mixin(z);var _=[[o.Msg$$module$build$src$core$msg.TEXT_PROMPT_TYPE_TEXT,"TEXT"],[o.Msg$$module$build$src$core$msg.TEXT_PROMPT_TYPE_NUMBER,"NUMBER"]];this.setHelpUrl(o.Msg$$module$build$src$core$msg.TEXT_PROMPT_HELPURL),this.setStyle("text_blocks"),_=o.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:_}),_.setValidator(I=>{this.updateType_(I)}),this.appendDummyInput().appendField(_,"TYPE").appendField(this.newQuote_(!0)).appendField(o.fromJson$$module$build$src$core$field_registry({type:"field_input",text:""}),"TEXT").appendField(this.newQuote_(!1)),this.setOutput(!0,"String"),this.setTooltip(()=>this.getFieldValue("TYPE")==="TEXT"?o.Msg$$module$build$src$core$msg.TEXT_PROMPT_TOOLTIP_TEXT:o.Msg$$module$build$src$core$msg.TEXT_PROMPT_TOOLTIP_NUMBER)}});C.text_prompt=F,C.text_count={init:function(){this.jsonInit({message0:o.Msg$$module$build$src$core$msg.TEXT_COUNT_MESSAGE0,args0:[{type:"input_value",name:"SUB",check:"String"},{type:"input_value",name:"TEXT",check:"String"}],output:"Number",inputsInline:!0,style:"text_blocks",tooltip:o.Msg$$module$build$src$core$msg.TEXT_COUNT_TOOLTIP,helpUrl:o.Msg$$module$build$src$core$msg.TEXT_COUNT_HELPURL})}},C.text_replace={init:function(){this.jsonInit({message0:o.Msg$$module$build$src$core$msg.TEXT_REPLACE_MESSAGE0,args0:[{type:"input_value",name:"FROM",check:"String"},{type:"input_value",name:"TO",check:"String"},{type:"input_value",name:"TEXT",check:"String"}],output:"String",inputsInline:!0,style:"text_blocks",tooltip:o.Msg$$module$build$src$core$msg.TEXT_REPLACE_TOOLTIP,helpUrl:o.Msg$$module$build$src$core$msg.TEXT_REPLACE_HELPURL})}},C.text_reverse={init:function(){this.jsonInit({message0:o.Msg$$module$build$src$core$msg.TEXT_REVERSE_MESSAGE0,args0:[{type:"input_value",name:"TEXT",check:"String"}],output:"String",inputsInline:!0,style:"text_blocks",tooltip:o.Msg$$module$build$src$core$msg.TEXT_REVERSE_TOOLTIP,helpUrl:o.Msg$$module$build$src$core$msg.TEXT_REVERSE_HELPURL})}};var z={QUOTE_IMAGE_LEFT_DATAURI:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAQAAAAqJXdxAAAAn0lEQVQI1z3OMa5BURSF4f/cQhAKjUQhuQmFNwGJEUi0RKN5rU7FHKhpjEH3TEMtkdBSCY1EIv8r7nFX9e29V7EBAOvu7RPjwmWGH/VuF8CyN9/OAdvqIXYLvtRaNjx9mMTDyo+NjAN1HNcl9ZQ5oQMM3dgDUqDo1l8DzvwmtZN7mnD+PkmLa+4mhrxVA9fRowBWmVBhFy5gYEjKMfz9AylsaRRgGzvZAAAAAElFTkSuQmCC",QUOTE_IMAGE_RIGHT_DATAURI:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAKCAQAAAAqJXdxAAAAqUlEQVQI1z3KvUpCcRiA8ef9E4JNHhI0aFEacm1o0BsI0Slx8wa8gLauoDnoBhq7DcfWhggONDmJJgqCPA7neJ7p934EOOKOnM8Q7PDElo/4x4lFb2DmuUjcUzS3URnGib9qaPNbuXvBO3sGPHJDRG6fGVdMSeWDP2q99FQdFrz26Gu5Tq7dFMzUvbXy8KXeAj57cOklgA+u1B5AoslLtGIHQMaCVnwDnADZIFIrXsoXrgAAAABJRU5ErkJggg==",QUOTE_IMAGE_WIDTH:12,QUOTE_IMAGE_HEIGHT:12,quoteField_:function(_){for(let I=0,M;M=this.inputList[I];I++)for(let P=0,nt;nt=M.fieldRow[P];P++)if(_===nt.name){M.insertFieldAt(P,this.newQuote_(!0)),M.insertFieldAt(P+2,this.newQuote_(!1));return}console.warn('field named "'+_+'" not found in '+this.toDevString())},newQuote_:function(_){return _=this.RTL?!_:_,o.fromJson$$module$build$src$core$field_registry({type:"field_image",src:_?this.QUOTE_IMAGE_LEFT_DATAURI:this.QUOTE_IMAGE_RIGHT_DATAURI,width:this.QUOTE_IMAGE_WIDTH,height:this.QUOTE_IMAGE_HEIGHT,alt:_?"":""})}},X=function(){this.mixin(z),this.quoteField_("TEXT")},K={itemCount_:0,mutationToDom:function(){const _=o.createElement$$module$build$src$core$utils$xml("mutation");return _.setAttribute("items",`${this.itemCount_}`),_},domToMutation:function(_){this.itemCount_=parseInt(_.getAttribute("items"),10),this.updateShape_()},saveExtraState:function(){return{itemCount:this.itemCount_}},loadExtraState:function(_){this.itemCount_=_.itemCount,this.updateShape_()},decompose:function(_){const I=_.newBlock("text_create_join_container");I.initSvg();let M=I.getInput("STACK").connection;for(let P=0;P<this.itemCount_;P++){const nt=_.newBlock("text_create_join_item");nt.initSvg(),M.connect(nt.previousConnection),M=nt.nextConnection}return I},compose:function(_){var I=_.getInputTargetBlock("STACK");for(_=[];I;)I.isInsertionMarker()||_.push(I.valueConnection_),I=I.getNextBlock();for(I=0;I<this.itemCount_;I++){const M=this.getInput("ADD"+I).connection.targetConnection;M&&_.indexOf(M)===-1&&M.disconnect()}for(this.itemCount_=_.length,this.updateShape_(),I=0;I<this.itemCount_;I++){let M;(M=_[I])==null||M.reconnect(this,"ADD"+I)}},saveConnections:function(_){_=_.getInputTargetBlock("STACK");let I=0;for(;_;){if(_.isInsertionMarker()){_=_.getNextBlock();continue}const M=this.getInput("ADD"+I);_.valueConnection_=M&&M.connection.targetConnection,_=_.getNextBlock(),I++}},updateShape_:function(){this.itemCount_&&this.getInput("EMPTY")?this.removeInput("EMPTY"):this.itemCount_||this.getInput("EMPTY")||this.appendDummyInput("EMPTY").appendField(this.newQuote_(!0)).appendField(this.newQuote_(!1));for(var _=0;_<this.itemCount_;_++)if(!this.getInput("ADD"+_)){const I=this.appendValueInput("ADD"+_).setAlign(o.Align$$module$build$src$core$inputs$align.RIGHT);_===0&&I.appendField(o.Msg$$module$build$src$core$msg.TEXT_JOIN_TITLE_CREATEWITH)}for(_=this.itemCount_;this.getInput("ADD"+_);_++)this.removeInput("ADD"+_)}},Y=function(){this.mixin(z),this.itemCount_=2,this.updateShape_(),this.setMutator(new o.MutatorIcon$$module$build$src$core$icons$mutator_icon(["text_create_join_item"],this))};o.register$$module$build$src$core$extensions("text_append_tooltip",o.buildTooltipWithFieldText$$module$build$src$core$extensions("%{BKY_TEXT_APPEND_TOOLTIP}","VAR"));var V=function(){this.setTooltip(()=>o.Msg$$module$build$src$core$msg.TEXT_INDEXOF_TOOLTIP.replace("%1",this.workspace.options.oneBasedIndex?"0":"-1"))},H={isAt_:!1,mutationToDom:function(){const _=o.createElement$$module$build$src$core$utils$xml("mutation");return _.setAttribute("at",`${this.isAt_}`),_},domToMutation:function(_){_=_.getAttribute("at")!=="false",this.updateAt_(_)},updateAt_:function(_){this.removeInput("AT",!0),this.removeInput("ORDINAL",!0),_&&(this.appendValueInput("AT").setCheck("Number"),o.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(o.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)),o.Msg$$module$build$src$core$msg.TEXT_CHARAT_TAIL&&(this.removeInput("TAIL",!0),this.appendDummyInput("TAIL").appendField(o.Msg$$module$build$src$core$msg.TEXT_CHARAT_TAIL)),this.isAt_=_}},Tt=function(){this.getField("WHERE").setValidator(function(_){_=_==="FROM_START"||_==="FROM_END";const I=this.getSourceBlock();_!==I.isAt_&&I.updateAt_(_)}),this.updateAt_(!0),this.setTooltip(()=>{var _=this.getFieldValue("WHERE");let I=o.Msg$$module$build$src$core$msg.TEXT_CHARAT_TOOLTIP;return(_==="FROM_START"||_==="FROM_END")&&(_=_==="FROM_START"?o.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_START_TOOLTIP:o.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_END_TOOLTIP)&&(I+="  "+_.replace("%1",this.workspace.options.oneBasedIndex?"#1":"#0")),I})};o.register$$module$build$src$core$extensions("text_indexOf_tooltip",V),o.register$$module$build$src$core$extensions("text_quotes",X),o.registerMixin$$module$build$src$core$extensions("quote_image_mixin",z),o.registerMutator$$module$build$src$core$extensions("text_join_mutator",K,Y),o.registerMutator$$module$build$src$core$extensions("text_charAt_mutator",H,Tt),o.defineBlocks$$module$build$src$core$common(C);var $t={blocks:C},lt={},ot={setStatements_:function(_){this.hasStatements_!==_&&(_?(this.appendStatementInput("STACK").appendField(o.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_DO),this.getInput("RETURN")&&this.moveInputBefore("STACK","RETURN")):this.removeInput("STACK",!0),this.hasStatements_=_)},updateParams_:function(){let _="";this.arguments_.length&&(_=o.Msg$$module$build$src$core$msg.PROCEDURES_BEFORE_PARAMS+" "+this.arguments_.join(", ")),o.disable$$module$build$src$core$events$utils();try{this.setFieldValue(_,"PARAMS")}finally{o.enable$$module$build$src$core$events$utils()}},mutationToDom:function(_){const I=o.createElement$$module$build$src$core$utils$xml("mutation");_&&I.setAttribute("name",this.getFieldValue("NAME"));for(let M=0;M<this.argumentVarModels_.length;M++){const P=o.createElement$$module$build$src$core$utils$xml("arg"),nt=this.argumentVarModels_[M];P.setAttribute("name",nt.name),P.setAttribute("varid",nt.getId()),_&&this.paramIds_&&P.setAttribute("paramId",this.paramIds_[M]),I.appendChild(P)}return this.hasStatements_||I.setAttribute("statements","false"),I},domToMutation:function(_){this.arguments_=[],this.argumentVarModels_=[];for(let M=0,P;P=_.childNodes[M];M++)if(P.nodeName.toLowerCase()==="arg"){var I=P;const nt=I.getAttribute("name");I=I.getAttribute("varid")||I.getAttribute("varId"),this.arguments_.push(nt),I=o.getOrCreateVariablePackage$$module$build$src$core$variables(this.workspace,I,nt,""),I!==null?this.argumentVarModels_.push(I):console.log(`Failed to create a variable named "${nt}", ignoring.`)}this.updateParams_(),o.mutateCallers$$module$build$src$core$procedures(this),this.setStatements_(_.getAttribute("statements")!=="false")},saveExtraState:function(){if(!this.argumentVarModels_.length&&this.hasStatements_)return null;const _=Object.create(null);if(this.argumentVarModels_.length){_.params=[];for(let I=0;I<this.argumentVarModels_.length;I++)_.params.push({name:this.argumentVarModels_[I].name,id:this.argumentVarModels_[I].getId()})}return this.hasStatements_||(_.hasStatements=!1),_},loadExtraState:function(_){if(this.arguments_=[],this.argumentVarModels_=[],_.params)for(let M=0;M<_.params.length;M++){var I=_.params[M];I=o.getOrCreateVariablePackage$$module$build$src$core$variables(this.workspace,I.id,I.name,""),this.arguments_.push(I.name),this.argumentVarModels_.push(I)}this.updateParams_(),o.mutateCallers$$module$build$src$core$procedures(this),this.setStatements_(_.hasStatements!==!1)},decompose:function(_){const I=o.createElement$$module$build$src$core$utils$xml("block");I.setAttribute("type","procedures_mutatorcontainer");var M=o.createElement$$module$build$src$core$utils$xml("statement");M.setAttribute("name","STACK"),I.appendChild(M);for(let nt=0;nt<this.arguments_.length;nt++){const Pt=o.createElement$$module$build$src$core$utils$xml("block");Pt.setAttribute("type","procedures_mutatorarg");var P=o.createElement$$module$build$src$core$utils$xml("field");P.setAttribute("name","NAME");const te=o.createTextNode$$module$build$src$core$utils$xml(this.arguments_[nt]);P.appendChild(te),Pt.appendChild(P),P=o.createElement$$module$build$src$core$utils$xml("next"),Pt.appendChild(P),M.appendChild(Pt),M=P}return _=o.domToBlock$$module$build$src$core$xml(I,_),this.type==="procedures_defreturn"?_.setFieldValue(this.hasStatements_,"STATEMENTS"):_.removeInput("STATEMENT_INPUT"),o.mutateCallers$$module$build$src$core$procedures(this),_},compose:function(_){this.arguments_=[],this.paramIds_=[],this.argumentVarModels_=[];let I=_.getInputTargetBlock("STACK");for(;I&&!I.isInsertionMarker();){var M=I.getFieldValue("NAME");this.arguments_.push(M),M=this.workspace.getVariable(M,""),this.argumentVarModels_.push(M),this.paramIds_.push(I.id),I=I.nextConnection&&I.nextConnection.targetBlock()}if(this.updateParams_(),o.mutateCallers$$module$build$src$core$procedures(this),_=_.getFieldValue("STATEMENTS"),_!==null&&(_=_==="TRUE",this.hasStatements_!==_))if(_){this.setStatements_(!0);var P;(P=this.statementConnection_)==null||P.reconnect(this,"STACK"),this.statementConnection_=null}else P=this.getInput("STACK").connection,(this.statementConnection_=P.targetConnection)&&(P=P.targetBlock(),P.unplug(),P.bumpNeighbours()),this.setStatements_(!1)},getVars:function(){return this.arguments_},getVarModels:function(){return this.argumentVarModels_},renameVarById:function(_,I){var M=this.workspace.getVariableById(_);if(M.type===""){M=M.name,I=this.workspace.getVariableById(I);var P=!1;for(let nt=0;nt<this.argumentVarModels_.length;nt++)this.argumentVarModels_[nt].getId()===_&&(this.arguments_[nt]=I.name,this.argumentVarModels_[nt]=I,P=!0);P&&(this.displayRenamedVar_(M,I.name),o.mutateCallers$$module$build$src$core$procedures(this))}},updateVarName:function(_){const I=_.name;let M=!1,P;for(let nt=0;nt<this.argumentVarModels_.length;nt++)this.argumentVarModels_[nt].getId()===_.getId()&&(P=this.arguments_[nt],this.arguments_[nt]=I,M=!0);M&&(this.displayRenamedVar_(P,I),o.mutateCallers$$module$build$src$core$procedures(this))},displayRenamedVar_:function(_,I){this.updateParams_();var M=this.getIcon(o.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE);if(M&&M.bubbleIsVisible()){M=M.getWorkspace().getAllBlocks(!1);for(let P=0,nt;nt=M[P];P++)nt.type==="procedures_mutatorarg"&&o.Names$$module$build$src$core$names.equals(_,nt.getFieldValue("NAME"))&&nt.setFieldValue(I,"NAME")}},customContextMenu:function(_){if(!this.isInFlyout){var I=this.getFieldValue("NAME"),M={type:this.callType_,extraState:{name:I,params:this.arguments_}};if(_.push({enabled:!0,text:o.Msg$$module$build$src$core$msg.PROCEDURES_CREATE_DO.replace("%1",I),callback:o.callbackFactory$$module$build$src$core$contextmenu(this,M)}),!this.isCollapsed())for(I=0;I<this.argumentVarModels_.length;I++){M=this.argumentVarModels_[I];const P={type:"variables_get",fields:{VAR:{name:M.name,id:M.getId(),type:M.type}}};_.push({enabled:!0,text:o.Msg$$module$build$src$core$msg.VARIABLES_SET_CREATE_GET.replace("%1",M.name),callback:o.callbackFactory$$module$build$src$core$contextmenu(this,P)})}}}};lt.procedures_defnoreturn=Object.assign({},ot,{init:function(){var _=o.findLegalName$$module$build$src$core$procedures("",this);_=o.fromJson$$module$build$src$core$field_registry({type:"field_input",text:_}),_.setValidator(o.rename$$module$build$src$core$procedures),_.setSpellcheck(!1),this.appendDummyInput().appendField(o.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_TITLE).appendField(_,"NAME").appendField("","PARAMS"),this.setMutator(new o.MutatorIcon$$module$build$src$core$icons$mutator_icon(["procedures_mutatorarg"],this)),(this.workspace.options.comments||this.workspace.options.parentWorkspace&&this.workspace.options.parentWorkspace.options.comments)&&o.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_COMMENT&&this.setCommentText(o.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_COMMENT),this.setStyle("procedure_blocks"),this.setTooltip(o.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_TOOLTIP),this.setHelpUrl(o.Msg$$module$build$src$core$msg.PROCEDURES_DEFNORETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.setStatements_(!0),this.statementConnection_=null},getProcedureDef:function(){return[this.getFieldValue("NAME"),this.arguments_,!1]},callType_:"procedures_callnoreturn"}),lt.procedures_defreturn=Object.assign({},ot,{init:function(){var _=o.findLegalName$$module$build$src$core$procedures("",this);_=o.fromJson$$module$build$src$core$field_registry({type:"field_input",text:_}),_.setValidator(o.rename$$module$build$src$core$procedures),_.setSpellcheck(!1),this.appendDummyInput().appendField(o.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_TITLE).appendField(_,"NAME").appendField("","PARAMS"),this.appendValueInput("RETURN").setAlign(o.Align$$module$build$src$core$inputs$input.RIGHT).appendField(o.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN),this.setMutator(new o.MutatorIcon$$module$build$src$core$icons$mutator_icon(["procedures_mutatorarg"],this)),(this.workspace.options.comments||this.workspace.options.parentWorkspace&&this.workspace.options.parentWorkspace.options.comments)&&o.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_COMMENT&&this.setCommentText(o.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_COMMENT),this.setStyle("procedure_blocks"),this.setTooltip(o.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_TOOLTIP),this.setHelpUrl(o.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.setStatements_(!0),this.statementConnection_=null},getProcedureDef:function(){return[this.getFieldValue("NAME"),this.arguments_,!0]},callType_:"procedures_callreturn"});var ct={init:function(){this.appendDummyInput().appendField(o.Msg$$module$build$src$core$msg.PROCEDURES_MUTATORCONTAINER_TITLE),this.appendStatementInput("STACK"),this.appendDummyInput("STATEMENT_INPUT").appendField(o.Msg$$module$build$src$core$msg.PROCEDURES_ALLOW_STATEMENTS).appendField(o.fromJson$$module$build$src$core$field_registry({type:"field_checkbox",checked:!0}),"STATEMENTS"),this.setStyle("procedure_blocks"),this.setTooltip(o.Msg$$module$build$src$core$msg.PROCEDURES_MUTATORCONTAINER_TOOLTIP),this.contextMenu=!1}};lt.procedures_mutatorcontainer=ct;var gt={init:function(){const _=o.fromJson$$module$build$src$core$field_registry({type:"field_input",text:o.DEFAULT_ARG$$module$build$src$core$procedures});_.setValidator(this.validator_),_.oldShowEditorFn_=_.showEditor_,_.showEditor_=function(){this.createdVariables_=[],this.oldShowEditorFn_()},this.appendDummyInput().appendField(o.Msg$$module$build$src$core$msg.PROCEDURES_MUTATORARG_TITLE).appendField(_,"NAME"),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setTooltip(o.Msg$$module$build$src$core$msg.PROCEDURES_MUTATORARG_TOOLTIP),this.contextMenu=!1,_.onFinishEditing_=this.deleteIntermediateVars_,_.createdVariables_=[],_.onFinishEditing_("x")},validator_:function(_){var I=this.getSourceBlock();const M=I.workspace.getRootWorkspace();if(_=_.replace(/[\s\xa0]+/g," ").replace(/^ | $/g,""),!_)return null;const P=(I.workspace.targetWorkspace||I.workspace).getAllBlocks(!1),nt=_.toLowerCase();for(let Pt=0;Pt<P.length;Pt++){if(P[Pt].id===this.getSourceBlock().id)continue;const te=P[Pt].getFieldValue("NAME");if(te&&te.toLowerCase()===nt)return null}return I.isInFlyout||((I=M.getVariable(_,""))&&I.name!==_&&M.renameVariableById(I.getId(),_),I||(I=M.createVariable(_,""))&&this.createdVariables_&&this.createdVariables_.push(I)),_},deleteIntermediateVars_:function(_){const I=this.getSourceBlock().workspace.getRootWorkspace();if(I)for(let M=0;M<this.createdVariables_.length;M++){const P=this.createdVariables_[M];P.name!==_&&I.deleteVariableById(P.getId())}}};lt.procedures_mutatorarg=gt;var vt={getProcedureCall:function(){return this.getFieldValue("NAME")},renameProcedure:function(_,I){o.Names$$module$build$src$core$names.equals(_,this.getProcedureCall())&&(this.setFieldValue(I,"NAME"),this.setTooltip((this.outputConnection?o.Msg$$module$build$src$core$msg.PROCEDURES_CALLRETURN_TOOLTIP:o.Msg$$module$build$src$core$msg.PROCEDURES_CALLNORETURN_TOOLTIP).replace("%1",I)))},setProcedureParameters_:function(_,I){var M=o.getDefinition$$module$build$src$core$procedures(this.getProcedureCall(),this.workspace);if((M=(M=M&&M.getIcon(o.MutatorIcon$$module$build$src$core$icons$mutator_icon.TYPE))&&M.bubbleIsVisible())?this.setCollapsed(!1):(this.quarkConnections_={},this.quarkIds_=null),_.join(`
`)===this.arguments_.join(`
`))this.quarkIds_=I;else{if(I.length!==_.length)throw RangeError("paramNames and paramIds must be the same length.");this.quarkIds_||(this.quarkConnections_={},this.quarkIds_=[]);for(let nt=0;nt<this.arguments_.length;nt++){var P=this.getInput("ARG"+nt);P&&(P=P.connection.targetConnection,this.quarkConnections_[this.quarkIds_[nt]]=P,M&&P&&I.indexOf(this.quarkIds_[nt])===-1&&(P.disconnect(),P.getSourceBlock().bumpNeighbours()))}for(this.arguments_=[].concat(_),this.argumentVarModels_=[],_=0;_<this.arguments_.length;_++)M=o.getOrCreateVariablePackage$$module$build$src$core$variables(this.workspace,null,this.arguments_[_],""),this.argumentVarModels_.push(M);if(this.updateShape_(),this.quarkIds_=I){for(I=0;I<this.arguments_.length;I++)if(_=this.quarkIds_[I],_ in this.quarkConnections_){let nt;(nt=this.quarkConnections_[_])!=null&&nt.reconnect(this,"ARG"+I)||delete this.quarkConnections_[_]}}}},updateShape_:function(){for(var _=0;_<this.arguments_.length;_++){var I=this.getField("ARGNAME"+_);if(I){o.disable$$module$build$src$core$events$utils();try{I.setValue(this.arguments_[_])}finally{o.enable$$module$build$src$core$events$utils()}}else I=o.fromJson$$module$build$src$core$field_registry({type:"field_label",text:this.arguments_[_]}),this.appendValueInput("ARG"+_).setAlign(o.Align$$module$build$src$core$inputs$input.RIGHT).appendField(I,"ARGNAME"+_).init()}for(_=this.arguments_.length;this.getInput("ARG"+_);_++)this.removeInput("ARG"+_);(_=this.getInput("TOPROW"))&&(this.arguments_.length?this.getField("WITH")||(_.appendField(o.Msg$$module$build$src$core$msg.PROCEDURES_CALL_BEFORE_PARAMS,"WITH"),_.init()):this.getField("WITH")&&_.removeField("WITH"))},mutationToDom:function(){const _=o.createElement$$module$build$src$core$utils$xml("mutation");_.setAttribute("name",this.getProcedureCall());for(let I=0;I<this.arguments_.length;I++){const M=o.createElement$$module$build$src$core$utils$xml("arg");M.setAttribute("name",this.arguments_[I]),_.appendChild(M)}return _},domToMutation:function(_){var I=_.getAttribute("name");this.renameProcedure(this.getProcedureCall(),I),I=[];const M=[];for(let P=0,nt;nt=_.childNodes[P];P++)nt.nodeName.toLowerCase()==="arg"&&(I.push(nt.getAttribute("name")),M.push(nt.getAttribute("paramId")));this.setProcedureParameters_(I,M)},saveExtraState:function(){const _=Object.create(null);return _.name=this.getProcedureCall(),this.arguments_.length&&(_.params=this.arguments_),_},loadExtraState:function(_){if(this.renameProcedure(this.getProcedureCall(),_.name),_=_.params){const I=[];I.length=_.length,I.fill(null),this.setProcedureParameters_(_,I)}},getVars:function(){return this.arguments_},getVarModels:function(){return this.argumentVarModels_},onchange:function(_){if(this.workspace&&!this.workspace.isFlyout&&_.recordUndo)if(_.type===o.CREATE$$module$build$src$core$events$utils&&_.ids.indexOf(this.id)!==-1){var I=this.getProcedureCall();if(I=o.getDefinition$$module$build$src$core$procedures(I,this.workspace),!I||I.type===this.defType_&&JSON.stringify(I.getVars())===JSON.stringify(this.arguments_)||(I=null),!I){o.setGroup$$module$build$src$core$events$utils(_.group),_=o.createElement$$module$build$src$core$utils$xml("xml"),I=o.createElement$$module$build$src$core$utils$xml("block"),I.setAttribute("type",this.defType_);var M=this.getRelativeToSurfaceXY(),P=M.y+2*o.config$$module$build$src$core$config.snapRadius;I.setAttribute("x",`${M.x+o.config$$module$build$src$core$config.snapRadius*(this.RTL?-1:1)}`),I.setAttribute("y",`${P}`),M=this.mutationToDom(),I.appendChild(M),M=o.createElement$$module$build$src$core$utils$xml("field"),M.setAttribute("name","NAME"),P=this.getProcedureCall();const nt=o.findLegalName$$module$build$src$core$procedures(P,this);P!==nt&&this.renameProcedure(P,nt),M.appendChild(o.createTextNode$$module$build$src$core$utils$xml(P)),I.appendChild(M),_.appendChild(I),o.domToWorkspace$$module$build$src$core$xml(_,this.workspace),o.setGroup$$module$build$src$core$events$utils(!1)}}else _.type===o.DELETE$$module$build$src$core$events$utils?(I=this.getProcedureCall(),o.getDefinition$$module$build$src$core$procedures(I,this.workspace)||(o.setGroup$$module$build$src$core$events$utils(_.group),this.dispose(!0),o.setGroup$$module$build$src$core$events$utils(!1))):_.type===o.CHANGE$$module$build$src$core$events$utils&&_.element==="disabled"&&(I=this.getProcedureCall(),(I=o.getDefinition$$module$build$src$core$procedures(I,this.workspace))&&I.id===_.blockId&&((I=o.getGroup$$module$build$src$core$events$utils())&&console.log("Saw an existing group while responding to a definition change"),o.setGroup$$module$build$src$core$events$utils(_.group),_.newValue?(this.previousEnabledState_=this.isEnabled(),this.setEnabled(!1)):this.setEnabled(this.previousEnabledState_),o.setGroup$$module$build$src$core$events$utils(I)))},customContextMenu:function(_){if(this.workspace.isMovable()){var I=this.getProcedureCall(),M=this.workspace;_.push({enabled:!0,text:o.Msg$$module$build$src$core$msg.PROCEDURES_HIGHLIGHT_DEF,callback:function(){const P=o.getDefinition$$module$build$src$core$procedures(I,M);P&&(M.centerOnBlock(P.id),P.select())}})}}};lt.procedures_callnoreturn=Object.assign({},vt,{init:function(){this.appendDummyInput("TOPROW").appendField("","NAME"),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setHelpUrl(o.Msg$$module$build$src$core$msg.PROCEDURES_CALLNORETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.quarkConnections_={},this.quarkIds_=null,this.previousEnabledState_=!0},defType_:"procedures_defnoreturn"}),lt.procedures_callreturn=Object.assign({},vt,{init:function(){this.appendDummyInput("TOPROW").appendField("","NAME"),this.setOutput(!0),this.setStyle("procedure_blocks"),this.setHelpUrl(o.Msg$$module$build$src$core$msg.PROCEDURES_CALLRETURN_HELPURL),this.arguments_=[],this.argumentVarModels_=[],this.quarkConnections_={},this.quarkIds_=null,this.previousEnabledState_=!0},defType_:"procedures_defreturn"});var it={init:function(){this.appendValueInput("CONDITION").setCheck("Boolean").appendField(o.Msg$$module$build$src$core$msg.CONTROLS_IF_MSG_IF),this.appendValueInput("VALUE").appendField(o.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setStyle("procedure_blocks"),this.setTooltip(o.Msg$$module$build$src$core$msg.PROCEDURES_IFRETURN_TOOLTIP),this.setHelpUrl(o.Msg$$module$build$src$core$msg.PROCEDURES_IFRETURN_HELPURL),this.hasReturnValue_=!0},mutationToDom:function(){const _=o.createElement$$module$build$src$core$utils$xml("mutation");return _.setAttribute("value",String(Number(this.hasReturnValue_))),_},domToMutation:function(_){this.hasReturnValue_=_.getAttribute("value")==="1",this.hasReturnValue_||(this.removeInput("VALUE"),this.appendDummyInput("VALUE").appendField(o.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN))},onchange:function(_){if(!(this.workspace.isDragging&&this.workspace.isDragging()||_.type!==o.MOVE$$module$build$src$core$events$utils)){var I=!1,M=this;do{if(this.FUNCTION_TYPES.indexOf(M.type)!==-1){I=!0;break}M=M.getSurroundParent()}while(M);I?(M.type==="procedures_defnoreturn"&&this.hasReturnValue_?(this.removeInput("VALUE"),this.appendDummyInput("VALUE").appendField(o.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN),this.hasReturnValue_=!1):M.type!=="procedures_defreturn"||this.hasReturnValue_||(this.removeInput("VALUE"),this.appendValueInput("VALUE").appendField(o.Msg$$module$build$src$core$msg.PROCEDURES_DEFRETURN_RETURN),this.hasReturnValue_=!0),this.setWarningText(null)):this.setWarningText(o.Msg$$module$build$src$core$msg.PROCEDURES_IFRETURN_WARNING),this.isInFlyout||(M=o.getGroup$$module$build$src$core$events$utils(),o.setGroup$$module$build$src$core$events$utils(_.group),this.setEnabled(I),o.setGroup$$module$build$src$core$events$utils(M))}},FUNCTION_TYPES:["procedures_defnoreturn","procedures_defreturn"]};lt.procedures_ifreturn=it,o.defineBlocks$$module$build$src$core$common(lt);var Ft={blocks:lt},Rt=o.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"math_number",message0:"%1",args0:[{type:"field_number",name:"NUM",value:0}],output:"Number",helpUrl:"%{BKY_MATH_NUMBER_HELPURL}",style:"math_blocks",tooltip:"%{BKY_MATH_NUMBER_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"math_arithmetic",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A",check:"Number"},{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ADDITION_SYMBOL}","ADD"],["%{BKY_MATH_SUBTRACTION_SYMBOL}","MINUS"],["%{BKY_MATH_MULTIPLICATION_SYMBOL}","MULTIPLY"],["%{BKY_MATH_DIVISION_SYMBOL}","DIVIDE"],["%{BKY_MATH_POWER_SYMBOL}","POWER"]]},{type:"input_value",name:"B",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ARITHMETIC_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_single",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_SINGLE_OP_ROOT}","ROOT"],["%{BKY_MATH_SINGLE_OP_ABSOLUTE}","ABS"],["-","NEG"],["ln","LN"],["log10","LOG10"],["e^","EXP"],["10^","POW10"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_SINGLE_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_trig",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_TRIG_SIN}","SIN"],["%{BKY_MATH_TRIG_COS}","COS"],["%{BKY_MATH_TRIG_TAN}","TAN"],["%{BKY_MATH_TRIG_ASIN}","ASIN"],["%{BKY_MATH_TRIG_ACOS}","ACOS"],["%{BKY_MATH_TRIG_ATAN}","ATAN"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_TRIG_HELPURL}",extensions:["math_op_tooltip"]},{type:"math_constant",message0:"%1",args0:[{type:"field_dropdown",name:"CONSTANT",options:[["","PI"],["e","E"],["","GOLDEN_RATIO"],["sqrt(2)","SQRT2"],["sqrt()","SQRT1_2"],["","INFINITY"]]}],output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_CONSTANT_TOOLTIP}",helpUrl:"%{BKY_MATH_CONSTANT_HELPURL}"},{type:"math_number_property",message0:"%1 %2",args0:[{type:"input_value",name:"NUMBER_TO_CHECK",check:"Number"},{type:"field_dropdown",name:"PROPERTY",options:[["%{BKY_MATH_IS_EVEN}","EVEN"],["%{BKY_MATH_IS_ODD}","ODD"],["%{BKY_MATH_IS_PRIME}","PRIME"],["%{BKY_MATH_IS_WHOLE}","WHOLE"],["%{BKY_MATH_IS_POSITIVE}","POSITIVE"],["%{BKY_MATH_IS_NEGATIVE}","NEGATIVE"],["%{BKY_MATH_IS_DIVISIBLE_BY}","DIVISIBLE_BY"]]}],inputsInline:!0,output:"Boolean",style:"math_blocks",tooltip:"%{BKY_MATH_IS_TOOLTIP}",mutator:"math_is_divisibleby_mutator"},{type:"math_change",message0:"%{BKY_MATH_CHANGE_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:"%{BKY_MATH_CHANGE_TITLE_ITEM}"},{type:"input_value",name:"DELTA",check:"Number"}],previousStatement:null,nextStatement:null,style:"variable_blocks",helpUrl:"%{BKY_MATH_CHANGE_HELPURL}",extensions:["math_change_tooltip"]},{type:"math_round",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ROUND_OPERATOR_ROUND}","ROUND"],["%{BKY_MATH_ROUND_OPERATOR_ROUNDUP}","ROUNDUP"],["%{BKY_MATH_ROUND_OPERATOR_ROUNDDOWN}","ROUNDDOWN"]]},{type:"input_value",name:"NUM",check:"Number"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ROUND_HELPURL}",tooltip:"%{BKY_MATH_ROUND_TOOLTIP}"},{type:"math_on_list",message0:"%1 %2",args0:[{type:"field_dropdown",name:"OP",options:[["%{BKY_MATH_ONLIST_OPERATOR_SUM}","SUM"],["%{BKY_MATH_ONLIST_OPERATOR_MIN}","MIN"],["%{BKY_MATH_ONLIST_OPERATOR_MAX}","MAX"],["%{BKY_MATH_ONLIST_OPERATOR_AVERAGE}","AVERAGE"],["%{BKY_MATH_ONLIST_OPERATOR_MEDIAN}","MEDIAN"],["%{BKY_MATH_ONLIST_OPERATOR_MODE}","MODE"],["%{BKY_MATH_ONLIST_OPERATOR_STD_DEV}","STD_DEV"],["%{BKY_MATH_ONLIST_OPERATOR_RANDOM}","RANDOM"]]},{type:"input_value",name:"LIST",check:"Array"}],output:"Number",style:"math_blocks",helpUrl:"%{BKY_MATH_ONLIST_HELPURL}",mutator:"math_modes_of_list_mutator",extensions:["math_op_tooltip"]},{type:"math_modulo",message0:"%{BKY_MATH_MODULO_TITLE}",args0:[{type:"input_value",name:"DIVIDEND",check:"Number"},{type:"input_value",name:"DIVISOR",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_MODULO_TOOLTIP}",helpUrl:"%{BKY_MATH_MODULO_HELPURL}"},{type:"math_constrain",message0:"%{BKY_MATH_CONSTRAIN_TITLE}",args0:[{type:"input_value",name:"VALUE",check:"Number"},{type:"input_value",name:"LOW",check:"Number"},{type:"input_value",name:"HIGH",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_CONSTRAIN_TOOLTIP}",helpUrl:"%{BKY_MATH_CONSTRAIN_HELPURL}"},{type:"math_random_int",message0:"%{BKY_MATH_RANDOM_INT_TITLE}",args0:[{type:"input_value",name:"FROM",check:"Number"},{type:"input_value",name:"TO",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_RANDOM_INT_TOOLTIP}",helpUrl:"%{BKY_MATH_RANDOM_INT_HELPURL}"},{type:"math_random_float",message0:"%{BKY_MATH_RANDOM_FLOAT_TITLE_RANDOM}",output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_RANDOM_FLOAT_TOOLTIP}",helpUrl:"%{BKY_MATH_RANDOM_FLOAT_HELPURL}"},{type:"math_atan2",message0:"%{BKY_MATH_ATAN2_TITLE}",args0:[{type:"input_value",name:"X",check:"Number"},{type:"input_value",name:"Y",check:"Number"}],inputsInline:!0,output:"Number",style:"math_blocks",tooltip:"%{BKY_MATH_ATAN2_TOOLTIP}",helpUrl:"%{BKY_MATH_ATAN2_HELPURL}"}]),Nt={ADD:"%{BKY_MATH_ARITHMETIC_TOOLTIP_ADD}",MINUS:"%{BKY_MATH_ARITHMETIC_TOOLTIP_MINUS}",MULTIPLY:"%{BKY_MATH_ARITHMETIC_TOOLTIP_MULTIPLY}",DIVIDE:"%{BKY_MATH_ARITHMETIC_TOOLTIP_DIVIDE}",POWER:"%{BKY_MATH_ARITHMETIC_TOOLTIP_POWER}",ROOT:"%{BKY_MATH_SINGLE_TOOLTIP_ROOT}",ABS:"%{BKY_MATH_SINGLE_TOOLTIP_ABS}",NEG:"%{BKY_MATH_SINGLE_TOOLTIP_NEG}",LN:"%{BKY_MATH_SINGLE_TOOLTIP_LN}",LOG10:"%{BKY_MATH_SINGLE_TOOLTIP_LOG10}",EXP:"%{BKY_MATH_SINGLE_TOOLTIP_EXP}",POW10:"%{BKY_MATH_SINGLE_TOOLTIP_POW10}",SIN:"%{BKY_MATH_TRIG_TOOLTIP_SIN}",COS:"%{BKY_MATH_TRIG_TOOLTIP_COS}",TAN:"%{BKY_MATH_TRIG_TOOLTIP_TAN}",ASIN:"%{BKY_MATH_TRIG_TOOLTIP_ASIN}",ACOS:"%{BKY_MATH_TRIG_TOOLTIP_ACOS}",ATAN:"%{BKY_MATH_TRIG_TOOLTIP_ATAN}",SUM:"%{BKY_MATH_ONLIST_TOOLTIP_SUM}",MIN:"%{BKY_MATH_ONLIST_TOOLTIP_MIN}",MAX:"%{BKY_MATH_ONLIST_TOOLTIP_MAX}",AVERAGE:"%{BKY_MATH_ONLIST_TOOLTIP_AVERAGE}",MEDIAN:"%{BKY_MATH_ONLIST_TOOLTIP_MEDIAN}",MODE:"%{BKY_MATH_ONLIST_TOOLTIP_MODE}",STD_DEV:"%{BKY_MATH_ONLIST_TOOLTIP_STD_DEV}",RANDOM:"%{BKY_MATH_ONLIST_TOOLTIP_RANDOM}"};o.register$$module$build$src$core$extensions("math_op_tooltip",o.buildTooltipForDropdown$$module$build$src$core$extensions("OP",Nt));var me={mutationToDom:function(){const _=o.createElement$$module$build$src$core$utils$xml("mutation"),I=this.getFieldValue("PROPERTY")==="DIVISIBLE_BY";return _.setAttribute("divisor_input",String(I)),_},domToMutation:function(_){_=_.getAttribute("divisor_input")==="true",this.updateShape_(_)},updateShape_:function(_){const I=this.getInput("DIVISOR");_?I||this.appendValueInput("DIVISOR").setCheck("Number"):I&&this.removeInput("DIVISOR")}},Lt=function(){this.getField("PROPERTY").setValidator(function(_){_=_==="DIVISIBLE_BY",this.getSourceBlock().updateShape_(_)})};o.registerMutator$$module$build$src$core$extensions("math_is_divisibleby_mutator",me,Lt),o.register$$module$build$src$core$extensions("math_change_tooltip",o.buildTooltipWithFieldText$$module$build$src$core$extensions("%{BKY_MATH_CHANGE_TOOLTIP}","VAR"));var Gt={updateType_:function(_){_==="MODE"?this.outputConnection.setCheck("Array"):this.outputConnection.setCheck("Number")},mutationToDom:function(){const _=o.createElement$$module$build$src$core$utils$xml("mutation");return _.setAttribute("op",this.getFieldValue("OP")),_},domToMutation:function(_){if(_=_.getAttribute("op"),_===null)throw new TypeError("xmlElement had no op attribute");this.updateType_(_)}},Ht=function(){this.getField("OP").setValidator((function(_){this.updateType_(_)}).bind(this))};o.registerMutator$$module$build$src$core$extensions("math_modes_of_list_mutator",Gt,Ht),o.defineBlocks$$module$build$src$core$common(Rt);var fe={blocks:Rt},ut=o.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"controls_repeat_ext",message0:"%{BKY_CONTROLS_REPEAT_TITLE}",args0:[{type:"input_value",name:"TIMES",check:"Number"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",tooltip:"%{BKY_CONTROLS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_CONTROLS_REPEAT_HELPURL}"},{type:"controls_repeat",message0:"%{BKY_CONTROLS_REPEAT_TITLE}",args0:[{type:"field_number",name:"TIMES",value:10,min:0,precision:1}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",tooltip:"%{BKY_CONTROLS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_CONTROLS_REPEAT_HELPURL}"},{type:"controls_whileUntil",message0:"%1 %2",args0:[{type:"field_dropdown",name:"MODE",options:[["%{BKY_CONTROLS_WHILEUNTIL_OPERATOR_WHILE}","WHILE"],["%{BKY_CONTROLS_WHILEUNTIL_OPERATOR_UNTIL}","UNTIL"]]},{type:"input_value",name:"BOOL",check:"Boolean"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_WHILEUNTIL_HELPURL}",extensions:["controls_whileUntil_tooltip"]},{type:"controls_for",message0:"%{BKY_CONTROLS_FOR_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:null},{type:"input_value",name:"FROM",check:"Number",align:"RIGHT"},{type:"input_value",name:"TO",check:"Number",align:"RIGHT"},{type:"input_value",name:"BY",check:"Number",align:"RIGHT"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],inputsInline:!0,previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FOR_HELPURL}",extensions:["contextMenu_newGetVariableBlock","controls_for_tooltip"]},{type:"controls_forEach",message0:"%{BKY_CONTROLS_FOREACH_TITLE}",args0:[{type:"field_variable",name:"VAR",variable:null},{type:"input_value",name:"LIST",check:"Array"}],message1:"%{BKY_CONTROLS_REPEAT_INPUT_DO} %1",args1:[{type:"input_statement",name:"DO"}],previousStatement:null,nextStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FOREACH_HELPURL}",extensions:["contextMenu_newGetVariableBlock","controls_forEach_tooltip"]},{type:"controls_flow_statements",message0:"%1",args0:[{type:"field_dropdown",name:"FLOW",options:[["%{BKY_CONTROLS_FLOW_STATEMENTS_OPERATOR_BREAK}","BREAK"],["%{BKY_CONTROLS_FLOW_STATEMENTS_OPERATOR_CONTINUE}","CONTINUE"]]}],previousStatement:null,style:"loop_blocks",helpUrl:"%{BKY_CONTROLS_FLOW_STATEMENTS_HELPURL}",suppressPrefixSuffix:!0,extensions:["controls_flow_tooltip","controls_flow_in_loop_check"]}]),be={WHILE:"%{BKY_CONTROLS_WHILEUNTIL_TOOLTIP_WHILE}",UNTIL:"%{BKY_CONTROLS_WHILEUNTIL_TOOLTIP_UNTIL}"};o.register$$module$build$src$core$extensions("controls_whileUntil_tooltip",o.buildTooltipForDropdown$$module$build$src$core$extensions("MODE",be));var _e={BREAK:"%{BKY_CONTROLS_FLOW_STATEMENTS_TOOLTIP_BREAK}",CONTINUE:"%{BKY_CONTROLS_FLOW_STATEMENTS_TOOLTIP_CONTINUE}"};o.register$$module$build$src$core$extensions("controls_flow_tooltip",o.buildTooltipForDropdown$$module$build$src$core$extensions("FLOW",_e));var xe={customContextMenu:function(_){if(!this.isInFlyout){var I=this.getField("VAR"),M=I.getVariable().name;this.isCollapsed()||M===null||(I={type:"variables_get",fields:{VAR:I.saveState(!0)}},_.push({enabled:!0,text:o.Msg$$module$build$src$core$msg.VARIABLES_SET_CREATE_GET.replace("%1",M),callback:o.callbackFactory$$module$build$src$core$contextmenu(this,I)}))}}};o.registerMixin$$module$build$src$core$extensions("contextMenu_newGetVariableBlock",xe),o.register$$module$build$src$core$extensions("controls_for_tooltip",o.buildTooltipWithFieldText$$module$build$src$core$extensions("%{BKY_CONTROLS_FOR_TOOLTIP}","VAR")),o.register$$module$build$src$core$extensions("controls_forEach_tooltip",o.buildTooltipWithFieldText$$module$build$src$core$extensions("%{BKY_CONTROLS_FOREACH_TOOLTIP}","VAR"));var Ee=new Set(["controls_repeat","controls_repeat_ext","controls_forEach","controls_for","controls_whileUntil"]),ai={getSurroundLoop:function(){let _=this;do{if(Ee.has(_.type))return _;_=_.getSurroundParent()}while(_);return null},onchange:function(_){var I=this.workspace;if(I.isDragging&&!I.isDragging()&&_.type===o.MOVE$$module$build$src$core$events$utils&&(I=!!this.getSurroundLoop(),this.setWarningText(I?null:o.Msg$$module$build$src$core$msg.CONTROLS_FLOW_STATEMENTS_WARNING),!this.isInFlyout)){const M=o.getGroup$$module$build$src$core$events$utils();o.setGroup$$module$build$src$core$events$utils(_.group),this.setEnabled(I),o.setGroup$$module$build$src$core$events$utils(M)}}};o.registerMixin$$module$build$src$core$extensions("controls_flow_in_loop_check",ai),o.defineBlocks$$module$build$src$core$common(ut);var Ke={blocks:ut,loopTypes:Ee},hi=o.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"logic_boolean",message0:"%1",args0:[{type:"field_dropdown",name:"BOOL",options:[["%{BKY_LOGIC_BOOLEAN_TRUE}","TRUE"],["%{BKY_LOGIC_BOOLEAN_FALSE}","FALSE"]]}],output:"Boolean",style:"logic_blocks",tooltip:"%{BKY_LOGIC_BOOLEAN_TOOLTIP}",helpUrl:"%{BKY_LOGIC_BOOLEAN_HELPURL}"},{type:"controls_if",message0:"%{BKY_CONTROLS_IF_MSG_IF} %1",args0:[{type:"input_value",name:"IF0",check:"Boolean"}],message1:"%{BKY_CONTROLS_IF_MSG_THEN} %1",args1:[{type:"input_statement",name:"DO0"}],previousStatement:null,nextStatement:null,style:"logic_blocks",helpUrl:"%{BKY_CONTROLS_IF_HELPURL}",suppressPrefixSuffix:!0,mutator:"controls_if_mutator",extensions:["controls_if_tooltip"]},{type:"controls_ifelse",message0:"%{BKY_CONTROLS_IF_MSG_IF} %1",args0:[{type:"input_value",name:"IF0",check:"Boolean"}],message1:"%{BKY_CONTROLS_IF_MSG_THEN} %1",args1:[{type:"input_statement",name:"DO0"}],message2:"%{BKY_CONTROLS_IF_MSG_ELSE} %1",args2:[{type:"input_statement",name:"ELSE"}],previousStatement:null,nextStatement:null,style:"logic_blocks",tooltip:"%{BKYCONTROLS_IF_TOOLTIP_2}",helpUrl:"%{BKY_CONTROLS_IF_HELPURL}",suppressPrefixSuffix:!0,extensions:["controls_if_tooltip"]},{type:"logic_compare",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A"},{type:"field_dropdown",name:"OP",options:[["=","EQ"],["","NEQ"],["<","LT"],["","LTE"],[">","GT"],["","GTE"]]},{type:"input_value",name:"B"}],inputsInline:!0,output:"Boolean",style:"logic_blocks",helpUrl:"%{BKY_LOGIC_COMPARE_HELPURL}",extensions:["logic_compare","logic_op_tooltip"]},{type:"logic_operation",message0:"%1 %2 %3",args0:[{type:"input_value",name:"A",check:"Boolean"},{type:"field_dropdown",name:"OP",options:[["%{BKY_LOGIC_OPERATION_AND}","AND"],["%{BKY_LOGIC_OPERATION_OR}","OR"]]},{type:"input_value",name:"B",check:"Boolean"}],inputsInline:!0,output:"Boolean",style:"logic_blocks",helpUrl:"%{BKY_LOGIC_OPERATION_HELPURL}",extensions:["logic_op_tooltip"]},{type:"logic_negate",message0:"%{BKY_LOGIC_NEGATE_TITLE}",args0:[{type:"input_value",name:"BOOL",check:"Boolean"}],output:"Boolean",style:"logic_blocks",tooltip:"%{BKY_LOGIC_NEGATE_TOOLTIP}",helpUrl:"%{BKY_LOGIC_NEGATE_HELPURL}"},{type:"logic_null",message0:"%{BKY_LOGIC_NULL}",output:null,style:"logic_blocks",tooltip:"%{BKY_LOGIC_NULL_TOOLTIP}",helpUrl:"%{BKY_LOGIC_NULL_HELPURL}"},{type:"logic_ternary",message0:"%{BKY_LOGIC_TERNARY_CONDITION} %1",args0:[{type:"input_value",name:"IF",check:"Boolean"}],message1:"%{BKY_LOGIC_TERNARY_IF_TRUE} %1",args1:[{type:"input_value",name:"THEN"}],message2:"%{BKY_LOGIC_TERNARY_IF_FALSE} %1",args2:[{type:"input_value",name:"ELSE"}],output:null,style:"logic_blocks",tooltip:"%{BKY_LOGIC_TERNARY_TOOLTIP}",helpUrl:"%{BKY_LOGIC_TERNARY_HELPURL}",extensions:["logic_ternary"]},{type:"controls_if_if",message0:"%{BKY_CONTROLS_IF_IF_TITLE_IF}",nextStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_IF_TOOLTIP}"},{type:"controls_if_elseif",message0:"%{BKY_CONTROLS_IF_ELSEIF_TITLE_ELSEIF}",previousStatement:null,nextStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_ELSEIF_TOOLTIP}"},{type:"controls_if_else",message0:"%{BKY_CONTROLS_IF_ELSE_TITLE_ELSE}",previousStatement:null,enableContextMenu:!1,style:"logic_blocks",tooltip:"%{BKY_CONTROLS_IF_ELSE_TOOLTIP}"}]),yt={EQ:"%{BKY_LOGIC_COMPARE_TOOLTIP_EQ}",NEQ:"%{BKY_LOGIC_COMPARE_TOOLTIP_NEQ}",LT:"%{BKY_LOGIC_COMPARE_TOOLTIP_LT}",LTE:"%{BKY_LOGIC_COMPARE_TOOLTIP_LTE}",GT:"%{BKY_LOGIC_COMPARE_TOOLTIP_GT}",GTE:"%{BKY_LOGIC_COMPARE_TOOLTIP_GTE}",AND:"%{BKY_LOGIC_OPERATION_TOOLTIP_AND}",OR:"%{BKY_LOGIC_OPERATION_TOOLTIP_OR}"};o.register$$module$build$src$core$extensions("logic_op_tooltip",o.buildTooltipForDropdown$$module$build$src$core$extensions("OP",yt));var w={elseifCount_:0,elseCount_:0,mutationToDom:function(){if(!this.elseifCount_&&!this.elseCount_)return null;const _=o.createElement$$module$build$src$core$utils$xml("mutation");return this.elseifCount_&&_.setAttribute("elseif",String(this.elseifCount_)),this.elseCount_&&_.setAttribute("else","1"),_},domToMutation:function(_){this.elseifCount_=parseInt(_.getAttribute("elseif"),10)||0,this.elseCount_=parseInt(_.getAttribute("else"),10)||0,this.rebuildShape_()},saveExtraState:function(){if(!this.elseifCount_&&!this.elseCount_)return null;const _=Object.create(null);return this.elseifCount_&&(_.elseIfCount=this.elseifCount_),this.elseCount_&&(_.hasElse=!0),_},loadExtraState:function(_){this.elseifCount_=_.elseIfCount||0,this.elseCount_=_.hasElse?1:0,this.updateShape_()},decompose:function(_){const I=_.newBlock("controls_if_if");I.initSvg();let M=I.nextConnection;for(let P=1;P<=this.elseifCount_;P++){const nt=_.newBlock("controls_if_elseif");nt.initSvg(),M.connect(nt.previousConnection),M=nt.nextConnection}return this.elseCount_&&(_=_.newBlock("controls_if_else"),_.initSvg(),M.connect(_.previousConnection)),I},compose:function(_){_=_.nextConnection.targetBlock(),this.elseCount_=this.elseifCount_=0;const I=[null],M=[null];let P=null;for(;_;){if(!_.isInsertionMarker())switch(_.type){case"controls_if_elseif":this.elseifCount_++,I.push(_.valueConnection_),M.push(_.statementConnection_);break;case"controls_if_else":this.elseCount_++,P=_.statementConnection_;break;default:throw TypeError("Unknown block type: "+_.type)}_=_.getNextBlock()}this.updateShape_(),this.reconnectChildBlocks_(I,M,P)},saveConnections:function(_){_=_.nextConnection.targetBlock();let I=1;for(;_;){if(!_.isInsertionMarker())switch(_.type){case"controls_if_elseif":var M=this.getInput("IF"+I);const P=this.getInput("DO"+I);_.valueConnection_=M&&M.connection.targetConnection,_.statementConnection_=P&&P.connection.targetConnection,I++;break;case"controls_if_else":M=this.getInput("ELSE"),_.statementConnection_=M&&M.connection.targetConnection;break;default:throw TypeError("Unknown block type: "+_.type)}_=_.getNextBlock()}},rebuildShape_:function(){const _=[null],I=[null];let M=null;this.getInput("ELSE")&&(M=this.getInput("ELSE").connection.targetConnection);for(let P=1;this.getInput("IF"+P);P++){const nt=this.getInput("IF"+P),Pt=this.getInput("DO"+P);_.push(nt.connection.targetConnection),I.push(Pt.connection.targetConnection)}this.updateShape_(),this.reconnectChildBlocks_(_,I,M)},updateShape_:function(){this.getInput("ELSE")&&this.removeInput("ELSE");for(var _=1;this.getInput("IF"+_);_++)this.removeInput("IF"+_),this.removeInput("DO"+_);for(_=1;_<=this.elseifCount_;_++)this.appendValueInput("IF"+_).setCheck("Boolean").appendField(o.Msg$$module$build$src$core$msg.CONTROLS_IF_MSG_ELSEIF),this.appendStatementInput("DO"+_).appendField(o.Msg$$module$build$src$core$msg.CONTROLS_IF_MSG_THEN);this.elseCount_&&this.appendStatementInput("ELSE").appendField(o.Msg$$module$build$src$core$msg.CONTROLS_IF_MSG_ELSE)},reconnectChildBlocks_:function(_,I,M){for(let P=1;P<=this.elseifCount_;P++){let nt;(nt=_[P])==null||nt.reconnect(this,"IF"+P);let Pt;(Pt=I[P])==null||Pt.reconnect(this,"DO"+P)}M==null||M.reconnect(this,"ELSE")}};o.registerMutator$$module$build$src$core$extensions("controls_if_mutator",w,null,["controls_if_elseif","controls_if_else"]);var N=function(){this.setTooltip((function(){if(this.elseifCount_||this.elseCount_){if(!this.elseifCount_&&this.elseCount_)return o.Msg$$module$build$src$core$msg.CONTROLS_IF_TOOLTIP_2;if(this.elseifCount_&&!this.elseCount_)return o.Msg$$module$build$src$core$msg.CONTROLS_IF_TOOLTIP_3;if(this.elseifCount_&&this.elseCount_)return o.Msg$$module$build$src$core$msg.CONTROLS_IF_TOOLTIP_4}else return o.Msg$$module$build$src$core$msg.CONTROLS_IF_TOOLTIP_1;return""}).bind(this))};o.register$$module$build$src$core$extensions("controls_if_tooltip",N);var G={onchange:function(_){this.prevBlocks_||(this.prevBlocks_=[null,null]);var I=this.getInputTargetBlock("A");const M=this.getInputTargetBlock("B");I&&M&&!this.workspace.connectionChecker.doTypeChecks(I.outputConnection,M.outputConnection)&&(o.setGroup$$module$build$src$core$events$utils(_.group),_=this.prevBlocks_[0],_!==I&&(I.unplug(),!_||_.isDisposed()||_.isShadow()||this.getInput("A").connection.connect(_.outputConnection)),I=this.prevBlocks_[1],I!==M&&(M.unplug(),!I||I.isDisposed()||I.isShadow()||this.getInput("B").connection.connect(I.outputConnection)),this.bumpNeighbours(),o.setGroup$$module$build$src$core$events$utils(!1)),this.prevBlocks_[0]=this.getInputTargetBlock("A"),this.prevBlocks_[1]=this.getInputTargetBlock("B")}},q=function(){this.mixin(G)};o.register$$module$build$src$core$extensions("logic_compare",q);var Z={prevParentConnection_:null,onchange:function(_){const I=this.getInputTargetBlock("THEN"),M=this.getInputTargetBlock("ELSE"),P=this.outputConnection.targetConnection;if((I||M)&&P)for(let nt=0;2>nt;nt++){const Pt=nt===1?I:M;Pt&&!Pt.workspace.connectionChecker.doTypeChecks(Pt.outputConnection,P)&&(o.setGroup$$module$build$src$core$events$utils(_.group),P===this.prevParentConnection_?(this.unplug(),P.getSourceBlock().bumpNeighbours()):(Pt.unplug(),Pt.bumpNeighbours()),o.setGroup$$module$build$src$core$events$utils(!1))}this.prevParentConnection_=P}};o.registerMixin$$module$build$src$core$extensions("logic_ternary",Z),o.defineBlocks$$module$build$src$core$common(hi);var st=o.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"lists_create_empty",message0:"%{BKY_LISTS_CREATE_EMPTY_TITLE}",output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_CREATE_EMPTY_TOOLTIP}",helpUrl:"%{BKY_LISTS_CREATE_EMPTY_HELPURL}"},{type:"lists_repeat",message0:"%{BKY_LISTS_REPEAT_TITLE}",args0:[{type:"input_value",name:"ITEM"},{type:"input_value",name:"NUM",check:"Number"}],output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_REPEAT_TOOLTIP}",helpUrl:"%{BKY_LISTS_REPEAT_HELPURL}"},{type:"lists_reverse",message0:"%{BKY_LISTS_REVERSE_MESSAGE0}",args0:[{type:"input_value",name:"LIST",check:"Array"}],output:"Array",inputsInline:!0,style:"list_blocks",tooltip:"%{BKY_LISTS_REVERSE_TOOLTIP}",helpUrl:"%{BKY_LISTS_REVERSE_HELPURL}"},{type:"lists_isEmpty",message0:"%{BKY_LISTS_ISEMPTY_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Boolean",style:"list_blocks",tooltip:"%{BKY_LISTS_ISEMPTY_TOOLTIP}",helpUrl:"%{BKY_LISTS_ISEMPTY_HELPURL}"},{type:"lists_length",message0:"%{BKY_LISTS_LENGTH_TITLE}",args0:[{type:"input_value",name:"VALUE",check:["String","Array"]}],output:"Number",style:"list_blocks",tooltip:"%{BKY_LISTS_LENGTH_TOOLTIP}",helpUrl:"%{BKY_LISTS_LENGTH_HELPURL}"}]),ht={init:function(){this.setHelpUrl(o.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_HELPURL),this.setStyle("list_blocks"),this.itemCount_=3,this.updateShape_(),this.setOutput(!0,"Array"),this.setMutator(new o.MutatorIcon$$module$build$src$core$icons$mutator_icon(["lists_create_with_item"],this)),this.setTooltip(o.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_TOOLTIP)},mutationToDom:function(){const _=o.createElement$$module$build$src$core$utils$xml("mutation");return _.setAttribute("items",String(this.itemCount_)),_},domToMutation:function(_){if(_=_.getAttribute("items"),!_)throw new TypeError("element did not have items");this.itemCount_=parseInt(_,10),this.updateShape_()},saveExtraState:function(){return{itemCount:this.itemCount_}},loadExtraState:function(_){this.itemCount_=_.itemCount,this.updateShape_()},decompose:function(_){const I=_.newBlock("lists_create_with_container");I.initSvg();let M=I.getInput("STACK").connection;for(let P=0;P<this.itemCount_;P++){const nt=_.newBlock("lists_create_with_item");if(nt.initSvg(),!nt.previousConnection)throw Error("itemBlock has no previousConnection");M.connect(nt.previousConnection),M=nt.nextConnection}return I},compose:function(_){var I=_.getInputTargetBlock("STACK");for(_=[];I;)I.isInsertionMarker()||_.push(I.valueConnection_),I=I.getNextBlock();for(I=0;I<this.itemCount_;I++){const M=this.getInput("ADD"+I).connection.targetConnection;M&&_.indexOf(M)===-1&&M.disconnect()}for(this.itemCount_=_.length,this.updateShape_(),I=0;I<this.itemCount_;I++){let M;(M=_[I])==null||M.reconnect(this,"ADD"+I)}},saveConnections:function(_){_=_.getInputTargetBlock("STACK");let I=0;for(;_;){if(_.isInsertionMarker()){_=_.getNextBlock();continue}const M=this.getInput("ADD"+I);let P;_.valueConnection_=(P=M)==null?void 0:P.connection.targetConnection,_=_.getNextBlock(),I++}},updateShape_:function(){this.itemCount_&&this.getInput("EMPTY")?this.removeInput("EMPTY"):this.itemCount_||this.getInput("EMPTY")||this.appendDummyInput("EMPTY").appendField(o.Msg$$module$build$src$core$msg.LISTS_CREATE_EMPTY_TITLE);for(var _=0;_<this.itemCount_;_++)if(!this.getInput("ADD"+_)){const I=this.appendValueInput("ADD"+_).setAlign(o.Align$$module$build$src$core$inputs$align.RIGHT);_===0&&I.appendField(o.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_INPUT_WITH)}for(_=this.itemCount_;this.getInput("ADD"+_);_++)this.removeInput("ADD"+_)}};st.lists_create_with=ht;var et={init:function(){this.setStyle("list_blocks"),this.appendDummyInput().appendField(o.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_CONTAINER_TITLE_ADD),this.appendStatementInput("STACK"),this.setTooltip(o.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_CONTAINER_TOOLTIP),this.contextMenu=!1}};st.lists_create_with_container=et;var dt={init:function(){this.setStyle("list_blocks"),this.appendDummyInput().appendField(o.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_ITEM_TITLE),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(o.Msg$$module$build$src$core$msg.LISTS_CREATE_WITH_ITEM_TOOLTIP),this.contextMenu=!1}};st.lists_create_with_item=dt;var j={init:function(){var _=[[o.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_FIRST,"FIRST"],[o.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_LAST,"LAST"]];if(this.setHelpUrl(o.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_HELPURL),this.setStyle("list_blocks"),this.setOutput(!0,"Number"),this.appendValueInput("VALUE").setCheck("Array").appendField(o.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_INPUT_IN_LIST),_=o.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:_}),!_)throw Error("field_dropdown not found");this.appendValueInput("FIND").appendField(_,"END"),this.setInputsInline(!0),this.setTooltip(()=>o.Msg$$module$build$src$core$msg.LISTS_INDEX_OF_TOOLTIP.replace("%1",this.workspace.options.oneBasedIndex?"0":"-1"))}};st.lists_indexOf=j;var R={init:function(){var _=[[o.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_GET,"GET"],[o.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_GET_REMOVE,"GET_REMOVE"],[o.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_REMOVE,"REMOVE"]];this.WHERE_OPTIONS=[[o.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FROM_START,"FROM_START"],[o.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FROM_END,"FROM_END"],[o.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FIRST,"FIRST"],[o.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_LAST,"LAST"],[o.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_RANDOM,"RANDOM"]],this.setHelpUrl(o.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_HELPURL),this.setStyle("list_blocks"),_=o.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:_}),_.setValidator(function(I){I=I==="REMOVE",this.getSourceBlock().updateStatement_(I)}),this.appendValueInput("VALUE").setCheck("Array").appendField(o.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_INPUT_IN_LIST),this.appendDummyInput().appendField(_,"MODE").appendField("","SPACE"),this.appendDummyInput("AT"),o.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TAIL&&this.appendDummyInput("TAIL").appendField(o.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TAIL),this.setInputsInline(!0),this.setOutput(!0),this.updateAt_(!0),this.setTooltip(()=>{const I=this.getFieldValue("MODE"),M=this.getFieldValue("WHERE");let P="";switch(I+" "+M){case"GET FROM_START":case"GET FROM_END":P=o.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_FROM;break;case"GET FIRST":P=o.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_FIRST;break;case"GET LAST":P=o.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_LAST;break;case"GET RANDOM":P=o.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_RANDOM;break;case"GET_REMOVE FROM_START":case"GET_REMOVE FROM_END":P=o.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FROM;break;case"GET_REMOVE FIRST":P=o.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_FIRST;break;case"GET_REMOVE LAST":P=o.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_LAST;break;case"GET_REMOVE RANDOM":P=o.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_GET_REMOVE_RANDOM;break;case"REMOVE FROM_START":case"REMOVE FROM_END":P=o.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FROM;break;case"REMOVE FIRST":P=o.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_FIRST;break;case"REMOVE LAST":P=o.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_LAST;break;case"REMOVE RANDOM":P=o.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TOOLTIP_REMOVE_RANDOM}return(M==="FROM_START"||M==="FROM_END")&&(P+="  "+(M==="FROM_START"?o.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_START_TOOLTIP:o.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_END_TOOLTIP).replace("%1",this.workspace.options.oneBasedIndex?"#1":"#0")),P})},mutationToDom:function(){const _=o.createElement$$module$build$src$core$utils$xml("mutation");_.setAttribute("statement",String(!this.outputConnection));const I=this.getInput("AT")instanceof o.ValueInput$$module$build$src$core$inputs$value_input;return _.setAttribute("at",String(I)),_},domToMutation:function(_){const I=_.getAttribute("statement")==="true";this.updateStatement_(I),_=_.getAttribute("at")!=="false",this.updateAt_(_)},saveExtraState:function(){return this.outputConnection?null:{isStatement:!0}},loadExtraState:function(_){_.isStatement?this.updateStatement_(!0):typeof _=="string"&&this.domToMutation(o.textToDom$$module$build$src$core$utils$xml(_))},updateStatement_:function(_){_!==!this.outputConnection&&(this.unplug(!0,!0),_?(this.setOutput(!1),this.setPreviousStatement(!0),this.setNextStatement(!0)):(this.setPreviousStatement(!1),this.setNextStatement(!1),this.setOutput(!0)))},updateAt_:function(_){this.removeInput("AT"),this.removeInput("ORDINAL",!0),_?(this.appendValueInput("AT").setCheck("Number"),o.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(o.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT");const I=o.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:this.WHERE_OPTIONS});I.setValidator(function(M){const P=M==="FROM_START"||M==="FROM_END";if(P!==_){const nt=this.getSourceBlock();return nt.updateAt_(P),nt.setFieldValue(M,"WHERE"),null}}),this.getInput("AT").appendField(I,"WHERE"),o.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_TAIL&&this.moveInputBefore("TAIL",null)}};st.lists_getIndex=R;var J={init:function(){var _=[[o.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_SET,"SET"],[o.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_INSERT,"INSERT"]];this.WHERE_OPTIONS=[[o.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FROM_START,"FROM_START"],[o.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FROM_END,"FROM_END"],[o.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_FIRST,"FIRST"],[o.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_LAST,"LAST"],[o.Msg$$module$build$src$core$msg.LISTS_GET_INDEX_RANDOM,"RANDOM"]],this.setHelpUrl(o.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("LIST").setCheck("Array").appendField(o.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_INPUT_IN_LIST),_=o.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:_}),this.appendDummyInput().appendField(_,"MODE").appendField("","SPACE"),this.appendDummyInput("AT"),this.appendValueInput("TO").appendField(o.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_INPUT_TO),this.setInputsInline(!0),this.setPreviousStatement(!0),this.setNextStatement(!0),this.setTooltip(o.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP),this.updateAt_(!0),this.setTooltip(()=>{const I=this.getFieldValue("MODE"),M=this.getFieldValue("WHERE");let P="";switch(I+" "+M){case"SET FROM_START":case"SET FROM_END":P=o.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_SET_FROM;break;case"SET FIRST":P=o.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_SET_FIRST;break;case"SET LAST":P=o.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_SET_LAST;break;case"SET RANDOM":P=o.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_SET_RANDOM;break;case"INSERT FROM_START":case"INSERT FROM_END":P=o.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FROM;break;case"INSERT FIRST":P=o.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_INSERT_FIRST;break;case"INSERT LAST":P=o.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_INSERT_LAST;break;case"INSERT RANDOM":P=o.Msg$$module$build$src$core$msg.LISTS_SET_INDEX_TOOLTIP_INSERT_RANDOM}return(M==="FROM_START"||M==="FROM_END")&&(P+="  "+o.Msg$$module$build$src$core$msg.LISTS_INDEX_FROM_START_TOOLTIP.replace("%1",this.workspace.options.oneBasedIndex?"#1":"#0")),P})},mutationToDom:function(){const _=o.createElement$$module$build$src$core$utils$xml("mutation"),I=this.getInput("AT")instanceof o.ValueInput$$module$build$src$core$inputs$value_input;return _.setAttribute("at",String(I)),_},domToMutation:function(_){_=_.getAttribute("at")!=="false",this.updateAt_(_)},saveExtraState:function(){return null},loadExtraState:function(){},updateAt_:function(_){this.removeInput("AT"),this.removeInput("ORDINAL",!0),_?(this.appendValueInput("AT").setCheck("Number"),o.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL").appendField(o.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT");const I=o.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:this.WHERE_OPTIONS});I.setValidator(function(M){const P=M==="FROM_START"||M==="FROM_END";if(P!==_){const nt=this.getSourceBlock();return nt.updateAt_(P),nt.setFieldValue(M,"WHERE"),null}}),this.moveInputBefore("AT","TO"),this.getInput("ORDINAL")&&this.moveInputBefore("ORDINAL","TO"),this.getInput("AT").appendField(I,"WHERE")}};st.lists_setIndex=J;var kt={init:function(){this.WHERE_OPTIONS_1=[[o.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_START_FROM_START,"FROM_START"],[o.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_START_FROM_END,"FROM_END"],[o.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_START_FIRST,"FIRST"]],this.WHERE_OPTIONS_2=[[o.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_END_FROM_START,"FROM_START"],[o.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_END_FROM_END,"FROM_END"],[o.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_END_LAST,"LAST"]],this.setHelpUrl(o.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("LIST").setCheck("Array").appendField(o.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_INPUT_IN_LIST),this.appendDummyInput("AT1"),this.appendDummyInput("AT2"),o.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_TAIL&&this.appendDummyInput("TAIL").appendField(o.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_TAIL),this.setInputsInline(!0),this.setOutput(!0,"Array"),this.updateAt_(1,!0),this.updateAt_(2,!0),this.setTooltip(o.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_TOOLTIP)},mutationToDom:function(){const _=o.createElement$$module$build$src$core$utils$xml("mutation");var I=this.getInput("AT1")instanceof o.ValueInput$$module$build$src$core$inputs$value_input;return _.setAttribute("at1",String(I)),I=this.getInput("AT2")instanceof o.ValueInput$$module$build$src$core$inputs$value_input,_.setAttribute("at2",String(I)),_},domToMutation:function(_){const I=_.getAttribute("at1")==="true";_=_.getAttribute("at2")==="true",this.updateAt_(1,I),this.updateAt_(2,_)},saveExtraState:function(){return null},loadExtraState:function(){},updateAt_:function(_,I){this.removeInput("AT"+_),this.removeInput("ORDINAL"+_,!0),I?(this.appendValueInput("AT"+_).setCheck("Number"),o.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX&&this.appendDummyInput("ORDINAL"+_).appendField(o.Msg$$module$build$src$core$msg.ORDINAL_NUMBER_SUFFIX)):this.appendDummyInput("AT"+_);const M=o.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:this["WHERE_OPTIONS_"+_]});M.setValidator(function(P){const nt=P==="FROM_START"||P==="FROM_END";if(nt!==I){const Pt=this.getSourceBlock();return Pt.updateAt_(_,nt),Pt.setFieldValue(P,"WHERE"+_),null}}),this.getInput("AT"+_).appendField(M,"WHERE"+_),_===1&&(this.moveInputBefore("AT1","AT2"),this.getInput("ORDINAL1")&&this.moveInputBefore("ORDINAL1","AT2")),o.Msg$$module$build$src$core$msg.LISTS_GET_SUBLIST_TAIL&&this.moveInputBefore("TAIL",null)}};st.lists_getSublist=kt,st.lists_sort={init:function(){this.jsonInit({message0:"%{BKY_LISTS_SORT_TITLE}",args0:[{type:"field_dropdown",name:"TYPE",options:[["%{BKY_LISTS_SORT_TYPE_NUMERIC}","NUMERIC"],["%{BKY_LISTS_SORT_TYPE_TEXT}","TEXT"],["%{BKY_LISTS_SORT_TYPE_IGNORECASE}","IGNORE_CASE"]]},{type:"field_dropdown",name:"DIRECTION",options:[["%{BKY_LISTS_SORT_ORDER_ASCENDING}","1"],["%{BKY_LISTS_SORT_ORDER_DESCENDING}","-1"]]},{type:"input_value",name:"LIST",check:"Array"}],output:"Array",style:"list_blocks",tooltip:"%{BKY_LISTS_SORT_TOOLTIP}",helpUrl:"%{BKY_LISTS_SORT_HELPURL}"})}},st.lists_split={init:function(){const _=o.fromJson$$module$build$src$core$field_registry({type:"field_dropdown",options:[[o.Msg$$module$build$src$core$msg.LISTS_SPLIT_LIST_FROM_TEXT,"SPLIT"],[o.Msg$$module$build$src$core$msg.LISTS_SPLIT_TEXT_FROM_LIST,"JOIN"]]});if(!_)throw Error("field_dropdown not found");_.setValidator(I=>{this.updateType_(I)}),this.setHelpUrl(o.Msg$$module$build$src$core$msg.LISTS_SPLIT_HELPURL),this.setStyle("list_blocks"),this.appendValueInput("INPUT").setCheck("String").appendField(_,"MODE"),this.appendValueInput("DELIM").setCheck("String").appendField(o.Msg$$module$build$src$core$msg.LISTS_SPLIT_WITH_DELIMITER),this.setInputsInline(!0),this.setOutput(!0,"Array"),this.setTooltip(()=>{const I=this.getFieldValue("MODE");if(I==="SPLIT")return o.Msg$$module$build$src$core$msg.LISTS_SPLIT_TOOLTIP_SPLIT;if(I==="JOIN")return o.Msg$$module$build$src$core$msg.LISTS_SPLIT_TOOLTIP_JOIN;throw Error("Unknown mode: "+I)})},updateType_:function(_){if(this.getFieldValue("MODE")!==_){const I=this.getInput("INPUT").connection;I.setShadowDom(null);const M=I.targetBlock();M&&(I.disconnect(),M.isShadow()?M.dispose(!1):this.bumpNeighbours())}_==="SPLIT"?(this.outputConnection.setCheck("Array"),this.getInput("INPUT").setCheck("String")):(this.outputConnection.setCheck("String"),this.getInput("INPUT").setCheck("Array"))},mutationToDom:function(){const _=o.createElement$$module$build$src$core$utils$xml("mutation");return _.setAttribute("mode",this.getFieldValue("MODE")),_},domToMutation:function(_){this.updateType_(_.getAttribute("mode"))},saveExtraState:function(){return null},loadExtraState:function(){}},o.defineBlocks$$module$build$src$core$common(st);var mt={blocks:st},Vt=o.createBlockDefinitionsFromJsonArray$$module$build$src$core$common([{type:"colour_picker",message0:"%1",args0:[{type:"field_colour",name:"COLOUR",colour:"#ff0000"}],output:"Colour",helpUrl:"%{BKY_COLOUR_PICKER_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_PICKER_TOOLTIP}",extensions:["parent_tooltip_when_inline"]},{type:"colour_random",message0:"%{BKY_COLOUR_RANDOM_TITLE}",output:"Colour",helpUrl:"%{BKY_COLOUR_RANDOM_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_RANDOM_TOOLTIP}"},{type:"colour_rgb",message0:"%{BKY_COLOUR_RGB_TITLE} %{BKY_COLOUR_RGB_RED} %1 %{BKY_COLOUR_RGB_GREEN} %2 %{BKY_COLOUR_RGB_BLUE} %3",args0:[{type:"input_value",name:"RED",check:"Number",align:"RIGHT"},{type:"input_value",name:"GREEN",check:"Number",align:"RIGHT"},{type:"input_value",name:"BLUE",check:"Number",align:"RIGHT"}],output:"Colour",helpUrl:"%{BKY_COLOUR_RGB_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_RGB_TOOLTIP}"},{type:"colour_blend",message0:"%{BKY_COLOUR_BLEND_TITLE} %{BKY_COLOUR_BLEND_COLOUR1} %1 %{BKY_COLOUR_BLEND_COLOUR2} %2 %{BKY_COLOUR_BLEND_RATIO} %3",args0:[{type:"input_value",name:"COLOUR1",check:"Colour",align:"RIGHT"},{type:"input_value",name:"COLOUR2",check:"Colour",align:"RIGHT"},{type:"input_value",name:"RATIO",check:"Number",align:"RIGHT"}],output:"Colour",helpUrl:"%{BKY_COLOUR_BLEND_HELPURL}",style:"colour_blocks",tooltip:"%{BKY_COLOUR_BLEND_TOOLTIP}"}]);o.defineBlocks$$module$build$src$core$common(Vt);var Ct={blocks:Vt},Qt=Object.assign({},Vt,st,hi,ut,Rt,lt,g,l),k={blocks:Qt,colour:Ct,lists:mt,loops:Ke,math:fe,procedures:Ft,texts:$t,variables:y,variablesDynamic:p};return k.__namespace__=o,k})}(Z$)),Z$.exports}var hC;function rx(){return hC||(hC=1,function(n,e){(function(s,o){n.exports=o(nx())})(ps,function(s){/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */return s})}(q$)),q$.exports}var Q$={exports:{}},t_={exports:{}},uC;function lx(){return uC||(uC=1,function(n,e){(function(s,o){n.exports=o(kb())})(ps,function(s){var o=s.__namespace__,l=function($,v){return[v.quote_($.getFieldValue("COLOUR")),k.ATOMIC]},a=function($,v){return[v.provideFunction_("colourRandom",`
function ${v.FUNCTION_NAME_PLACEHOLDER_}() {
  var num = Math.floor(Math.random() * Math.pow(2, 24));
  return '#' + ('00000' + num.toString(16)).substr(-6);
}
`)+"()",k.FUNCTION_CALL]},h=function($,v){const O=v.valueToCode($,"RED",k.NONE)||0,B=v.valueToCode($,"GREEN",k.NONE)||0;return $=v.valueToCode($,"BLUE",k.NONE)||0,[v.provideFunction_("colourRgb",`
function ${v.FUNCTION_NAME_PLACEHOLDER_}(r, g, b) {
  r = Math.max(Math.min(Number(r), 100), 0) * 2.55;
  g = Math.max(Math.min(Number(g), 100), 0) * 2.55;
  b = Math.max(Math.min(Number(b), 100), 0) * 2.55;
  r = ('0' + (Math.round(r) || 0).toString(16)).slice(-2);
  g = ('0' + (Math.round(g) || 0).toString(16)).slice(-2);
  b = ('0' + (Math.round(b) || 0).toString(16)).slice(-2);
  return '#' + r + g + b;
}
`)+"("+O+", "+B+", "+$+")",k.FUNCTION_CALL]},d=function($,v){const O=v.valueToCode($,"COLOUR1",k.NONE)||"'#000000'",B=v.valueToCode($,"COLOUR2",k.NONE)||"'#000000'";return $=v.valueToCode($,"RATIO",k.NONE)||.5,[v.provideFunction_("colourBlend",`
function ${v.FUNCTION_NAME_PLACEHOLDER_}(c1, c2, ratio) {
  ratio = Math.max(Math.min(Number(ratio), 1), 0);
  var r1 = parseInt(c1.substring(1, 3), 16);
  var g1 = parseInt(c1.substring(3, 5), 16);
  var b1 = parseInt(c1.substring(5, 7), 16);
  var r2 = parseInt(c2.substring(1, 3), 16);
  var g2 = parseInt(c2.substring(3, 5), 16);
  var b2 = parseInt(c2.substring(5, 7), 16);
  var r = Math.round(r1 * (1 - ratio) + r2 * ratio);
  var g = Math.round(g1 * (1 - ratio) + g2 * ratio);
  var b = Math.round(b1 * (1 - ratio) + b2 * ratio);
  r = ('0' + (r || 0).toString(16)).slice(-2);
  g = ('0' + (g || 0).toString(16)).slice(-2);
  b = ('0' + (b || 0).toString(16)).slice(-2);
  return '#' + r + g + b;
}
`)+"("+O+", "+B+", "+$+")",k.FUNCTION_CALL]},p=function($,v){return["[]",k.ATOMIC]},g=function($,v){const O=Array($.itemCount_);for(let B=0;B<$.itemCount_;B++)O[B]=v.valueToCode($,"ADD"+B,k.NONE)||"null";return["["+O.join(", ")+"]",k.ATOMIC]},m=function($,v){const O=v.provideFunction_("listsRepeat",`
function ${v.FUNCTION_NAME_PLACEHOLDER_}(value, n) {
  var array = [];
  for (var i = 0; i < n; i++) {
    array[i] = value;
  }
  return array;
}
`),B=v.valueToCode($,"ITEM",k.NONE)||"null";return $=v.valueToCode($,"NUM",k.NONE)||"0",[O+"("+B+", "+$+")",k.FUNCTION_CALL]},T=function($,v){return[(v.valueToCode($,"VALUE",k.MEMBER)||"[]")+".length",k.MEMBER]},b=function($,v){return["!"+(v.valueToCode($,"VALUE",k.MEMBER)||"[]")+".length",k.LOGICAL_NOT]},y=function($,v){const O=$.getFieldValue("END")==="FIRST"?"indexOf":"lastIndexOf",B=v.valueToCode($,"FIND",k.NONE)||"''";return v=(v.valueToCode($,"VALUE",k.MEMBER)||"[]")+"."+O+"("+B+")",$.workspace.options.oneBasedIndex?[v+" + 1",k.ADDITION]:[v,k.FUNCTION_CALL]},C=function($,v){const O=$.getFieldValue("MODE")||"GET",B=$.getFieldValue("WHERE")||"FROM_START";var tt=v.valueToCode($,"VALUE",B==="RANDOM"?k.NONE:k.MEMBER)||"[]";switch(B){case"FIRST":if(O==="GET")return[tt+"[0]",k.MEMBER];if(O==="GET_REMOVE")return[tt+".shift()",k.MEMBER];if(O==="REMOVE")return tt+`.shift();
`;break;case"LAST":if(O==="GET")return[tt+".slice(-1)[0]",k.MEMBER];if(O==="GET_REMOVE")return[tt+".pop()",k.MEMBER];if(O==="REMOVE")return tt+`.pop();
`;break;case"FROM_START":if($=v.getAdjusted($,"AT"),O==="GET")return[tt+"["+$+"]",k.MEMBER];if(O==="GET_REMOVE")return[tt+".splice("+$+", 1)[0]",k.FUNCTION_CALL];if(O==="REMOVE")return tt+".splice("+$+`, 1);
`;break;case"FROM_END":if($=v.getAdjusted($,"AT",1,!0),O==="GET")return[tt+".slice("+$+")[0]",k.FUNCTION_CALL];if(O==="GET_REMOVE")return[tt+".splice("+$+", 1)[0]",k.FUNCTION_CALL];if(O==="REMOVE")return tt+".splice("+$+", 1);";break;case"RANDOM":if(tt=v.provideFunction_("listsGetRandomItem",`
function ${v.FUNCTION_NAME_PLACEHOLDER_}(list, remove) {
  var x = Math.floor(Math.random() * list.length);
  if (remove) {
    return list.splice(x, 1)[0];
  } else {
    return list[x];
  }
}
`)+"("+tt+", "+(O!=="GET")+")",O==="GET"||O==="GET_REMOVE")return[tt,k.FUNCTION_CALL];if(O==="REMOVE")return tt+`;
`}throw Error("Unhandled combination (lists_getIndex).")},L=function($,v){function O(){if(B.match(/^\w+$/))return"";const Wi=v.nameDB_.getDistinctName("tmpList",o.NameType$$module$build$src$core$names.VARIABLE),yo="var "+Wi+" = "+B+`;
`;return B=Wi,yo}let B=v.valueToCode($,"LIST",k.MEMBER)||"[]";const tt=$.getFieldValue("MODE")||"GET";var At=$.getFieldValue("WHERE")||"FROM_START";const Ut=v.valueToCode($,"TO",k.ASSIGNMENT)||"null";switch(At){case"FIRST":if(tt==="SET")return B+"[0] = "+Ut+`;
`;if(tt==="INSERT")return B+".unshift("+Ut+`);
`;break;case"LAST":if(tt==="SET")return O()+(B+"["+B+".length - 1] = "+Ut+`;
`);if(tt==="INSERT")return B+".push("+Ut+`);
`;break;case"FROM_START":if($=v.getAdjusted($,"AT"),tt==="SET")return B+"["+$+"] = "+Ut+`;
`;if(tt==="INSERT")return B+".splice("+$+", 0, "+Ut+`);
`;break;case"FROM_END":if($=v.getAdjusted($,"AT",1,!1,k.SUBTRACTION),At=O(),tt==="SET")return At+(B+"["+B+".length - "+$+"] = "+Ut+`;
`);if(tt==="INSERT")return At+(B+".splice("+B+".length - "+$+", 0, "+Ut+`);
`);break;case"RANDOM":if($=O(),At=v.nameDB_.getDistinctName("tmpX",o.NameType$$module$build$src$core$names.VARIABLE),$+="var "+At+" = Math.floor(Math.random() * "+B+`.length);
`,tt==="SET")return $+(B+"["+At+"] = "+Ut+`;
`);if(tt==="INSERT")return $+(B+".splice("+At+", 0, "+Ut+`);
`)}throw Error("Unhandled combination (lists_setIndex).")},A=function($,v){var O={FIRST:"First",LAST:"Last",FROM_START:"FromStart",FROM_END:"FromEnd"},B=v.valueToCode($,"LIST",k.MEMBER)||"[]";const tt=$.getFieldValue("WHERE1"),At=$.getFieldValue("WHERE2");if(tt==="FIRST"&&At==="LAST")B+=".slice(0)";else if(B.match(/^\w+$/)||tt!=="FROM_END"&&At==="FROM_START"){switch(tt){case"FROM_START":O=v.getAdjusted($,"AT1");break;case"FROM_END":O=v.getAdjusted($,"AT1",1,!1,k.SUBTRACTION),O=B+".length - "+O;break;case"FIRST":O="0";break;default:throw Error("Unhandled option (lists_getSublist).")}switch(At){case"FROM_START":v=v.getAdjusted($,"AT2",1);break;case"FROM_END":v=v.getAdjusted($,"AT2",0,!1,k.SUBTRACTION),v=B+".length - "+v;break;case"LAST":v=B+".length";break;default:throw Error("Unhandled option (lists_getSublist).")}B=B+".slice("+O+", "+v+")"}else{const Ut=v.getAdjusted($,"AT1");$=v.getAdjusted($,"AT2"),B=v.provideFunction_("subsequence"+O[tt]+O[At],`
function ${v.FUNCTION_NAME_PLACEHOLDER_}(sequence${tt==="FROM_END"||tt==="FROM_START"?", at1":""}${At==="FROM_END"||At==="FROM_START"?", at2":""}) {
  var start = ${M("sequence",tt,"at1")};
  var end = ${M("sequence",At,"at2")} + 1;
  return sequence.slice(start, end);
}
`)+"("+B+(tt==="FROM_END"||tt==="FROM_START"?", "+Ut:"")+(At==="FROM_END"||At==="FROM_START"?", "+$:"")+")"}return[B,k.FUNCTION_CALL]},F=function($,v){const O=v.valueToCode($,"LIST",k.FUNCTION_CALL)||"[]",B=$.getFieldValue("DIRECTION")==="1"?1:-1;return $=$.getFieldValue("TYPE"),v=v.provideFunction_("listsGetSortCompare",`
function ${v.FUNCTION_NAME_PLACEHOLDER_}(type, direction) {
  var compareFuncs = {
    'NUMERIC': function(a, b) {
        return Number(a) - Number(b); },
    'TEXT': function(a, b) {
        return String(a) > String(b) ? 1 : -1; },
    'IGNORE_CASE': function(a, b) {
        return String(a).toLowerCase() > String(b).toLowerCase() ? 1 : -1; },
  };
  var compare = compareFuncs[type];
  return function(a, b) { return compare(a, b) * direction; };
}
      `),[O+".slice().sort("+v+'("'+$+'", '+B+"))",k.FUNCTION_CALL]},z=function($,v){let O=v.valueToCode($,"INPUT",k.MEMBER);if(v=v.valueToCode($,"DELIM",k.NONE)||"''",$=$.getFieldValue("MODE"),$==="SPLIT")O||(O="''"),$="split";else if($==="JOIN")O||(O="[]"),$="join";else throw Error("Unknown mode: "+$);return[O+"."+$+"("+v+")",k.FUNCTION_CALL]},X=function($,v){return[(v.valueToCode($,"LIST",k.FUNCTION_CALL)||"[]")+".slice().reverse()",k.FUNCTION_CALL]},K=function($,v){var O=0;let B="";v.STATEMENT_PREFIX&&(B+=v.injectId(v.STATEMENT_PREFIX,$));do{const tt=v.valueToCode($,"IF"+O,k.NONE)||"false";let At=v.statementToCode($,"DO"+O);v.STATEMENT_SUFFIX&&(At=v.prefixLines(v.injectId(v.STATEMENT_SUFFIX,$),v.INDENT)+At),B+=(0<O?" else ":"")+"if ("+tt+`) {
`+At+"}",O++}while($.getInput("IF"+O));return($.getInput("ELSE")||v.STATEMENT_SUFFIX)&&(O=v.statementToCode($,"ELSE"),v.STATEMENT_SUFFIX&&(O=v.prefixLines(v.injectId(v.STATEMENT_SUFFIX,$),v.INDENT)+O),B+=` else {
`+O+"}"),B+`
`},Y=function($,v){const O={EQ:"==",NEQ:"!=",LT:"<",LTE:"<=",GT:">",GTE:">="}[$.getFieldValue("OP")],B=O==="=="||O==="!="?k.EQUALITY:k.RELATIONAL,tt=v.valueToCode($,"A",B)||"0";return $=v.valueToCode($,"B",B)||"0",[tt+" "+O+" "+$,B]},V=function($,v){const O=$.getFieldValue("OP")==="AND"?"&&":"||",B=O==="&&"?k.LOGICAL_AND:k.LOGICAL_OR;let tt=v.valueToCode($,"A",B);return $=v.valueToCode($,"B",B),tt||$?(v=O==="&&"?"true":"false",tt||(tt=v),$||($=v)):$=tt="false",[tt+" "+O+" "+$,B]},H=function($,v){const O=k.LOGICAL_NOT;return["!"+(v.valueToCode($,"BOOL",O)||"true"),O]},Tt=function($,v){return[$.getFieldValue("BOOL")==="TRUE"?"true":"false",k.ATOMIC]},$t=function($,v){return["null",k.ATOMIC]},lt=function($,v){const O=v.valueToCode($,"IF",k.CONDITIONAL)||"false",B=v.valueToCode($,"THEN",k.CONDITIONAL)||"null";return $=v.valueToCode($,"ELSE",k.CONDITIONAL)||"null",[O+" ? "+B+" : "+$,k.CONDITIONAL]},ot=function($,v){let O;O=$.getField("TIMES")?String(Number($.getFieldValue("TIMES"))):v.valueToCode($,"TIMES",k.ASSIGNMENT)||"0";let B=v.statementToCode($,"DO");B=v.addLoopTrap(B,$),$="";const tt=v.nameDB_.getDistinctName("count",o.NameType$$module$build$src$core$names.VARIABLE);let At=O;return O.match(/^\w+$/)||o.isNumber$$module$build$src$core$utils$string(O)||(At=v.nameDB_.getDistinctName("repeat_end",o.NameType$$module$build$src$core$names.VARIABLE),$+="var "+At+" = "+O+`;
`),$+("for (var "+tt+" = 0; "+tt+" < "+At+"; "+tt+`++) {
`+B+`}
`)},ct=function($,v){const O=$.getFieldValue("MODE")==="UNTIL";let B=v.valueToCode($,"BOOL",O?k.LOGICAL_NOT:k.NONE)||"false",tt=v.statementToCode($,"DO");return tt=v.addLoopTrap(tt,$),O&&(B="!"+B),"while ("+B+`) {
`+tt+`}
`},gt=function($,v){var O=v.getVariableName($.getFieldValue("VAR")),B=v.valueToCode($,"FROM",k.ASSIGNMENT)||"0",tt=v.valueToCode($,"TO",k.ASSIGNMENT)||"0";const At=v.valueToCode($,"BY",k.ASSIGNMENT)||"1";let Ut=v.statementToCode($,"DO");if(Ut=v.addLoopTrap(Ut,$),o.isNumber$$module$build$src$core$utils$string(B)&&o.isNumber$$module$build$src$core$utils$string(tt)&&o.isNumber$$module$build$src$core$utils$string(At))v=Number(B)<=Number(tt),$="for ("+O+" = "+B+"; "+O+(v?" <= ":" >= ")+tt+"; "+O,O=Math.abs(Number(At)),$=O===1?$+(v?"++":"--"):$+((v?" += ":" -= ")+O),$+=`) {
`+Ut+`}
`;else{$="";let Wi=B;B.match(/^\w+$/)||o.isNumber$$module$build$src$core$utils$string(B)||(Wi=v.nameDB_.getDistinctName(O+"_start",o.NameType$$module$build$src$core$names.VARIABLE),$+="var "+Wi+" = "+B+`;
`),B=tt,tt.match(/^\w+$/)||o.isNumber$$module$build$src$core$utils$string(tt)||(B=v.nameDB_.getDistinctName(O+"_end",o.NameType$$module$build$src$core$names.VARIABLE),$+="var "+B+" = "+tt+`;
`),tt=v.nameDB_.getDistinctName(O+"_inc",o.NameType$$module$build$src$core$names.VARIABLE),$+="var "+tt+" = ",$=o.isNumber$$module$build$src$core$utils$string(At)?$+(Math.abs(Number(At))+`;
`):$+("Math.abs("+At+`);
`),$+="if ("+Wi+" > "+B+`) {
`,$+=v.INDENT+tt+" = -"+tt+`;
`,$=$+`}
for (`+(O+" = "+Wi+"; "+tt+" >= 0 ? "+O+" <= "+B+" : "+O+" >= "+B+"; "+O+" += "+tt+`) {
`+Ut+`}
`)}return $},vt=function($,v){const O=v.getVariableName($.getFieldValue("VAR"));var B=v.valueToCode($,"LIST",k.ASSIGNMENT)||"[]";let tt=v.statementToCode($,"DO");tt=v.addLoopTrap(tt,$),$="";let At=B;return B.match(/^\w+$/)||(At=v.nameDB_.getDistinctName(O+"_list",o.NameType$$module$build$src$core$names.VARIABLE),$+="var "+At+" = "+B+`;
`),B=v.nameDB_.getDistinctName(O+"_index",o.NameType$$module$build$src$core$names.VARIABLE),tt=v.INDENT+O+" = "+At+"["+B+`];
`+tt,$+("for (var "+B+" in "+At+`) {
`+tt+`}
`)},it=function($,v){let O="";if(v.STATEMENT_PREFIX&&(O+=v.injectId(v.STATEMENT_PREFIX,$)),v.STATEMENT_SUFFIX&&(O+=v.injectId(v.STATEMENT_SUFFIX,$)),v.STATEMENT_PREFIX){const B=$.getSurroundLoop();B&&!B.suppressPrefixSuffix&&(O+=v.injectId(v.STATEMENT_PREFIX,B))}switch($.getFieldValue("FLOW")){case"BREAK":return O+`break;
`;case"CONTINUE":return O+`continue;
`}throw Error("Unknown flow statement.")},Ft=function($,v){return $=Number($.getFieldValue("NUM")),[String($),0<=$?k.ATOMIC:k.UNARY_NEGATION]},Rt=function($,v){var O={ADD:[" + ",k.ADDITION],MINUS:[" - ",k.SUBTRACTION],MULTIPLY:[" * ",k.MULTIPLICATION],DIVIDE:[" / ",k.DIVISION],POWER:[null,k.NONE]}[$.getFieldValue("OP")];const B=O[0];O=O[1];const tt=v.valueToCode($,"A",O)||"0";return $=v.valueToCode($,"B",O)||"0",B?[tt+B+$,O]:["Math.pow("+tt+", "+$+")",k.FUNCTION_CALL]},Nt=function($,v){const O=$.getFieldValue("OP");let B;if(O==="NEG")return $=v.valueToCode($,"NUM",k.UNARY_NEGATION)||"0",$[0]==="-"&&($=" "+$),["-"+$,k.UNARY_NEGATION];switch($=O==="SIN"||O==="COS"||O==="TAN"?v.valueToCode($,"NUM",k.DIVISION)||"0":v.valueToCode($,"NUM",k.NONE)||"0",O){case"ABS":B="Math.abs("+$+")";break;case"ROOT":B="Math.sqrt("+$+")";break;case"LN":B="Math.log("+$+")";break;case"EXP":B="Math.exp("+$+")";break;case"POW10":B="Math.pow(10,"+$+")";break;case"ROUND":B="Math.round("+$+")";break;case"ROUNDUP":B="Math.ceil("+$+")";break;case"ROUNDDOWN":B="Math.floor("+$+")";break;case"SIN":B="Math.sin("+$+" / 180 * Math.PI)";break;case"COS":B="Math.cos("+$+" / 180 * Math.PI)";break;case"TAN":B="Math.tan("+$+" / 180 * Math.PI)"}if(B)return[B,k.FUNCTION_CALL];switch(O){case"LOG10":B="Math.log("+$+") / Math.log(10)";break;case"ASIN":B="Math.asin("+$+") / Math.PI * 180";break;case"ACOS":B="Math.acos("+$+") / Math.PI * 180";break;case"ATAN":B="Math.atan("+$+") / Math.PI * 180";break;default:throw Error("Unknown math operator: "+O)}return[B,k.DIVISION]},me=function($,v){return{PI:["Math.PI",k.MEMBER],E:["Math.E",k.MEMBER],GOLDEN_RATIO:["(1 + Math.sqrt(5)) / 2",k.DIVISION],SQRT2:["Math.SQRT2",k.MEMBER],SQRT1_2:["Math.SQRT1_2",k.MEMBER],INFINITY:["Infinity",k.ATOMIC]}[$.getFieldValue("CONSTANT")]},Lt=function($,v){var O={EVEN:[" % 2 === 0",k.MODULUS,k.EQUALITY],ODD:[" % 2 === 1",k.MODULUS,k.EQUALITY],WHOLE:[" % 1 === 0",k.MODULUS,k.EQUALITY],POSITIVE:[" > 0",k.RELATIONAL,k.RELATIONAL],NEGATIVE:[" < 0",k.RELATIONAL,k.RELATIONAL],DIVISIBLE_BY:[null,k.MODULUS,k.EQUALITY],PRIME:[null,k.NONE,k.FUNCTION_CALL]};const B=$.getFieldValue("PROPERTY"),[tt,At,Ut]=O[B];return O=v.valueToCode($,"NUMBER_TO_CHECK",At)||"0",B==="PRIME"?$=v.provideFunction_("mathIsPrime",`
function ${v.FUNCTION_NAME_PLACEHOLDER_}(n) {
  // https://en.wikipedia.org/wiki/Primality_test#Naive_methods
  if (n == 2 || n == 3) {
    return true;
  }
  // False if n is NaN, negative, is 1, or not whole.
  // And false if n is divisible by 2 or 3.
  if (isNaN(n) || n <= 1 || n % 1 !== 0 || n % 2 === 0 || n % 3 === 0) {
    return false;
  }
  // Check all the numbers of form 6k +/- 1, up to sqrt(n).
  for (var x = 6; x <= Math.sqrt(n) + 1; x += 6) {
    if (n % (x - 1) === 0 || n % (x + 1) === 0) {
      return false;
    }
  }
  return true;
}
`)+"("+O+")":B==="DIVISIBLE_BY"?($=v.valueToCode($,"DIVISOR",k.MODULUS)||"0",$=O+" % "+$+" === 0"):$=O+tt,[$,Ut]},Gt=function($,v){const O=v.valueToCode($,"DELTA",k.ADDITION)||"0";return $=v.getVariableName($.getFieldValue("VAR")),$+" = (typeof "+$+" === 'number' ? "+$+" : 0) + "+O+`;
`},Ht=function($,v){var O=$.getFieldValue("OP");switch(O){case"SUM":$=v.valueToCode($,"LIST",k.MEMBER)||"[]",$+=".reduce(function(x, y) {return x + y;}, 0)";break;case"MIN":$=v.valueToCode($,"LIST",k.NONE)||"[]",$="Math.min.apply(null, "+$+")";break;case"MAX":$=v.valueToCode($,"LIST",k.NONE)||"[]",$="Math.max.apply(null, "+$+")";break;case"AVERAGE":O=v.provideFunction_("mathMean",`
function ${v.FUNCTION_NAME_PLACEHOLDER_}(myList) {
  return myList.reduce(function(x, y) {return x + y;}, 0) / myList.length;
}
`),$=v.valueToCode($,"LIST",k.NONE)||"[]",$=O+"("+$+")";break;case"MEDIAN":O=v.provideFunction_("mathMedian",`
function ${v.FUNCTION_NAME_PLACEHOLDER_}(myList) {
  var localList = myList.filter(function (x) {return typeof x === 'number';});
  if (!localList.length) return null;
  localList.sort(function(a, b) {return b - a;});
  if (localList.length % 2 === 0) {
    return (localList[localList.length / 2 - 1] + localList[localList.length / 2]) / 2;
  } else {
    return localList[(localList.length - 1) / 2];
  }
}
`),$=v.valueToCode($,"LIST",k.NONE)||"[]",$=O+"("+$+")";break;case"MODE":O=v.provideFunction_("mathModes",`
function ${v.FUNCTION_NAME_PLACEHOLDER_}(values) {
  var modes = [];
  var counts = [];
  var maxCount = 0;
  for (var i = 0; i < values.length; i++) {
    var value = values[i];
    var found = false;
    var thisCount;
    for (var j = 0; j < counts.length; j++) {
      if (counts[j][0] === value) {
        thisCount = ++counts[j][1];
        found = true;
        break;
      }
    }
    if (!found) {
      counts.push([value, 1]);
      thisCount = 1;
    }
    maxCount = Math.max(thisCount, maxCount);
  }
  for (var j = 0; j < counts.length; j++) {
    if (counts[j][1] === maxCount) {
        modes.push(counts[j][0]);
    }
  }
  return modes;
}
`),$=v.valueToCode($,"LIST",k.NONE)||"[]",$=O+"("+$+")";break;case"STD_DEV":O=v.provideFunction_("mathStandardDeviation",`
function ${v.FUNCTION_NAME_PLACEHOLDER_}(numbers) {
  var n = numbers.length;
  if (!n) return null;
  var mean = numbers.reduce(function(x, y) {return x + y;}) / n;
  var variance = 0;
  for (var j = 0; j < n; j++) {
    variance += Math.pow(numbers[j] - mean, 2);
  }
  variance = variance / n;
  return Math.sqrt(variance);
}
`),$=v.valueToCode($,"LIST",k.NONE)||"[]",$=O+"("+$+")";break;case"RANDOM":O=v.provideFunction_("mathRandomList",`
function ${v.FUNCTION_NAME_PLACEHOLDER_}(list) {
  var x = Math.floor(Math.random() * list.length);
  return list[x];
}
`),$=v.valueToCode($,"LIST",k.NONE)||"[]",$=O+"("+$+")";break;default:throw Error("Unknown operator: "+O)}return[$,k.FUNCTION_CALL]},fe=function($,v){const O=v.valueToCode($,"DIVIDEND",k.MODULUS)||"0";return $=v.valueToCode($,"DIVISOR",k.MODULUS)||"0",[O+" % "+$,k.MODULUS]},ut=function($,v){const O=v.valueToCode($,"VALUE",k.NONE)||"0",B=v.valueToCode($,"LOW",k.NONE)||"0";return $=v.valueToCode($,"HIGH",k.NONE)||"Infinity",["Math.min(Math.max("+O+", "+B+"), "+$+")",k.FUNCTION_CALL]},be=function($,v){const O=v.valueToCode($,"FROM",k.NONE)||"0";return $=v.valueToCode($,"TO",k.NONE)||"0",[v.provideFunction_("mathRandomInt",`
function ${v.FUNCTION_NAME_PLACEHOLDER_}(a, b) {
  if (a > b) {
    // Swap a and b to ensure a is smaller.
    var c = a;
    a = b;
    b = c;
  }
  return Math.floor(Math.random() * (b - a + 1) + a);
}
`)+"("+O+", "+$+")",k.FUNCTION_CALL]},_e=function($,v){return["Math.random()",k.FUNCTION_CALL]},xe=function($,v){const O=v.valueToCode($,"X",k.NONE)||"0";return["Math.atan2("+(v.valueToCode($,"Y",k.NONE)||"0")+", "+O+") / Math.PI * 180",k.DIVISION]},Ee=function($,v){const O=v.getProcedureName($.getFieldValue("NAME"));var B="";v.STATEMENT_PREFIX&&(B+=v.injectId(v.STATEMENT_PREFIX,$)),v.STATEMENT_SUFFIX&&(B+=v.injectId(v.STATEMENT_SUFFIX,$)),B&&(B=v.prefixLines(B,v.INDENT));let tt="";v.INFINITE_LOOP_TRAP&&(tt=v.prefixLines(v.injectId(v.INFINITE_LOOP_TRAP,$),v.INDENT));const At=v.statementToCode($,"STACK");let Ut=v.valueToCode($,"RETURN",k.NONE)||"",Wi="";At&&Ut&&(Wi=B),Ut&&(Ut=v.INDENT+"return "+Ut+`;
`);const yo=[],xc=$.getVars();for(let Ps=0;Ps<xc.length;Ps++)yo[Ps]=v.getVariableName(xc[Ps]);return B="function "+O+"("+yo.join(", ")+`) {
`+B+tt+At+Wi+Ut+"}",B=v.scrub_($,B),v.definitions_["%"+O]=B,null},ai=function($,v){const O=v.getProcedureName($.getFieldValue("NAME")),B=[],tt=$.getVars();for(let At=0;At<tt.length;At++)B[At]=v.valueToCode($,"ARG"+At,k.NONE)||"null";return[O+"("+B.join(", ")+")",k.FUNCTION_CALL]},Ke=function($,v){return v.forBlock.procedures_callreturn($,v)[0]+`;
`},hi=function($,v){let O="if ("+(v.valueToCode($,"CONDITION",k.NONE)||"false")+`) {
`;return v.STATEMENT_SUFFIX&&(O+=v.prefixLines(v.injectId(v.STATEMENT_SUFFIX,$),v.INDENT)),$.hasReturnValue_?($=v.valueToCode($,"VALUE",k.NONE)||"null",O+=v.INDENT+"return "+$+`;
`):O+=v.INDENT+`return;
`,O+`}
`},yt=function($,v){return[v.quote_($.getFieldValue("TEXT")),k.ATOMIC]},w=function($,v){return $=v.multiline_quote_($.getFieldValue("TEXT")),v=$.indexOf("+")!==-1?k.ADDITION:k.ATOMIC,[$,v]},N=function($,v){switch($.itemCount_){case 0:return["''",k.ATOMIC];case 1:return $=v.valueToCode($,"ADD0",k.NONE)||"''",sn($);case 2:var O=v.valueToCode($,"ADD0",k.NONE)||"''";return $=v.valueToCode($,"ADD1",k.NONE)||"''",[sn(O)[0]+" + "+sn($)[0],k.ADDITION];default:O=Array($.itemCount_);for(let B=0;B<$.itemCount_;B++)O[B]=v.valueToCode($,"ADD"+B,k.NONE)||"''";return["["+O.join(",")+"].join('')",k.FUNCTION_CALL]}},G=function($,v){const O=v.getVariableName($.getFieldValue("VAR"));return $=v.valueToCode($,"TEXT",k.NONE)||"''",O+" += "+sn($)[0]+`;
`},q=function($,v){return[(v.valueToCode($,"VALUE",k.MEMBER)||"''")+".length",k.MEMBER]},Z=function($,v){return["!"+(v.valueToCode($,"VALUE",k.MEMBER)||"''")+".length",k.LOGICAL_NOT]},st=function($,v){const O=$.getFieldValue("END")==="FIRST"?"indexOf":"lastIndexOf",B=v.valueToCode($,"FIND",k.NONE)||"''";return v=(v.valueToCode($,"VALUE",k.MEMBER)||"''")+"."+O+"("+B+")",$.workspace.options.oneBasedIndex?[v+" + 1",k.ADDITION]:[v,k.FUNCTION_CALL]},ht=function($,v){const O=$.getFieldValue("WHERE")||"FROM_START",B=v.valueToCode($,"VALUE",O==="RANDOM"?k.NONE:k.MEMBER)||"''";switch(O){case"FIRST":return[B+".charAt(0)",k.FUNCTION_CALL];case"LAST":return[B+".slice(-1)",k.FUNCTION_CALL];case"FROM_START":return $=v.getAdjusted($,"AT"),[B+".charAt("+$+")",k.FUNCTION_CALL];case"FROM_END":return $=v.getAdjusted($,"AT",1,!0),[B+".slice("+$+").charAt(0)",k.FUNCTION_CALL];case"RANDOM":return[v.provideFunction_("textRandomLetter",`
function ${v.FUNCTION_NAME_PLACEHOLDER_}(text) {
  var x = Math.floor(Math.random() * text.length);
  return text[x];
}
`)+"("+B+")",k.FUNCTION_CALL]}throw Error("Unhandled option (text_charAt).")},et=function($,v){var O={FIRST:"First",LAST:"Last",FROM_START:"FromStart",FROM_END:"FromEnd"};const B=$.getFieldValue("WHERE1"),tt=$.getFieldValue("WHERE2");var At=B!=="FROM_END"&&B!=="LAST"&&tt!=="FROM_END"&&tt!=="LAST",Ut=v.valueToCode($,"STRING",At?k.MEMBER:k.NONE)||"''";if(B==="FIRST"&&tt==="LAST")return[Ut,k.NONE];if(Ut.match(/^'?\w+'?$/)||At){switch(B){case"FROM_START":O=v.getAdjusted($,"AT1");break;case"FROM_END":O=v.getAdjusted($,"AT1",1,!1,k.SUBTRACTION),O=Ut+".length - "+O;break;case"FIRST":O="0";break;default:throw Error("Unhandled option (text_getSubstring).")}switch(tt){case"FROM_START":v=v.getAdjusted($,"AT2",1);break;case"FROM_END":v=v.getAdjusted($,"AT2",0,!1,k.SUBTRACTION),v=Ut+".length - "+v;break;case"LAST":v=Ut+".length";break;default:throw Error("Unhandled option (text_getSubstring).")}Ut=Ut+".slice("+O+", "+v+")"}else At=v.getAdjusted($,"AT1"),$=v.getAdjusted($,"AT2"),Ut=v.provideFunction_("subsequence"+O[B]+O[tt],`
function ${v.FUNCTION_NAME_PLACEHOLDER_}(sequence${B==="FROM_END"||B==="FROM_START"?", at1":""}${tt==="FROM_END"||tt==="FROM_START"?", at2":""}) {
  var start = ${Gi("sequence",B,"at1")};
  var end = ${Gi("sequence",tt,"at2")} + 1;
  return sequence.slice(start, end);
}
`)+"("+Ut+(B==="FROM_END"||B==="FROM_START"?", "+At:"")+(tt==="FROM_END"||tt==="FROM_START"?", "+$:"")+")";return[Ut,k.FUNCTION_CALL]},dt=function($,v){const O={UPPERCASE:".toUpperCase()",LOWERCASE:".toLowerCase()",TITLECASE:null}[$.getFieldValue("CASE")];return $=v.valueToCode($,"TEXT",O?k.MEMBER:k.NONE)||"''",[O?$+O:v.provideFunction_("textToTitleCase",`
function ${v.FUNCTION_NAME_PLACEHOLDER_}(str) {
  return str.replace(/\\S+/g,
      function(txt) {return txt[0].toUpperCase() + txt.substring(1).toLowerCase();});
}
`)+"("+$+")",k.FUNCTION_CALL]},j=function($,v){const O={LEFT:".replace(/^[\\s\\xa0]+/, '')",RIGHT:".replace(/[\\s\\xa0]+$/, '')",BOTH:".trim()"}[$.getFieldValue("MODE")];return[(v.valueToCode($,"TEXT",k.MEMBER)||"''")+O,k.FUNCTION_CALL]},R=function($,v){return"window.alert("+(v.valueToCode($,"TEXT",k.NONE)||"''")+`);
`},J=function($,v){return v="window.prompt("+($.getField("TEXT")?v.quote_($.getFieldValue("TEXT")):v.valueToCode($,"TEXT",k.NONE)||"''")+")",$.getFieldValue("TYPE")==="NUMBER"&&(v="Number("+v+")"),[v,k.FUNCTION_CALL]},kt=function($,v){const O=v.valueToCode($,"TEXT",k.NONE)||"''";return $=v.valueToCode($,"SUB",k.NONE)||"''",[v.provideFunction_("textCount",`
function ${v.FUNCTION_NAME_PLACEHOLDER_}(haystack, needle) {
  if (needle.length === 0) {
    return haystack.length + 1;
  } else {
    return haystack.split(needle).length - 1;
  }
}
`)+"("+O+", "+$+")",k.FUNCTION_CALL]},mt=function($,v){const O=v.valueToCode($,"TEXT",k.NONE)||"''",B=v.valueToCode($,"FROM",k.NONE)||"''";return $=v.valueToCode($,"TO",k.NONE)||"''",[v.provideFunction_("textReplace",`
function ${v.FUNCTION_NAME_PLACEHOLDER_}(haystack, needle, replacement) {
  needle = needle.replace(/([-()\\[\\]{}+?*.$\\^|,:#<!\\\\])/g, '\\\\$1')
                 .replace(/\\x08/g, '\\\\x08');
  return haystack.replace(new RegExp(needle, 'g'), replacement);
}
`)+"("+O+", "+B+", "+$+")",k.FUNCTION_CALL]},Vt=function($,v){return[(v.valueToCode($,"TEXT",k.MEMBER)||"''")+".split('').reverse().join('')",k.FUNCTION_CALL]},Ct=function($,v){return[v.getVariableName($.getFieldValue("VAR")),k.ATOMIC]},Qt=function($,v){const O=v.valueToCode($,"VALUE",k.ASSIGNMENT)||"0";return v.getVariableName($.getFieldValue("VAR"))+" = "+O+`;
`},k;(function($){$[$.ATOMIC=0]="ATOMIC",$[$.NEW=1.1]="NEW",$[$.MEMBER=1.2]="MEMBER",$[$.FUNCTION_CALL=2]="FUNCTION_CALL",$[$.INCREMENT=3]="INCREMENT",$[$.DECREMENT=3]="DECREMENT",$[$.BITWISE_NOT=4.1]="BITWISE_NOT",$[$.UNARY_PLUS=4.2]="UNARY_PLUS",$[$.UNARY_NEGATION=4.3]="UNARY_NEGATION",$[$.LOGICAL_NOT=4.4]="LOGICAL_NOT",$[$.TYPEOF=4.5]="TYPEOF",$[$.VOID=4.6]="VOID",$[$.DELETE=4.7]="DELETE",$[$.AWAIT=4.8]="AWAIT",$[$.EXPONENTIATION=5]="EXPONENTIATION",$[$.MULTIPLICATION=5.1]="MULTIPLICATION",$[$.DIVISION=5.2]="DIVISION",$[$.MODULUS=5.3]="MODULUS",$[$.SUBTRACTION=6.1]="SUBTRACTION",$[$.ADDITION=6.2]="ADDITION",$[$.BITWISE_SHIFT=7]="BITWISE_SHIFT",$[$.RELATIONAL=8]="RELATIONAL",$[$.IN=8]="IN",$[$.INSTANCEOF=8]="INSTANCEOF",$[$.EQUALITY=9]="EQUALITY",$[$.BITWISE_AND=10]="BITWISE_AND",$[$.BITWISE_XOR=11]="BITWISE_XOR",$[$.BITWISE_OR=12]="BITWISE_OR",$[$.LOGICAL_AND=13]="LOGICAL_AND",$[$.LOGICAL_OR=14]="LOGICAL_OR",$[$.CONDITIONAL=15]="CONDITIONAL",$[$.ASSIGNMENT=16]="ASSIGNMENT",$[$.YIELD=17]="YIELD",$[$.COMMA=18]="COMMA",$[$.NONE=99]="NONE"})(k||(k={}));var _=class extends o.CodeGenerator$$module$build$src$core$generator{constructor($="JavaScript"){super($),this.ORDER_OVERRIDES=[[k.FUNCTION_CALL,k.MEMBER],[k.FUNCTION_CALL,k.FUNCTION_CALL],[k.MEMBER,k.MEMBER],[k.MEMBER,k.FUNCTION_CALL],[k.LOGICAL_NOT,k.LOGICAL_NOT],[k.MULTIPLICATION,k.MULTIPLICATION],[k.ADDITION,k.ADDITION],[k.LOGICAL_AND,k.LOGICAL_AND],[k.LOGICAL_OR,k.LOGICAL_OR]],this.isInitialized=!1;for(const v in k)$=k[v],typeof $!="string"&&(this["ORDER_"+v]=$);this.addReservedWords("break,case,catch,class,const,continue,debugger,default,delete,do,else,export,extends,finally,for,function,if,import,in,instanceof,new,return,super,switch,this,throw,try,typeof,var,void,while,with,yield,enum,implements,interface,let,package,private,protected,public,static,await,null,true,false,arguments,"+Object.getOwnPropertyNames(globalThis).join(","))}init($){super.init($),this.nameDB_?this.nameDB_.reset():this.nameDB_=new o.Names$$module$build$src$core$names(this.RESERVED_WORDS_),this.nameDB_.setVariableMap($.getVariableMap()),this.nameDB_.populateVariables($),this.nameDB_.populateProcedures($);const v=[];var O=o.allDeveloperVariables$$module$build$src$core$variables($);for(let B=0;B<O.length;B++)v.push(this.nameDB_.getName(O[B],o.NameType$$module$build$src$core$names.DEVELOPER_VARIABLE));for($=o.allUsedVarModels$$module$build$src$core$variables($),O=0;O<$.length;O++)v.push(this.nameDB_.getName($[O].getId(),o.NameType$$module$build$src$core$names.VARIABLE));v.length&&(this.definitions_.variables="var "+v.join(", ")+";"),this.isInitialized=!0}finish($){const v=Object.values(this.definitions_);return super.finish($),this.isInitialized=!1,this.nameDB_.reset(),v.join(`

`)+`


`+$}scrubNakedValue($){return $+`;
`}quote_($){return $=$.replace(/\\/g,"\\\\").replace(/\n/g,`\\
`).replace(/'/g,"\\'"),"'"+$+"'"}multiline_quote_($){return $.split(/\n/g).map(this.quote_).join(` + '\\n' +
`)}scrub_($,v,O=!1){let B="";if(!$.outputConnection||!$.outputConnection.targetConnection){var tt=$.getCommentText();tt&&(tt=o.wrap$$module$build$src$core$utils$string(tt,this.COMMENT_WRAP-3),B+=this.prefixLines(tt+`
`,"// "));for(let At=0;At<$.inputList.length;At++)$.inputList[At].type===o.inputTypes$$module$build$src$core$inputs$input_types.VALUE&&(tt=$.inputList[At].connection.targetBlock())&&(tt=this.allNestedComments(tt))&&(B+=this.prefixLines(tt,"// "))}return $=$.nextConnection&&$.nextConnection.targetBlock(),O=O?"":this.blockToCode($),B+v+O}getAdjusted($,v,O=0,B=!1,tt=k.NONE){$.workspace.options.oneBasedIndex&&O--;const At=$.workspace.options.oneBasedIndex?"1":"0";let Ut=tt;return 0<O?Ut=k.ADDITION:0>O?Ut=k.SUBTRACTION:B&&(Ut=k.UNARY_NEGATION),$=this.valueToCode($,v,Ut)||At,O===0&&!B?$:o.isNumber$$module$build$src$core$utils$string($)?($=String(Number($)+O),B&&($=String(-Number($))),$):(0<O?$=`${$} + ${O}`:0>O&&($=`${$} - ${-O}`),B&&($=O?`-(${$})`:`-${$}`),Math.floor(tt)>=Math.floor(Ut)&&($=`(${$})`),$)}},I={};I.colour_blend=d,I.colour_picker=l,I.colour_random=a,I.colour_rgb=h;var M=function($,v,O){return v==="FIRST"?"0":v==="FROM_END"?$+".length - 1 - "+O:v==="LAST"?$+".length - 1":O},P={};P.lists_create_empty=p,P.lists_create_with=g,P.lists_getIndex=C,P.lists_getSublist=A,P.lists_indexOf=y,P.lists_isEmpty=b,P.lists_length=T,P.lists_repeat=m,P.lists_reverse=X,P.lists_setIndex=L,P.lists_sort=F,P.lists_split=z;var nt={};nt.controls_if=K,nt.controls_ifelse=K,nt.logic_boolean=Tt,nt.logic_compare=Y,nt.logic_negate=H,nt.logic_null=$t,nt.logic_operation=V,nt.logic_ternary=lt;var Pt={};Pt.controls_flow_statements=it,Pt.controls_for=gt,Pt.controls_forEach=vt,Pt.controls_repeat=ot,Pt.controls_repeat_ext=ot,Pt.controls_whileUntil=ct;var te={};te.math_arithmetic=Rt,te.math_atan2=xe,te.math_change=Gt,te.math_constant=me,te.math_constrain=ut,te.math_modulo=fe,te.math_number=Ft,te.math_number_property=Lt,te.math_on_list=Ht,te.math_random_float=_e,te.math_random_int=be,te.math_round=Nt,te.math_single=Nt,te.math_trig=Nt;var bi={};bi.procedures_callnoreturn=Ke,bi.procedures_callreturn=ai,bi.procedures_defnoreturn=Ee,bi.procedures_defreturn=Ee,bi.procedures_ifreturn=hi;var Hh=/^\s*'([^']|\\')*'\s*$/,sn=function($){return Hh.test($)?[$,k.ATOMIC]:["String("+$+")",k.FUNCTION_CALL]},Gi=function($,v,O){return v==="FIRST"?"0":v==="FROM_END"?$+".length - 1 - "+O:v==="LAST"?$+".length - 1":O},Se={};Se.text=yt,Se.text_append=G,Se.text_changeCase=dt,Se.text_charAt=ht,Se.text_count=kt,Se.text_getSubstring=et,Se.text_indexOf=st,Se.text_isEmpty=Z,Se.text_join=N,Se.text_length=q,Se.text_multiline=w,Se.text_print=R,Se.text_prompt=J,Se.text_prompt_ext=J,Se.text_replace=mt,Se.text_reverse=Vt,Se.text_trim=j;var qn={};qn.variables_get=Ct,qn.variables_set=Qt;var Zn={};Zn.variables_get_dynamic=Ct,Zn.variables_set_dynamic=Qt;var Qn=new _,Jr=Object.assign({},I,P,nt,Pt,te,bi,Se,qn,Zn);for(const $ in Jr)Qn.forBlock[$]=Jr[$];var ls={};return ls.JavascriptGenerator=_,ls.Order=k,ls.javascriptGenerator=Qn,ls.__namespace__=o,ls})}(t_)),t_.exports}var dC;function cx(){return dC||(dC=1,function(n,e){(function(s,o){n.exports=o(Ob(),lx())})(ps,function(s,o){/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */return o})}(Q$)),Q$.exports}var pC;function ax(){return pC||(pC=1,function(n,e){(function(s,o){n.exports=o(Ob(),ox(),rx(),cx())})(ps,function(s,o,l,a){return s.setLocale(o),s})}(X$)),X$.exports}(function(n,e){(function(s,o){n.exports=o(ax())})(ps,function(s){/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */return s})})(T0);var b0=T0.exports;const Kd=ix(b0),hx=Kd.common.createBlockDefinitionsFromJsonArray([{type:"add",message0:"add %1 %2 and %3 and store result to %4",args0:[{type:"input_dummy"},{type:"input_value",name:"rs1",check:"register"},{type:"input_value",name:"rs2",check:"register"},{type:"input_value",name:"rd",check:"register"}],inputsInline:!0,previousStatement:null,nextStatement:null,colour:230,tooltip:"",helpUrl:""},{type:"addi",message0:"add %1 %2 and %3 and store result to %4",args0:[{type:"input_dummy"},{type:"input_value",name:"rs1",check:"register"},{type:"field_number",name:"immediate",value:0,min:-32,max:31},{type:"input_value",name:"rd",check:"register"}],inputsInline:!0,previousStatement:null,nextStatement:null,colour:230,tooltip:"",helpUrl:""},{type:"sub",message0:"subtract %1 %2 and %3 and store result to %4",args0:[{type:"input_dummy"},{type:"input_value",name:"rs1",check:"register"},{type:"input_value",name:"rs2",check:"register"},{type:"input_value",name:"rd",check:"register"}],inputsInline:!0,previousStatement:null,nextStatement:null,colour:230,tooltip:"",helpUrl:""},{type:"lli",message0:"set lower 8 bits of register %1 to %2",args0:[{type:"input_value",name:"rd",check:"register"},{type:"field_number",name:"immediate",value:0,min:-128,max:127}],previousStatement:null,nextStatement:null,colour:230,tooltip:"",helpUrl:""},{type:"lui",message0:"set upper 8 bits of register %1 to %2",args0:[{type:"input_value",name:"rd",check:"register"},{type:"field_number",name:"immediate",value:0,min:-128,max:127}],previousStatement:null,nextStatement:null,colour:230,tooltip:"",helpUrl:""},{type:"and",message0:'Do bit-wise "and" between  %1 and %2 and store result to %3',args0:[{type:"input_value",name:"rs1",check:"register"},{type:"input_value",name:"rs2",check:"register"},{type:"input_value",name:"rd",check:"register"}],inputsInline:!0,previousStatement:null,nextStatement:null,colour:230,tooltip:"",helpUrl:""},{type:"or",message0:'Do bit-wise "or" between  %1 and %2 and store result to %3',args0:[{type:"input_value",name:"rs1",check:"register"},{type:"input_value",name:"rs2",check:"register"},{type:"input_value",name:"rd",check:"register"}],inputsInline:!0,previousStatement:null,nextStatement:null,colour:230,tooltip:"",helpUrl:""},{type:"not",message0:'Do bit-wise "not" on %1 and store result to %2',args0:[{type:"input_value",name:"rs",check:"register"},{type:"input_value",name:"rd",check:"register"}],inputsInline:!0,previousStatement:null,nextStatement:null,colour:230,tooltip:"",helpUrl:""},{type:"shf",message0:"shift register  %1 by %2 %3 and store result to %4",args0:[{type:"input_value",name:"rs"},{type:"field_number",name:"immediate",value:1,min:-32,max:31},{type:"input_dummy"},{type:"input_value",name:"rd"}],inputsInline:!0,previousStatement:null,nextStatement:null,colour:230,tooltip:"",helpUrl:""},{type:"lw",message0:"load word from address %1 + %2 %3 and store result to %4",args0:[{type:"input_value",name:"rs",check:"register"},{type:"field_number",name:"offset",value:0,min:-32,max:31},{type:"input_dummy"},{type:"input_value",name:"rd",check:"register"}],inputsInline:!0,previousStatement:null,nextStatement:null,colour:120,tooltip:"",helpUrl:""},{type:"sw",message0:"store %1 to memory address %2 + %3",args0:[{type:"input_value",name:"rd",check:"register"},{type:"input_value",name:"rs",check:"register"},{type:"field_number",name:"offset",value:0,min:-32,max:31}],inputsInline:!0,previousStatement:null,nextStatement:null,colour:120,tooltip:"",helpUrl:""},{type:"in",message0:"read input to register %1",args0:[{type:"input_value",name:"rd",check:"register"}],inputsInline:!0,previousStatement:null,nextStatement:null,colour:330,tooltip:"",helpUrl:""},{type:"out",message0:"output register %1",args0:[{type:"input_value",name:"rd",check:"register"}],inputsInline:!0,previousStatement:null,nextStatement:null,colour:330,tooltip:"",helpUrl:""},{type:"bez",message0:"if  %1 is zero, jump to label %2",args0:[{type:"input_value",name:"rd",check:"register"},{type:"input_value",name:"Label",check:"label"}],inputsInline:!0,previousStatement:null,nextStatement:null,colour:230,tooltip:"",helpUrl:""},{type:"bgz",message0:"if  %1 is greater than zero, jump to label %2",args0:[{type:"input_value",name:"rd",check:"register"},{type:"input_value",name:"label",check:"label"}],inputsInline:!0,previousStatement:null,nextStatement:null,colour:230,tooltip:"",helpUrl:""},{type:"jalr",message0:"store PC+1 to  %1 and jump to label %2",args0:[{type:"input_value",name:"rs",check:"register"},{type:"input_value",name:"rd"}],inputsInline:!0,previousStatement:null,nextStatement:null,colour:230,tooltip:"",helpUrl:""},{type:"halt",message0:"halt",previousStatement:null,nextStatement:null,colour:0,tooltip:"",helpUrl:""},{type:"start",message0:"start",nextStatement:null,colour:0,tooltip:"",helpUrl:""},{type:"r0",message0:"r0",output:"register",colour:0,tooltip:"",helpUrl:""},{type:"r1",message0:"r1",output:"register",colour:122,tooltip:"",helpUrl:""},{type:"r2",message0:"r2",output:"register",colour:122,tooltip:"",helpUrl:""},{type:"r3",message0:"r3",output:"register",colour:122,tooltip:"",helpUrl:""},{type:"r4",message0:"r4",output:"register",colour:122,tooltip:"",helpUrl:""},{type:"r5",message0:"r5",output:"register",colour:122,tooltip:"",helpUrl:""},{type:"r6",message0:"r6",output:"register",colour:122,tooltip:"",helpUrl:""},{type:"r7",message0:"r7",output:"register",colour:122,tooltip:"",helpUrl:""},{type:"labelsection",message0:"Label %1 %2",args0:[{type:"input_value",name:"label",check:"label"},{type:"input_statement",name:"statements"}],previousStatement:null,nextStatement:null,colour:20,tooltip:"",helpUrl:""},{type:"labeldescriptor",message0:"%1",args0:[{type:"field_input",name:"label_name",text:"loop1"}],output:"label",colour:65,tooltip:"label name",helpUrl:""}]),ue=new b0.Generator("ANNA"),ie={ATOMIC:0};ue.scrub_=function(n,e,s){const o=n.nextConnection&&n.nextConnection.targetBlock();return n.parentBlock_==null&&n.type!=="start"?null:o&&!s?e.length==0?`${e}${ue.blockToCode(o)}`:`${e}
${ue.blockToCode(o)}`:e};ue.forBlock.add=function(n,e){var s=e.valueToCode(n,"rs1",ie.ATOMIC),o=e.valueToCode(n,"rs2",ie.ATOMIC),l=e.valueToCode(n,"rd",ie.ATOMIC),a=`add ${l} ${s} ${o}`;return a};ue.forBlock.register=function(n,e){var s=n.getFieldValue("registerNr"),o=`r${s}`;return[o,ie.ATOMIC]};ue.forBlock.addi=function(n,e){var s=e.valueToCode(n,"rs1",ie.ATOMIC),o=n.getFieldValue("immediate"),l=e.valueToCode(n,"rd",ie.ATOMIC),a=`addi ${l} ${s} ${o}`;return a};ue.forBlock.sub=function(n,e){var s=e.valueToCode(n,"rs1",ie.ATOMIC),o=e.valueToCode(n,"rs2",ie.ATOMIC),l=e.valueToCode(n,"rd",ie.ATOMIC),a=`sub ${l} ${s} ${o}`;return a};ue.forBlock.lli=function(n,e){var s=e.valueToCode(n,"rd",ie.ATOMIC),o=n.getFieldValue("immediate"),l=`lli ${s} ${o}`;return l};ue.forBlock.lui=function(n,e){var s=e.valueToCode(n,"rd",ie.ATOMIC),o=n.getFieldValue("immediate"),l=`lui ${s} ${o}`;return l};ue.forBlock.and=function(n,e){var s=e.valueToCode(n,"rs1",ie.ATOMIC),o=e.valueToCode(n,"rs2",ie.ATOMIC),l=e.valueToCode(n,"rd",ie.ATOMIC),a=`and ${l} ${s} ${o}`;return a};ue.forBlock.or=function(n,e){var s=e.valueToCode(n,"rs1",ie.ATOMIC),o=e.valueToCode(n,"rs2",ie.ATOMIC),l=e.valueToCode(n,"rd",ie.ATOMIC),a=`or ${l} ${s} ${o}`;return a};ue.forBlock.not=function(n,e){var s=e.valueToCode(n,"rs",ie.ATOMIC),o=e.valueToCode(n,"rd",ie.ATOMIC),l=`not ${o} ${s}`;return l};ue.forBlock.shf=function(n,e){var s=e.valueToCode(n,"rd",ie.ATOMIC),o=e.valueToCode(n,"rs",ie.ATOMIC),l=n.getFieldValue("immediate"),a=`shf ${s} ${o} ${l}`;return a};ue.forBlock.lw=function(n,e){var s=e.valueToCode(n,"rs",ie.ATOMIC),o=n.getFieldValue("offset"),l=e.valueToCode(n,"rd",ie.ATOMIC),a=`lw ${l} ${s} ${o}`;return a};ue.forBlock.sw=function(n,e){var s=e.valueToCode(n,"rd",ie.ATOMIC),o=e.valueToCode(n,"rs",ie.ATOMIC),l=n.getFieldValue("offset"),a=`sw ${s} ${o} ${l}`;return a};ue.forBlock.in=function(n,e){var s=e.valueToCode(n,"rd",ie.ATOMIC),o=`in ${s}`;return o};ue.forBlock.out=function(n,e){var s=e.valueToCode(n,"rd",ie.ATOMIC),o=`out ${s}`;return o};ue.forBlock.bez=function(n,e){var s=e.valueToCode(n,"rd",ie.ATOMIC),o=e.valueToCode(n,"Label",ie.ATOMIC),l=`bez ${s} ${o}`;return l};ue.forBlock.bgz=function(n,e){var s=e.valueToCode(n,"rd",ie.ATOMIC),o=e.valueToCode(n,"label",ie.ATOMIC),l=`bgz ${s} ${o}`;return l};ue.forBlock.jalr=function(n,e){var s=e.valueToCode(n,"rd",ie.ATOMIC),o=e.valueToCode(n,"rs",ie.ATOMIC),l=`jalr ${s} ${o}`;return l};ue.forBlock.halt=function(n,e){var s=".halt";return s};ue.forBlock.start=function(n,e){var s="";return s};const Xn=function(n,e){return[n.type,ie.ATOMIC]};ue.forBlock.r0=Xn;ue.forBlock.r1=Xn;ue.forBlock.r2=Xn;ue.forBlock.r3=Xn;ue.forBlock.r4=Xn;ue.forBlock.r5=Xn;ue.forBlock.r6=Xn;ue.forBlock.r7=Xn;ue.forBlock.labelsection=function(n,e){let s=e.valueToCode(n,"label",ie.ATOMIC),o=e.statementToCode(n,"statements");return`${s.slice(1)}: ${o} 
`};ue.forBlock.labeldescriptor=function(n,e){var s=n.getFieldValue("label_name");return[`&${s}`,ie.ATOMIC]};const ux=`
############################
# Generated Assembler Code #
############################
`,dx=(n,e)=>{const s=n.split(`
`);let o="";for(let l of s)o+=px(l,e);return`${ux}
${o}`.trim()},px=(n,e)=>{let s="";if(fx(n)){let o=`${n.split(":")[0].trim()}:`,l=n.split(":")[1].trim();s=`
${o.padEnd(e," ")}${l}`}else s="".padStart(e," ")+n.trim();return`${s}
`},fx=n=>n.indexOf(":")!=-1;var jd=Ob();const E0="blocksambler-local-storage",gx=function(n){var s;const e=jd.serialization.workspaces.save(n);(s=window.localStorage)==null||s.setItem(E0,JSON.stringify(e))},mx=function(n){var s;const e=(s=window.localStorage)==null?void 0:s.getItem(E0);e&&(jd.Events.disable(),jd.serialization.workspaces.load(JSON.parse(e),n,!1),jd.Events.enable())};class $x{constructor(e,s,o,l){this.instructionFactory=o,this.interruptHandler=l,this.addressSize=s,this.memorySize=2**s,this.loadedProgramSize=0,this.isRunning=!1,this.output=[],this.registers={pc:Yt.fromSignedIntValue(0,this.addressSize),...e},this.memory=[],this.initMemory(this.memorySize)}print(e){this.output.push(e.toString())}getInstructionFactory(){return this.instructionFactory}initMemory(){this.memory=[];for(let e=0;e<this.memorySize;e++)this.memory[e]=Yt.fromSignedIntValue(0,this.addressSize),this.memory[e].id=e}getMemoryFragment(e,s){let o=[];for(let l=e;l<s;l++)o.push({address:l,word:this.memory[l]});return o}loadProgramm(e){this.loadedProgramSize=e.length;for(let s in e){let o=e[s].toMachineCode();this.memory[s].set(Yt.fromString(o))}}executeNextInstruction(){let e=this.loadNextInstruction();this.registers.pc.set(this.registers.pc.addImmedate(1)),e.executeOn(this)}loadNextInstruction(){let e=this.registers.pc.toUnsignedIntValue(),s=this.memory[e].toBitString();return this.instructionFactory.createFromOpCode(s)}storeToMemory(e,s){this.memory[e].set(s)}loadFromMemory(e){return this.memory[e]}callInterrupt(e,...s){return this.interruptHandler[e](this,...s)}resetMemory(){this.loadedProgramSize=0;for(let e in this.memory)this.memory[e].set(Yt.fromSignedIntValue(0,this.addressSize))}resetRegisters(){for(let e in this.registers)this.registers[e].set(Yt.fromSignedIntValue(0,this.addressSize))}halt(){this.isRunning=!1}}class Yt{constructor(){ee(this,"bits",[])}static fromString(e){return Yt.fromBitArray([...e].reverse())}static fromBitArray(e){let s=new Yt;return s.bits=e.map(o=>parseInt(o)),s}static fromSignedIntValue(e,s=16){let o=new Yt;return e<0?o.bits=Yt.integerToTwoCompliment(Math.abs(e),s):o.bits=Yt.integerToBitArray(e,s),o}static integerToTwoCompliment(e,s){let o=Yt.integerToBitArray(e-1,s);return Yt.invertBits(o)}static integerToBitArray(e,s){let o=[...e.toString(2)].map(l=>parseInt(l)).reverse();for(;o.length<s;)o.push(0);return o.length>s&&(o=o.slice(0,s)),o}static invertBits(e){return e.map(s=>s==1?0:1)}toSignedIntValue(){let e=this.bits[this.bits.length-1]==1,s=[...this.bits].reverse();if(e){let o=Yt.invertBits(s).reduce((l,a)=>l.toString()+a.toString());return(parseInt(o,2)+1)*-1}return parseInt(s.reduce((o,l)=>o.toString()+l.toString()),2)}toUnsignedIntValue(){let e=[...this.bits].reverse().join("");return parseInt(e,2)}set(e){this.bits=[...e.bits]}add(e){let s=this.toSignedIntValue()+e.toSignedIntValue();return Yt.fromSignedIntValue(s,this.size)}addImmedate(e){let s=Yt.fromSignedIntValue(e);return this.add(s)}subtract(e){let s=this.toSignedIntValue()-e.toSignedIntValue();return Yt.fromSignedIntValue(s,this.size)}invert(){return Yt.fromBitArray(Yt.invertBits(this.bits))}or(e){let s=this.toSignedIntValue()|e.toSignedIntValue();return Yt.fromSignedIntValue(s,this.bits.length)}and(e){let s=this.toSignedIntValue()&e.toSignedIntValue();return Yt.fromSignedIntValue(s,this.bits.length)}shift(e){let s=this.bits.length,o=Yt.fromBitArray(this.bits);e>0&&o.bits.reverse();for(let l=0;l<Math.abs(e);l++)o.bits.shift();for(;o.bits.length<s;)o.bits.push(0);return e>0&&o.bits.reverse(),o}toBitString(){return[...this.bits].reverse().join("")}toString(){return`${this.toSignedIntValue()}`}}class Fo extends Yt{static fromString(e){return Fo.fromBitArray([...e].reverse())}static fromBitArray(e){let s=new Fo;return s.bits=e.map(o=>parseInt(o)),s}static fromSignedIntValue(e,s=16){let o=new Fo;return e<0?o.bits=Fo.integerToTwoCompliment(Math.abs(e),s):o.bits=Fo.integerToBitArray(e,s),o}static integerToTwoCompliment(e,s){let o=Fo.integerToBitArray(e-1,s);return Fo.invertBits(o)}static integerToBitArray(e,s){let o=[...e.toString(2)].map(l=>parseInt(l)).reverse();for(;o.length<s;)o.push(0);return o.length>s&&(o=o.slice(0,s)),o}static invertBits(e){return e.map(s=>s==1?0:1)}set(e){console.log("set instruction on immutable word prevented!")}}const xn=(n,e,s="0")=>{let o="";for(;n.length+o.length<e;)o+="0";return`${o}${n}`};class Ab{constructor(e){this.meta=e}}class _x{createFromMnemonic(e,s){let o=this.getInstructionClassByMnemonic(e);return new o(s)}getInstructionClassByMnemonic(e){return fC.filter(s=>s.mnemonic==e)[0]}createFromOpCode(e){return e=="1111000000000000"?gp.fromMachineCode(e):this.getInstructionClassByOpCode(e.slice(0,4)).fromMachineCode(e)}getInstructionClassByOpCode(e){return fC.filter(s=>s.opCode==e)[0]}}class tn extends Ab{constructor(e){super(e)}get rd(){return this.meta.args[0]?parseInt(this.meta.args[0][1]):0}get rs1(){return this.meta.args[1]?parseInt(this.meta.args[1][1]):0}get rs2(){return this.meta.args[2]?parseInt(this.meta.args[2][1]):0}toMachineCode(){let e=this.constructor.opCode+xn(this.rd.toString(2),3);return e+=xn(this.rs1.toString(2),3),e+=xn(this.rs2.toString(2),3),e+="000",e}toString(){return`${Object.getPrototypeOf(this).constructor.mnemonic} r${this.rd} r${this.rs1} r${this.rs2}`}static extractMeta(e){let s=parseInt(e.slice(4,7),2),o=parseInt(e.slice(7,10),2),l=parseInt(e.slice(10,13),2);return{args:[`r${s}`,`r${o}`,`r${l}`]}}}class bh extends Ab{constructor(e){super(e)}get rd(){return this.meta.args[0]?parseInt(this.meta.args[0][1]):0}get rs(){return this.meta.args[1]?parseInt(this.meta.args[1][1]):0}get imm(){return this.meta.args[2]?parseInt(this.meta.args[2]):0}toMachineCode(){let e=this.constructor.opCode+xn(this.rd.toString(2),3);return e+=xn(this.rs.toString(2),3),e+=Yt.fromSignedIntValue(this.imm,6).toBitString(),e}toString(){return`${Object.getPrototypeOf(this).constructor.mnemonic} r${this.rd} r${this.rs} #${this.imm}`}static extractMeta(e){let s=parseInt(e.slice(4,7),2),o=parseInt(e.slice(7,10),2),l=e.slice(10,16),a=Yt.fromString(l).toSignedIntValue();return{args:[`r${s}`,`r${o}`,a]}}}class Gp extends Ab{constructor(e){super(e)}get rd(){return this.meta.args[0]?parseInt(this.meta.args[0][1]):0}get imm(){return this.meta.args[1]?parseInt(this.meta.args[1]):0}toMachineCode(){let e=this.constructor.opCode+xn(this.rd.toString(2),3);return e+="0",e+=Yt.fromSignedIntValue(this.imm,8).toBitString(),e}toString(){return`${Object.getPrototypeOf(this).constructor.mnemonic} r${this.rd} #${this.imm}`}static extractMeta(e){let s=parseInt(e.slice(4,7),2),o=e.slice(8,16),l=Yt.fromString(o).toSignedIntValue();return{args:[`r${s}`,l]}}}const Qa=class Qa extends tn{executeOn(e){let s=e.registers[this.rd],o=e.registers[this.rs1],l=e.registers[this.rs2],a=o.add(l);s.set(a)}static fromMachineCode(e){let s=this.extractMeta(e);return new Qa(s)}};ee(Qa,"mnemonic","add"),ee(Qa,"opCode","0000");let Y_=Qa;const th=class th extends bh{executeOn(e){let s=e.registers[this.rd],o=e.registers[this.rs],l=Number(this.imm),a=o.addImmedate(l);s.set(a)}static fromMachineCode(e){let s=bh.extractMeta(e);return new th(s)}};ee(th,"mnemonic","addi"),ee(th,"opCode","1100");let K_=th;const eh=class eh extends tn{executeOn(e){let s=e.registers[this.rd],o=e.registers[this.rs1],l=e.registers[this.rs2],a=o.subtract(l);s.set(a)}static fromMachineCode(e){let s=this.extractMeta(e);return new eh(s)}};ee(eh,"mnemonic","sub"),ee(eh,"opCode","0001");let j_=eh;const ih=class ih extends tn{executeOn(e){let s=e.registers[this.rd],o=e.registers[this.rs1],l=e.registers[this.rs2],a=o.and(l);s.set(a)}static fromMachineCode(e){let s=this.extractMeta(e);return new ih(s)}};ee(ih,"mnemonic","and"),ee(ih,"opCode","0010");let J_=ih;const sh=class sh extends tn{executeOn(e){let s=e.registers[this.rd],o=e.registers[this.rs1],l=e.registers[this.rs2],a=o.or(l);s.set(a)}static fromMachineCode(e){let s=this.extractMeta(e);return new sh(s)}};ee(sh,"mnemonic","or"),ee(sh,"opCode","0011");let q_=sh;const oh=class oh extends tn{executeOn(e){let s=e.registers[this.rd],o=e.registers[this.rs1];s.set(o.invert())}static fromMachineCode(e){let s=this.extractMeta(e);return new oh(s)}static extractMeta(e){let s=parseInt(e.slice(4,7),2),o=parseInt(e.slice(7,10),2);return{args:[`r${s}`,`r${o}`]}}};ee(oh,"mnemonic","not"),ee(oh,"opCode","0100");let Z_=oh;const nh=class nh extends bh{executeOn(e){let s=e.registers[this.rd],o=e.registers[this.rs],l=Number(this.imm);s.set(o.shift(l))}static fromMachineCode(e){let s=this.extractMeta(e);return new nh(s)}};ee(nh,"mnemonic","shf"),ee(nh,"opCode","0101");let Q_=nh;const rh=class rh extends Gp{executeOn(e){let s=e.registers[this.rd],o=Number(this.imm),l=Yt.fromString("0000000011111111"),a=Yt.fromSignedIntValue(o).and(l);s.set(s.and(l.invert()).or(a))}static fromMachineCode(e){let s=this.extractMeta(e);return new rh(s)}};ee(rh,"mnemonic","lli"),ee(rh,"opCode","0110");let tT=rh;const lh=class lh extends Gp{executeOn(e){let s=e.registers[this.rd],o=Number(this.imm),l=Yt.fromString("0000000011111111"),a=Yt.fromSignedIntValue(o).and(l).shift(8);s.set(s.and(l).or(a))}static fromMachineCode(e){let s=this.extractMeta(e);return new lh(s)}};ee(lh,"mnemonic","lui"),ee(lh,"opCode","0111");let eT=lh;const ch=class ch extends bh{executeOn(e){let s=e.registers[this.rd],o=e.registers[this.rs],l=Number(this.imm);s.set(e.loadFromMemory(o.toSignedIntValue()+l))}static fromMachineCode(e){let s=this.extractMeta(e);return new ch(s)}};ee(ch,"mnemonic","lw"),ee(ch,"opCode","1000");let iT=ch;const ah=class ah extends bh{executeOn(e){let s=e.registers[this.rd],o=e.registers[this.rs],l=this.imm;e.storeToMemory(o.toSignedIntValue()+l,s)}static fromMachineCode(e){let s=this.extractMeta(e);return new ah(s)}};ee(ah,"mnemonic","sw"),ee(ah,"opCode","1001");let sT=ah;const hh=class hh extends Gp{executeOn(e){if(e.registers[this.rd].toSignedIntValue()==0){let o=e.registers.pc.toSignedIntValue();e.registers.pc.set(Yt.fromSignedIntValue(o+this.imm))}}static fromMachineCode(e){let s=this.extractMeta(e);return new hh(s)}};ee(hh,"mnemonic","bez"),ee(hh,"opCode","1010");let oT=hh;const uh=class uh extends Gp{executeOn(e){if(e.registers[this.rd].toSignedIntValue()>0){let o=e.registers.pc.toSignedIntValue();e.registers.pc.set(Yt.fromSignedIntValue(o+this.imm))}}static fromMachineCode(e){let s=this.extractMeta(e);return new uh(s)}};ee(uh,"mnemonic","bgz"),ee(uh,"opCode","1011");let nT=uh;const dh=class dh extends tn{executeOn(e){let s=e.registers[this.rd];e.registers[this.rs1].set(e.registers.pc.add(Yt.fromSignedIntValue(1))),e.registers.pc.set(s)}static fromMachineCode(e){let s=this.extractMeta(e);return new dh(s)}static extractMeta(e){let s=parseInt(e.slice(4,7),2),o=parseInt(e.slice(7,10),2);return{args:[`r${s}`,`r${o}`]}}};ee(dh,"mnemonic","jalr"),ee(dh,"opCode","1101");let rT=dh;const ph=class ph extends tn{executeOn(e){let s=e.registers[this.rd],o=e.callInterrupt("input");s.set(Yt.fromSignedIntValue(o))}static fromMachineCode(e){let s=this.extractMeta(e);return new ph(s)}static extractMeta(e){return{args:[`r${parseInt(e.slice(4,7),2)}`]}}};ee(ph,"mnemonic","in"),ee(ph,"opCode","1110");let lT=ph;const fh=class fh extends tn{executeOn(e){let s=e.registers[this.rd];e.callInterrupt("output",s)}static fromMachineCode(e){let s=this.extractMeta(e);return new fh(s)}static extractMeta(e){return{args:[`r${parseInt(e.slice(4,7),2)}`]}}};ee(fh,"mnemonic","out"),ee(fh,"opCode","1111");let cT=fh;const gh=class gh extends tn{executeOn(e){e.callInterrupt("halt")}toMachineCode(){return"1111000000000000"}static fromMachineCode(e){let s=this.extractMeta(e);return new gh(s)}static extractMeta(e){return{args:[`r${parseInt(e.slice(4,7),2)}`]}}};ee(gh,"mnemonic",".halt"),ee(gh,"opCode","1111");let gp=gh;const fC=[oT,nT,rT,Y_,K_,j_,J_,q_,Z_,Q_,tT,eT,lT,cT,iT,sT,gp],Bo=16,Tx={0:Fo.fromSignedIntValue(0,Bo),1:Yt.fromSignedIntValue(0,Bo),2:Yt.fromSignedIntValue(0,Bo),3:Yt.fromSignedIntValue(0,Bo),4:Yt.fromSignedIntValue(0,Bo),5:Yt.fromSignedIntValue(0,Bo),6:Yt.fromSignedIntValue(0,Bo),7:Yt.fromSignedIntValue(0,Bo)},bx={input:(n,e)=>parseInt(prompt("Enter a value")),output:(n,e)=>{n.print(e)},halt:()=>{alert("The program terminated"),emulator.halt()}};class Ex extends $x{constructor(){super(Tx,Bo,new _x,bx)}}class vx{constructor(e){this.instructionFactory=e}parseCode(e){let s=e.split(`
`).map(l=>l.trim()),o=[];return s.forEach(l=>{let a=this.trimComments(l);a&&o.push(this.parseInstructionLine(a))}),this.resolveLabels(o)}trimComments(e){return e.split("#")[0]}parseInstructionLine(e){let s=e.split(" ").filter(d=>d.length>0),o=this.extractLabel(s),l=this.extractType(s),h={label:o,args:s};return this.instructionFactory.createFromMnemonic(l,h)}extractLabel(e){if(e[0].endsWith(":")){let s=e.splice(0,1)[0];return s=s.slice(0,s.length-1),s}return null}extractType(e){return e.splice(0,1)[0]}resolveLabels(e){let s={};return e.forEach((o,l)=>{o.meta.label&&(s[o.meta.label]=l)}),e.forEach((o,l)=>{const a=["bgz","bez","jalr"],h=["lli","lui"],d=o.constructor.mnemonic;for(let p in o.meta.args){let g=o.meta.args;if(g[p][0]=="&"){if(a.includes(d)){let m=s[g[p].slice(1)]-l-1;g[p]=m}else if(h.includes(d)){let m=labelAddress[g[p].slice(1)];g[p]=m}}}}),e}}const Xa=Ls(""),ki=bo(new Ex),v0=bo(new vx(ki.getInstructionFactory()));const yx={class:"p-0 m-0"},Ix={__name:"BaseBlocklyEditor",props:["options","assemblerCode"],setup(n,{expose:e}){const s=n,o=Ls(),l=Ls(),a=LN();return e({workspace:a}),vb(()=>{Kd.common.defineBlocks(hx);const h=s.options||{};h.toolbox||(h.toolbox=o.value),a.value=Kd.inject(l.value,h);const d=()=>{Xa.value=dx(ue.workspaceToCode(a.value),10)};mx(a.value),d(),a.value.addChangeListener(p=>{p.isUiEvent||gx(a.value)}),a.value.addChangeListener(p=>{p.isUiEvent||p.type==Kd.Events.FINISHED_LOADING||a.value.isDragging()||d()})}),(h,d)=>(Zt(),se("div",yx,[_t("div",{class:"blocklyDiv p-0 m-0",ref_key:"blocklyDiv",ref:l},null,512)]))}},Sx=Lh(Ix,[["__scopeId","data-v-cfc7904e"]]);class Te{lineAt(e){if(e<0||e>this.length)throw new RangeError(`Invalid position ${e} in document of length ${this.length}`);return this.lineInner(e,!1,1,0)}line(e){if(e<1||e>this.lines)throw new RangeError(`Invalid line number ${e} in ${this.lines}-line document`);return this.lineInner(e,!0,1,0)}replace(e,s,o){[e,s]=pc(this,e,s);let l=[];return this.decompose(0,e,l,2),o.length&&o.decompose(0,o.length,l,3),this.decompose(s,this.length,l,1),po.from(l,this.length-(s-e)+o.length)}append(e){return this.replace(this.length,this.length,e)}slice(e,s=this.length){[e,s]=pc(this,e,s);let o=[];return this.decompose(e,s,o,0),po.from(o,s-e)}eq(e){if(e==this)return!0;if(e.length!=this.length||e.lines!=this.lines)return!1;let s=this.scanIdentical(e,1),o=this.length-this.scanIdentical(e,-1),l=new Ya(this),a=new Ya(e);for(let h=s,d=s;;){if(l.next(h),a.next(h),h=0,l.lineBreak!=a.lineBreak||l.done!=a.done||l.value!=a.value)return!1;if(d+=l.value.length,l.done||d>=o)return!0}}iter(e=1){return new Ya(this,e)}iterRange(e,s=this.length){return new y0(this,e,s)}iterLines(e,s){let o;if(e==null)o=this.iter();else{s==null&&(s=this.lines+1);let l=this.line(e).from;o=this.iterRange(l,Math.max(l,s==this.lines+1?this.length:s<=1?0:this.line(s-1).to))}return new I0(o)}toString(){return this.sliceString(0)}toJSON(){let e=[];return this.flatten(e),e}constructor(){}static of(e){if(e.length==0)throw new RangeError("A document must have at least one line");return e.length==1&&!e[0]?Te.empty:e.length<=32?new We(e):po.from(We.split(e,[]))}}class We extends Te{constructor(e,s=Cx(e)){super(),this.text=e,this.length=s}get lines(){return this.text.length}get children(){return null}lineInner(e,s,o,l){for(let a=0;;a++){let h=this.text[a],d=l+h.length;if((s?o:d)>=e)return new wx(l,d,o,h);l=d+1,o++}}decompose(e,s,o,l){let a=e<=0&&s>=this.length?this:new We(gC(this.text,e,s),Math.min(s,this.length)-Math.max(0,e));if(l&1){let h=o.pop(),d=Jd(a.text,h.text.slice(),0,a.length);if(d.length<=32)o.push(new We(d,h.length+a.length));else{let p=d.length>>1;o.push(new We(d.slice(0,p)),new We(d.slice(p)))}}else o.push(a)}replace(e,s,o){if(!(o instanceof We))return super.replace(e,s,o);[e,s]=pc(this,e,s);let l=Jd(this.text,Jd(o.text,gC(this.text,0,e)),s),a=this.length+o.length-(s-e);return l.length<=32?new We(l,a):po.from(We.split(l,[]),a)}sliceString(e,s=this.length,o=`
`){[e,s]=pc(this,e,s);let l="";for(let a=0,h=0;a<=s&&h<this.text.length;h++){let d=this.text[h],p=a+d.length;a>e&&h&&(l+=o),e<p&&s>a&&(l+=d.slice(Math.max(0,e-a),s-a)),a=p+1}return l}flatten(e){for(let s of this.text)e.push(s)}scanIdentical(){return 0}static split(e,s){let o=[],l=-1;for(let a of e)o.push(a),l+=a.length+1,o.length==32&&(s.push(new We(o,l)),o=[],l=-1);return l>-1&&s.push(new We(o,l)),s}}class po extends Te{constructor(e,s){super(),this.children=e,this.length=s,this.lines=0;for(let o of e)this.lines+=o.lines}lineInner(e,s,o,l){for(let a=0;;a++){let h=this.children[a],d=l+h.length,p=o+h.lines-1;if((s?p:d)>=e)return h.lineInner(e,s,o,l);l=d+1,o=p+1}}decompose(e,s,o,l){for(let a=0,h=0;h<=s&&a<this.children.length;a++){let d=this.children[a],p=h+d.length;if(e<=p&&s>=h){let g=l&((h<=e?1:0)|(p>=s?2:0));h>=e&&p<=s&&!g?o.push(d):d.decompose(e-h,s-h,o,g)}h=p+1}}replace(e,s,o){if([e,s]=pc(this,e,s),o.lines<this.lines)for(let l=0,a=0;l<this.children.length;l++){let h=this.children[l],d=a+h.length;if(e>=a&&s<=d){let p=h.replace(e-a,s-a,o),g=this.lines-h.lines+p.lines;if(p.lines<g>>5-1&&p.lines>g>>5+1){let m=this.children.slice();return m[l]=p,new po(m,this.length-(s-e)+o.length)}return super.replace(a,d,p)}a=d+1}return super.replace(e,s,o)}sliceString(e,s=this.length,o=`
`){[e,s]=pc(this,e,s);let l="";for(let a=0,h=0;a<this.children.length&&h<=s;a++){let d=this.children[a],p=h+d.length;h>e&&a&&(l+=o),e<p&&s>h&&(l+=d.sliceString(e-h,s-h,o)),h=p+1}return l}flatten(e){for(let s of this.children)s.flatten(e)}scanIdentical(e,s){if(!(e instanceof po))return 0;let o=0,[l,a,h,d]=s>0?[0,0,this.children.length,e.children.length]:[this.children.length-1,e.children.length-1,-1,-1];for(;;l+=s,a+=s){if(l==h||a==d)return o;let p=this.children[l],g=e.children[a];if(p!=g)return o+p.scanIdentical(g,s);o+=p.length+1}}static from(e,s=e.reduce((o,l)=>o+l.length+1,-1)){let o=0;for(let y of e)o+=y.lines;if(o<32){let y=[];for(let C of e)C.flatten(y);return new We(y,s)}let l=Math.max(32,o>>5),a=l<<1,h=l>>1,d=[],p=0,g=-1,m=[];function T(y){let C;if(y.lines>a&&y instanceof po)for(let L of y.children)T(L);else y.lines>h&&(p>h||!p)?(b(),d.push(y)):y instanceof We&&p&&(C=m[m.length-1])instanceof We&&y.lines+C.lines<=32?(p+=y.lines,g+=y.length+1,m[m.length-1]=new We(C.text.concat(y.text),C.length+1+y.length)):(p+y.lines>l&&b(),p+=y.lines,g+=y.length+1,m.push(y))}function b(){p!=0&&(d.push(m.length==1?m[0]:po.from(m,g)),g=-1,p=m.length=0)}for(let y of e)T(y);return b(),d.length==1?d[0]:new po(d,s)}}Te.empty=new We([""],0);function Cx(n){let e=-1;for(let s of n)e+=s.length+1;return e}function Jd(n,e,s=0,o=1e9){for(let l=0,a=0,h=!0;a<n.length&&l<=o;a++){let d=n[a],p=l+d.length;p>=s&&(p>o&&(d=d.slice(0,o-l)),l<s&&(d=d.slice(s-l)),h?(e[e.length-1]+=d,h=!1):e.push(d)),l=p+1}return e}function gC(n,e,s){return Jd(n,[""],e,s)}class Ya{constructor(e,s=1){this.dir=s,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[e],this.offsets=[s>0?1:(e instanceof We?e.text.length:e.children.length)<<1]}nextInner(e,s){for(this.done=this.lineBreak=!1;;){let o=this.nodes.length-1,l=this.nodes[o],a=this.offsets[o],h=a>>1,d=l instanceof We?l.text.length:l.children.length;if(h==(s>0?d:0)){if(o==0)return this.done=!0,this.value="",this;s>0&&this.offsets[o-1]++,this.nodes.pop(),this.offsets.pop()}else if((a&1)==(s>0?0:1)){if(this.offsets[o]+=s,e==0)return this.lineBreak=!0,this.value=`
`,this;e--}else if(l instanceof We){let p=l.text[h+(s<0?-1:0)];if(this.offsets[o]+=s,p.length>Math.max(0,e))return this.value=e==0?p:s>0?p.slice(e):p.slice(0,p.length-e),this;e-=p.length}else{let p=l.children[h+(s<0?-1:0)];e>p.length?(e-=p.length,this.offsets[o]+=s):(s<0&&this.offsets[o]--,this.nodes.push(p),this.offsets.push(s>0?1:(p instanceof We?p.text.length:p.children.length)<<1))}}}next(e=0){return e<0&&(this.nextInner(-e,-this.dir),e=this.value.length),this.nextInner(e,this.dir)}}class y0{constructor(e,s,o){this.value="",this.done=!1,this.cursor=new Ya(e,s>o?-1:1),this.pos=s>o?e.length:0,this.from=Math.min(s,o),this.to=Math.max(s,o)}nextInner(e,s){if(s<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;e+=Math.max(0,s<0?this.pos-this.to:this.from-this.pos);let o=s<0?this.pos-this.from:this.to-this.pos;e>o&&(e=o),o-=e;let{value:l}=this.cursor.next(e);return this.pos+=(l.length+e)*s,this.value=l.length<=o?l:s<0?l.slice(l.length-o):l.slice(0,o),this.done=!this.value,this}next(e=0){return e<0?e=Math.max(e,this.from-this.pos):e>0&&(e=Math.min(e,this.to-this.pos)),this.nextInner(e,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class I0{constructor(e){this.inner=e,this.afterBreak=!0,this.value="",this.done=!1}next(e=0){let{done:s,lineBreak:o,value:l}=this.inner.next(e);return s&&this.afterBreak?(this.value="",this.afterBreak=!1):s?(this.done=!0,this.value=""):o?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=l,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol<"u"&&(Te.prototype[Symbol.iterator]=function(){return this.iter()},Ya.prototype[Symbol.iterator]=y0.prototype[Symbol.iterator]=I0.prototype[Symbol.iterator]=function(){return this});class wx{constructor(e,s,o,l){this.from=e,this.to=s,this.number=o,this.text=l}get length(){return this.to-this.from}}function pc(n,e,s){return e=Math.max(0,Math.min(n.length,e)),[e,Math.max(e,Math.min(n.length,s))]}let lc="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(n=>n?parseInt(n,36):1);for(let n=1;n<lc.length;n++)lc[n]+=lc[n-1];function kx(n){for(let e=1;e<lc.length;e+=2)if(lc[e]>n)return lc[e-1]<=n;return!1}function mC(n){return n>=127462&&n<=127487}const $C=8205;function Uo(n,e,s=!0,o=!0){return(s?S0:Ox)(n,e,o)}function S0(n,e,s){if(e==n.length)return e;e&&C0(n.charCodeAt(e))&&w0(n.charCodeAt(e-1))&&e--;let o=e_(n,e);for(e+=_C(o);e<n.length;){let l=e_(n,e);if(o==$C||l==$C||s&&kx(l))e+=_C(l),o=l;else if(mC(l)){let a=0,h=e-2;for(;h>=0&&mC(e_(n,h));)a++,h-=2;if(a%2==0)break;e+=2}else break}return e}function Ox(n,e,s){for(;e>0;){let o=S0(n,e-2,s);if(o<e)return o;e--}return 0}function C0(n){return n>=56320&&n<57344}function w0(n){return n>=55296&&n<56320}function e_(n,e){let s=n.charCodeAt(e);if(!w0(s)||e+1==n.length)return s;let o=n.charCodeAt(e+1);return C0(o)?(s-55296<<10)+(o-56320)+65536:s}function _C(n){return n<65536?1:2}const aT=/\r\n?|\n/;var ts=function(n){return n[n.Simple=0]="Simple",n[n.TrackDel=1]="TrackDel",n[n.TrackBefore=2]="TrackBefore",n[n.TrackAfter=3]="TrackAfter",n}(ts||(ts={}));class Go{constructor(e){this.sections=e}get length(){let e=0;for(let s=0;s<this.sections.length;s+=2)e+=this.sections[s];return e}get newLength(){let e=0;for(let s=0;s<this.sections.length;s+=2){let o=this.sections[s+1];e+=o<0?this.sections[s]:o}return e}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(e){for(let s=0,o=0,l=0;s<this.sections.length;){let a=this.sections[s++],h=this.sections[s++];h<0?(e(o,l,a),l+=a):l+=h,o+=a}}iterChangedRanges(e,s=!1){hT(this,e,s)}get invertedDesc(){let e=[];for(let s=0;s<this.sections.length;){let o=this.sections[s++],l=this.sections[s++];l<0?e.push(o,l):e.push(l,o)}return new Go(e)}composeDesc(e){return this.empty?e:e.empty?this:k0(this,e)}mapDesc(e,s=!1){return e.empty?this:uT(this,e,s)}mapPos(e,s=-1,o=ts.Simple){let l=0,a=0;for(let h=0;h<this.sections.length;){let d=this.sections[h++],p=this.sections[h++],g=l+d;if(p<0){if(g>e)return a+(e-l);a+=d}else{if(o!=ts.Simple&&g>=e&&(o==ts.TrackDel&&l<e&&g>e||o==ts.TrackBefore&&l<e||o==ts.TrackAfter&&g>e))return null;if(g>e||g==e&&s<0&&!d)return e==l||s<0?a:a+p;a+=p}l=g}if(e>l)throw new RangeError(`Position ${e} is out of range for changeset of length ${l}`);return a}touchesRange(e,s=e){for(let o=0,l=0;o<this.sections.length&&l<=s;){let a=this.sections[o++],h=this.sections[o++],d=l+a;if(h>=0&&l<=s&&d>=e)return l<e&&d>s?"cover":!0;l=d}return!1}toString(){let e="";for(let s=0;s<this.sections.length;){let o=this.sections[s++],l=this.sections[s++];e+=(e?" ":"")+o+(l>=0?":"+l:"")}return e}toJSON(){return this.sections}static fromJSON(e){if(!Array.isArray(e)||e.length%2||e.some(s=>typeof s!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new Go(e)}static create(e){return new Go(e)}}class Qe extends Go{constructor(e,s){super(e),this.inserted=s}apply(e){if(this.length!=e.length)throw new RangeError("Applying change set to a document with the wrong length");return hT(this,(s,o,l,a,h)=>e=e.replace(l,l+(o-s),h),!1),e}mapDesc(e,s=!1){return uT(this,e,s,!0)}invert(e){let s=this.sections.slice(),o=[];for(let l=0,a=0;l<s.length;l+=2){let h=s[l],d=s[l+1];if(d>=0){s[l]=d,s[l+1]=h;let p=l>>1;for(;o.length<p;)o.push(Te.empty);o.push(h?e.slice(a,a+h):Te.empty)}a+=h}return new Qe(s,o)}compose(e){return this.empty?e:e.empty?this:k0(this,e,!0)}map(e,s=!1){return e.empty?this:uT(this,e,s,!0)}iterChanges(e,s=!1){hT(this,e,s)}get desc(){return Go.create(this.sections)}filter(e){let s=[],o=[],l=[],a=new Eh(this);t:for(let h=0,d=0;;){let p=h==e.length?1e9:e[h++];for(;d<p||d==p&&a.len==0;){if(a.done)break t;let m=Math.min(a.len,p-d);di(l,m,-1);let T=a.ins==-1?-1:a.off==0?a.ins:0;di(s,m,T),T>0&&An(o,s,a.text),a.forward(m),d+=m}let g=e[h++];for(;d<g;){if(a.done)break t;let m=Math.min(a.len,g-d);di(s,m,-1),di(l,m,a.ins==-1?-1:a.off==0?a.ins:0),a.forward(m),d+=m}}return{changes:new Qe(s,o),filtered:Go.create(l)}}toJSON(){let e=[];for(let s=0;s<this.sections.length;s+=2){let o=this.sections[s],l=this.sections[s+1];l<0?e.push(o):l==0?e.push([o]):e.push([o].concat(this.inserted[s>>1].toJSON()))}return e}static of(e,s,o){let l=[],a=[],h=0,d=null;function p(m=!1){if(!m&&!l.length)return;h<s&&di(l,s-h,-1);let T=new Qe(l,a);d=d?d.compose(T.map(d)):T,l=[],a=[],h=0}function g(m){if(Array.isArray(m))for(let T of m)g(T);else if(m instanceof Qe){if(m.length!=s)throw new RangeError(`Mismatched change set length (got ${m.length}, expected ${s})`);p(),d=d?d.compose(m.map(d)):m}else{let{from:T,to:b=T,insert:y}=m;if(T>b||T<0||b>s)throw new RangeError(`Invalid change range ${T} to ${b} (in doc of length ${s})`);let C=y?typeof y=="string"?Te.of(y.split(o||aT)):y:Te.empty,L=C.length;if(T==b&&L==0)return;T<h&&p(),T>h&&di(l,T-h,-1),di(l,b-T,L),An(a,l,C),h=b}}return g(e),p(!d),d}static empty(e){return new Qe(e?[e,-1]:[],[])}static fromJSON(e){if(!Array.isArray(e))throw new RangeError("Invalid JSON representation of ChangeSet");let s=[],o=[];for(let l=0;l<e.length;l++){let a=e[l];if(typeof a=="number")s.push(a,-1);else{if(!Array.isArray(a)||typeof a[0]!="number"||a.some((h,d)=>d&&typeof h!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(a.length==1)s.push(a[0],0);else{for(;o.length<l;)o.push(Te.empty);o[l]=Te.of(a.slice(1)),s.push(a[0],o[l].length)}}}return new Qe(s,o)}static createSet(e,s){return new Qe(e,s)}}function di(n,e,s,o=!1){if(e==0&&s<=0)return;let l=n.length-2;l>=0&&s<=0&&s==n[l+1]?n[l]+=e:e==0&&n[l]==0?n[l+1]+=s:o?(n[l]+=e,n[l+1]+=s):n.push(e,s)}function An(n,e,s){if(s.length==0)return;let o=e.length-2>>1;if(o<n.length)n[n.length-1]=n[n.length-1].append(s);else{for(;n.length<o;)n.push(Te.empty);n.push(s)}}function hT(n,e,s){let o=n.inserted;for(let l=0,a=0,h=0;h<n.sections.length;){let d=n.sections[h++],p=n.sections[h++];if(p<0)l+=d,a+=d;else{let g=l,m=a,T=Te.empty;for(;g+=d,m+=p,p&&o&&(T=T.append(o[h-2>>1])),!(s||h==n.sections.length||n.sections[h+1]<0);)d=n.sections[h++],p=n.sections[h++];e(l,g,a,m,T),l=g,a=m}}}function uT(n,e,s,o=!1){let l=[],a=o?[]:null,h=new Eh(n),d=new Eh(e);for(let p=-1;;)if(h.ins==-1&&d.ins==-1){let g=Math.min(h.len,d.len);di(l,g,-1),h.forward(g),d.forward(g)}else if(d.ins>=0&&(h.ins<0||p==h.i||h.off==0&&(d.len<h.len||d.len==h.len&&!s))){let g=d.len;for(di(l,d.ins,-1);g;){let m=Math.min(h.len,g);h.ins>=0&&p<h.i&&h.len<=m&&(di(l,0,h.ins),a&&An(a,l,h.text),p=h.i),h.forward(m),g-=m}d.next()}else if(h.ins>=0){let g=0,m=h.len;for(;m;)if(d.ins==-1){let T=Math.min(m,d.len);g+=T,m-=T,d.forward(T)}else if(d.ins==0&&d.len<m)m-=d.len,d.next();else break;di(l,g,p<h.i?h.ins:0),a&&p<h.i&&An(a,l,h.text),p=h.i,h.forward(h.len-m)}else{if(h.done&&d.done)return a?Qe.createSet(l,a):Go.create(l);throw new Error("Mismatched change set lengths")}}function k0(n,e,s=!1){let o=[],l=s?[]:null,a=new Eh(n),h=new Eh(e);for(let d=!1;;){if(a.done&&h.done)return l?Qe.createSet(o,l):Go.create(o);if(a.ins==0)di(o,a.len,0,d),a.next();else if(h.len==0&&!h.done)di(o,0,h.ins,d),l&&An(l,o,h.text),h.next();else{if(a.done||h.done)throw new Error("Mismatched change set lengths");{let p=Math.min(a.len2,h.len),g=o.length;if(a.ins==-1){let m=h.ins==-1?-1:h.off?0:h.ins;di(o,p,m,d),l&&m&&An(l,o,h.text)}else h.ins==-1?(di(o,a.off?0:a.len,p,d),l&&An(l,o,a.textBit(p))):(di(o,a.off?0:a.len,h.off?0:h.ins,d),l&&!h.off&&An(l,o,h.text));d=(a.ins>p||h.ins>=0&&h.len>p)&&(d||o.length>g),a.forward2(p),h.forward(p)}}}}class Eh{constructor(e){this.set=e,this.i=0,this.next()}next(){let{sections:e}=this.set;this.i<e.length?(this.len=e[this.i++],this.ins=e[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:e}=this.set,s=this.i-2>>1;return s>=e.length?Te.empty:e[s]}textBit(e){let{inserted:s}=this.set,o=this.i-2>>1;return o>=s.length&&!e?Te.empty:s[o].slice(this.off,e==null?void 0:this.off+e)}forward(e){e==this.len?this.next():(this.len-=e,this.off+=e)}forward2(e){this.ins==-1?this.forward(e):e==this.ins?this.next():(this.ins-=e,this.off+=e)}}class Lr{constructor(e,s,o){this.from=e,this.to=s,this.flags=o}get anchor(){return this.flags&32?this.to:this.from}get head(){return this.flags&32?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&8?-1:this.flags&16?1:0}get bidiLevel(){let e=this.flags&7;return e==7?null:e}get goalColumn(){let e=this.flags>>6;return e==16777215?void 0:e}map(e,s=-1){let o,l;return this.empty?o=l=e.mapPos(this.from,s):(o=e.mapPos(this.from,1),l=e.mapPos(this.to,-1)),o==this.from&&l==this.to?this:new Lr(o,l,this.flags)}extend(e,s=e){if(e<=this.anchor&&s>=this.anchor)return xt.range(e,s);let o=Math.abs(e-this.anchor)>Math.abs(s-this.anchor)?e:s;return xt.range(this.anchor,o)}eq(e,s=!1){return this.anchor==e.anchor&&this.head==e.head&&(!s||!this.empty||this.assoc==e.assoc)}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(e){if(!e||typeof e.anchor!="number"||typeof e.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return xt.range(e.anchor,e.head)}static create(e,s,o){return new Lr(e,s,o)}}class xt{constructor(e,s){this.ranges=e,this.mainIndex=s}map(e,s=-1){return e.empty?this:xt.create(this.ranges.map(o=>o.map(e,s)),this.mainIndex)}eq(e,s=!1){if(this.ranges.length!=e.ranges.length||this.mainIndex!=e.mainIndex)return!1;for(let o=0;o<this.ranges.length;o++)if(!this.ranges[o].eq(e.ranges[o],s))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new xt([this.main],0)}addRange(e,s=!0){return xt.create([e].concat(this.ranges),s?0:this.mainIndex+1)}replaceRange(e,s=this.mainIndex){let o=this.ranges.slice();return o[s]=e,xt.create(o,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(e=>e.toJSON()),main:this.mainIndex}}static fromJSON(e){if(!e||!Array.isArray(e.ranges)||typeof e.main!="number"||e.main>=e.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new xt(e.ranges.map(s=>Lr.fromJSON(s)),e.main)}static single(e,s=e){return new xt([xt.range(e,s)],0)}static create(e,s=0){if(e.length==0)throw new RangeError("A selection needs at least one range");for(let o=0,l=0;l<e.length;l++){let a=e[l];if(a.empty?a.from<=o:a.from<o)return xt.normalized(e.slice(),s);o=a.to}return new xt(e,s)}static cursor(e,s=0,o,l){return Lr.create(e,e,(s==0?0:s<0?8:16)|(o==null?7:Math.min(6,o))|(l??16777215)<<6)}static range(e,s,o,l){let a=(o??16777215)<<6|(l==null?7:Math.min(6,l));return s<e?Lr.create(s,e,48|a):Lr.create(e,s,(s>e?8:0)|a)}static normalized(e,s=0){let o=e[s];e.sort((l,a)=>l.from-a.from),s=e.indexOf(o);for(let l=1;l<e.length;l++){let a=e[l],h=e[l-1];if(a.empty?a.from<=h.to:a.from<h.to){let d=h.from,p=Math.max(a.to,h.to);l<=s&&s--,e.splice(--l,2,a.anchor>a.head?xt.range(p,d):xt.range(d,p))}}return new xt(e,s)}}function O0(n,e){for(let s of n.ranges)if(s.to>e)throw new RangeError("Selection points outside of document")}let Rb=0;class Xt{constructor(e,s,o,l,a){this.combine=e,this.compareInput=s,this.compare=o,this.isStatic=l,this.id=Rb++,this.default=e([]),this.extensions=typeof a=="function"?a(this):a}get reader(){return this}static define(e={}){return new Xt(e.combine||(s=>s),e.compareInput||((s,o)=>s===o),e.compare||(e.combine?(s,o)=>s===o:Nb),!!e.static,e.enables)}of(e){return new qd([],this,0,e)}compute(e,s){if(this.isStatic)throw new Error("Can't compute a static facet");return new qd(e,this,1,s)}computeN(e,s){if(this.isStatic)throw new Error("Can't compute a static facet");return new qd(e,this,2,s)}from(e,s){return s||(s=o=>o),this.compute([e],o=>s(o.field(e)))}}function Nb(n,e){return n==e||n.length==e.length&&n.every((s,o)=>s===e[o])}class qd{constructor(e,s,o,l){this.dependencies=e,this.facet=s,this.type=o,this.value=l,this.id=Rb++}dynamicSlot(e){var s;let o=this.value,l=this.facet.compareInput,a=this.id,h=e[a]>>1,d=this.type==2,p=!1,g=!1,m=[];for(let T of this.dependencies)T=="doc"?p=!0:T=="selection"?g=!0:((s=e[T.id])!==null&&s!==void 0?s:1)&1||m.push(e[T.id]);return{create(T){return T.values[h]=o(T),1},update(T,b){if(p&&b.docChanged||g&&(b.docChanged||b.selection)||dT(T,m)){let y=o(T);if(d?!TC(y,T.values[h],l):!l(y,T.values[h]))return T.values[h]=y,1}return 0},reconfigure:(T,b)=>{let y,C=b.config.address[a];if(C!=null){let L=$p(b,C);if(this.dependencies.every(A=>A instanceof Xt?b.facet(A)===T.facet(A):A instanceof Yn?b.field(A,!1)==T.field(A,!1):!0)||(d?TC(y=o(T),L,l):l(y=o(T),L)))return T.values[h]=L,0}else y=o(T);return T.values[h]=y,1}}}}function TC(n,e,s){if(n.length!=e.length)return!1;for(let o=0;o<n.length;o++)if(!s(n[o],e[o]))return!1;return!0}function dT(n,e){let s=!1;for(let o of e)Ka(n,o)&1&&(s=!0);return s}function Ax(n,e,s){let o=s.map(p=>n[p.id]),l=s.map(p=>p.type),a=o.filter(p=>!(p&1)),h=n[e.id]>>1;function d(p){let g=[];for(let m=0;m<o.length;m++){let T=$p(p,o[m]);if(l[m]==2)for(let b of T)g.push(b);else g.push(T)}return e.combine(g)}return{create(p){for(let g of o)Ka(p,g);return p.values[h]=d(p),1},update(p,g){if(!dT(p,a))return 0;let m=d(p);return e.compare(m,p.values[h])?0:(p.values[h]=m,1)},reconfigure(p,g){let m=dT(p,o),T=g.config.facets[e.id],b=g.facet(e);if(T&&!m&&Nb(s,T))return p.values[h]=b,0;let y=d(p);return e.compare(y,b)?(p.values[h]=b,0):(p.values[h]=y,1)}}}const bC=Xt.define({static:!0});class Yn{constructor(e,s,o,l,a){this.id=e,this.createF=s,this.updateF=o,this.compareF=l,this.spec=a,this.provides=void 0}static define(e){let s=new Yn(Rb++,e.create,e.update,e.compare||((o,l)=>o===l),e);return e.provide&&(s.provides=e.provide(s)),s}create(e){let s=e.facet(bC).find(o=>o.field==this);return((s==null?void 0:s.create)||this.createF)(e)}slot(e){let s=e[this.id]>>1;return{create:o=>(o.values[s]=this.create(o),1),update:(o,l)=>{let a=o.values[s],h=this.updateF(a,l);return this.compareF(a,h)?0:(o.values[s]=h,1)},reconfigure:(o,l)=>l.config.address[this.id]!=null?(o.values[s]=l.field(this),0):(o.values[s]=this.create(o),1)}}init(e){return[this,bC.of({field:this,create:e})]}get extension(){return this}}const Nr={lowest:4,low:3,default:2,high:1,highest:0};function wa(n){return e=>new R0(e,n)}const A0={highest:wa(Nr.highest),high:wa(Nr.high),default:wa(Nr.default),low:wa(Nr.low),lowest:wa(Nr.lowest)};class R0{constructor(e,s){this.inner=e,this.prec=s}}class Wp{of(e){return new pT(this,e)}reconfigure(e){return Wp.reconfigure.of({compartment:this,extension:e})}get(e){return e.config.compartments.get(this)}}class pT{constructor(e,s){this.compartment=e,this.inner=s}}class mp{constructor(e,s,o,l,a,h){for(this.base=e,this.compartments=s,this.dynamicSlots=o,this.address=l,this.staticValues=a,this.facets=h,this.statusTemplate=[];this.statusTemplate.length<o.length;)this.statusTemplate.push(0)}staticFacet(e){let s=this.address[e.id];return s==null?e.default:this.staticValues[s>>1]}static resolve(e,s,o){let l=[],a=Object.create(null),h=new Map;for(let b of Rx(e,s,h))b instanceof Yn?l.push(b):(a[b.facet.id]||(a[b.facet.id]=[])).push(b);let d=Object.create(null),p=[],g=[];for(let b of l)d[b.id]=g.length<<1,g.push(y=>b.slot(y));let m=o==null?void 0:o.config.facets;for(let b in a){let y=a[b],C=y[0].facet,L=m&&m[b]||[];if(y.every(A=>A.type==0))if(d[C.id]=p.length<<1|1,Nb(L,y))p.push(o.facet(C));else{let A=C.combine(y.map(F=>F.value));p.push(o&&C.compare(A,o.facet(C))?o.facet(C):A)}else{for(let A of y)A.type==0?(d[A.id]=p.length<<1|1,p.push(A.value)):(d[A.id]=g.length<<1,g.push(F=>A.dynamicSlot(F)));d[C.id]=g.length<<1,g.push(A=>Ax(A,C,y))}}let T=g.map(b=>b(d));return new mp(e,h,T,d,p,a)}}function Rx(n,e,s){let o=[[],[],[],[],[]],l=new Map;function a(h,d){let p=l.get(h);if(p!=null){if(p<=d)return;let g=o[p].indexOf(h);g>-1&&o[p].splice(g,1),h instanceof pT&&s.delete(h.compartment)}if(l.set(h,d),Array.isArray(h))for(let g of h)a(g,d);else if(h instanceof pT){if(s.has(h.compartment))throw new RangeError("Duplicate use of compartment in extensions");let g=e.get(h.compartment)||h.inner;s.set(h.compartment,g),a(g,d)}else if(h instanceof R0)a(h.inner,h.prec);else if(h instanceof Yn)o[d].push(h),h.provides&&a(h.provides,d);else if(h instanceof qd)o[d].push(h),h.facet.extensions&&a(h.facet.extensions,Nr.default);else{let g=h.extension;if(!g)throw new Error(`Unrecognized extension value in extension set (${h}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);a(g,d)}}return a(n,Nr.default),o.reduce((h,d)=>h.concat(d))}function Ka(n,e){if(e&1)return 2;let s=e>>1,o=n.status[s];if(o==4)throw new Error("Cyclic dependency between fields and/or facets");if(o&2)return o;n.status[s]=4;let l=n.computeSlot(n,n.config.dynamicSlots[s]);return n.status[s]=2|l}function $p(n,e){return e&1?n.config.staticValues[e>>1]:n.values[e>>1]}const N0=Xt.define(),fT=Xt.define({combine:n=>n.some(e=>e),static:!0}),L0=Xt.define({combine:n=>n.length?n[0]:void 0,static:!0}),M0=Xt.define(),x0=Xt.define(),D0=Xt.define(),P0=Xt.define({combine:n=>n.length?n[0]:!1});class Ac{constructor(e,s){this.type=e,this.value=s}static define(){return new Nx}}class Nx{of(e){return new Ac(this,e)}}class Lx{constructor(e){this.map=e}of(e){return new Ze(this,e)}}class Ze{constructor(e,s){this.type=e,this.value=s}map(e){let s=this.type.map(this.value,e);return s===void 0?void 0:s==this.value?this:new Ze(this.type,s)}is(e){return this.type==e}static define(e={}){return new Lx(e.map||(s=>s))}static mapEffects(e,s){if(!e.length)return e;let o=[];for(let l of e){let a=l.map(s);a&&o.push(a)}return o}}Ze.reconfigure=Ze.define();Ze.appendConfig=Ze.define();class $i{constructor(e,s,o,l,a,h){this.startState=e,this.changes=s,this.selection=o,this.effects=l,this.annotations=a,this.scrollIntoView=h,this._doc=null,this._state=null,o&&O0(o,s.newLength),a.some(d=>d.type==$i.time)||(this.annotations=a.concat($i.time.of(Date.now())))}static create(e,s,o,l,a,h){return new $i(e,s,o,l,a,h)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(e){for(let s of this.annotations)if(s.type==e)return s.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(e){let s=this.annotation($i.userEvent);return!!(s&&(s==e||s.length>e.length&&s.slice(0,e.length)==e&&s[e.length]=="."))}}$i.time=Ac.define();$i.userEvent=Ac.define();$i.addToHistory=Ac.define();$i.remote=Ac.define();function Mx(n,e){let s=[];for(let o=0,l=0;;){let a,h;if(o<n.length&&(l==e.length||e[l]>=n[o]))a=n[o++],h=n[o++];else if(l<e.length)a=e[l++],h=e[l++];else return s;!s.length||s[s.length-1]<a?s.push(a,h):s[s.length-1]<h&&(s[s.length-1]=h)}}function B0(n,e,s){var o;let l,a,h;return s?(l=e.changes,a=Qe.empty(e.changes.length),h=n.changes.compose(e.changes)):(l=e.changes.map(n.changes),a=n.changes.mapDesc(e.changes,!0),h=n.changes.compose(l)),{changes:h,selection:e.selection?e.selection.map(a):(o=n.selection)===null||o===void 0?void 0:o.map(l),effects:Ze.mapEffects(n.effects,l).concat(Ze.mapEffects(e.effects,a)),annotations:n.annotations.length?n.annotations.concat(e.annotations):e.annotations,scrollIntoView:n.scrollIntoView||e.scrollIntoView}}function gT(n,e,s){let o=e.selection,l=cc(e.annotations);return e.userEvent&&(l=l.concat($i.userEvent.of(e.userEvent))),{changes:e.changes instanceof Qe?e.changes:Qe.of(e.changes||[],s,n.facet(L0)),selection:o&&(o instanceof xt?o:xt.single(o.anchor,o.head)),effects:cc(e.effects),annotations:l,scrollIntoView:!!e.scrollIntoView}}function F0(n,e,s){let o=gT(n,e.length?e[0]:{},n.doc.length);e.length&&e[0].filter===!1&&(s=!1);for(let a=1;a<e.length;a++){e[a].filter===!1&&(s=!1);let h=!!e[a].sequential;o=B0(o,gT(n,e[a],h?o.changes.newLength:n.doc.length),h)}let l=$i.create(n,o.changes,o.selection,o.effects,o.annotations,o.scrollIntoView);return Dx(s?xx(l):l)}function xx(n){let e=n.startState,s=!0;for(let l of e.facet(M0)){let a=l(n);if(a===!1){s=!1;break}Array.isArray(a)&&(s=s===!0?a:Mx(s,a))}if(s!==!0){let l,a;if(s===!1)a=n.changes.invertedDesc,l=Qe.empty(e.doc.length);else{let h=n.changes.filter(s);l=h.changes,a=h.filtered.mapDesc(h.changes).invertedDesc}n=$i.create(e,l,n.selection&&n.selection.map(a),Ze.mapEffects(n.effects,a),n.annotations,n.scrollIntoView)}let o=e.facet(x0);for(let l=o.length-1;l>=0;l--){let a=o[l](n);a instanceof $i?n=a:Array.isArray(a)&&a.length==1&&a[0]instanceof $i?n=a[0]:n=F0(e,cc(a),!1)}return n}function Dx(n){let e=n.startState,s=e.facet(D0),o=n;for(let l=s.length-1;l>=0;l--){let a=s[l](n);a&&Object.keys(a).length&&(o=B0(o,gT(e,a,n.changes.newLength),!0))}return o==n?n:$i.create(e,n.changes,n.selection,o.effects,o.annotations,o.scrollIntoView)}const Px=[];function cc(n){return n==null?Px:Array.isArray(n)?n:[n]}var Ho=function(n){return n[n.Word=0]="Word",n[n.Space=1]="Space",n[n.Other=2]="Other",n}(Ho||(Ho={}));const Bx=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let mT;try{mT=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function Fx(n){if(mT)return mT.test(n);for(let e=0;e<n.length;e++){let s=n[e];if(/\w/.test(s)||s>""&&(s.toUpperCase()!=s.toLowerCase()||Bx.test(s)))return!0}return!1}function Ux(n){return e=>{if(!/\S/.test(e))return Ho.Space;if(Fx(e))return Ho.Word;for(let s=0;s<n.length;s++)if(e.indexOf(n[s])>-1)return Ho.Word;return Ho.Other}}class $e{constructor(e,s,o,l,a,h){this.config=e,this.doc=s,this.selection=o,this.values=l,this.status=e.statusTemplate.slice(),this.computeSlot=a,h&&(h._state=this);for(let d=0;d<this.config.dynamicSlots.length;d++)Ka(this,d<<1);this.computeSlot=null}field(e,s=!0){let o=this.config.address[e.id];if(o==null){if(s)throw new RangeError("Field is not present in this state");return}return Ka(this,o),$p(this,o)}update(...e){return F0(this,e,!0)}applyTransaction(e){let s=this.config,{base:o,compartments:l}=s;for(let d of e.effects)d.is(Wp.reconfigure)?(s&&(l=new Map,s.compartments.forEach((p,g)=>l.set(g,p)),s=null),l.set(d.value.compartment,d.value.extension)):d.is(Ze.reconfigure)?(s=null,o=d.value):d.is(Ze.appendConfig)&&(s=null,o=cc(o).concat(d.value));let a;s?a=e.startState.values.slice():(s=mp.resolve(o,l,this),a=new $e(s,this.doc,this.selection,s.dynamicSlots.map(()=>null),(p,g)=>g.reconfigure(p,this),null).values);let h=e.startState.facet(fT)?e.newSelection:e.newSelection.asSingle();new $e(s,e.newDoc,h,a,(d,p)=>p.update(d,e),e)}replaceSelection(e){return typeof e=="string"&&(e=this.toText(e)),this.changeByRange(s=>({changes:{from:s.from,to:s.to,insert:e},range:xt.cursor(s.from+e.length)}))}changeByRange(e){let s=this.selection,o=e(s.ranges[0]),l=this.changes(o.changes),a=[o.range],h=cc(o.effects);for(let d=1;d<s.ranges.length;d++){let p=e(s.ranges[d]),g=this.changes(p.changes),m=g.map(l);for(let b=0;b<d;b++)a[b]=a[b].map(m);let T=l.mapDesc(g,!0);a.push(p.range.map(T)),l=l.compose(m),h=Ze.mapEffects(h,m).concat(Ze.mapEffects(cc(p.effects),T))}return{changes:l,selection:xt.create(a,s.mainIndex),effects:h}}changes(e=[]){return e instanceof Qe?e:Qe.of(e,this.doc.length,this.facet($e.lineSeparator))}toText(e){return Te.of(e.split(this.facet($e.lineSeparator)||aT))}sliceDoc(e=0,s=this.doc.length){return this.doc.sliceString(e,s,this.lineBreak)}facet(e){let s=this.config.address[e.id];return s==null?e.default:(Ka(this,s),$p(this,s))}toJSON(e){let s={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(e)for(let o in e){let l=e[o];l instanceof Yn&&this.config.address[l.id]!=null&&(s[o]=l.spec.toJSON(this.field(e[o]),this))}return s}static fromJSON(e,s={},o){if(!e||typeof e.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let l=[];if(o){for(let a in o)if(Object.prototype.hasOwnProperty.call(e,a)){let h=o[a],d=e[a];l.push(h.init(p=>h.spec.fromJSON(d,p)))}}return $e.create({doc:e.doc,selection:xt.fromJSON(e.selection),extensions:s.extensions?l.concat([s.extensions]):l})}static create(e={}){let s=mp.resolve(e.extensions||[],new Map),o=e.doc instanceof Te?e.doc:Te.of((e.doc||"").split(s.staticFacet($e.lineSeparator)||aT)),l=e.selection?e.selection instanceof xt?e.selection:xt.single(e.selection.anchor,e.selection.head):xt.single(0);return O0(l,o.length),s.staticFacet(fT)||(l=l.asSingle()),new $e(s,o,l,s.dynamicSlots.map(()=>null),(a,h)=>h.create(a),null)}get tabSize(){return this.facet($e.tabSize)}get lineBreak(){return this.facet($e.lineSeparator)||`
`}get readOnly(){return this.facet(P0)}phrase(e,...s){for(let o of this.facet($e.phrases))if(Object.prototype.hasOwnProperty.call(o,e)){e=o[e];break}return s.length&&(e=e.replace(/\$(\$|\d*)/g,(o,l)=>{if(l=="$")return"$";let a=+(l||1);return!a||a>s.length?o:s[a-1]})),e}languageDataAt(e,s,o=-1){let l=[];for(let a of this.facet(N0))for(let h of a(this,s,o))Object.prototype.hasOwnProperty.call(h,e)&&l.push(h[e]);return l}charCategorizer(e){return Ux(this.languageDataAt("wordChars",e).join(""))}wordAt(e){let{text:s,from:o,length:l}=this.doc.lineAt(e),a=this.charCategorizer(e),h=e-o,d=e-o;for(;h>0;){let p=Uo(s,h,!1);if(a(s.slice(p,h))!=Ho.Word)break;h=p}for(;d<l;){let p=Uo(s,d);if(a(s.slice(d,p))!=Ho.Word)break;d=p}return h==d?null:xt.range(h+o,d+o)}}$e.allowMultipleSelections=fT;$e.tabSize=Xt.define({combine:n=>n.length?n[0]:4});$e.lineSeparator=L0;$e.readOnly=P0;$e.phrases=Xt.define({compare(n,e){let s=Object.keys(n),o=Object.keys(e);return s.length==o.length&&s.every(l=>n[l]==e[l])}});$e.languageData=N0;$e.changeFilter=M0;$e.transactionFilter=x0;$e.transactionExtender=D0;Wp.reconfigure=Ze.define();function Hx(n,e,s={}){let o={};for(let l of n)for(let a of Object.keys(l)){let h=l[a],d=o[a];if(d===void 0)o[a]=h;else if(!(d===h||h===void 0))if(Object.hasOwnProperty.call(s,a))o[a]=s[a](d,h);else throw new Error("Config merge conflict for field "+a)}for(let l in e)o[l]===void 0&&(o[l]=e[l]);return o}class fc{eq(e){return this==e}range(e,s=e){return $T.create(e,s,this)}}fc.prototype.startSide=fc.prototype.endSide=0;fc.prototype.point=!1;fc.prototype.mapMode=ts.TrackDel;let $T=class U0{constructor(e,s,o){this.from=e,this.to=s,this.value=o}static create(e,s,o){return new U0(e,s,o)}};function _T(n,e){return n.from-e.from||n.value.startSide-e.value.startSide}class Lb{constructor(e,s,o,l){this.from=e,this.to=s,this.value=o,this.maxPoint=l}get length(){return this.to[this.to.length-1]}findIndex(e,s,o,l=0){let a=o?this.to:this.from;for(let h=l,d=a.length;;){if(h==d)return h;let p=h+d>>1,g=a[p]-e||(o?this.value[p].endSide:this.value[p].startSide)-s;if(p==h)return g>=0?h:d;g>=0?d=p:h=p+1}}between(e,s,o,l){for(let a=this.findIndex(s,-1e9,!0),h=this.findIndex(o,1e9,!1,a);a<h;a++)if(l(this.from[a]+e,this.to[a]+e,this.value[a])===!1)return!1}map(e,s){let o=[],l=[],a=[],h=-1,d=-1;for(let p=0;p<this.value.length;p++){let g=this.value[p],m=this.from[p]+e,T=this.to[p]+e,b,y;if(m==T){let C=s.mapPos(m,g.startSide,g.mapMode);if(C==null||(b=y=C,g.startSide!=g.endSide&&(y=s.mapPos(m,g.endSide),y<b)))continue}else if(b=s.mapPos(m,g.startSide),y=s.mapPos(T,g.endSide),b>y||b==y&&g.startSide>0&&g.endSide<=0)continue;(y-b||g.endSide-g.startSide)<0||(h<0&&(h=b),g.point&&(d=Math.max(d,y-b)),o.push(g),l.push(b-h),a.push(y-h))}return{mapped:o.length?new Lb(l,a,o,d):null,pos:h}}}class pe{constructor(e,s,o,l){this.chunkPos=e,this.chunk=s,this.nextLayer=o,this.maxPoint=l}static create(e,s,o,l){return new pe(e,s,o,l)}get length(){let e=this.chunk.length-1;return e<0?0:Math.max(this.chunkEnd(e),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let e=this.nextLayer.size;for(let s of this.chunk)e+=s.value.length;return e}chunkEnd(e){return this.chunkPos[e]+this.chunk[e].length}update(e){let{add:s=[],sort:o=!1,filterFrom:l=0,filterTo:a=this.length}=e,h=e.filter;if(s.length==0&&!h)return this;if(o&&(s=s.slice().sort(_T)),this.isEmpty)return s.length?pe.of(s):this;let d=new H0(this,null,-1).goto(0),p=0,g=[],m=new vh;for(;d.value||p<s.length;)if(p<s.length&&(d.from-s[p].from||d.startSide-s[p].value.startSide)>=0){let T=s[p++];m.addInner(T.from,T.to,T.value)||g.push(T)}else d.rangeIndex==1&&d.chunkIndex<this.chunk.length&&(p==s.length||this.chunkEnd(d.chunkIndex)<s[p].from)&&(!h||l>this.chunkEnd(d.chunkIndex)||a<this.chunkPos[d.chunkIndex])&&m.addChunk(this.chunkPos[d.chunkIndex],this.chunk[d.chunkIndex])?d.nextChunk():((!h||l>d.to||a<d.from||h(d.from,d.to,d.value))&&(m.addInner(d.from,d.to,d.value)||g.push($T.create(d.from,d.to,d.value))),d.next());return m.finishInner(this.nextLayer.isEmpty&&!g.length?pe.empty:this.nextLayer.update({add:g,filter:h,filterFrom:l,filterTo:a}))}map(e){if(e.empty||this.isEmpty)return this;let s=[],o=[],l=-1;for(let h=0;h<this.chunk.length;h++){let d=this.chunkPos[h],p=this.chunk[h],g=e.touchesRange(d,d+p.length);if(g===!1)l=Math.max(l,p.maxPoint),s.push(p),o.push(e.mapPos(d));else if(g===!0){let{mapped:m,pos:T}=p.map(d,e);m&&(l=Math.max(l,m.maxPoint),s.push(m),o.push(T))}}let a=this.nextLayer.map(e);return s.length==0?a:new pe(o,s,a||pe.empty,l)}between(e,s,o){if(!this.isEmpty){for(let l=0;l<this.chunk.length;l++){let a=this.chunkPos[l],h=this.chunk[l];if(s>=a&&e<=a+h.length&&h.between(a,e-a,s-a,o)===!1)return}this.nextLayer.between(e,s,o)}}iter(e=0){return yh.from([this]).goto(e)}get isEmpty(){return this.nextLayer==this}static iter(e,s=0){return yh.from(e).goto(s)}static compare(e,s,o,l,a=-1){let h=e.filter(T=>T.maxPoint>0||!T.isEmpty&&T.maxPoint>=a),d=s.filter(T=>T.maxPoint>0||!T.isEmpty&&T.maxPoint>=a),p=EC(h,d,o),g=new ka(h,p,a),m=new ka(d,p,a);o.iterGaps((T,b,y)=>vC(g,T,m,b,y,l)),o.empty&&o.length==0&&vC(g,0,m,0,0,l)}static eq(e,s,o=0,l){l==null&&(l=1e9-1);let a=e.filter(m=>!m.isEmpty&&s.indexOf(m)<0),h=s.filter(m=>!m.isEmpty&&e.indexOf(m)<0);if(a.length!=h.length)return!1;if(!a.length)return!0;let d=EC(a,h),p=new ka(a,d,0).goto(o),g=new ka(h,d,0).goto(o);for(;;){if(p.to!=g.to||!TT(p.active,g.active)||p.point&&(!g.point||!p.point.eq(g.point)))return!1;if(p.to>l)return!0;p.next(),g.next()}}static spans(e,s,o,l,a=-1){let h=new ka(e,null,a).goto(s),d=s,p=h.openStart;for(;;){let g=Math.min(h.to,o);if(h.point){let m=h.activeForPoint(h.to),T=h.pointFrom<s?m.length+1:Math.min(m.length,p);l.point(d,g,h.point,m,T,h.pointRank),p=Math.min(h.openEnd(g),m.length)}else g>d&&(l.span(d,g,h.active,p),p=h.openEnd(g));if(h.to>o)return p+(h.point&&h.to>o?1:0);d=h.to,h.next()}}static of(e,s=!1){let o=new vh;for(let l of e instanceof $T?[e]:s?Vx(e):e)o.add(l.from,l.to,l.value);return o.finish()}static join(e){if(!e.length)return pe.empty;let s=e[e.length-1];for(let o=e.length-2;o>=0;o--)for(let l=e[o];l!=pe.empty;l=l.nextLayer)s=new pe(l.chunkPos,l.chunk,s,Math.max(l.maxPoint,s.maxPoint));return s}}pe.empty=new pe([],[],null,-1);function Vx(n){if(n.length>1)for(let e=n[0],s=1;s<n.length;s++){let o=n[s];if(_T(e,o)>0)return n.slice().sort(_T);e=o}return n}pe.empty.nextLayer=pe.empty;class vh{finishChunk(e){this.chunks.push(new Lb(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,e&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(e,s,o){this.addInner(e,s,o)||(this.nextLayer||(this.nextLayer=new vh)).add(e,s,o)}addInner(e,s,o){let l=e-this.lastTo||o.startSide-this.last.endSide;if(l<=0&&(e-this.lastFrom||o.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return l<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=e),this.from.push(e-this.chunkStart),this.to.push(s-this.chunkStart),this.last=o,this.lastFrom=e,this.lastTo=s,this.value.push(o),o.point&&(this.maxPoint=Math.max(this.maxPoint,s-e)),!0)}addChunk(e,s){if((e-this.lastTo||s.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,s.maxPoint),this.chunks.push(s),this.chunkPos.push(e);let o=s.value.length-1;return this.last=s.value[o],this.lastFrom=s.from[o]+e,this.lastTo=s.to[o]+e,!0}finish(){return this.finishInner(pe.empty)}finishInner(e){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return e;let s=pe.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(e):e,this.setMaxPoint);return this.from=null,s}}function EC(n,e,s){let o=new Map;for(let a of n)for(let h=0;h<a.chunk.length;h++)a.chunk[h].maxPoint<=0&&o.set(a.chunk[h],a.chunkPos[h]);let l=new Set;for(let a of e)for(let h=0;h<a.chunk.length;h++){let d=o.get(a.chunk[h]);d!=null&&(s?s.mapPos(d):d)==a.chunkPos[h]&&!(s!=null&&s.touchesRange(d,d+a.chunk[h].length))&&l.add(a.chunk[h])}return l}class H0{constructor(e,s,o,l=0){this.layer=e,this.skip=s,this.minPoint=o,this.rank=l}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(e,s=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(e,s,!1),this}gotoInner(e,s,o){for(;this.chunkIndex<this.layer.chunk.length;){let l=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(l)||this.layer.chunkEnd(this.chunkIndex)<e||l.maxPoint<this.minPoint))break;this.chunkIndex++,o=!1}if(this.chunkIndex<this.layer.chunk.length){let l=this.layer.chunk[this.chunkIndex].findIndex(e-this.layer.chunkPos[this.chunkIndex],s,!0);(!o||this.rangeIndex<l)&&this.setRangeIndex(l)}this.next()}forward(e,s){(this.to-e||this.endSide-s)<0&&this.gotoInner(e,s,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let e=this.layer.chunkPos[this.chunkIndex],s=this.layer.chunk[this.chunkIndex],o=e+s.from[this.rangeIndex];if(this.from=o,this.to=e+s.to[this.rangeIndex],this.value=s.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(e){if(e==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=e}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(e){return this.from-e.from||this.startSide-e.startSide||this.rank-e.rank||this.to-e.to||this.endSide-e.endSide}}class yh{constructor(e){this.heap=e}static from(e,s=null,o=-1){let l=[];for(let a=0;a<e.length;a++)for(let h=e[a];!h.isEmpty;h=h.nextLayer)h.maxPoint>=o&&l.push(new H0(h,s,o,a));return l.length==1?l[0]:new yh(l)}get startSide(){return this.value?this.value.startSide:0}goto(e,s=-1e9){for(let o of this.heap)o.goto(e,s);for(let o=this.heap.length>>1;o>=0;o--)i_(this.heap,o);return this.next(),this}forward(e,s){for(let o of this.heap)o.forward(e,s);for(let o=this.heap.length>>1;o>=0;o--)i_(this.heap,o);(this.to-e||this.value.endSide-s)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let e=this.heap[0];this.from=e.from,this.to=e.to,this.value=e.value,this.rank=e.rank,e.value&&e.next(),i_(this.heap,0)}}}function i_(n,e){for(let s=n[e];;){let o=(e<<1)+1;if(o>=n.length)break;let l=n[o];if(o+1<n.length&&l.compare(n[o+1])>=0&&(l=n[o+1],o++),s.compare(l)<0)break;n[o]=s,n[e]=l,e=o}}class ka{constructor(e,s,o){this.minPoint=o,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=yh.from(e,s,o)}goto(e,s=-1e9){return this.cursor.goto(e,s),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=e,this.endSide=s,this.openStart=-1,this.next(),this}forward(e,s){for(;this.minActive>-1&&(this.activeTo[this.minActive]-e||this.active[this.minActive].endSide-s)<0;)this.removeActive(this.minActive);this.cursor.forward(e,s)}removeActive(e){bd(this.active,e),bd(this.activeTo,e),bd(this.activeRank,e),this.minActive=yC(this.active,this.activeTo)}addActive(e){let s=0,{value:o,to:l,rank:a}=this.cursor;for(;s<this.activeRank.length&&(a-this.activeRank[s]||l-this.activeTo[s])>0;)s++;Ed(this.active,s,o),Ed(this.activeTo,s,l),Ed(this.activeRank,s,a),e&&Ed(e,s,this.cursor.from),this.minActive=yC(this.active,this.activeTo)}next(){let e=this.to,s=this.point;this.point=null;let o=this.openStart<0?[]:null;for(;;){let l=this.minActive;if(l>-1&&(this.activeTo[l]-this.cursor.from||this.active[l].endSide-this.cursor.startSide)<0){if(this.activeTo[l]>e){this.to=this.activeTo[l],this.endSide=this.active[l].endSide;break}this.removeActive(l),o&&bd(o,l)}else if(this.cursor.value)if(this.cursor.from>e){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let a=this.cursor.value;if(!a.point)this.addActive(o),this.cursor.next();else if(s&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=a,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=a.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(o){this.openStart=0;for(let l=o.length-1;l>=0&&o[l]<e;l--)this.openStart++}}activeForPoint(e){if(!this.active.length)return this.active;let s=[];for(let o=this.active.length-1;o>=0&&!(this.activeRank[o]<this.pointRank);o--)(this.activeTo[o]>e||this.activeTo[o]==e&&this.active[o].endSide>=this.point.endSide)&&s.push(this.active[o]);return s.reverse()}openEnd(e){let s=0;for(let o=this.activeTo.length-1;o>=0&&this.activeTo[o]>e;o--)s++;return s}}function vC(n,e,s,o,l,a){n.goto(e),s.goto(o);let h=o+l,d=o,p=o-e;for(;;){let g=n.to+p-s.to||n.endSide-s.endSide,m=g<0?n.to+p:s.to,T=Math.min(m,h);if(n.point||s.point?n.point&&s.point&&(n.point==s.point||n.point.eq(s.point))&&TT(n.activeForPoint(n.to),s.activeForPoint(s.to))||a.comparePoint(d,T,n.point,s.point):T>d&&!TT(n.active,s.active)&&a.compareRange(d,T,n.active,s.active),m>h)break;d=m,g<=0&&n.next(),g>=0&&s.next()}}function TT(n,e){if(n.length!=e.length)return!1;for(let s=0;s<n.length;s++)if(n[s]!=e[s]&&!n[s].eq(e[s]))return!1;return!0}function bd(n,e){for(let s=e,o=n.length-1;s<o;s++)n[s]=n[s+1];n.pop()}function Ed(n,e,s){for(let o=n.length-1;o>=e;o--)n[o+1]=n[o];n[e]=s}function yC(n,e){let s=-1,o=1e9;for(let l=0;l<e.length;l++)(e[l]-o||n[l].endSide-n[s].endSide)<0&&(s=l,o=e[l]);return s}function Gx(n,e,s,o){for(let l=0,a=0;;){if(a>=e)return l;if(l==n.length)break;a+=n.charCodeAt(l)==9?s-a%s:1,l=Uo(n,l)}return o===!0?-1:n.length}const bT="",IC=typeof Symbol>"u"?"__"+bT:Symbol.for(bT),ET=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),SC=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{};let gc=class{constructor(e,s){this.rules=[];let{finish:o}=s||{};function l(h){return/^@/.test(h)?[h]:h.split(/,\s*/)}function a(h,d,p,g){let m=[],T=/^@(\w+)\b/.exec(h[0]),b=T&&T[1]=="keyframes";if(T&&d==null)return p.push(h[0]+";");for(let y in d){let C=d[y];if(/&/.test(y))a(y.split(/,\s*/).map(L=>h.map(A=>L.replace(/&/,A))).reduce((L,A)=>L.concat(A)),C,p);else if(C&&typeof C=="object"){if(!T)throw new RangeError("The value of a property ("+y+") should be a primitive value.");a(l(y),C,m,b)}else C!=null&&m.push(y.replace(/_.*/,"").replace(/[A-Z]/g,L=>"-"+L.toLowerCase())+": "+C+";")}(m.length||b)&&p.push((o&&!T&&!g?h.map(o):h).join(", ")+" {"+m.join(" ")+"}")}for(let h in e)a(l(h),e[h],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let e=SC[IC]||1;return SC[IC]=e+1,bT+e.toString(36)}static mount(e,s,o){let l=e[ET],a=o&&o.nonce;l?a&&l.setNonce(a):l=new Wx(e,a),l.mount(Array.isArray(s)?s:[s])}},CC=new Map,Wx=class{constructor(e,s){let o=e.ownerDocument||e,l=o.defaultView;if(!e.head&&e.adoptedStyleSheets&&l.CSSStyleSheet){let a=CC.get(o);if(a)return e.adoptedStyleSheets=[a.sheet,...e.adoptedStyleSheets],e[ET]=a;this.sheet=new l.CSSStyleSheet,e.adoptedStyleSheets=[this.sheet,...e.adoptedStyleSheets],CC.set(o,this)}else{this.styleTag=o.createElement("style"),s&&this.styleTag.setAttribute("nonce",s);let a=e.head||e;a.insertBefore(this.styleTag,a.firstChild)}this.modules=[],e[ET]=this}mount(e){let s=this.sheet,o=0,l=0;for(let a=0;a<e.length;a++){let h=e[a],d=this.modules.indexOf(h);if(d<l&&d>-1&&(this.modules.splice(d,1),l--,d=-1),d==-1){if(this.modules.splice(l++,0,h),s)for(let p=0;p<h.rules.length;p++)s.insertRule(h.rules[p],o++)}else{for(;l<d;)o+=this.modules[l++].rules.length;o+=h.rules.length,l++}}if(!s){let a="";for(let h=0;h<this.modules.length;h++)a+=this.modules[h].getRules()+`
`;this.styleTag.textContent=a}}setNonce(e){this.styleTag&&this.styleTag.getAttribute("nonce")!=e&&this.styleTag.setAttribute("nonce",e)}};var mc={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},vT={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'};for(var li=0;li<10;li++)mc[48+li]=mc[96+li]=String(li);for(var li=1;li<=24;li++)mc[li+111]="F"+li;for(var li=65;li<=90;li++)mc[li]=String.fromCharCode(li+32),vT[li]=String.fromCharCode(li);for(var s_ in mc)vT.hasOwnProperty(s_)||(vT[s_]=mc[s_]);function _p(n){let e;return n.nodeType==11?e=n.getSelection?n:n.ownerDocument:e=n,e.getSelection()}function yT(n,e){return e?n==e||n.contains(e.nodeType!=1?e.parentNode:e):!1}function zx(n){let e=n.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function Zd(n,e){if(!e.anchorNode)return!1;try{return yT(n,e.anchorNode)}catch{return!1}}function Ih(n){return n.nodeType==3?Hr(n,0,n.nodeValue.length).getClientRects():n.nodeType==1?n.getClientRects():[]}function ja(n,e,s,o){return s?wC(n,e,s,o,-1)||wC(n,e,s,o,1):!1}function Sh(n){for(var e=0;;e++)if(n=n.previousSibling,!n)return e}function wC(n,e,s,o,l){for(;;){if(n==s&&e==o)return!0;if(e==(l<0?0:Yo(n))){if(n.nodeName=="DIV")return!1;let a=n.parentNode;if(!a||a.nodeType!=1)return!1;e=Sh(n)+(l<0?0:1),n=a}else if(n.nodeType==1){if(n=n.childNodes[e+(l<0?-1:0)],n.nodeType==1&&n.contentEditable=="false")return!1;e=l<0?Yo(n):0}else return!1}}function Yo(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function Mb(n,e){let s=e?n.left:n.right;return{left:s,right:s,top:n.top,bottom:n.bottom}}function Xx(n){return{left:0,right:n.innerWidth,top:0,bottom:n.innerHeight}}function V0(n,e){let s=e.width/n.offsetWidth,o=e.height/n.offsetHeight;return(s>.995&&s<1.005||!isFinite(s)||Math.abs(e.width-n.offsetWidth)<1)&&(s=1),(o>.995&&o<1.005||!isFinite(o)||Math.abs(e.height-n.offsetHeight)<1)&&(o=1),{scaleX:s,scaleY:o}}function Yx(n,e,s,o,l,a,h,d){let p=n.ownerDocument,g=p.defaultView||window;for(let m=n,T=!1;m&&!T;)if(m.nodeType==1){let b,y=m==p.body,C=1,L=1;if(y)b=Xx(g);else{if(/^(fixed|sticky)$/.test(getComputedStyle(m).position)&&(T=!0),m.scrollHeight<=m.clientHeight&&m.scrollWidth<=m.clientWidth){m=m.assignedSlot||m.parentNode;continue}let z=m.getBoundingClientRect();({scaleX:C,scaleY:L}=V0(m,z)),b={left:z.left,right:z.left+m.clientWidth*C,top:z.top,bottom:z.top+m.clientHeight*L}}let A=0,F=0;if(l=="nearest")e.top<b.top?(F=-(b.top-e.top+h),s>0&&e.bottom>b.bottom+F&&(F=e.bottom-b.bottom+F+h)):e.bottom>b.bottom&&(F=e.bottom-b.bottom+h,s<0&&e.top-F<b.top&&(F=-(b.top+F-e.top+h)));else{let z=e.bottom-e.top,X=b.bottom-b.top;F=(l=="center"&&z<=X?e.top+z/2-X/2:l=="start"||l=="center"&&s<0?e.top-h:e.bottom-X+h)-b.top}if(o=="nearest"?e.left<b.left?(A=-(b.left-e.left+a),s>0&&e.right>b.right+A&&(A=e.right-b.right+A+a)):e.right>b.right&&(A=e.right-b.right+a,s<0&&e.left<b.left+A&&(A=-(b.left+A-e.left+a))):A=(o=="center"?e.left+(e.right-e.left)/2-(b.right-b.left)/2:o=="start"==d?e.left-a:e.right-(b.right-b.left)+a)-b.left,A||F)if(y)g.scrollBy(A,F);else{let z=0,X=0;if(F){let K=m.scrollTop;m.scrollTop+=F/L,X=(m.scrollTop-K)*L}if(A){let K=m.scrollLeft;m.scrollLeft+=A/C,z=(m.scrollLeft-K)*C}e={left:e.left-z,top:e.top-X,right:e.right-z,bottom:e.bottom-X},z&&Math.abs(z-A)<1&&(o="nearest"),X&&Math.abs(X-F)<1&&(l="nearest")}if(y)break;m=m.assignedSlot||m.parentNode}else if(m.nodeType==11)m=m.host;else break}function Kx(n){let e=n.ownerDocument;for(let s=n.parentNode;s&&s!=e.body;)if(s.nodeType==1){if(s.scrollHeight>s.clientHeight||s.scrollWidth>s.clientWidth)return s;s=s.assignedSlot||s.parentNode}else if(s.nodeType==11)s=s.host;else break;return null}class jx{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){let{anchorNode:s,focusNode:o}=e;this.set(s,Math.min(e.anchorOffset,s?Yo(s):0),o,Math.min(e.focusOffset,o?Yo(o):0))}set(e,s,o,l){this.anchorNode=e,this.anchorOffset=s,this.focusNode=o,this.focusOffset=l}}let Yl=null;function G0(n){if(n.setActive)return n.setActive();if(Yl)return n.focus(Yl);let e=[];for(let s=n;s&&(e.push(s,s.scrollTop,s.scrollLeft),s!=s.ownerDocument);s=s.parentNode);if(n.focus(Yl==null?{get preventScroll(){return Yl={preventScroll:!0},!0}}:void 0),!Yl){Yl=!1;for(let s=0;s<e.length;){let o=e[s++],l=e[s++],a=e[s++];o.scrollTop!=l&&(o.scrollTop=l),o.scrollLeft!=a&&(o.scrollLeft=a)}}}let kC;function Hr(n,e,s=e){let o=kC||(kC=document.createRange());return o.setEnd(n,s),o.setStart(n,e),o}function ac(n,e,s){let o={key:e,code:e,keyCode:s,which:s,cancelable:!0},l=new KeyboardEvent("keydown",o);l.synthetic=!0,n.dispatchEvent(l);let a=new KeyboardEvent("keyup",o);return a.synthetic=!0,n.dispatchEvent(a),l.defaultPrevented||a.defaultPrevented}function Jx(n){for(;n;){if(n&&(n.nodeType==9||n.nodeType==11&&n.host))return n;n=n.assignedSlot||n.parentNode}return null}function W0(n){for(;n.attributes.length;)n.removeAttributeNode(n.attributes[0])}function qx(n,e){let s=e.focusNode,o=e.focusOffset;if(!s||e.anchorNode!=s||e.anchorOffset!=o)return!1;for(o=Math.min(o,Yo(s));;)if(o){if(s.nodeType!=1)return!1;let l=s.childNodes[o-1];l.contentEditable=="false"?o--:(s=l,o=Yo(s))}else{if(s==n)return!0;o=Sh(s),s=s.parentNode}}function z0(n){return n.scrollTop>Math.max(1,n.scrollHeight-n.clientHeight-4)}class mi{constructor(e,s,o=!0){this.node=e,this.offset=s,this.precise=o}static before(e,s){return new mi(e.parentNode,Sh(e),s)}static after(e,s){return new mi(e.parentNode,Sh(e)+1,s)}}const xb=[];class Me{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e){let s=this.posAtStart;for(let o of this.children){if(o==e)return s;s+=o.length+o.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}sync(e,s){if(this.flags&2){let o=this.dom,l=null,a;for(let h of this.children){if(h.flags&7){if(!h.dom&&(a=l?l.nextSibling:o.firstChild)){let d=Me.get(a);(!d||!d.parent&&d.canReuseDOM(h))&&h.reuseDOM(a)}h.sync(e,s),h.flags&=-8}if(a=l?l.nextSibling:o.firstChild,s&&!s.written&&s.node==o&&a!=h.dom&&(s.written=!0),h.dom.parentNode==o)for(;a&&a!=h.dom;)a=OC(a);else o.insertBefore(h.dom,a);l=h.dom}for(a=l?l.nextSibling:o.firstChild,a&&s&&s.node==o&&(s.written=!0);a;)a=OC(a)}else if(this.flags&1)for(let o of this.children)o.flags&7&&(o.sync(e,s),o.flags&=-8)}reuseDOM(e){}localPosFromDOM(e,s){let o;if(e==this.dom)o=this.dom.childNodes[s];else{let l=Yo(e)==0?0:s==0?-1:1;for(;;){let a=e.parentNode;if(a==this.dom)break;l==0&&a.firstChild!=a.lastChild&&(e==a.firstChild?l=-1:l=1),e=a}l<0?o=e:o=e.nextSibling}if(o==this.dom.firstChild)return 0;for(;o&&!Me.get(o);)o=o.nextSibling;if(!o)return this.length;for(let l=0,a=0;;l++){let h=this.children[l];if(h.dom==o)return a;a+=h.length+h.breakAfter}}domBoundsAround(e,s,o=0){let l=-1,a=-1,h=-1,d=-1;for(let p=0,g=o,m=o;p<this.children.length;p++){let T=this.children[p],b=g+T.length;if(g<e&&b>s)return T.domBoundsAround(e,s,g);if(b>=e&&l==-1&&(l=p,a=g),g>s&&T.dom.parentNode==this.dom){h=p,d=m;break}m=b,g=b+T.breakAfter}return{from:a,to:d<0?o+this.length:d,startDOM:(l?this.children[l-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:h<this.children.length&&h>=0?this.children[h].dom:null}}markDirty(e=!1){this.flags|=2,this.markParentsDirty(e)}markParentsDirty(e){for(let s=this.parent;s;s=s.parent){if(e&&(s.flags|=2),s.flags&1)return;s.flags|=1,e=!1}}setParent(e){this.parent!=e&&(this.parent=e,this.flags&7&&this.markParentsDirty(!0))}setDOM(e){this.dom!=e&&(this.dom&&(this.dom.cmView=null),this.dom=e,e.cmView=this)}get rootView(){for(let e=this;;){let s=e.parent;if(!s)return e;e=s}}replaceChildren(e,s,o=xb){this.markDirty();for(let l=e;l<s;l++){let a=this.children[l];a.parent==this&&o.indexOf(a)<0&&a.destroy()}this.children.splice(e,s-e,...o);for(let l=0;l<o.length;l++)o[l].setParent(this)}ignoreMutation(e){return!1}ignoreEvent(e){return!1}childCursor(e=this.length){return new X0(this.children,e,this.children.length)}childPos(e,s=1){return this.childCursor().findPos(e,s)}toString(){let e=this.constructor.name.replace("View","");return e+(this.children.length?"("+this.children.join()+")":this.length?"["+(e=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(e){return e.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(e,s,o,l,a,h){return!1}become(e){return!1}canReuseDOM(e){return e.constructor==this.constructor&&!((this.flags|e.flags)&8)}getSide(){return 0}destroy(){for(let e of this.children)e.parent==this&&e.destroy();this.parent=null}}Me.prototype.breakAfter=0;function OC(n){let e=n.nextSibling;return n.parentNode.removeChild(n),e}class X0{constructor(e,s,o){this.children=e,this.pos=s,this.i=o,this.off=0}findPos(e,s=1){for(;;){if(e>this.pos||e==this.pos&&(s>0||this.i==0||this.children[this.i-1].breakAfter))return this.off=e-this.pos,this;let o=this.children[--this.i];this.pos-=o.length+o.breakAfter}}}function Y0(n,e,s,o,l,a,h,d,p){let{children:g}=n,m=g.length?g[e]:null,T=a.length?a[a.length-1]:null,b=T?T.breakAfter:h;if(!(e==o&&m&&!h&&!b&&a.length<2&&m.merge(s,l,a.length?T:null,s==0,d,p))){if(o<g.length){let y=g[o];y&&(l<y.length||y.breakAfter&&(T!=null&&T.breakAfter))?(e==o&&(y=y.split(l),l=0),!b&&T&&y.merge(0,l,T,!0,0,p)?a[a.length-1]=y:((l||y.children.length&&!y.children[0].length)&&y.merge(0,l,null,!1,0,p),a.push(y))):y!=null&&y.breakAfter&&(T?T.breakAfter=1:h=1),o++}for(m&&(m.breakAfter=h,s>0&&(!h&&a.length&&m.merge(s,m.length,a[0],!1,d,0)?m.breakAfter=a.shift().breakAfter:(s<m.length||m.children.length&&m.children[m.children.length-1].length==0)&&m.merge(s,m.length,null,!1,d,0),e++));e<o&&a.length;)if(g[o-1].become(a[a.length-1]))o--,a.pop(),p=a.length?0:d;else if(g[e].become(a[0]))e++,a.shift(),d=a.length?0:p;else break;!a.length&&e&&o<g.length&&!g[e-1].breakAfter&&g[o].merge(0,0,g[e-1],!1,d,p)&&e--,(e<o||a.length)&&n.replaceChildren(e,o,a)}}function K0(n,e,s,o,l,a){let h=n.childCursor(),{i:d,off:p}=h.findPos(s,1),{i:g,off:m}=h.findPos(e,-1),T=e-s;for(let b of o)T+=b.length;n.length+=T,Y0(n,g,m,d,p,o,0,l,a)}let es=typeof navigator<"u"?navigator:{userAgent:"",vendor:"",platform:""},IT=typeof document<"u"?document:{documentElement:{style:{}}};const ST=/Edge\/(\d+)/.exec(es.userAgent),j0=/MSIE \d/.test(es.userAgent),CT=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(es.userAgent),zp=!!(j0||CT||ST),AC=!zp&&/gecko\/(\d+)/i.test(es.userAgent),o_=!zp&&/Chrome\/(\d+)/.exec(es.userAgent),RC="webkitFontSmoothing"in IT.documentElement.style,J0=!zp&&/Apple Computer/.test(es.vendor),NC=J0&&(/Mobile\/\w+/.test(es.userAgent)||es.maxTouchPoints>2);var Dt={mac:NC||/Mac/.test(es.platform),windows:/Win/.test(es.platform),linux:/Linux|X11/.test(es.platform),ie:zp,ie_version:j0?IT.documentMode||6:CT?+CT[1]:ST?+ST[1]:0,gecko:AC,gecko_version:AC?+(/Firefox\/(\d+)/.exec(es.userAgent)||[0,0])[1]:0,chrome:!!o_,chrome_version:o_?+o_[1]:0,ios:NC,android:/Android\b/.test(es.userAgent),webkit:RC,safari:J0,webkit_version:RC?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0,tabSize:IT.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};const Zx=256;class Ko extends Me{constructor(e){super(),this.text=e}get length(){return this.text.length}createDOM(e){this.setDOM(e||document.createTextNode(this.text))}sync(e,s){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(s&&s.node==this.dom&&(s.written=!0),this.dom.nodeValue=this.text)}reuseDOM(e){e.nodeType==3&&this.createDOM(e)}merge(e,s,o){return this.flags&8||o&&(!(o instanceof Ko)||this.length-(s-e)+o.length>Zx||o.flags&8)?!1:(this.text=this.text.slice(0,e)+(o?o.text:"")+this.text.slice(s),this.markDirty(),!0)}split(e){let s=new Ko(this.text.slice(e));return this.text=this.text.slice(0,e),this.markDirty(),s.flags|=this.flags&8,s}localPosFromDOM(e,s){return e==this.dom?s:s?this.text.length:0}domAtPos(e){return new mi(this.dom,e)}domBoundsAround(e,s,o){return{from:o,to:o+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(e,s){return Qx(this.dom,e,s)}}class jo extends Me{constructor(e,s=[],o=0){super(),this.mark=e,this.children=s,this.length=o;for(let l of s)l.setParent(this)}setAttrs(e){if(W0(e),this.mark.class&&(e.className=this.mark.class),this.mark.attrs)for(let s in this.mark.attrs)e.setAttribute(s,this.mark.attrs[s]);return e}canReuseDOM(e){return super.canReuseDOM(e)&&!((this.flags|e.flags)&8)}reuseDOM(e){e.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(e),this.flags|=6)}sync(e,s){this.dom?this.flags&4&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(e,s)}merge(e,s,o,l,a,h){return o&&(!(o instanceof jo&&o.mark.eq(this.mark))||e&&a<=0||s<this.length&&h<=0)?!1:(K0(this,e,s,o?o.children.slice():[],a-1,h-1),this.markDirty(),!0)}split(e){let s=[],o=0,l=-1,a=0;for(let d of this.children){let p=o+d.length;p>e&&s.push(o<e?d.split(e-o):d),l<0&&o>=e&&(l=a),o=p,a++}let h=this.length-e;return this.length=e,l>-1&&(this.children.length=l,this.markDirty()),new jo(this.mark,s,h)}domAtPos(e){return q0(this,e)}coordsAt(e,s){return Q0(this,e,s)}}function Qx(n,e,s){let o=n.nodeValue.length;e>o&&(e=o);let l=e,a=e,h=0;e==0&&s<0||e==o&&s>=0?Dt.chrome||Dt.gecko||(e?(l--,h=1):a<o&&(a++,h=-1)):s<0?l--:a<o&&a++;let d=Hr(n,l,a).getClientRects();if(!d.length)return null;let p=d[(h?h<0:s>=0)?0:d.length-1];return Dt.safari&&!h&&p.width==0&&(p=Array.prototype.find.call(d,g=>g.width)||p),h?Mb(p,h<0):p||null}class Mr extends Me{static create(e,s,o){return new Mr(e,s,o)}constructor(e,s,o){super(),this.widget=e,this.length=s,this.side=o,this.prevWidget=null}split(e){let s=Mr.create(this.widget,this.length-e,this.side);return this.length-=e,s}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}getSide(){return this.side}merge(e,s,o,l,a,h){return o&&(!(o instanceof Mr)||!this.widget.compare(o.widget)||e>0&&a<=0||s<this.length&&h<=0)?!1:(this.length=e+(o?o.length:0)+(this.length-s),!0)}become(e){return e instanceof Mr&&e.side==this.side&&this.widget.constructor==e.widget.constructor?(this.widget.compare(e.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get overrideDOMText(){if(this.length==0)return Te.empty;let e=this;for(;e.parent;)e=e.parent;let{view:s}=e,o=s&&s.state.doc,l=this.posAtStart;return o?o.slice(l,l+this.length):Te.empty}domAtPos(e){return(this.length?e==0:this.side>0)?mi.before(this.dom):mi.after(this.dom,e==this.length)}domBoundsAround(){return null}coordsAt(e,s){let o=this.widget.coordsAt(this.dom,e,s);if(o)return o;let l=this.dom.getClientRects(),a=null;if(!l.length)return null;let h=this.side?this.side<0:e>0;for(let d=h?l.length-1:0;a=l[d],!(e>0?d==0:d==l.length-1||a.top<a.bottom);d+=h?-1:1);return Mb(a,!h)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class $c extends Me{constructor(e){super(),this.side=e}get length(){return 0}merge(){return!1}become(e){return e instanceof $c&&e.side==this.side}split(){return new $c(this.side)}sync(){if(!this.dom){let e=document.createElement("img");e.className="cm-widgetBuffer",e.setAttribute("aria-hidden","true"),this.setDOM(e)}}getSide(){return this.side}domAtPos(e){return this.side>0?mi.before(this.dom):mi.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(e){return this.dom.getBoundingClientRect()}get overrideDOMText(){return Te.empty}get isHidden(){return!0}}Ko.prototype.children=Mr.prototype.children=$c.prototype.children=xb;function q0(n,e){let s=n.dom,{children:o}=n,l=0;for(let a=0;l<o.length;l++){let h=o[l],d=a+h.length;if(!(d==a&&h.getSide()<=0)){if(e>a&&e<d&&h.dom.parentNode==s)return h.domAtPos(e-a);if(e<=a)break;a=d}}for(let a=l;a>0;a--){let h=o[a-1];if(h.dom.parentNode==s)return h.domAtPos(h.length)}for(let a=l;a<o.length;a++){let h=o[a];if(h.dom.parentNode==s)return h.domAtPos(0)}return new mi(s,0)}function Z0(n,e,s){let o,{children:l}=n;s>0&&e instanceof jo&&l.length&&(o=l[l.length-1])instanceof jo&&o.mark.eq(e.mark)?Z0(o,e.children[0],s-1):(l.push(e),e.setParent(n)),n.length+=e.length}function Q0(n,e,s){let o=null,l=-1,a=null,h=-1;function d(g,m){for(let T=0,b=0;T<g.children.length&&b<=m;T++){let y=g.children[T],C=b+y.length;C>=m&&(y.children.length?d(y,m-b):(!a||a.isHidden&&s>0)&&(C>m||b==C&&y.getSide()>0)?(a=y,h=m-b):(b<m||b==C&&y.getSide()<0&&!y.isHidden)&&(o=y,l=m-b)),b=C}}d(n,e);let p=(s<0?o:a)||o||a;return p?p.coordsAt(Math.max(0,p==o?l:h),s):tD(n)}function tD(n){let e=n.dom.lastChild;if(!e)return n.dom.getBoundingClientRect();let s=Ih(e);return s[s.length-1]||null}function wT(n,e){for(let s in n)s=="class"&&e.class?e.class+=" "+n.class:s=="style"&&e.style?e.style+=";"+n.style:e[s]=n[s];return e}const LC=Object.create(null);function Db(n,e,s){if(n==e)return!0;n||(n=LC),e||(e=LC);let o=Object.keys(n),l=Object.keys(e);if(o.length-(s&&o.indexOf(s)>-1?1:0)!=l.length-(s&&l.indexOf(s)>-1?1:0))return!1;for(let a of o)if(a!=s&&(l.indexOf(a)==-1||n[a]!==e[a]))return!1;return!0}function kT(n,e,s){let o=!1;if(e)for(let l in e)s&&l in s||(o=!0,l=="style"?n.style.cssText="":n.removeAttribute(l));if(s)for(let l in s)e&&e[l]==s[l]||(o=!0,l=="style"?n.style.cssText=s[l]:n.setAttribute(l,s[l]));return o}function eD(n){let e=Object.create(null);for(let s=0;s<n.attributes.length;s++){let o=n.attributes[s];e[o.name]=o.value}return e}class qe extends Me{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(e,s,o,l,a,h){if(o){if(!(o instanceof qe))return!1;this.dom||o.transferDOM(this)}return l&&this.setDeco(o?o.attrs:null),K0(this,e,s,o?o.children.slice():[],a,h),!0}split(e){let s=new qe;if(s.breakAfter=this.breakAfter,this.length==0)return s;let{i:o,off:l}=this.childPos(e);l&&(s.append(this.children[o].split(l),0),this.children[o].merge(l,this.children[o].length,null,!1,0,0),o++);for(let a=o;a<this.children.length;a++)s.append(this.children[a],0);for(;o>0&&this.children[o-1].length==0;)this.children[--o].destroy();return this.children.length=o,this.markDirty(),this.length=e,s}transferDOM(e){this.dom&&(this.markDirty(),e.setDOM(this.dom),e.prevAttrs=this.prevAttrs===void 0?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(e){Db(this.attrs,e)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=e)}append(e,s){Z0(this,e,s)}addLineDeco(e){let s=e.spec.attributes,o=e.spec.class;s&&(this.attrs=wT(s,this.attrs||{})),o&&(this.attrs=wT({class:o},this.attrs||{}))}domAtPos(e){return q0(this,e)}reuseDOM(e){e.nodeName=="DIV"&&(this.setDOM(e),this.flags|=6)}sync(e,s){var o;this.dom?this.flags&4&&(W0(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),this.prevAttrs!==void 0&&(kT(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(e,s);let l=this.dom.lastChild;for(;l&&Me.get(l)instanceof jo;)l=l.lastChild;if(!l||!this.length||l.nodeName!="BR"&&((o=Me.get(l))===null||o===void 0?void 0:o.isEditable)==!1&&(!Dt.ios||!this.children.some(a=>a instanceof Ko))){let a=document.createElement("BR");a.cmIgnore=!0,this.dom.appendChild(a)}}measureTextSize(){if(this.children.length==0||this.length>20)return null;let e=0,s;for(let o of this.children){if(!(o instanceof Ko)||/[^ -~]/.test(o.text))return null;let l=Ih(o.dom);if(l.length!=1)return null;e+=l[0].width,s=l[0].height}return e?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:e/this.length,textHeight:s}:null}coordsAt(e,s){let o=Q0(this,e,s);if(!this.children.length&&o&&this.parent){let{heightOracle:l}=this.parent.view.viewState,a=o.bottom-o.top;if(Math.abs(a-l.lineHeight)<2&&l.textHeight<a){let h=(a-l.textHeight)/2;return{top:o.top+h,bottom:o.bottom-h,left:o.left,right:o.left}}}return o}become(e){return!1}covers(){return!0}static find(e,s){for(let o=0,l=0;o<e.children.length;o++){let a=e.children[o],h=l+a.length;if(h>=s){if(a instanceof qe)return a;if(h>s)break}l=h+a.breakAfter}return null}}class Dn extends Me{constructor(e,s,o){super(),this.widget=e,this.length=s,this.deco=o,this.breakAfter=0,this.prevWidget=null}merge(e,s,o,l,a,h){return o&&(!(o instanceof Dn)||!this.widget.compare(o.widget)||e>0&&a<=0||s<this.length&&h<=0)?!1:(this.length=e+(o?o.length:0)+(this.length-s),!0)}domAtPos(e){return e==0?mi.before(this.dom):mi.after(this.dom,e==this.length)}split(e){let s=this.length-e;this.length=e;let o=new Dn(this.widget,s,this.deco);return o.breakAfter=this.breakAfter,o}get children(){return xb}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.widget.editable||(this.dom.contentEditable="false"))}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):Te.empty}domBoundsAround(){return null}become(e){return e instanceof Dn&&e.widget.constructor==this.widget.constructor?(e.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,this.deco=e.deco,this.breakAfter=e.breakAfter,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(e,s){return this.widget.coordsAt(this.dom,e,s)}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}covers(e){let{startSide:s,endSide:o}=this.deco;return s==o?!1:e<0?s<0:o>0}}class Pb{eq(e){return!1}updateDOM(e,s){return!1}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(e){return!0}coordsAt(e,s,o){return null}get isHidden(){return!1}get editable(){return!1}destroy(e){}}var Ns=function(n){return n[n.Text=0]="Text",n[n.WidgetBefore=1]="WidgetBefore",n[n.WidgetAfter=2]="WidgetAfter",n[n.WidgetRange=3]="WidgetRange",n}(Ns||(Ns={}));class _i extends fc{constructor(e,s,o,l){super(),this.startSide=e,this.endSide=s,this.widget=o,this.spec=l}get heightRelevant(){return!1}static mark(e){return new Mh(e)}static widget(e){let s=Math.max(-1e4,Math.min(1e4,e.side||0)),o=!!e.block;return s+=o&&!e.inlineOrder?s>0?3e8:-4e8:s>0?1e8:-1e8,new Un(e,s,s,o,e.widget||null,!1)}static replace(e){let s=!!e.block,o,l;if(e.isBlockGap)o=-5e8,l=4e8;else{let{start:a,end:h}=tO(e,s);o=(a?s?-3e8:-1:5e8)-1,l=(h?s?2e8:1:-6e8)+1}return new Un(e,o,l,s,e.widget||null,!0)}static line(e){return new xh(e)}static set(e,s=!1){return pe.of(e,s)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}_i.none=pe.empty;class Mh extends _i{constructor(e){let{start:s,end:o}=tO(e);super(s?-1:5e8,o?1:-6e8,null,e),this.tagName=e.tagName||"span",this.class=e.class||"",this.attrs=e.attributes||null}eq(e){var s,o;return this==e||e instanceof Mh&&this.tagName==e.tagName&&(this.class||((s=this.attrs)===null||s===void 0?void 0:s.class))==(e.class||((o=e.attrs)===null||o===void 0?void 0:o.class))&&Db(this.attrs,e.attrs,"class")}range(e,s=e){if(e>=s)throw new RangeError("Mark decorations may not be empty");return super.range(e,s)}}Mh.prototype.point=!1;class xh extends _i{constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof xh&&this.spec.class==e.spec.class&&Db(this.spec.attributes,e.spec.attributes)}range(e,s=e){if(s!=e)throw new RangeError("Line decoration ranges must be zero-length");return super.range(e,s)}}xh.prototype.mapMode=ts.TrackBefore;xh.prototype.point=!0;class Un extends _i{constructor(e,s,o,l,a,h){super(s,o,a,e),this.block=l,this.isReplace=h,this.mapMode=l?s<=0?ts.TrackBefore:ts.TrackAfter:ts.TrackDel}get type(){return this.startSide!=this.endSide?Ns.WidgetRange:this.startSide<=0?Ns.WidgetBefore:Ns.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(e){return e instanceof Un&&iD(this.widget,e.widget)&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide}range(e,s=e){if(this.isReplace&&(e>s||e==s&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&s!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(e,s)}}Un.prototype.point=!0;function tO(n,e=!1){let{inclusiveStart:s,inclusiveEnd:o}=n;return s==null&&(s=n.inclusive),o==null&&(o=n.inclusive),{start:s??e,end:o??e}}function iD(n,e){return n==e||!!(n&&e&&n.compare(e))}function OT(n,e,s,o=0){let l=s.length-1;l>=0&&s[l]+o>=n?s[l]=Math.max(s[l],e):s.push(n,e)}class Ja{constructor(e,s,o,l){this.doc=e,this.pos=s,this.end=o,this.disallowBlockEffectsFor=l,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=e.iter(),this.skip=s}posCovered(){if(this.content.length==0)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let e=this.content[this.content.length-1];return!(e.breakAfter||e instanceof Dn&&e.deco.endSide<0)}getLine(){return this.curLine||(this.content.push(this.curLine=new qe),this.atCursorPos=!0),this.curLine}flushBuffer(e=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(vd(new $c(-1),e),e.length),this.pendingBuffer=0)}addBlockWidget(e){this.flushBuffer(),this.curLine=null,this.content.push(e)}finish(e){this.pendingBuffer&&e<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,!this.posCovered()&&!(e&&this.content.length&&this.content[this.content.length-1]instanceof Dn)&&this.getLine()}buildText(e,s,o){for(;e>0;){if(this.textOff==this.text.length){let{value:a,lineBreak:h,done:d}=this.cursor.next(this.skip);if(this.skip=0,d)throw new Error("Ran out of text content when drawing inline views");if(h){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,e--;continue}else this.text=a,this.textOff=0}let l=Math.min(this.text.length-this.textOff,e,512);this.flushBuffer(s.slice(s.length-o)),this.getLine().append(vd(new Ko(this.text.slice(this.textOff,this.textOff+l)),s),o),this.atCursorPos=!0,this.textOff+=l,e-=l,o=0}}span(e,s,o,l){this.buildText(s-e,o,l),this.pos=s,this.openStart<0&&(this.openStart=l)}point(e,s,o,l,a,h){if(this.disallowBlockEffectsFor[h]&&o instanceof Un){if(o.block)throw new RangeError("Block decorations may not be specified via plugins");if(s>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let d=s-e;if(o instanceof Un)if(o.block)o.startSide>0&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new Dn(o.widget||new MC("div"),d,o));else{let p=Mr.create(o.widget||new MC("span"),d,d?0:o.startSide),g=this.atCursorPos&&!p.isEditable&&a<=l.length&&(e<s||o.startSide>0),m=!p.isEditable&&(e<s||a>l.length||o.startSide<=0),T=this.getLine();this.pendingBuffer==2&&!g&&!p.isEditable&&(this.pendingBuffer=0),this.flushBuffer(l),g&&(T.append(vd(new $c(1),l),a),a=l.length+Math.max(0,a-l.length)),T.append(vd(p,l),a),this.atCursorPos=m,this.pendingBuffer=m?e<s||a>l.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=l.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(o);d&&(this.textOff+d<=this.text.length?this.textOff+=d:(this.skip+=d-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=s),this.openStart<0&&(this.openStart=a)}static build(e,s,o,l,a){let h=new Ja(e,s,o,a);return h.openEnd=pe.spans(l,s,o,h),h.openStart<0&&(h.openStart=h.openEnd),h.finish(h.openEnd),h}}function vd(n,e){for(let s of e)n=new jo(s,[n],n.length);return n}class MC extends Pb{constructor(e){super(),this.tag=e}eq(e){return e.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(e){return e.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}var ti=function(n){return n[n.LTR=0]="LTR",n[n.RTL=1]="RTL",n}(ti||(ti={}));const Vr=ti.LTR,Bb=ti.RTL;function eO(n){let e=[];for(let s=0;s<n.length;s++)e.push(1<<+n[s]);return e}const sD=eO("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),oD=eO("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),AT=Object.create(null),no=[];for(let n of["()","[]","{}"]){let e=n.charCodeAt(0),s=n.charCodeAt(1);AT[e]=s,AT[s]=-e}function iO(n){return n<=247?sD[n]:1424<=n&&n<=1524?2:1536<=n&&n<=1785?oD[n-1536]:1774<=n&&n<=2220?4:8192<=n&&n<=8204?256:64336<=n&&n<=65023?4:1}const nD=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class Rn{get dir(){return this.level%2?Bb:Vr}constructor(e,s,o){this.from=e,this.to=s,this.level=o}side(e,s){return this.dir==s==e?this.to:this.from}forward(e,s){return e==(this.dir==s)}static find(e,s,o,l){let a=-1;for(let h=0;h<e.length;h++){let d=e[h];if(d.from<=s&&d.to>=s){if(d.level==o)return h;(a<0||(l!=0?l<0?d.from<s:d.to>s:e[a].level>d.level))&&(a=h)}}if(a<0)throw new RangeError("Index out of range");return a}}function sO(n,e){if(n.length!=e.length)return!1;for(let s=0;s<n.length;s++){let o=n[s],l=e[s];if(o.from!=l.from||o.to!=l.to||o.direction!=l.direction||!sO(o.inner,l.inner))return!1}return!0}const Oe=[];function rD(n,e,s,o,l){for(let a=0;a<=o.length;a++){let h=a?o[a-1].to:e,d=a<o.length?o[a].from:s,p=a?256:l;for(let g=h,m=p,T=p;g<d;g++){let b=iO(n.charCodeAt(g));b==512?b=m:b==8&&T==4&&(b=16),Oe[g]=b==4?2:b,b&7&&(T=b),m=b}for(let g=h,m=p,T=p;g<d;g++){let b=Oe[g];if(b==128)g<d-1&&m==Oe[g+1]&&m&24?b=Oe[g]=m:Oe[g]=256;else if(b==64){let y=g+1;for(;y<d&&Oe[y]==64;)y++;let C=g&&m==8||y<s&&Oe[y]==8?T==1?1:8:256;for(let L=g;L<y;L++)Oe[L]=C;g=y-1}else b==8&&T==1&&(Oe[g]=1);m=b,b&7&&(T=b)}}}function lD(n,e,s,o,l){let a=l==1?2:1;for(let h=0,d=0,p=0;h<=o.length;h++){let g=h?o[h-1].to:e,m=h<o.length?o[h].from:s;for(let T=g,b,y,C;T<m;T++)if(y=AT[b=n.charCodeAt(T)])if(y<0){for(let L=d-3;L>=0;L-=3)if(no[L+1]==-y){let A=no[L+2],F=A&2?l:A&4?A&1?a:l:0;F&&(Oe[T]=Oe[no[L]]=F),d=L;break}}else{if(no.length==189)break;no[d++]=T,no[d++]=b,no[d++]=p}else if((C=Oe[T])==2||C==1){let L=C==l;p=L?0:1;for(let A=d-3;A>=0;A-=3){let F=no[A+2];if(F&2)break;if(L)no[A+2]|=2;else{if(F&4)break;no[A+2]|=4}}}}}function cD(n,e,s,o){for(let l=0,a=o;l<=s.length;l++){let h=l?s[l-1].to:n,d=l<s.length?s[l].from:e;for(let p=h;p<d;){let g=Oe[p];if(g==256){let m=p+1;for(;;)if(m==d){if(l==s.length)break;m=s[l++].to,d=l<s.length?s[l].from:e}else if(Oe[m]==256)m++;else break;let T=a==1,b=(m<e?Oe[m]:o)==1,y=T==b?T?1:2:o;for(let C=m,L=l,A=L?s[L-1].to:n;C>p;)C==A&&(C=s[--L].from,A=L?s[L-1].to:n),Oe[--C]=y;p=m}else a=g,p++}}}function RT(n,e,s,o,l,a,h){let d=o%2?2:1;if(o%2==l%2)for(let p=e,g=0;p<s;){let m=!0,T=!1;if(g==a.length||p<a[g].from){let L=Oe[p];L!=d&&(m=!1,T=L==16)}let b=!m&&d==1?[]:null,y=m?o:o+1,C=p;t:for(;;)if(g<a.length&&C==a[g].from){if(T)break t;let L=a[g];if(!m)for(let A=L.to,F=g+1;;){if(A==s)break t;if(F<a.length&&a[F].from==A)A=a[F++].to;else{if(Oe[A]==d)break t;break}}if(g++,b)b.push(L);else{L.from>p&&h.push(new Rn(p,L.from,y));let A=L.direction==Vr!=!(y%2);NT(n,A?o+1:o,l,L.inner,L.from,L.to,h),p=L.to}C=L.to}else{if(C==s||(m?Oe[C]!=d:Oe[C]==d))break;C++}b?RT(n,p,C,o+1,l,b,h):p<C&&h.push(new Rn(p,C,y)),p=C}else for(let p=s,g=a.length;p>e;){let m=!0,T=!1;if(!g||p>a[g-1].to){let L=Oe[p-1];L!=d&&(m=!1,T=L==16)}let b=!m&&d==1?[]:null,y=m?o:o+1,C=p;t:for(;;)if(g&&C==a[g-1].to){if(T)break t;let L=a[--g];if(!m)for(let A=L.from,F=g;;){if(A==e)break t;if(F&&a[F-1].to==A)A=a[--F].from;else{if(Oe[A-1]==d)break t;break}}if(b)b.push(L);else{L.to<p&&h.push(new Rn(L.to,p,y));let A=L.direction==Vr!=!(y%2);NT(n,A?o+1:o,l,L.inner,L.from,L.to,h),p=L.from}C=L.from}else{if(C==e||(m?Oe[C-1]!=d:Oe[C-1]==d))break;C--}b?RT(n,C,p,o+1,l,b,h):C<p&&h.push(new Rn(C,p,y)),p=C}}function NT(n,e,s,o,l,a,h){let d=e%2?2:1;rD(n,l,a,o,d),lD(n,l,a,o,d),cD(l,a,o,d),RT(n,l,a,e,s,o,h)}function aD(n,e,s){if(!n)return[new Rn(0,0,e==Bb?1:0)];if(e==Vr&&!s.length&&!nD.test(n))return oO(n.length);if(s.length)for(;n.length>Oe.length;)Oe[Oe.length]=256;let o=[],l=e==Vr?0:1;return NT(n,l,l,s,0,n.length,o),o}function oO(n){return[new Rn(0,n,0)]}let nO="";function hD(n,e,s,o,l){var a;let h=o.head-n.from,d=Rn.find(e,h,(a=o.bidiLevel)!==null&&a!==void 0?a:-1,o.assoc),p=e[d],g=p.side(l,s);if(h==g){let b=d+=l?1:-1;if(b<0||b>=e.length)return null;p=e[d=b],h=p.side(!l,s),g=p.side(l,s)}let m=Uo(n.text,h,p.forward(l,s));(m<p.from||m>p.to)&&(m=g),nO=n.text.slice(Math.min(h,m),Math.max(h,m));let T=d==(l?e.length-1:0)?null:e[d+(l?1:-1)];return T&&m==g&&T.level+(l?0:1)<p.level?xt.cursor(T.side(!l,s)+n.from,T.forward(l,s)?1:-1,T.level):xt.cursor(m+n.from,p.forward(l,s)?-1:1,p.level)}function uD(n,e,s){for(let o=e;o<s;o++){let l=iO(n.charCodeAt(o));if(l==1)return Vr;if(l==2||l==4)return Bb}return Vr}const rO=Xt.define(),lO=Xt.define(),cO=Xt.define(),aO=Xt.define(),LT=Xt.define(),hO=Xt.define(),uO=Xt.define(),dO=Xt.define({combine:n=>n.some(e=>e)}),dD=Xt.define({combine:n=>n.some(e=>e)});class hc{constructor(e,s="nearest",o="nearest",l=5,a=5,h=!1){this.range=e,this.y=s,this.x=o,this.yMargin=l,this.xMargin=a,this.isSnapshot=h}map(e){return e.empty?this:new hc(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(e){return this.range.to<=e.doc.length?this:new hc(xt.cursor(e.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const yd=Ze.define({map:(n,e)=>n.map(e)});function Pn(n,e,s){let o=n.facet(aO);o.length?o[0](e):window.onerror?window.onerror(String(e),s,void 0,void 0,e):s?console.error(s+":",e):console.error(e)}const Xp=Xt.define({combine:n=>n.length?n[0]:!0});let pD=0;const xa=Xt.define();class Jo{constructor(e,s,o,l,a){this.id=e,this.create=s,this.domEventHandlers=o,this.domEventObservers=l,this.extension=a(this)}static define(e,s){const{eventHandlers:o,eventObservers:l,provide:a,decorations:h}=s||{};return new Jo(pD++,e,o,l,d=>{let p=[xa.of(d)];return h&&p.push(Ch.of(g=>{let m=g.plugin(d);return m?h(m):_i.none})),a&&p.push(a(d)),p})}static fromClass(e,s){return Jo.define(o=>new e(o),s)}}class n_{constructor(e){this.spec=e,this.mustUpdate=null,this.value=null}update(e){if(this.value){if(this.mustUpdate){let s=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(s)}catch(o){if(Pn(s.state,o,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(e)}catch(s){Pn(e.state,s,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(e){var s;if(!((s=this.value)===null||s===void 0)&&s.destroy)try{this.value.destroy()}catch(o){Pn(e.state,o,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const pO=Xt.define(),Fb=Xt.define(),Ch=Xt.define(),fO=Xt.define(),Ub=Xt.define(),gO=Xt.define();function xC(n,e){let s=n.state.facet(gO);if(!s.length)return s;let o=s.map(a=>a instanceof Function?a(n):a),l=[];return pe.spans(o,e.from,e.to,{point(){},span(a,h,d,p){let g=a-e.from,m=h-e.from,T=l;for(let b=d.length-1;b>=0;b--,p--){let y=d[b].spec.bidiIsolate,C;if(y==null&&(y=uD(e.text,g,m)),p>0&&T.length&&(C=T[T.length-1]).to==g&&C.direction==y)C.to=m,T=C.inner;else{let L={from:g,to:m,direction:y,inner:[]};T.push(L),T=L.inner}}}}),l}const mO=Xt.define();function $O(n){let e=0,s=0,o=0,l=0;for(let a of n.state.facet(mO)){let h=a(n);h&&(h.left!=null&&(e=Math.max(e,h.left)),h.right!=null&&(s=Math.max(s,h.right)),h.top!=null&&(o=Math.max(o,h.top)),h.bottom!=null&&(l=Math.max(l,h.bottom)))}return{left:e,right:s,top:o,bottom:l}}const Da=Xt.define();class fs{constructor(e,s,o,l){this.fromA=e,this.toA=s,this.fromB=o,this.toB=l}join(e){return new fs(Math.min(this.fromA,e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let s=e.length,o=this;for(;s>0;s--){let l=e[s-1];if(!(l.fromA>o.toA)){if(l.toA<o.fromA)break;o=o.join(l),e.splice(s-1,1)}}return e.splice(s,0,o),e}static extendWithRanges(e,s){if(s.length==0)return e;let o=[];for(let l=0,a=0,h=0,d=0;;l++){let p=l==e.length?null:e[l],g=h-d,m=p?p.fromB:1e9;for(;a<s.length&&s[a]<m;){let T=s[a],b=s[a+1],y=Math.max(d,T),C=Math.min(m,b);if(y<=C&&new fs(y+g,C+g,y,C).addToSet(o),b>m)break;a+=2}if(!p)return o;new fs(p.fromA,p.toA,p.fromB,p.toB).addToSet(o),h=p.toA,d=p.toB}}}class Tp{constructor(e,s,o){this.view=e,this.state=s,this.transactions=o,this.flags=0,this.startState=e.state,this.changes=Qe.empty(this.startState.doc.length);for(let a of o)this.changes=this.changes.compose(a.changes);let l=[];this.changes.iterChangedRanges((a,h,d,p)=>l.push(new fs(a,h,d,p))),this.changedRanges=l}static create(e,s,o){return new Tp(e,s,o)}get viewportChanged(){return(this.flags&4)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&10)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(e=>e.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}class DC extends Me{get length(){return this.view.state.doc.length}constructor(e){super(),this.view=e,this.decorations=[],this.dynamicDecorationMap=[],this.domChanged=null,this.hasComposition=null,this.markedForComposition=new Set,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(e.contentDOM),this.children=[new qe],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new fs(0,0,0,e.state.doc.length)],0,null)}update(e){var s;let o=e.changedRanges;this.minWidth>0&&o.length&&(o.every(({fromA:g,toA:m})=>m<this.minWidthFrom||g>this.minWidthTo)?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0);let l=-1;this.view.inputState.composing>=0&&(!((s=this.domChanged)===null||s===void 0)&&s.newSel?l=this.domChanged.newSel.head:!bD(e.changes,this.hasComposition)&&!e.selectionSet&&(l=e.state.selection.main.head));let a=l>-1?gD(this.view,e.changes,l):null;if(this.domChanged=null,this.hasComposition){this.markedForComposition.clear();let{from:g,to:m}=this.hasComposition;o=new fs(g,m,e.changes.mapPos(g,-1),e.changes.mapPos(m,1)).addToSet(o.slice())}this.hasComposition=a?{from:a.range.fromB,to:a.range.toB}:null,(Dt.ie||Dt.chrome)&&!a&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0);let h=this.decorations,d=this.updateDeco(),p=_D(h,d,e.changes);return o=fs.extendWithRanges(o,p),!(this.flags&7)&&o.length==0?!1:(this.updateInner(o,e.startState.doc.length,a),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(e,s,o){this.view.viewState.mustMeasureContent=!0,this.updateChildren(e,s,o);let{observer:l}=this.view;l.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let h=Dt.chrome||Dt.ios?{node:l.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,h),this.flags&=-8,h&&(h.written||l.selectionRange.focusNode!=h.node)&&(this.forceSelection=!0),this.dom.style.height=""}),this.markedForComposition.forEach(h=>h.flags&=-9);let a=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let h of this.children)h instanceof Dn&&h.widget instanceof PC&&a.push(h.dom);l.updateGaps(a)}updateChildren(e,s,o){let l=o?o.range.addToSet(e.slice()):e,a=this.childCursor(s);for(let h=l.length-1;;h--){let d=h>=0?l[h]:null;if(!d)break;let{fromA:p,toA:g,fromB:m,toB:T}=d,b,y,C,L;if(o&&o.range.fromB<T&&o.range.toB>m){let K=Ja.build(this.view.state.doc,m,o.range.fromB,this.decorations,this.dynamicDecorationMap),Y=Ja.build(this.view.state.doc,o.range.toB,T,this.decorations,this.dynamicDecorationMap);y=K.breakAtStart,C=K.openStart,L=Y.openEnd;let V=this.compositionView(o);Y.breakAtStart?V.breakAfter=1:Y.content.length&&V.merge(V.length,V.length,Y.content[0],!1,Y.openStart,0)&&(V.breakAfter=Y.content[0].breakAfter,Y.content.shift()),K.content.length&&V.merge(0,0,K.content[K.content.length-1],!0,0,K.openEnd)&&K.content.pop(),b=K.content.concat(V).concat(Y.content)}else({content:b,breakAtStart:y,openStart:C,openEnd:L}=Ja.build(this.view.state.doc,m,T,this.decorations,this.dynamicDecorationMap));let{i:A,off:F}=a.findPos(g,1),{i:z,off:X}=a.findPos(p,-1);Y0(this,z,X,A,F,b,y,C,L)}o&&this.fixCompositionDOM(o)}compositionView(e){let s=new Ko(e.text.nodeValue);s.flags|=8;for(let{deco:l}of e.marks)s=new jo(l,[s],s.length);let o=new qe;return o.append(s,0),o}fixCompositionDOM(e){let s=(a,h)=>{h.flags|=8|(h.children.some(p=>p.flags&7)?1:0),this.markedForComposition.add(h);let d=Me.get(a);d&&d!=h&&(d.dom=null),h.setDOM(a)},o=this.childPos(e.range.fromB,1),l=this.children[o.i];s(e.line,l);for(let a=e.marks.length-1;a>=-1;a--)o=l.childPos(o.off,1),l=l.children[o.i],s(a>=0?e.marks[a].node:e.text,l)}updateSelection(e=!1,s=!1){(e||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let o=this.view.root.activeElement,l=o==this.dom,a=!l&&Zd(this.dom,this.view.observer.selectionRange)&&!(o&&this.dom.contains(o));if(!(l||s||a))return;let h=this.forceSelection;this.forceSelection=!1;let d=this.view.state.selection.main,p=this.moveToLine(this.domAtPos(d.anchor)),g=d.empty?p:this.moveToLine(this.domAtPos(d.head));if(Dt.gecko&&d.empty&&!this.hasComposition&&fD(p)){let T=document.createTextNode("");this.view.observer.ignore(()=>p.node.insertBefore(T,p.node.childNodes[p.offset]||null)),p=g=new mi(T,0),h=!0}let m=this.view.observer.selectionRange;(h||!m.focusNode||(!ja(p.node,p.offset,m.anchorNode,m.anchorOffset)||!ja(g.node,g.offset,m.focusNode,m.focusOffset))&&!this.suppressWidgetCursorChange(m,d))&&(this.view.observer.ignore(()=>{Dt.android&&Dt.chrome&&this.dom.contains(m.focusNode)&&TD(m.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let T=_p(this.view.root);if(T)if(d.empty){if(Dt.gecko){let b=mD(p.node,p.offset);if(b&&b!=3){let y=TO(p.node,p.offset,b==1?1:-1);y&&(p=new mi(y.node,y.offset))}}T.collapse(p.node,p.offset),d.bidiLevel!=null&&T.caretBidiLevel!==void 0&&(T.caretBidiLevel=d.bidiLevel)}else if(T.extend){T.collapse(p.node,p.offset);try{T.extend(g.node,g.offset)}catch{}}else{let b=document.createRange();d.anchor>d.head&&([p,g]=[g,p]),b.setEnd(g.node,g.offset),b.setStart(p.node,p.offset),T.removeAllRanges(),T.addRange(b)}a&&this.view.root.activeElement==this.dom&&(this.dom.blur(),o&&o.focus())}),this.view.observer.setSelectionRange(p,g)),this.impreciseAnchor=p.precise?null:new mi(m.anchorNode,m.anchorOffset),this.impreciseHead=g.precise?null:new mi(m.focusNode,m.focusOffset)}suppressWidgetCursorChange(e,s){return this.hasComposition&&s.empty&&ja(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset)&&this.posFromDOM(e.focusNode,e.focusOffset)==s.head}enforceCursorAssoc(){if(this.hasComposition)return;let{view:e}=this,s=e.state.selection.main,o=_p(e.root),{anchorNode:l,anchorOffset:a}=e.observer.selectionRange;if(!o||!s.empty||!s.assoc||!o.modify)return;let h=qe.find(this,s.head);if(!h)return;let d=h.posAtStart;if(s.head==d||s.head==d+h.length)return;let p=this.coordsAt(s.head,-1),g=this.coordsAt(s.head,1);if(!p||!g||p.bottom>g.top)return;let m=this.domAtPos(s.head+s.assoc);o.collapse(m.node,m.offset),o.modify("move",s.assoc<0?"forward":"backward","lineboundary"),e.observer.readSelectionRange();let T=e.observer.selectionRange;e.docView.posFromDOM(T.anchorNode,T.anchorOffset)!=s.from&&o.collapse(l,a)}moveToLine(e){let s=this.dom,o;if(e.node!=s)return e;for(let l=e.offset;!o&&l<s.childNodes.length;l++){let a=Me.get(s.childNodes[l]);a instanceof qe&&(o=a.domAtPos(0))}for(let l=e.offset-1;!o&&l>=0;l--){let a=Me.get(s.childNodes[l]);a instanceof qe&&(o=a.domAtPos(a.length))}return o?new mi(o.node,o.offset,!0):e}nearest(e){for(let s=e;s;){let o=Me.get(s);if(o&&o.rootView==this)return o;s=s.parentNode}return null}posFromDOM(e,s){let o=this.nearest(e);if(!o)throw new RangeError("Trying to find position for a DOM position outside of the document");return o.localPosFromDOM(e,s)+o.posAtStart}domAtPos(e){let{i:s,off:o}=this.childCursor().findPos(e,-1);for(;s<this.children.length-1;){let l=this.children[s];if(o<l.length||l instanceof qe)break;s++,o=0}return this.children[s].domAtPos(o)}coordsAt(e,s){let o=null,l=0;for(let a=this.length,h=this.children.length-1;h>=0;h--){let d=this.children[h],p=a-d.breakAfter,g=p-d.length;if(p<e)break;g<=e&&(g<e||d.covers(-1))&&(p>e||d.covers(1))&&(!o||d instanceof qe&&!(o instanceof qe&&s>=0))&&(o=d,l=g),a=g}return o?o.coordsAt(e-l,s):null}coordsForChar(e){let{i:s,off:o}=this.childPos(e,1),l=this.children[s];if(!(l instanceof qe))return null;for(;l.children.length;){let{i:d,off:p}=l.childPos(o,1);for(;;d++){if(d==l.children.length)return null;if((l=l.children[d]).length)break}o=p}if(!(l instanceof Ko))return null;let a=Uo(l.text,o);if(a==o)return null;let h=Hr(l.dom,o,a).getClientRects();for(let d=0;d<h.length;d++){let p=h[d];if(d==h.length-1||p.top<p.bottom&&p.left<p.right)return p}return null}measureVisibleLineHeights(e){let s=[],{from:o,to:l}=e,a=this.view.contentDOM.clientWidth,h=a>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,d=-1,p=this.view.textDirection==ti.LTR;for(let g=0,m=0;m<this.children.length;m++){let T=this.children[m],b=g+T.length;if(b>l)break;if(g>=o){let y=T.dom.getBoundingClientRect();if(s.push(y.height),h){let C=T.dom.lastChild,L=C?Ih(C):[];if(L.length){let A=L[L.length-1],F=p?A.right-y.left:y.right-A.left;F>d&&(d=F,this.minWidth=a,this.minWidthFrom=g,this.minWidthTo=b)}}}g=b+T.breakAfter}return s}textDirectionAt(e){let{i:s}=this.childPos(e,1);return getComputedStyle(this.children[s].dom).direction=="rtl"?ti.RTL:ti.LTR}measureTextSize(){for(let a of this.children)if(a instanceof qe){let h=a.measureTextSize();if(h)return h}let e=document.createElement("div"),s,o,l;return e.className="cm-line",e.style.width="99999px",e.style.position="absolute",e.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(e);let a=Ih(e.firstChild)[0];s=e.getBoundingClientRect().height,o=a?a.width/27:7,l=a?a.height:s,e.remove()}),{lineHeight:s,charWidth:o,textHeight:l}}childCursor(e=this.length){let s=this.children.length;return s&&(e-=this.children[--s].length),new X0(this.children,e,s)}computeBlockGapDeco(){let e=[],s=this.view.viewState;for(let o=0,l=0;;l++){let a=l==s.viewports.length?null:s.viewports[l],h=a?a.from-1:this.length;if(h>o){let d=(s.lineBlockAt(h).bottom-s.lineBlockAt(o).top)/this.view.scaleY;e.push(_i.replace({widget:new PC(d),block:!0,inclusive:!0,isBlockGap:!0}).range(o,h))}if(!a)break;o=a.to+1}return _i.set(e)}updateDeco(){let e=this.view.state.facet(Ch).map((l,a)=>(this.dynamicDecorationMap[a]=typeof l=="function")?l(this.view):l),s=!1,o=this.view.state.facet(fO).map((l,a)=>{let h=typeof l=="function";return h&&(s=!0),h?l(this.view):l});o.length&&(this.dynamicDecorationMap[e.length]=s,e.push(pe.join(o)));for(let l=e.length;l<e.length+3;l++)this.dynamicDecorationMap[l]=!1;return this.decorations=[...e,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco]}scrollIntoView(e){if(e.isSnapshot){let g=this.view.viewState.lineBlockAt(e.range.head);this.view.scrollDOM.scrollTop=g.top-e.yMargin,this.view.scrollDOM.scrollLeft=e.xMargin;return}let{range:s}=e,o=this.coordsAt(s.head,s.empty?s.assoc:s.head>s.anchor?-1:1),l;if(!o)return;!s.empty&&(l=this.coordsAt(s.anchor,s.anchor>s.head?-1:1))&&(o={left:Math.min(o.left,l.left),top:Math.min(o.top,l.top),right:Math.max(o.right,l.right),bottom:Math.max(o.bottom,l.bottom)});let a=$O(this.view),h={left:o.left-a.left,top:o.top-a.top,right:o.right+a.right,bottom:o.bottom+a.bottom},{offsetWidth:d,offsetHeight:p}=this.view.scrollDOM;Yx(this.view.scrollDOM,h,s.head<s.anchor?-1:1,e.x,e.y,Math.max(Math.min(e.xMargin,d),-d),Math.max(Math.min(e.yMargin,p),-p),this.view.textDirection==ti.LTR)}}function fD(n){return n.node.nodeType==1&&n.node.firstChild&&(n.offset==0||n.node.childNodes[n.offset-1].contentEditable=="false")&&(n.offset==n.node.childNodes.length||n.node.childNodes[n.offset].contentEditable=="false")}class PC extends Pb{constructor(e){super(),this.height=e}toDOM(){let e=document.createElement("div");return e.className="cm-gap",this.updateDOM(e),e}eq(e){return e.height==this.height}updateDOM(e){return e.style.height=this.height+"px",!0}get editable(){return!0}get estimatedHeight(){return this.height}}function _O(n,e){let s=n.observer.selectionRange,o=s.focusNode&&TO(s.focusNode,s.focusOffset,0);if(!o)return null;let l=e-o.offset;return{from:l,to:l+o.node.nodeValue.length,node:o.node}}function gD(n,e,s){let o=_O(n,s);if(!o)return null;let{node:l,from:a,to:h}=o,d=l.nodeValue;if(/[\n\r]/.test(d)||n.state.doc.sliceString(o.from,o.to)!=d)return null;let p=e.invertedDesc,g=new fs(p.mapPos(a),p.mapPos(h),a,h),m=[];for(let T=l.parentNode;;T=T.parentNode){let b=Me.get(T);if(b instanceof jo)m.push({node:T,deco:b.mark});else{if(b instanceof qe||T.nodeName=="DIV"&&T.parentNode==n.contentDOM)return{range:g,text:l,marks:m,line:T};if(T!=n.contentDOM)m.push({node:T,deco:new Mh({inclusive:!0,attributes:eD(T),tagName:T.tagName.toLowerCase()})});else return null}}}function TO(n,e,s){if(s<=0)for(let o=n,l=e;;){if(o.nodeType==3)return{node:o,offset:l};if(o.nodeType==1&&l>0)o=o.childNodes[l-1],l=Yo(o);else break}if(s>=0)for(let o=n,l=e;;){if(o.nodeType==3)return{node:o,offset:l};if(o.nodeType==1&&l<o.childNodes.length&&s>=0)o=o.childNodes[l],l=0;else break}return null}function mD(n,e){return n.nodeType!=1?0:(e&&n.childNodes[e-1].contentEditable=="false"?1:0)|(e<n.childNodes.length&&n.childNodes[e].contentEditable=="false"?2:0)}let $D=class{constructor(){this.changes=[]}compareRange(e,s){OT(e,s,this.changes)}comparePoint(e,s){OT(e,s,this.changes)}};function _D(n,e,s){let o=new $D;return pe.compare(n,e,s,o),o.changes}function TD(n,e){for(let s=n;s&&s!=e;s=s.assignedSlot||s.parentNode)if(s.nodeType==1&&s.contentEditable=="false")return!0;return!1}function bD(n,e){let s=!1;return e&&n.iterChangedRanges((o,l)=>{o<e.to&&l>e.from&&(s=!0)}),s}function ED(n,e,s=1){let o=n.charCategorizer(e),l=n.doc.lineAt(e),a=e-l.from;if(l.length==0)return xt.cursor(e);a==0?s=1:a==l.length&&(s=-1);let h=a,d=a;s<0?h=Uo(l.text,a,!1):d=Uo(l.text,a);let p=o(l.text.slice(h,d));for(;h>0;){let g=Uo(l.text,h,!1);if(o(l.text.slice(g,h))!=p)break;h=g}for(;d<l.length;){let g=Uo(l.text,d);if(o(l.text.slice(d,g))!=p)break;d=g}return xt.range(h+l.from,d+l.from)}function vD(n,e){return e.left>n?e.left-n:Math.max(0,n-e.right)}function yD(n,e){return e.top>n?e.top-n:Math.max(0,n-e.bottom)}function r_(n,e){return n.top<e.bottom-1&&n.bottom>e.top+1}function BC(n,e){return e<n.top?{top:e,left:n.left,right:n.right,bottom:n.bottom}:n}function FC(n,e){return e>n.bottom?{top:n.top,left:n.left,right:n.right,bottom:e}:n}function MT(n,e,s){let o,l,a,h,d=!1,p,g,m,T;for(let C=n.firstChild;C;C=C.nextSibling){let L=Ih(C);for(let A=0;A<L.length;A++){let F=L[A];l&&r_(l,F)&&(F=BC(FC(F,l.bottom),l.top));let z=vD(e,F),X=yD(s,F);if(z==0&&X==0)return C.nodeType==3?UC(C,e,s):MT(C,e,s);if(!o||h>X||h==X&&a>z){o=C,l=F,a=z,h=X;let K=X?s<F.top?-1:1:z?e<F.left?-1:1:0;d=!K||(K>0?A<L.length-1:A>0)}z==0?s>F.bottom&&(!m||m.bottom<F.bottom)?(p=C,m=F):s<F.top&&(!T||T.top>F.top)&&(g=C,T=F):m&&r_(m,F)?m=FC(m,F.bottom):T&&r_(T,F)&&(T=BC(T,F.top))}}if(m&&m.bottom>=s?(o=p,l=m):T&&T.top<=s&&(o=g,l=T),!o)return{node:n,offset:0};let b=Math.max(l.left,Math.min(l.right,e));if(o.nodeType==3)return UC(o,b,s);if(d&&o.contentEditable!="false")return MT(o,b,s);let y=Array.prototype.indexOf.call(n.childNodes,o)+(e>=(l.left+l.right)/2?1:0);return{node:n,offset:y}}function UC(n,e,s){let o=n.nodeValue.length,l=-1,a=1e9,h=0;for(let d=0;d<o;d++){let p=Hr(n,d,d+1).getClientRects();for(let g=0;g<p.length;g++){let m=p[g];if(m.top==m.bottom)continue;h||(h=e-m.left);let T=(m.top>s?m.top-s:s-m.bottom)-1;if(m.left-1<=e&&m.right+1>=e&&T<a){let b=e>=(m.left+m.right)/2,y=b;if((Dt.chrome||Dt.gecko)&&Hr(n,d).getBoundingClientRect().left==m.right&&(y=!b),T<=0)return{node:n,offset:d+(y?1:0)};l=d+(y?1:0),a=T}}}return{node:n,offset:l>-1?l:h>0?n.nodeValue.length:0}}function bO(n,e,s,o=-1){var l,a;let h=n.contentDOM.getBoundingClientRect(),d=h.top+n.viewState.paddingTop,p,{docHeight:g}=n.viewState,{x:m,y:T}=e,b=T-d;if(b<0)return 0;if(b>g)return n.state.doc.length;for(let K=n.viewState.heightOracle.textHeight/2,Y=!1;p=n.elementAtHeight(b),p.type!=Ns.Text;)for(;b=o>0?p.bottom+K:p.top-K,!(b>=0&&b<=g);){if(Y)return s?null:0;Y=!0,o=-o}T=d+b;let y=p.from;if(y<n.viewport.from)return n.viewport.from==0?0:s?null:HC(n,h,p,m,T);if(y>n.viewport.to)return n.viewport.to==n.state.doc.length?n.state.doc.length:s?null:HC(n,h,p,m,T);let C=n.dom.ownerDocument,L=n.root.elementFromPoint?n.root:C,A=L.elementFromPoint(m,T);A&&!n.contentDOM.contains(A)&&(A=null),A||(m=Math.max(h.left+1,Math.min(h.right-1,m)),A=L.elementFromPoint(m,T),A&&!n.contentDOM.contains(A)&&(A=null));let F,z=-1;if(A&&((l=n.docView.nearest(A))===null||l===void 0?void 0:l.isEditable)!=!1){if(C.caretPositionFromPoint){let K=C.caretPositionFromPoint(m,T);K&&({offsetNode:F,offset:z}=K)}else if(C.caretRangeFromPoint){let K=C.caretRangeFromPoint(m,T);K&&({startContainer:F,startOffset:z}=K,(!n.contentDOM.contains(F)||Dt.safari&&ID(F,z,m)||Dt.chrome&&SD(F,z,m))&&(F=void 0))}}if(!F||!n.docView.dom.contains(F)){let K=qe.find(n.docView,y);if(!K)return b>p.top+p.height/2?p.to:p.from;({node:F,offset:z}=MT(K.dom,m,T))}let X=n.docView.nearest(F);if(!X)return null;if(X.isWidget&&((a=X.dom)===null||a===void 0?void 0:a.nodeType)==1){let K=X.dom.getBoundingClientRect();return e.y<K.top||e.y<=K.bottom&&e.x<=(K.left+K.right)/2?X.posAtStart:X.posAtEnd}else return X.localPosFromDOM(F,z)+X.posAtStart}function HC(n,e,s,o,l){let a=Math.round((o-e.left)*n.defaultCharacterWidth);if(n.lineWrapping&&s.height>n.defaultLineHeight*1.5){let d=n.viewState.heightOracle.textHeight,p=Math.floor((l-s.top-(n.defaultLineHeight-d)*.5)/d);a+=p*n.viewState.heightOracle.lineLength}let h=n.state.sliceDoc(s.from,s.to);return s.from+Gx(h,a,n.state.tabSize)}function ID(n,e,s){let o;if(n.nodeType!=3||e!=(o=n.nodeValue.length))return!1;for(let l=n.nextSibling;l;l=l.nextSibling)if(l.nodeType!=1||l.nodeName!="BR")return!1;return Hr(n,o-1,o).getBoundingClientRect().left>s}function SD(n,e,s){if(e!=0)return!1;for(let l=n;;){let a=l.parentNode;if(!a||a.nodeType!=1||a.firstChild!=l)return!1;if(a.classList.contains("cm-line"))break;l=a}let o=n.nodeType==1?n.getBoundingClientRect():Hr(n,0,Math.max(n.nodeValue.length,1)).getBoundingClientRect();return s-o.left>5}function CD(n,e){let s=n.lineBlockAt(e);if(Array.isArray(s.type)){for(let o of s.type)if(o.to>e||o.to==e&&(o.to==s.to||o.type==Ns.Text))return o}return s}function wD(n,e,s,o){let l=CD(n,e.head),a=!o||l.type!=Ns.Text||!(n.lineWrapping||l.widgetLineBreaks)?null:n.coordsAtPos(e.assoc<0&&e.head>l.from?e.head-1:e.head);if(a){let h=n.dom.getBoundingClientRect(),d=n.textDirectionAt(l.from),p=n.posAtCoords({x:s==(d==ti.LTR)?h.right-1:h.left+1,y:(a.top+a.bottom)/2});if(p!=null)return xt.cursor(p,s?-1:1)}return xt.cursor(s?l.to:l.from,s?-1:1)}function VC(n,e,s,o){let l=n.state.doc.lineAt(e.head),a=n.bidiSpans(l),h=n.textDirectionAt(l.from);for(let d=e,p=null;;){let g=hD(l,a,h,d,s),m=nO;if(!g){if(l.number==(s?n.state.doc.lines:1))return d;m=`
`,l=n.state.doc.line(l.number+(s?1:-1)),a=n.bidiSpans(l),g=n.visualLineSide(l,!s)}if(p){if(!p(m))return d}else{if(!o)return g;p=o(m)}d=g}}function kD(n,e,s){let o=n.state.charCategorizer(e),l=o(s);return a=>{let h=o(a);return l==Ho.Space&&(l=h),l==h}}function OD(n,e,s,o){let l=e.head,a=s?1:-1;if(l==(s?n.state.doc.length:0))return xt.cursor(l,e.assoc);let h=e.goalColumn,d,p=n.contentDOM.getBoundingClientRect(),g=n.coordsAtPos(l,e.assoc||-1),m=n.documentTop;if(g)h==null&&(h=g.left-p.left),d=a<0?g.top:g.bottom;else{let y=n.viewState.lineBlockAt(l);h==null&&(h=Math.min(p.right-p.left,n.defaultCharacterWidth*(l-y.from))),d=(a<0?y.top:y.bottom)+m}let T=p.left+h,b=o??n.viewState.heightOracle.textHeight>>1;for(let y=0;;y+=10){let C=d+(b+y)*a,L=bO(n,{x:T,y:C},!1,a);if(C<p.top||C>p.bottom||(a<0?L<l:L>l)){let A=n.docView.coordsForChar(L),F=!A||C<A.top?-1:1;return xt.cursor(L,F,void 0,h)}}}function Qd(n,e,s){for(;;){let o=0;for(let l of n)l.between(e-1,e+1,(a,h,d)=>{if(e>a&&e<h){let p=o||s||(e-a<h-e?-1:1);e=p<0?a:h,o=p}});if(!o)return e}}function l_(n,e,s){let o=Qd(n.state.facet(Ub).map(l=>l(n)),s.from,e.head>s.from?-1:1);return o==s.from?s:xt.cursor(o,o<s.from?1:-1)}class AD{setSelectionOrigin(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}constructor(e){this.view=e,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastEscPress=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=e.hasFocus,Dt.safari&&e.contentDOM.addEventListener("input",()=>null),Dt.gecko&&YD(e.contentDOM.ownerDocument)}handleEvent(e){!FD(this.view,e)||this.ignoreDuringComposition(e)||e.type=="keydown"&&this.keydown(e)||this.runHandlers(e.type,e)}runHandlers(e,s){let o=this.handlers[e];if(o){for(let l of o.observers)l(this.view,s);for(let l of o.handlers){if(s.defaultPrevented)break;if(l(this.view,s)){s.preventDefault();break}}}}ensureHandlers(e){let s=RD(e),o=this.handlers,l=this.view.contentDOM;for(let a in s)if(a!="scroll"){let h=!s[a].handlers.length,d=o[a];d&&h!=!d.handlers.length&&(l.removeEventListener(a,this.handleEvent),d=null),d||l.addEventListener(a,this.handleEvent,{passive:h})}for(let a in o)a!="scroll"&&!s[a]&&l.removeEventListener(a,this.handleEvent);this.handlers=s}keydown(e){if(this.lastKeyCode=e.keyCode,this.lastKeyTime=Date.now(),e.keyCode==9&&Date.now()<this.lastEscPress+2e3)return!0;if(e.keyCode!=27&&LD.indexOf(e.keyCode)<0&&(this.view.inputState.lastEscPress=0),Dt.android&&Dt.chrome&&!e.synthetic&&(e.keyCode==13||e.keyCode==8))return this.view.observer.delayAndroidKey(e.key,e.keyCode),!0;let s;return Dt.ios&&!e.synthetic&&!e.altKey&&!e.metaKey&&((s=EO.find(o=>o.keyCode==e.keyCode))&&!e.ctrlKey||ND.indexOf(e.key)>-1&&e.ctrlKey&&!e.shiftKey)?(this.pendingIOSKey=s||e,setTimeout(()=>this.flushIOSKey(),250),!0):(e.keyCode!=229&&this.view.observer.forceFlush(),!1)}flushIOSKey(){let e=this.pendingIOSKey;return e?(this.pendingIOSKey=void 0,ac(this.view.contentDOM,e.key,e.keyCode)):!1}ignoreDuringComposition(e){return/^key/.test(e.type)?this.composing>0?!0:Dt.safari&&!Dt.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100?(this.compositionPendingKey=!1,!0):!1:!1}startMouseSelection(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e}update(e){this.mouseSelection&&this.mouseSelection.update(e),this.draggedContent&&e.docChanged&&(this.draggedContent=this.draggedContent.map(e.changes)),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function GC(n,e){return(s,o)=>{try{return e.call(n,o,s)}catch(l){Pn(s.state,l)}}}function RD(n){let e=Object.create(null);function s(o){return e[o]||(e[o]={observers:[],handlers:[]})}for(let o of n){let l=o.spec;if(l&&l.domEventHandlers)for(let a in l.domEventHandlers){let h=l.domEventHandlers[a];h&&s(a).handlers.push(GC(o.value,h))}if(l&&l.domEventObservers)for(let a in l.domEventObservers){let h=l.domEventObservers[a];h&&s(a).observers.push(GC(o.value,h))}}for(let o in Ms)s(o).handlers.push(Ms[o]);for(let o in xs)s(o).observers.push(xs[o]);return e}const EO=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],ND="dthko",LD=[16,17,18,20,91,92,224,225],Id=6;function Sd(n){return Math.max(0,n)*.7+8}function MD(n,e){return Math.max(Math.abs(n.clientX-e.clientX),Math.abs(n.clientY-e.clientY))}class xD{constructor(e,s,o,l){this.view=e,this.startEvent=s,this.style=o,this.mustSelect=l,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=s,this.scrollParent=Kx(e.contentDOM),this.atoms=e.state.facet(Ub).map(h=>h(e));let a=e.contentDOM.ownerDocument;a.addEventListener("mousemove",this.move=this.move.bind(this)),a.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=s.shiftKey,this.multiple=e.state.facet($e.allowMultipleSelections)&&DD(e,s),this.dragging=BD(e,s)&&SO(s)==1?null:!1}start(e){this.dragging===!1&&this.select(e)}move(e){var s;if(e.buttons==0)return this.destroy();if(this.dragging||this.dragging==null&&MD(this.startEvent,e)<10)return;this.select(this.lastEvent=e);let o=0,l=0,a=((s=this.scrollParent)===null||s===void 0?void 0:s.getBoundingClientRect())||{left:0,top:0,right:this.view.win.innerWidth,bottom:this.view.win.innerHeight},h=$O(this.view);e.clientX-h.left<=a.left+Id?o=-Sd(a.left-e.clientX):e.clientX+h.right>=a.right-Id&&(o=Sd(e.clientX-a.right)),e.clientY-h.top<=a.top+Id?l=-Sd(a.top-e.clientY):e.clientY+h.bottom>=a.bottom-Id&&(l=Sd(e.clientY-a.bottom)),this.setScrollSpeed(o,l)}up(e){this.dragging==null&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(e,s){this.scrollSpeed={x:e,y:s},e||s?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){this.scrollParent?(this.scrollParent.scrollLeft+=this.scrollSpeed.x,this.scrollParent.scrollTop+=this.scrollSpeed.y):this.view.win.scrollBy(this.scrollSpeed.x,this.scrollSpeed.y),this.dragging===!1&&this.select(this.lastEvent)}skipAtoms(e){let s=null;for(let o=0;o<e.ranges.length;o++){let l=e.ranges[o],a=null;if(l.empty){let h=Qd(this.atoms,l.from,0);h!=l.from&&(a=xt.cursor(h,-1))}else{let h=Qd(this.atoms,l.from,-1),d=Qd(this.atoms,l.to,1);(h!=l.from||d!=l.to)&&(a=xt.range(l.from==l.anchor?h:d,l.from==l.head?h:d))}a&&(s||(s=e.ranges.slice()),s[o]=a)}return s?xt.create(s,e.mainIndex):e}select(e){let{view:s}=this,o=this.skipAtoms(this.style.get(e,this.extend,this.multiple));(this.mustSelect||!o.eq(s.state.selection,this.dragging===!1))&&this.view.dispatch({selection:o,userEvent:"select.pointer"}),this.mustSelect=!1}update(e){this.style.update(e)&&setTimeout(()=>this.select(this.lastEvent),20)}}function DD(n,e){let s=n.state.facet(rO);return s.length?s[0](e):Dt.mac?e.metaKey:e.ctrlKey}function PD(n,e){let s=n.state.facet(lO);return s.length?s[0](e):Dt.mac?!e.altKey:!e.ctrlKey}function BD(n,e){let{main:s}=n.state.selection;if(s.empty)return!1;let o=_p(n.root);if(!o||o.rangeCount==0)return!0;let l=o.getRangeAt(0).getClientRects();for(let a=0;a<l.length;a++){let h=l[a];if(h.left<=e.clientX&&h.right>=e.clientX&&h.top<=e.clientY&&h.bottom>=e.clientY)return!0}return!1}function FD(n,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let s=e.target,o;s!=n.contentDOM;s=s.parentNode)if(!s||s.nodeType==11||(o=Me.get(s))&&o.ignoreEvent(e))return!1;return!0}const Ms=Object.create(null),xs=Object.create(null),vO=Dt.ie&&Dt.ie_version<15||Dt.ios&&Dt.webkit_version<604;function UD(n){let e=n.dom.parentNode;if(!e)return;let s=e.appendChild(document.createElement("textarea"));s.style.cssText="position: fixed; left: -10000px; top: 10px",s.focus(),setTimeout(()=>{n.focus(),s.remove(),yO(n,s.value)},50)}function yO(n,e){let{state:s}=n,o,l=1,a=s.toText(e),h=a.lines==s.selection.ranges.length;if(xT!=null&&s.selection.ranges.every(p=>p.empty)&&xT==a.toString()){let p=-1;o=s.changeByRange(g=>{let m=s.doc.lineAt(g.from);if(m.from==p)return{range:g};p=m.from;let T=s.toText((h?a.line(l++).text:e)+s.lineBreak);return{changes:{from:m.from,insert:T},range:xt.cursor(g.from+T.length)}})}else h?o=s.changeByRange(p=>{let g=a.line(l++);return{changes:{from:p.from,to:p.to,insert:g.text},range:xt.cursor(p.from+g.length)}}):o=s.replaceSelection(a);n.dispatch(o,{userEvent:"input.paste",scrollIntoView:!0})}xs.scroll=n=>{n.inputState.lastScrollTop=n.scrollDOM.scrollTop,n.inputState.lastScrollLeft=n.scrollDOM.scrollLeft};Ms.keydown=(n,e)=>(n.inputState.setSelectionOrigin("select"),e.keyCode==27&&(n.inputState.lastEscPress=Date.now()),!1);xs.touchstart=(n,e)=>{n.inputState.lastTouchTime=Date.now(),n.inputState.setSelectionOrigin("select.pointer")};xs.touchmove=n=>{n.inputState.setSelectionOrigin("select.pointer")};Ms.mousedown=(n,e)=>{if(n.observer.flush(),n.inputState.lastTouchTime>Date.now()-2e3)return!1;let s=null;for(let o of n.state.facet(cO))if(s=o(n,e),s)break;if(!s&&e.button==0&&(s=GD(n,e)),s){let o=!n.hasFocus;n.inputState.startMouseSelection(new xD(n,e,s,o)),o&&n.observer.ignore(()=>G0(n.contentDOM));let l=n.inputState.mouseSelection;if(l)return l.start(e),l.dragging===!1}return!1};function WC(n,e,s,o){if(o==1)return xt.cursor(e,s);if(o==2)return ED(n.state,e,s);{let l=qe.find(n.docView,e),a=n.state.doc.lineAt(l?l.posAtEnd:e),h=l?l.posAtStart:a.from,d=l?l.posAtEnd:a.to;return d<n.state.doc.length&&d==a.to&&d++,xt.range(h,d)}}let IO=(n,e)=>n>=e.top&&n<=e.bottom,zC=(n,e,s)=>IO(e,s)&&n>=s.left&&n<=s.right;function HD(n,e,s,o){let l=qe.find(n.docView,e);if(!l)return 1;let a=e-l.posAtStart;if(a==0)return 1;if(a==l.length)return-1;let h=l.coordsAt(a,-1);if(h&&zC(s,o,h))return-1;let d=l.coordsAt(a,1);return d&&zC(s,o,d)?1:h&&IO(o,h)?-1:1}function XC(n,e){let s=n.posAtCoords({x:e.clientX,y:e.clientY},!1);return{pos:s,bias:HD(n,s,e.clientX,e.clientY)}}const VD=Dt.ie&&Dt.ie_version<=11;let YC=null,KC=0,jC=0;function SO(n){if(!VD)return n.detail;let e=YC,s=jC;return YC=n,jC=Date.now(),KC=!e||s>Date.now()-400&&Math.abs(e.clientX-n.clientX)<2&&Math.abs(e.clientY-n.clientY)<2?(KC+1)%3:1}function GD(n,e){let s=XC(n,e),o=SO(e),l=n.state.selection;return{update(a){a.docChanged&&(s.pos=a.changes.mapPos(s.pos),l=l.map(a.changes))},get(a,h,d){let p=XC(n,a),g,m=WC(n,p.pos,p.bias,o);if(s.pos!=p.pos&&!h){let T=WC(n,s.pos,s.bias,o),b=Math.min(T.from,m.from),y=Math.max(T.to,m.to);m=b<m.from?xt.range(b,y):xt.range(y,b)}return h?l.replaceRange(l.main.extend(m.from,m.to)):d&&o==1&&l.ranges.length>1&&(g=WD(l,p.pos))?g:d?l.addRange(m):xt.create([m])}}}function WD(n,e){for(let s=0;s<n.ranges.length;s++){let{from:o,to:l}=n.ranges[s];if(o<=e&&l>=e)return xt.create(n.ranges.slice(0,s).concat(n.ranges.slice(s+1)),n.mainIndex==s?0:n.mainIndex-(n.mainIndex>s?1:0))}return null}Ms.dragstart=(n,e)=>{let{selection:{main:s}}=n.state;if(e.target.draggable){let l=n.docView.nearest(e.target);if(l&&l.isWidget){let a=l.posAtStart,h=a+l.length;(a>=s.to||h<=s.from)&&(s=xt.range(a,h))}}let{inputState:o}=n;return o.mouseSelection&&(o.mouseSelection.dragging=!0),o.draggedContent=s,e.dataTransfer&&(e.dataTransfer.setData("Text",n.state.sliceDoc(s.from,s.to)),e.dataTransfer.effectAllowed="copyMove"),!1};Ms.dragend=n=>(n.inputState.draggedContent=null,!1);function JC(n,e,s,o){if(!s)return;let l=n.posAtCoords({x:e.clientX,y:e.clientY},!1),{draggedContent:a}=n.inputState,h=o&&a&&PD(n,e)?{from:a.from,to:a.to}:null,d={from:l,insert:s},p=n.state.changes(h?[h,d]:d);n.focus(),n.dispatch({changes:p,selection:{anchor:p.mapPos(l,-1),head:p.mapPos(l,1)},userEvent:h?"move.drop":"input.drop"}),n.inputState.draggedContent=null}Ms.drop=(n,e)=>{if(!e.dataTransfer)return!1;if(n.state.readOnly)return!0;let s=e.dataTransfer.files;if(s&&s.length){let o=Array(s.length),l=0,a=()=>{++l==s.length&&JC(n,e,o.filter(h=>h!=null).join(n.state.lineBreak),!1)};for(let h=0;h<s.length;h++){let d=new FileReader;d.onerror=a,d.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(d.result)||(o[h]=d.result),a()},d.readAsText(s[h])}return!0}else{let o=e.dataTransfer.getData("Text");if(o)return JC(n,e,o,!0),!0}return!1};Ms.paste=(n,e)=>{if(n.state.readOnly)return!0;n.observer.flush();let s=vO?null:e.clipboardData;return s?(yO(n,s.getData("text/plain")||s.getData("text/uri-text")),!0):(UD(n),!1)};function zD(n,e){let s=n.dom.parentNode;if(!s)return;let o=s.appendChild(document.createElement("textarea"));o.style.cssText="position: fixed; left: -10000px; top: 10px",o.value=e,o.focus(),o.selectionEnd=e.length,o.selectionStart=0,setTimeout(()=>{o.remove(),n.focus()},50)}function XD(n){let e=[],s=[],o=!1;for(let l of n.selection.ranges)l.empty||(e.push(n.sliceDoc(l.from,l.to)),s.push(l));if(!e.length){let l=-1;for(let{from:a}of n.selection.ranges){let h=n.doc.lineAt(a);h.number>l&&(e.push(h.text),s.push({from:h.from,to:Math.min(n.doc.length,h.to+1)})),l=h.number}o=!0}return{text:e.join(n.lineBreak),ranges:s,linewise:o}}let xT=null;Ms.copy=Ms.cut=(n,e)=>{let{text:s,ranges:o,linewise:l}=XD(n.state);if(!s&&!l)return!1;xT=l?s:null,e.type=="cut"&&!n.state.readOnly&&n.dispatch({changes:o,scrollIntoView:!0,userEvent:"delete.cut"});let a=vO?null:e.clipboardData;return a?(a.clearData(),a.setData("text/plain",s),!0):(zD(n,s),!1)};const CO=Ac.define();function wO(n,e){let s=[];for(let o of n.facet(uO)){let l=o(n,e);l&&s.push(l)}return s?n.update({effects:s,annotations:CO.of(!0)}):null}function kO(n){setTimeout(()=>{let e=n.hasFocus;if(e!=n.inputState.notifiedFocused){let s=wO(n.state,e);s?n.dispatch(s):n.update([])}},10)}xs.focus=n=>{n.inputState.lastFocusTime=Date.now(),!n.scrollDOM.scrollTop&&(n.inputState.lastScrollTop||n.inputState.lastScrollLeft)&&(n.scrollDOM.scrollTop=n.inputState.lastScrollTop,n.scrollDOM.scrollLeft=n.inputState.lastScrollLeft),kO(n)};xs.blur=n=>{n.observer.clearSelectionRange(),kO(n)};xs.compositionstart=xs.compositionupdate=n=>{n.inputState.compositionFirstChange==null&&(n.inputState.compositionFirstChange=!0),n.inputState.composing<0&&(n.inputState.composing=0)};xs.compositionend=n=>{n.inputState.composing=-1,n.inputState.compositionEndedAt=Date.now(),n.inputState.compositionPendingKey=!0,n.inputState.compositionPendingChange=n.observer.pendingRecords().length>0,n.inputState.compositionFirstChange=null,Dt.chrome&&Dt.android?n.observer.flushSoon():n.inputState.compositionPendingChange?Promise.resolve().then(()=>n.observer.flush()):setTimeout(()=>{n.inputState.composing<0&&n.docView.hasComposition&&n.update([])},50)};xs.contextmenu=n=>{n.inputState.lastContextMenu=Date.now()};Ms.beforeinput=(n,e)=>{var s;let o;if(Dt.chrome&&Dt.android&&(o=EO.find(l=>l.inputType==e.inputType))&&(n.observer.delayAndroidKey(o.key,o.keyCode),o.key=="Backspace"||o.key=="Delete")){let l=((s=window.visualViewport)===null||s===void 0?void 0:s.height)||0;setTimeout(()=>{var a;(((a=window.visualViewport)===null||a===void 0?void 0:a.height)||0)>l+10&&n.hasFocus&&(n.contentDOM.blur(),n.focus())},100)}return!1};const qC=new Set;function YD(n){qC.has(n)||(qC.add(n),n.addEventListener("copy",()=>{}),n.addEventListener("cut",()=>{}))}const ZC=["pre-wrap","normal","pre-line","break-spaces"];class KD{constructor(e){this.lineWrapping=e,this.doc=Te.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30,this.heightChanged=!1}heightForGap(e,s){let o=this.doc.lineAt(s).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(o+=Math.max(0,Math.ceil((s-e-o*this.lineLength*.5)/this.lineLength))),this.lineHeight*o}heightForLine(e){return this.lineWrapping?(1+Math.max(0,Math.ceil((e-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(e){return this.doc=e,this}mustRefreshForWrapping(e){return ZC.indexOf(e)>-1!=this.lineWrapping}mustRefreshForHeights(e){let s=!1;for(let o=0;o<e.length;o++){let l=e[o];l<0?o++:this.heightSamples[Math.floor(l*10)]||(s=!0,this.heightSamples[Math.floor(l*10)]=!0)}return s}refresh(e,s,o,l,a,h){let d=ZC.indexOf(e)>-1,p=Math.round(s)!=Math.round(this.lineHeight)||this.lineWrapping!=d;if(this.lineWrapping=d,this.lineHeight=s,this.charWidth=o,this.textHeight=l,this.lineLength=a,p){this.heightSamples={};for(let g=0;g<h.length;g++){let m=h[g];m<0?g++:this.heightSamples[Math.floor(m*10)]=!0}}return p}}class jD{constructor(e,s){this.from=e,this.heights=s,this.index=0}get more(){return this.index<this.heights.length}}class fo{constructor(e,s,o,l,a){this.from=e,this.length=s,this.top=o,this.height=l,this._content=a}get type(){return typeof this._content=="number"?Ns.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof Un?this._content.widget:null}get widgetLineBreaks(){return typeof this._content=="number"?this._content:0}join(e){let s=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(e._content)?e._content:[e]);return new fo(this.from,this.length+e.length,this.top,this.height+e.height,s)}}var Le=function(n){return n[n.ByPos=0]="ByPos",n[n.ByHeight=1]="ByHeight",n[n.ByPosNoHeight=2]="ByPosNoHeight",n}(Le||(Le={}));const tp=.001;class Ai{constructor(e,s,o=2){this.length=e,this.height=s,this.flags=o}get outdated(){return(this.flags&2)>0}set outdated(e){this.flags=(e?2:0)|this.flags&-3}setHeight(e,s){this.height!=s&&(Math.abs(this.height-s)>tp&&(e.heightChanged=!0),this.height=s)}replace(e,s,o){return Ai.of(o)}decomposeLeft(e,s){s.push(this)}decomposeRight(e,s){s.push(this)}applyChanges(e,s,o,l){let a=this,h=o.doc;for(let d=l.length-1;d>=0;d--){let{fromA:p,toA:g,fromB:m,toB:T}=l[d],b=a.lineAt(p,Le.ByPosNoHeight,o.setDoc(s),0,0),y=b.to>=g?b:a.lineAt(g,Le.ByPosNoHeight,o,0,0);for(T+=y.to-g,g=y.to;d>0&&b.from<=l[d-1].toA;)p=l[d-1].fromA,m=l[d-1].fromB,d--,p<b.from&&(b=a.lineAt(p,Le.ByPosNoHeight,o,0,0));m+=b.from-p,p=b.from;let C=Hb.build(o.setDoc(h),e,m,T);a=a.replace(p,g,C)}return a.updateHeight(o,0)}static empty(){return new Qi(0,0)}static of(e){if(e.length==1)return e[0];let s=0,o=e.length,l=0,a=0;for(;;)if(s==o)if(l>a*2){let d=e[s-1];d.break?e.splice(--s,1,d.left,null,d.right):e.splice(--s,1,d.left,d.right),o+=1+d.break,l-=d.size}else if(a>l*2){let d=e[o];d.break?e.splice(o,1,d.left,null,d.right):e.splice(o,1,d.left,d.right),o+=2+d.break,a-=d.size}else break;else if(l<a){let d=e[s++];d&&(l+=d.size)}else{let d=e[--o];d&&(a+=d.size)}let h=0;return e[s-1]==null?(h=1,s--):e[s]==null&&(h=1,o++),new JD(Ai.of(e.slice(0,s)),h,Ai.of(e.slice(o)))}}Ai.prototype.size=1;class OO extends Ai{constructor(e,s,o){super(e,s),this.deco=o}blockAt(e,s,o,l){return new fo(l,this.length,o,this.height,this.deco||0)}lineAt(e,s,o,l,a){return this.blockAt(0,o,l,a)}forEachLine(e,s,o,l,a,h){e<=a+this.length&&s>=a&&h(this.blockAt(0,o,l,a))}updateHeight(e,s=0,o=!1,l){return l&&l.from<=s&&l.more&&this.setHeight(e,l.heights[l.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class Qi extends OO{constructor(e,s){super(e,s,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(e,s,o,l){return new fo(l,this.length,o,this.height,this.breaks)}replace(e,s,o){let l=o[0];return o.length==1&&(l instanceof Qi||l instanceof ni&&l.flags&4)&&Math.abs(this.length-l.length)<10?(l instanceof ni?l=new Qi(l.length,this.height):l.height=this.height,this.outdated||(l.outdated=!1),l):Ai.of(o)}updateHeight(e,s=0,o=!1,l){return l&&l.from<=s&&l.more?this.setHeight(e,l.heights[l.index++]):(o||this.outdated)&&this.setHeight(e,Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))+this.breaks*e.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class ni extends Ai{constructor(e){super(e,0)}heightMetrics(e,s){let o=e.doc.lineAt(s).number,l=e.doc.lineAt(s+this.length).number,a=l-o+1,h,d=0;if(e.lineWrapping){let p=Math.min(this.height,e.lineHeight*a);h=p/a,this.length>a+1&&(d=(this.height-p)/(this.length-a-1))}else h=this.height/a;return{firstLine:o,lastLine:l,perLine:h,perChar:d}}blockAt(e,s,o,l){let{firstLine:a,lastLine:h,perLine:d,perChar:p}=this.heightMetrics(s,l);if(s.lineWrapping){let g=l+Math.round(Math.max(0,Math.min(1,(e-o)/this.height))*this.length),m=s.doc.lineAt(g),T=d+m.length*p,b=Math.max(o,e-T/2);return new fo(m.from,m.length,b,T,0)}else{let g=Math.max(0,Math.min(h-a,Math.floor((e-o)/d))),{from:m,length:T}=s.doc.line(a+g);return new fo(m,T,o+d*g,d,0)}}lineAt(e,s,o,l,a){if(s==Le.ByHeight)return this.blockAt(e,o,l,a);if(s==Le.ByPosNoHeight){let{from:y,to:C}=o.doc.lineAt(e);return new fo(y,C-y,0,0,0)}let{firstLine:h,perLine:d,perChar:p}=this.heightMetrics(o,a),g=o.doc.lineAt(e),m=d+g.length*p,T=g.number-h,b=l+d*T+p*(g.from-a-T);return new fo(g.from,g.length,Math.max(l,Math.min(b,l+this.height-m)),m,0)}forEachLine(e,s,o,l,a,h){e=Math.max(e,a),s=Math.min(s,a+this.length);let{firstLine:d,perLine:p,perChar:g}=this.heightMetrics(o,a);for(let m=e,T=l;m<=s;){let b=o.doc.lineAt(m);if(m==e){let C=b.number-d;T+=p*C+g*(e-a-C)}let y=p+g*b.length;h(new fo(b.from,b.length,T,y,0)),T+=y,m=b.to+1}}replace(e,s,o){let l=this.length-s;if(l>0){let a=o[o.length-1];a instanceof ni?o[o.length-1]=new ni(a.length+l):o.push(null,new ni(l-1))}if(e>0){let a=o[0];a instanceof ni?o[0]=new ni(e+a.length):o.unshift(new ni(e-1),null)}return Ai.of(o)}decomposeLeft(e,s){s.push(new ni(e-1),null)}decomposeRight(e,s){s.push(null,new ni(this.length-e-1))}updateHeight(e,s=0,o=!1,l){let a=s+this.length;if(l&&l.from<=s+this.length&&l.more){let h=[],d=Math.max(s,l.from),p=-1;for(l.from>s&&h.push(new ni(l.from-s-1).updateHeight(e,s));d<=a&&l.more;){let m=e.doc.lineAt(d).length;h.length&&h.push(null);let T=l.heights[l.index++];p==-1?p=T:Math.abs(T-p)>=tp&&(p=-2);let b=new Qi(m,T);b.outdated=!1,h.push(b),d+=m+1}d<=a&&h.push(null,new ni(a-d).updateHeight(e,d));let g=Ai.of(h);return(p<0||Math.abs(g.height-this.height)>=tp||Math.abs(p-this.heightMetrics(e,s).perLine)>=tp)&&(e.heightChanged=!0),g}else(o||this.outdated)&&(this.setHeight(e,e.heightForGap(s,s+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class JD extends Ai{constructor(e,s,o){super(e.length+s+o.length,e.height+o.height,s|(e.outdated||o.outdated?2:0)),this.left=e,this.right=o,this.size=e.size+o.size}get break(){return this.flags&1}blockAt(e,s,o,l){let a=o+this.left.height;return e<a?this.left.blockAt(e,s,o,l):this.right.blockAt(e,s,a,l+this.left.length+this.break)}lineAt(e,s,o,l,a){let h=l+this.left.height,d=a+this.left.length+this.break,p=s==Le.ByHeight?e<h:e<d,g=p?this.left.lineAt(e,s,o,l,a):this.right.lineAt(e,s,o,h,d);if(this.break||(p?g.to<d:g.from>d))return g;let m=s==Le.ByPosNoHeight?Le.ByPosNoHeight:Le.ByPos;return p?g.join(this.right.lineAt(d,m,o,h,d)):this.left.lineAt(d,m,o,l,a).join(g)}forEachLine(e,s,o,l,a,h){let d=l+this.left.height,p=a+this.left.length+this.break;if(this.break)e<p&&this.left.forEachLine(e,s,o,l,a,h),s>=p&&this.right.forEachLine(e,s,o,d,p,h);else{let g=this.lineAt(p,Le.ByPos,o,l,a);e<g.from&&this.left.forEachLine(e,g.from-1,o,l,a,h),g.to>=e&&g.from<=s&&h(g),s>g.to&&this.right.forEachLine(g.to+1,s,o,d,p,h)}}replace(e,s,o){let l=this.left.length+this.break;if(s<l)return this.balanced(this.left.replace(e,s,o),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-l,s-l,o));let a=[];e>0&&this.decomposeLeft(e,a);let h=a.length;for(let d of o)a.push(d);if(e>0&&QC(a,h-1),s<this.length){let d=a.length;this.decomposeRight(s,a),QC(a,d)}return Ai.of(a)}decomposeLeft(e,s){let o=this.left.length;if(e<=o)return this.left.decomposeLeft(e,s);s.push(this.left),this.break&&(o++,e>=o&&s.push(null)),e>o&&this.right.decomposeLeft(e-o,s)}decomposeRight(e,s){let o=this.left.length,l=o+this.break;if(e>=l)return this.right.decomposeRight(e-l,s);e<o&&this.left.decomposeRight(e,s),this.break&&e<l&&s.push(null),s.push(this.right)}balanced(e,s){return e.size>2*s.size||s.size>2*e.size?Ai.of(this.break?[e,null,s]:[e,s]):(this.left=e,this.right=s,this.height=e.height+s.height,this.outdated=e.outdated||s.outdated,this.size=e.size+s.size,this.length=e.length+this.break+s.length,this)}updateHeight(e,s=0,o=!1,l){let{left:a,right:h}=this,d=s+a.length+this.break,p=null;return l&&l.from<=s+a.length&&l.more?p=a=a.updateHeight(e,s,o,l):a.updateHeight(e,s,o),l&&l.from<=d+h.length&&l.more?p=h=h.updateHeight(e,d,o,l):h.updateHeight(e,d,o),p?this.balanced(a,h):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function QC(n,e){let s,o;n[e]==null&&(s=n[e-1])instanceof ni&&(o=n[e+1])instanceof ni&&n.splice(e-1,3,new ni(s.length+1+o.length))}const qD=5;class Hb{constructor(e,s){this.pos=e,this.oracle=s,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,s){if(this.lineStart>-1){let o=Math.min(s,this.lineEnd),l=this.nodes[this.nodes.length-1];l instanceof Qi?l.length+=o-this.pos:(o>this.pos||!this.isCovered)&&this.nodes.push(new Qi(o-this.pos,-1)),this.writtenTo=o,s>o&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=s}point(e,s,o){if(e<s||o.heightRelevant){let l=o.widget?o.widget.estimatedHeight:0,a=o.widget?o.widget.lineBreaks:0;l<0&&(l=this.oracle.lineHeight);let h=s-e;o.block?this.addBlock(new OO(h,l,o)):(h||a||l>=qD)&&this.addLineDeco(l,a,h)}else s>e&&this.span(e,s);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:e,to:s}=this.oracle.doc.lineAt(this.pos);this.lineStart=e,this.lineEnd=s,this.writtenTo<e&&((this.writtenTo<e-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,e-1)),this.nodes.push(null)),this.pos>e&&this.nodes.push(new Qi(this.pos-e,-1)),this.writtenTo=this.pos}blankContent(e,s){let o=new ni(s-e);return this.oracle.doc.lineAt(e).to==s&&(o.flags|=4),o}ensureLine(){this.enterLine();let e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof Qi)return e;let s=new Qi(0,-1);return this.nodes.push(s),s}addBlock(e){this.enterLine();let s=e.deco;s&&s.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,s&&s.endSide>0&&(this.covering=e)}addLineDeco(e,s,o){let l=this.ensureLine();l.length+=o,l.collapsed+=o,l.widgetHeight=Math.max(l.widgetHeight,e),l.breaks+=s,this.writtenTo=this.pos=this.pos+o}finish(e){let s=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(s instanceof Qi)&&!this.isCovered?this.nodes.push(new Qi(0,-1)):(this.writtenTo<this.pos||s==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let o=e;for(let l of this.nodes)l instanceof Qi&&l.updateHeight(this.oracle,o),o+=l?l.length:1;return this.nodes}static build(e,s,o,l){let a=new Hb(o,e);return pe.spans(s,o,l,a,0),a.finish(o)}}function ZD(n,e,s){let o=new QD;return pe.compare(n,e,s,o,0),o.changes}class QD{constructor(){this.changes=[]}compareRange(){}comparePoint(e,s,o,l){(e<s||o&&o.heightRelevant||l&&l.heightRelevant)&&OT(e,s,this.changes,5)}}function t1(n,e){let s=n.getBoundingClientRect(),o=n.ownerDocument,l=o.defaultView||window,a=Math.max(0,s.left),h=Math.min(l.innerWidth,s.right),d=Math.max(0,s.top),p=Math.min(l.innerHeight,s.bottom);for(let g=n.parentNode;g&&g!=o.body;)if(g.nodeType==1){let m=g,T=window.getComputedStyle(m);if((m.scrollHeight>m.clientHeight||m.scrollWidth>m.clientWidth)&&T.overflow!="visible"){let b=m.getBoundingClientRect();a=Math.max(a,b.left),h=Math.min(h,b.right),d=Math.max(d,b.top),p=g==n.parentNode?b.bottom:Math.min(p,b.bottom)}g=T.position=="absolute"||T.position=="fixed"?m.offsetParent:m.parentNode}else if(g.nodeType==11)g=g.host;else break;return{left:a-s.left,right:Math.max(a,h)-s.left,top:d-(s.top+e),bottom:Math.max(d,p)-(s.top+e)}}function e1(n,e){let s=n.getBoundingClientRect();return{left:0,right:s.right-s.left,top:e,bottom:s.bottom-(s.top+e)}}class c_{constructor(e,s,o){this.from=e,this.to=s,this.size=o}static same(e,s){if(e.length!=s.length)return!1;for(let o=0;o<e.length;o++){let l=e[o],a=s[o];if(l.from!=a.from||l.to!=a.to||l.size!=a.size)return!1}return!0}draw(e,s){return _i.replace({widget:new i1(this.size*(s?e.scaleY:e.scaleX),s)}).range(this.from,this.to)}}class i1 extends Pb{constructor(e,s){super(),this.size=e,this.vertical=s}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){let e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}get estimatedHeight(){return this.vertical?this.size:-1}}class tw{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!0,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=ew,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=ti.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let s=e.facet(Fb).some(o=>typeof o!="function"&&o.class=="cm-lineWrapping");this.heightOracle=new KD(s),this.stateDeco=e.facet(Ch).filter(o=>typeof o!="function"),this.heightMap=Ai.empty().applyChanges(this.stateDeco,Te.empty,this.heightOracle.setDoc(e.doc),[new fs(0,0,0,e.doc.length)]),this.viewport=this.getViewport(0,null),this.updateViewportLines(),this.updateForViewport(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=_i.set(this.lineGaps.map(o=>o.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let e=[this.viewport],{main:s}=this.state.selection;for(let o=0;o<=1;o++){let l=o?s.head:s.anchor;if(!e.some(({from:a,to:h})=>l>=a&&l<=h)){let{from:a,to:h}=this.lineBlockAt(l);e.push(new Cd(a,h))}}this.viewports=e.sort((o,l)=>o.from-l.from),this.scaler=this.heightMap.height<=7e6?ew:new n1(this.heightOracle,this.heightMap,this.viewports)}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,e=>{this.viewportLines.push(this.scaler.scale==1?e:Pa(e,this.scaler))})}update(e,s=null){this.state=e.state;let o=this.stateDeco;this.stateDeco=this.state.facet(Ch).filter(m=>typeof m!="function");let l=e.changedRanges,a=fs.extendWithRanges(l,ZD(o,this.stateDeco,e?e.changes:Qe.empty(this.state.doc.length))),h=this.heightMap.height,d=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);this.heightMap=this.heightMap.applyChanges(this.stateDeco,e.startState.doc,this.heightOracle.setDoc(this.state.doc),a),this.heightMap.height!=h&&(e.flags|=2),d?(this.scrollAnchorPos=e.changes.mapPos(d.from,-1),this.scrollAnchorHeight=d.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=this.heightMap.height);let p=a.length?this.mapViewport(this.viewport,e.changes):this.viewport;(s&&(s.range.head<p.from||s.range.head>p.to)||!this.viewportIsAppropriate(p))&&(p=this.getViewport(0,s));let g=!e.changes.empty||e.flags&2||p.from!=this.viewport.from||p.to!=this.viewport.to;this.viewport=p,this.updateForViewport(),g&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(),s&&(this.scrollTarget=s),!this.mustEnforceCursorAssoc&&e.selectionSet&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&!e.state.facet(dD)&&(this.mustEnforceCursorAssoc=!0)}measure(e){let s=e.contentDOM,o=window.getComputedStyle(s),l=this.heightOracle,a=o.whiteSpace;this.defaultTextDirection=o.direction=="rtl"?ti.RTL:ti.LTR;let h=this.heightOracle.mustRefreshForWrapping(a),d=s.getBoundingClientRect(),p=h||this.mustMeasureContent||this.contentDOMHeight!=d.height;this.contentDOMHeight=d.height,this.mustMeasureContent=!1;let g=0,m=0;if(d.width&&d.height){let{scaleX:K,scaleY:Y}=V0(s,d);(this.scaleX!=K||this.scaleY!=Y)&&(this.scaleX=K,this.scaleY=Y,g|=8,h=p=!0)}let T=(parseInt(o.paddingTop)||0)*this.scaleY,b=(parseInt(o.paddingBottom)||0)*this.scaleY;(this.paddingTop!=T||this.paddingBottom!=b)&&(this.paddingTop=T,this.paddingBottom=b,g|=10),this.editorWidth!=e.scrollDOM.clientWidth&&(l.lineWrapping&&(p=!0),this.editorWidth=e.scrollDOM.clientWidth,g|=8);let y=e.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=y&&(this.scrollAnchorHeight=-1,this.scrollTop=y),this.scrolledToBottom=z0(e.scrollDOM);let C=(this.printing?e1:t1)(s,this.paddingTop),L=C.top-this.pixelViewport.top,A=C.bottom-this.pixelViewport.bottom;this.pixelViewport=C;let F=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(F!=this.inView&&(this.inView=F,F&&(p=!0)),!this.inView&&!this.scrollTarget)return 0;let z=d.width;if((this.contentDOMWidth!=z||this.editorHeight!=e.scrollDOM.clientHeight)&&(this.contentDOMWidth=d.width,this.editorHeight=e.scrollDOM.clientHeight,g|=8),p){let K=e.docView.measureVisibleLineHeights(this.viewport);if(l.mustRefreshForHeights(K)&&(h=!0),h||l.lineWrapping&&Math.abs(z-this.contentDOMWidth)>l.charWidth){let{lineHeight:Y,charWidth:V,textHeight:H}=e.docView.measureTextSize();h=Y>0&&l.refresh(a,Y,V,H,z/V,K),h&&(e.docView.minWidth=0,g|=8)}L>0&&A>0?m=Math.max(L,A):L<0&&A<0&&(m=Math.min(L,A)),l.heightChanged=!1;for(let Y of this.viewports){let V=Y.from==this.viewport.from?K:e.docView.measureVisibleLineHeights(Y);this.heightMap=(h?Ai.empty().applyChanges(this.stateDeco,Te.empty,this.heightOracle,[new fs(0,0,0,e.state.doc.length)]):this.heightMap).updateHeight(l,0,h,new jD(Y.from,V))}l.heightChanged&&(g|=2)}let X=!this.viewportIsAppropriate(this.viewport,m)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return X&&(this.viewport=this.getViewport(m,this.scrollTarget)),this.updateForViewport(),(g&2||X)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>4e3)&&this.updateLineGaps(this.ensureLineGaps(h?[]:this.lineGaps,e)),g|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),g}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,s){let o=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),l=this.heightMap,a=this.heightOracle,{visibleTop:h,visibleBottom:d}=this,p=new Cd(l.lineAt(h-o*1e3,Le.ByHeight,a,0,0).from,l.lineAt(d+(1-o)*1e3,Le.ByHeight,a,0,0).to);if(s){let{head:g}=s.range;if(g<p.from||g>p.to){let m=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),T=l.lineAt(g,Le.ByPos,a,0,0),b;s.y=="center"?b=(T.top+T.bottom)/2-m/2:s.y=="start"||s.y=="nearest"&&g<p.from?b=T.top:b=T.bottom-m,p=new Cd(l.lineAt(b-1e3/2,Le.ByHeight,a,0,0).from,l.lineAt(b+m+1e3/2,Le.ByHeight,a,0,0).to)}}return p}mapViewport(e,s){let o=s.mapPos(e.from,-1),l=s.mapPos(e.to,1);return new Cd(this.heightMap.lineAt(o,Le.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(l,Le.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:e,to:s},o=0){if(!this.inView)return!0;let{top:l}=this.heightMap.lineAt(e,Le.ByPos,this.heightOracle,0,0),{bottom:a}=this.heightMap.lineAt(s,Le.ByPos,this.heightOracle,0,0),{visibleTop:h,visibleBottom:d}=this;return(e==0||l<=h-Math.max(10,Math.min(-o,250)))&&(s==this.state.doc.length||a>=d+Math.max(10,Math.min(o,250)))&&l>h-2*1e3&&a<d+2*1e3}mapLineGaps(e,s){if(!e.length||s.empty)return e;let o=[];for(let l of e)s.touchesRange(l.from,l.to)||o.push(new c_(s.mapPos(l.from),s.mapPos(l.to),l.size));return o}ensureLineGaps(e,s){let o=this.heightOracle.lineWrapping,l=o?1e4:2e3,a=l>>1,h=l<<1;if(this.defaultTextDirection!=ti.LTR&&!o)return[];let d=[],p=(g,m,T,b)=>{if(m-g<a)return;let y=this.state.selection.main,C=[y.from];y.empty||C.push(y.to);for(let A of C)if(A>g&&A<m){p(g,A-10,T,b),p(A+10,m,T,b);return}let L=o1(e,A=>A.from>=T.from&&A.to<=T.to&&Math.abs(A.from-g)<a&&Math.abs(A.to-m)<a&&!C.some(F=>A.from<F&&A.to>F));if(!L){if(m<T.to&&s&&o&&s.visibleRanges.some(A=>A.from<=m&&A.to>=m)){let A=s.moveToLineBoundary(xt.cursor(m),!1,!0).head;A>g&&(m=A)}L=new c_(g,m,this.gapSize(T,g,m,b))}d.push(L)};for(let g of this.viewportLines){if(g.length<h)continue;let m=s1(g.from,g.to,this.stateDeco);if(m.total<h)continue;let T=this.scrollTarget?this.scrollTarget.range.head:null,b,y;if(o){let C=l/this.heightOracle.lineLength*this.heightOracle.lineHeight,L,A;if(T!=null){let F=kd(m,T),z=((this.visibleBottom-this.visibleTop)/2+C)/g.height;L=F-z,A=F+z}else L=(this.visibleTop-g.top-C)/g.height,A=(this.visibleBottom-g.top+C)/g.height;b=wd(m,L),y=wd(m,A)}else{let C=m.total*this.heightOracle.charWidth,L=l*this.heightOracle.charWidth,A,F;if(T!=null){let z=kd(m,T),X=((this.pixelViewport.right-this.pixelViewport.left)/2+L)/C;A=z-X,F=z+X}else A=(this.pixelViewport.left-L)/C,F=(this.pixelViewport.right+L)/C;b=wd(m,A),y=wd(m,F)}b>g.from&&p(g.from,b,g,m),y<g.to&&p(y,g.to,g,m)}return d}gapSize(e,s,o,l){let a=kd(l,o)-kd(l,s);return this.heightOracle.lineWrapping?e.height*a:l.total*this.heightOracle.charWidth*a}updateLineGaps(e){c_.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=_i.set(e.map(s=>s.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(){let e=this.stateDeco;this.lineGaps.length&&(e=e.concat(this.lineGapDeco));let s=[];pe.spans(e,this.viewport.from,this.viewport.to,{span(l,a){s.push({from:l,to:a})},point(){}},20);let o=s.length!=this.visibleRanges.length||this.visibleRanges.some((l,a)=>l.from!=s[a].from||l.to!=s[a].to);return this.visibleRanges=s,o?4:0}lineBlockAt(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find(s=>s.from<=e&&s.to>=e)||Pa(this.heightMap.lineAt(e,Le.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(e){return Pa(this.heightMap.lineAt(this.scaler.fromDOM(e),Le.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(e){let s=this.lineBlockAtHeight(e+8);return s.from>=this.viewport.from||this.viewportLines[0].top-e>200?s:this.viewportLines[0]}elementAtHeight(e){return Pa(this.heightMap.blockAt(this.scaler.fromDOM(e),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class Cd{constructor(e,s){this.from=e,this.to=s}}function s1(n,e,s){let o=[],l=n,a=0;return pe.spans(s,n,e,{span(){},point(h,d){h>l&&(o.push({from:l,to:h}),a+=h-l),l=d}},20),l<e&&(o.push({from:l,to:e}),a+=e-l),{total:a,ranges:o}}function wd({total:n,ranges:e},s){if(s<=0)return e[0].from;if(s>=1)return e[e.length-1].to;let o=Math.floor(n*s);for(let l=0;;l++){let{from:a,to:h}=e[l],d=h-a;if(o<=d)return a+o;o-=d}}function kd(n,e){let s=0;for(let{from:o,to:l}of n.ranges){if(e<=l){s+=e-o;break}s+=l-o}return s/n.total}function o1(n,e){for(let s of n)if(e(s))return s}const ew={toDOM(n){return n},fromDOM(n){return n},scale:1};class n1{constructor(e,s,o){let l=0,a=0,h=0;this.viewports=o.map(({from:d,to:p})=>{let g=s.lineAt(d,Le.ByPos,e,0,0).top,m=s.lineAt(p,Le.ByPos,e,0,0).bottom;return l+=m-g,{from:d,to:p,top:g,bottom:m,domTop:0,domBottom:0}}),this.scale=(7e6-l)/(s.height-l);for(let d of this.viewports)d.domTop=h+(d.top-a)*this.scale,h=d.domBottom=d.domTop+(d.bottom-d.top),a=d.bottom}toDOM(e){for(let s=0,o=0,l=0;;s++){let a=s<this.viewports.length?this.viewports[s]:null;if(!a||e<a.top)return l+(e-o)*this.scale;if(e<=a.bottom)return a.domTop+(e-a.top);o=a.bottom,l=a.domBottom}}fromDOM(e){for(let s=0,o=0,l=0;;s++){let a=s<this.viewports.length?this.viewports[s]:null;if(!a||e<a.domTop)return o+(e-l)/this.scale;if(e<=a.domBottom)return a.top+(e-a.domTop);o=a.bottom,l=a.domBottom}}}function Pa(n,e){if(e.scale==1)return n;let s=e.toDOM(n.top),o=e.toDOM(n.bottom);return new fo(n.from,n.length,s,o-s,Array.isArray(n._content)?n._content.map(l=>Pa(l,e)):n._content)}const Od=Xt.define({combine:n=>n.join(" ")}),DT=Xt.define({combine:n=>n.indexOf(!0)>-1}),PT=gc.newName(),AO=gc.newName(),RO=gc.newName(),NO={"&light":"."+AO,"&dark":"."+RO};function BT(n,e,s){return new gc(e,{finish(o){return/&/.test(o)?o.replace(/&\w*/,l=>{if(l=="&")return n;if(!s||!s[l])throw new RangeError(`Unsupported selector: ${l}`);return s[l]}):n+" "+o}})}const r1=BT("."+PT,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#444"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-iso":{unicodeBidi:"isolate"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",insetInlineStart:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top"},".cm-highlightSpace:before":{content:"attr(data-display)",position:"absolute",pointerEvents:"none",color:"#888"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},NO),Ba="";class l1{constructor(e,s){this.points=e,this.text="",this.lineSeparator=s.facet($e.lineSeparator)}append(e){this.text+=e}lineBreak(){this.text+=Ba}readRange(e,s){if(!e)return this;let o=e.parentNode;for(let l=e;;){this.findPointBefore(o,l);let a=this.text.length;this.readNode(l);let h=l.nextSibling;if(h==s)break;let d=Me.get(l),p=Me.get(h);(d&&p?d.breakAfter:(d?d.breakAfter:iw(l))||iw(h)&&(l.nodeName!="BR"||l.cmIgnore)&&this.text.length>a)&&this.lineBreak(),l=h}return this.findPointBefore(o,s),this}readTextNode(e){let s=e.nodeValue;for(let o of this.points)o.node==e&&(o.pos=this.text.length+Math.min(o.offset,s.length));for(let o=0,l=this.lineSeparator?null:/\r\n?|\n/g;;){let a=-1,h=1,d;if(this.lineSeparator?(a=s.indexOf(this.lineSeparator,o),h=this.lineSeparator.length):(d=l.exec(s))&&(a=d.index,h=d[0].length),this.append(s.slice(o,a<0?s.length:a)),a<0)break;if(this.lineBreak(),h>1)for(let p of this.points)p.node==e&&p.pos>this.text.length&&(p.pos-=h-1);o=a+h}}readNode(e){if(e.cmIgnore)return;let s=Me.get(e),o=s&&s.overrideDOMText;if(o!=null){this.findPointInside(e,o.length);for(let l=o.iter();!l.next().done;)l.lineBreak?this.lineBreak():this.append(l.value)}else e.nodeType==3?this.readTextNode(e):e.nodeName=="BR"?e.nextSibling&&this.lineBreak():e.nodeType==1&&this.readRange(e.firstChild,null)}findPointBefore(e,s){for(let o of this.points)o.node==e&&e.childNodes[o.offset]==s&&(o.pos=this.text.length)}findPointInside(e,s){for(let o of this.points)(e.nodeType==3?o.node==e:e.contains(o.node))&&(o.pos=this.text.length+(c1(e,o.node,o.offset)?s:0))}}function c1(n,e,s){for(;;){if(!e||s<Yo(e))return!1;if(e==n)return!0;s=Sh(e)+1,e=e.parentNode}}function iw(n){return n.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(n.nodeName)}class sw{constructor(e,s){this.node=e,this.offset=s,this.pos=-1}}class a1{constructor(e,s,o,l){this.typeOver=l,this.bounds=null,this.text="";let{impreciseHead:a,impreciseAnchor:h}=e.docView;if(e.state.readOnly&&s>-1)this.newSel=null;else if(s>-1&&(this.bounds=e.docView.domBoundsAround(s,o,0))){let d=a||h?[]:d1(e),p=new l1(d,e.state);p.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=p.text,this.newSel=p1(d,this.bounds.from)}else{let d=e.observer.selectionRange,p=a&&a.node==d.focusNode&&a.offset==d.focusOffset||!yT(e.contentDOM,d.focusNode)?e.state.selection.main.head:e.docView.posFromDOM(d.focusNode,d.focusOffset),g=h&&h.node==d.anchorNode&&h.offset==d.anchorOffset||!yT(e.contentDOM,d.anchorNode)?e.state.selection.main.anchor:e.docView.posFromDOM(d.anchorNode,d.anchorOffset),m=e.viewport;if(Dt.ios&&e.state.selection.main.empty&&p!=g&&(m.from>0||m.to<e.state.doc.length)){let T=m.from-Math.min(p,g),b=m.to-Math.max(p,g);(T==0||T==1)&&(b==0||b==-1)&&(p=0,g=e.state.doc.length)}this.newSel=xt.single(g,p)}}}function LO(n,e){let s,{newSel:o}=e,l=n.state.selection.main,a=n.inputState.lastKeyTime>Date.now()-100?n.inputState.lastKeyCode:-1;if(e.bounds){let{from:h,to:d}=e.bounds,p=l.from,g=null;(a===8||Dt.android&&e.text.length<d-h)&&(p=l.to,g="end");let m=u1(n.state.doc.sliceString(h,d,Ba),e.text,p-h,g);m&&(Dt.chrome&&a==13&&m.toB==m.from+2&&e.text.slice(m.from,m.toB)==Ba+Ba&&m.toB--,s={from:h+m.from,to:h+m.toA,insert:Te.of(e.text.slice(m.from,m.toB).split(Ba))})}else o&&(!n.hasFocus&&n.state.facet(Xp)||o.main.eq(l))&&(o=null);if(!s&&!o)return!1;if(!s&&e.typeOver&&!l.empty&&o&&o.main.empty?s={from:l.from,to:l.to,insert:n.state.doc.slice(l.from,l.to)}:s&&s.from>=l.from&&s.to<=l.to&&(s.from!=l.from||s.to!=l.to)&&l.to-l.from-(s.to-s.from)<=4?s={from:l.from,to:l.to,insert:n.state.doc.slice(l.from,s.from).append(s.insert).append(n.state.doc.slice(s.to,l.to))}:(Dt.mac||Dt.android)&&s&&s.from==s.to&&s.from==l.head-1&&/^\. ?$/.test(s.insert.toString())&&n.contentDOM.getAttribute("autocorrect")=="off"?(o&&s.insert.length==2&&(o=xt.single(o.main.anchor-1,o.main.head-1)),s={from:l.from,to:l.to,insert:Te.of([" "])}):Dt.chrome&&s&&s.from==s.to&&s.from==l.head&&s.insert.toString()==`
 `&&n.lineWrapping&&(o&&(o=xt.single(o.main.anchor-1,o.main.head-1)),s={from:l.from,to:l.to,insert:Te.of([" "])}),s){if(Dt.ios&&n.inputState.flushIOSKey()||Dt.android&&(s.from==l.from&&s.to==l.to&&s.insert.length==1&&s.insert.lines==2&&ac(n.contentDOM,"Enter",13)||(s.from==l.from-1&&s.to==l.to&&s.insert.length==0||a==8&&s.insert.length<s.to-s.from&&s.to>l.head)&&ac(n.contentDOM,"Backspace",8)||s.from==l.from&&s.to==l.to+1&&s.insert.length==0&&ac(n.contentDOM,"Delete",46)))return!0;let h=s.insert.toString();n.inputState.composing>=0&&n.inputState.composing++;let d,p=()=>d||(d=h1(n,s,o));return n.state.facet(hO).some(g=>g(n,s.from,s.to,h,p))||n.dispatch(p()),!0}else if(o&&!o.main.eq(l)){let h=!1,d="select";return n.inputState.lastSelectionTime>Date.now()-50&&(n.inputState.lastSelectionOrigin=="select"&&(h=!0),d=n.inputState.lastSelectionOrigin),n.dispatch({selection:o,scrollIntoView:h,userEvent:d}),!0}else return!1}function h1(n,e,s){let o,l=n.state,a=l.selection.main;if(e.from>=a.from&&e.to<=a.to&&e.to-e.from>=(a.to-a.from)/3&&(!s||s.main.empty&&s.main.from==e.from+e.insert.length)&&n.inputState.composing<0){let d=a.from<e.from?l.sliceDoc(a.from,e.from):"",p=a.to>e.to?l.sliceDoc(e.to,a.to):"";o=l.replaceSelection(n.state.toText(d+e.insert.sliceString(0,void 0,n.state.lineBreak)+p))}else{let d=l.changes(e),p=s&&s.main.to<=d.newLength?s.main:void 0;if(l.selection.ranges.length>1&&n.inputState.composing>=0&&e.to<=a.to&&e.to>=a.to-10){let g=n.state.sliceDoc(e.from,e.to),m,T=s&&_O(n,s.main.head);if(T){let C=e.insert.length-(e.to-e.from);m={from:T.from,to:T.to-C}}else m=n.state.doc.lineAt(a.head);let b=a.to-e.to,y=a.to-a.from;o=l.changeByRange(C=>{if(C.from==a.from&&C.to==a.to)return{changes:d,range:p||C.map(d)};let L=C.to-b,A=L-g.length;if(C.to-C.from!=y||n.state.sliceDoc(A,L)!=g||C.to>=m.from&&C.from<=m.to)return{range:C};let F=l.changes({from:A,to:L,insert:e.insert}),z=C.to-a.to;return{changes:F,range:p?xt.range(Math.max(0,p.anchor+z),Math.max(0,p.head+z)):C.map(F)}})}else o={changes:d,selection:p&&l.selection.replaceRange(p)}}let h="input.type";return(n.composing||n.inputState.compositionPendingChange&&n.inputState.compositionEndedAt>Date.now()-50)&&(n.inputState.compositionPendingChange=!1,h+=".compose",n.inputState.compositionFirstChange&&(h+=".start",n.inputState.compositionFirstChange=!1)),l.update(o,{userEvent:h,scrollIntoView:!0})}function u1(n,e,s,o){let l=Math.min(n.length,e.length),a=0;for(;a<l&&n.charCodeAt(a)==e.charCodeAt(a);)a++;if(a==l&&n.length==e.length)return null;let h=n.length,d=e.length;for(;h>0&&d>0&&n.charCodeAt(h-1)==e.charCodeAt(d-1);)h--,d--;if(o=="end"){let p=Math.max(0,a-Math.min(h,d));s-=h+p-a}if(h<a&&n.length<e.length){let p=s<=a&&s>=h?a-s:0;a-=p,d=a+(d-h),h=a}else if(d<a){let p=s<=a&&s>=d?a-s:0;a-=p,h=a+(h-d),d=a}return{from:a,toA:h,toB:d}}function d1(n){let e=[];if(n.root.activeElement!=n.contentDOM)return e;let{anchorNode:s,anchorOffset:o,focusNode:l,focusOffset:a}=n.observer.selectionRange;return s&&(e.push(new sw(s,o)),(l!=s||a!=o)&&e.push(new sw(l,a))),e}function p1(n,e){if(n.length==0)return null;let s=n[0].pos,o=n.length==2?n[1].pos:s;return s>-1&&o>-1?xt.single(s+e,o+e):null}const f1={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},a_=Dt.ie&&Dt.ie_version<=11;class g1{constructor(e){this.view=e,this.active=!1,this.selectionRange=new jx,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.parentCheck=-1,this.dom=e.contentDOM,this.observer=new MutationObserver(s=>{for(let o of s)this.queue.push(o);(Dt.ie&&Dt.ie_version<=11||Dt.ios&&e.composing)&&s.some(o=>o.type=="childList"&&o.removedNodes.length||o.type=="characterData"&&o.oldValue.length>o.target.nodeValue.length)?this.flushSoon():this.flush()}),a_&&(this.onCharData=s=>{this.queue.push({target:s.target,type:"characterData",oldValue:s.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var s;((s=this.view.docView)===null||s===void 0?void 0:s.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(e.scrollDOM)),this.addWindowListeners(this.win=e.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(s=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),s.length>0&&s[s.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(s=>{s.length>0&&s[s.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(e){this.view.inputState.runHandlers("scroll",e),this.intersecting&&this.view.measure()}onScroll(e){this.intersecting&&this.flush(!1),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(){this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500)}updateGaps(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some((s,o)=>s!=e[o]))){this.gapIntersection.disconnect();for(let s of e)this.gapIntersection.observe(s);this.gaps=e}}onSelectionChange(e){let s=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:o}=this,l=this.selectionRange;if(o.state.facet(Xp)?o.root.activeElement!=this.dom:!Zd(o.dom,l))return;let a=l.anchorNode&&o.docView.nearest(l.anchorNode);if(a&&a.ignoreEvent(e)){s||(this.selectionChanged=!1);return}(Dt.ie&&Dt.ie_version<=11||Dt.android&&Dt.chrome)&&!o.state.selection.main.empty&&l.focusNode&&ja(l.focusNode,l.focusOffset,l.anchorNode,l.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:e}=this,s=Dt.safari&&e.root.nodeType==11&&zx(this.dom.ownerDocument)==this.dom&&m1(this.view)||_p(e.root);if(!s||this.selectionRange.eq(s))return!1;let o=Zd(this.dom,s);return o&&!this.selectionChanged&&e.inputState.lastFocusTime>Date.now()-200&&e.inputState.lastTouchTime<Date.now()-300&&qx(this.dom,s)?(this.view.inputState.lastFocusTime=0,e.docView.updateSelection(),!1):(this.selectionRange.setRange(s),o&&(this.selectionChanged=!0),!0)}setSelectionRange(e,s){this.selectionRange.set(e.node,e.offset,s.node,s.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let e=0,s=null;for(let o=this.dom;o;)if(o.nodeType==1)!s&&e<this.scrollTargets.length&&this.scrollTargets[e]==o?e++:s||(s=this.scrollTargets.slice(0,e)),s&&s.push(o),o=o.assignedSlot||o.parentNode;else if(o.nodeType==11)o=o.host;else break;if(e<this.scrollTargets.length&&!s&&(s=this.scrollTargets.slice(0,e)),s){for(let o of this.scrollTargets)o.removeEventListener("scroll",this.onScroll);for(let o of this.scrollTargets=s)o.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,f1),a_&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),a_&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(e,s){var o;if(!this.delayedAndroidKey){let l=()=>{let a=this.delayedAndroidKey;a&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=a.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&a.force&&ac(this.dom,a.key,a.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(l)}(!this.delayedAndroidKey||e=="Enter")&&(this.delayedAndroidKey={key:e,keyCode:s,force:this.lastChange<Date.now()-50||!!(!((o=this.delayedAndroidKey)===null||o===void 0)&&o.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}processRecords(){let e=this.pendingRecords();e.length&&(this.queue=[]);let s=-1,o=-1,l=!1;for(let a of e){let h=this.readMutation(a);h&&(h.typeOver&&(l=!0),s==-1?{from:s,to:o}=h:(s=Math.min(h.from,s),o=Math.max(h.to,o)))}return{from:s,to:o,typeOver:l}}readChange(){let{from:e,to:s,typeOver:o}=this.processRecords(),l=this.selectionChanged&&Zd(this.dom,this.selectionRange);if(e<0&&!l)return null;e>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let a=new a1(this.view,e,s,o);return this.view.docView.domChanged={newSel:a.newSel?a.newSel.main:null},a}flush(e=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;e&&this.readSelectionRange();let s=this.readChange();if(!s)return this.view.requestMeasure(),!1;let o=this.view.state,l=LO(this.view,s);return this.view.state==o&&this.view.update([]),l}readMutation(e){let s=this.view.docView.nearest(e.target);if(!s||s.ignoreMutation(e))return null;if(s.markDirty(e.type=="attributes"),e.type=="attributes"&&(s.flags|=4),e.type=="childList"){let o=ow(s,e.previousSibling||e.target.previousSibling,-1),l=ow(s,e.nextSibling||e.target.nextSibling,1);return{from:o?s.posAfter(o):s.posAtStart,to:l?s.posBefore(l):s.posAtEnd,typeOver:!1}}else return e.type=="characterData"?{from:s.posAtStart,to:s.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null}setWindow(e){e!=this.win&&(this.removeWindowListeners(this.win),this.win=e,this.addWindowListeners(this.win))}addWindowListeners(e){e.addEventListener("resize",this.onResize),e.addEventListener("beforeprint",this.onPrint),e.addEventListener("scroll",this.onScroll),e.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(e){e.removeEventListener("scroll",this.onScroll),e.removeEventListener("resize",this.onResize),e.removeEventListener("beforeprint",this.onPrint),e.document.removeEventListener("selectionchange",this.onSelectionChange)}destroy(){var e,s,o;this.stop(),(e=this.intersection)===null||e===void 0||e.disconnect(),(s=this.gapIntersection)===null||s===void 0||s.disconnect(),(o=this.resizeScroll)===null||o===void 0||o.disconnect();for(let l of this.scrollTargets)l.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey)}}function ow(n,e,s){for(;e;){let o=Me.get(e);if(o&&o.parent==n)return o;let l=e.parentNode;e=l!=n.dom?l:s>0?e.nextSibling:e.previousSibling}return null}function m1(n){let e=null;function s(p){p.preventDefault(),p.stopImmediatePropagation(),e=p.getTargetRanges()[0]}if(n.contentDOM.addEventListener("beforeinput",s,!0),n.dom.ownerDocument.execCommand("indent"),n.contentDOM.removeEventListener("beforeinput",s,!0),!e)return null;let o=e.startContainer,l=e.startOffset,a=e.endContainer,h=e.endOffset,d=n.docView.domAtPos(n.state.selection.main.anchor);return ja(d.node,d.offset,a,h)&&([o,l,a,h]=[a,h,o,l]),{anchorNode:o,anchorOffset:l,focusNode:a,focusOffset:h}}class oe{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return this.inputState.composing>0}get compositionStarted(){return this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(e={}){this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),e.parent&&e.parent.appendChild(this.dom);let{dispatch:s}=e;this.dispatchTransactions=e.dispatchTransactions||s&&(o=>o.forEach(l=>s(l,this)))||(o=>this.update(o)),this.dispatch=this.dispatch.bind(this),this._root=e.root||Jx(e.parent)||document,this.viewState=new tw(e.state||$e.create(e)),e.scrollTo&&e.scrollTo.is(yd)&&(this.viewState.scrollTarget=e.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(xa).map(o=>new n_(o));for(let o of this.plugins)o.update(this);this.observer=new g1(this),this.inputState=new AD(this),this.inputState.ensureHandlers(this.plugins),this.docView=new DC(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure()}dispatch(...e){let s=e.length==1&&e[0]instanceof $i?e:e.length==1&&Array.isArray(e[0])?e[0]:[this.state.update(...e)];this.dispatchTransactions(s,this)}update(e){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let s=!1,o=!1,l,a=this.state;for(let b of e){if(b.startState!=a)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");a=b.state}if(this.destroyed){this.viewState.state=a;return}let h=this.hasFocus,d=0,p=null;e.some(b=>b.annotation(CO))?(this.inputState.notifiedFocused=h,d=1):h!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=h,p=wO(a,h),p||(d=1));let g=this.observer.delayedAndroidKey,m=null;if(g?(this.observer.clearDelayedAndroidKey(),m=this.observer.readChange(),(m&&!this.state.doc.eq(a.doc)||!this.state.selection.eq(a.selection))&&(m=null)):this.observer.clear(),a.facet($e.phrases)!=this.state.facet($e.phrases))return this.setState(a);l=Tp.create(this,a,e),l.flags|=d;let T=this.viewState.scrollTarget;try{this.updateState=2;for(let b of e){if(T&&(T=T.map(b.changes)),b.scrollIntoView){let{main:y}=b.state.selection;T=new hc(y.empty?y:xt.cursor(y.head,y.head>y.anchor?-1:1))}for(let y of b.effects)y.is(yd)&&(T=y.value.clip(this.state))}this.viewState.update(l,T),this.bidiCache=bp.update(this.bidiCache,l.changes),l.empty||(this.updatePlugins(l),this.inputState.update(l)),s=this.docView.update(l),this.state.facet(Da)!=this.styleModules&&this.mountStyles(),o=this.updateAttrs(),this.showAnnouncements(e),this.docView.updateSelection(s,e.some(b=>b.isUserEvent("select.pointer")))}finally{this.updateState=0}if(l.startState.facet(Od)!=l.state.facet(Od)&&(this.viewState.mustMeasureContent=!0),(s||o||T||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),!l.empty)for(let b of this.state.facet(LT))try{b(l)}catch(y){Pn(this.state,y,"update listener")}(p||m)&&Promise.resolve().then(()=>{p&&this.state==p.startState&&this.dispatch(p),m&&!LO(this,m)&&g.force&&ac(this.contentDOM,g.key,g.keyCode)})}setState(e){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=e;return}this.updateState=2;let s=this.hasFocus;try{for(let o of this.plugins)o.destroy(this);this.viewState=new tw(e),this.plugins=e.facet(xa).map(o=>new n_(o)),this.pluginMap.clear();for(let o of this.plugins)o.update(this);this.docView.destroy(),this.docView=new DC(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}s&&this.focus(),this.requestMeasure()}updatePlugins(e){let s=e.startState.facet(xa),o=e.state.facet(xa);if(s!=o){let l=[];for(let a of o){let h=s.indexOf(a);if(h<0)l.push(new n_(a));else{let d=this.plugins[h];d.mustUpdate=e,l.push(d)}}for(let a of this.plugins)a.mustUpdate!=e&&a.destroy(this);this.plugins=l,this.pluginMap.clear()}else for(let l of this.plugins)l.mustUpdate=e;for(let l=0;l<this.plugins.length;l++)this.plugins[l].update(this);s!=o&&this.inputState.ensureHandlers(this.plugins)}measure(e=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey){this.measureScheduled=-1,this.requestMeasure();return}this.measureScheduled=0,e&&this.observer.forceFlush();let s=null,o=this.scrollDOM,l=o.scrollTop*this.scaleY,{scrollAnchorPos:a,scrollAnchorHeight:h}=this.viewState;Math.abs(l-this.viewState.scrollTop)>1&&(h=-1),this.viewState.scrollAnchorHeight=-1;try{for(let d=0;;d++){if(h<0)if(z0(o))a=-1,h=this.viewState.heightMap.height;else{let y=this.viewState.scrollAnchorAt(l);a=y.from,h=y.top}this.updateState=1;let p=this.viewState.measure(this);if(!p&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(d>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let g=[];p&4||([this.measureRequests,g]=[g,this.measureRequests]);let m=g.map(y=>{try{return y.read(this)}catch(C){return Pn(this.state,C),nw}}),T=Tp.create(this,this.state,[]),b=!1;T.flags|=p,s?s.flags|=p:s=T,this.updateState=2,T.empty||(this.updatePlugins(T),this.inputState.update(T),this.updateAttrs(),b=this.docView.update(T));for(let y=0;y<g.length;y++)if(m[y]!=nw)try{let C=g[y];C.write&&C.write(m[y],this)}catch(C){Pn(this.state,C)}if(b&&this.docView.updateSelection(!0),!T.viewportChanged&&this.measureRequests.length==0){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,h=-1;continue}else{let C=(a<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(a).top)-h;if(C>1||C<-1){l=l+C,o.scrollTop=l/this.scaleY,h=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(s&&!s.empty)for(let d of this.state.facet(LT))d(s)}get themeClasses(){return PT+" "+(this.state.facet(DT)?RO:AO)+" "+this.state.facet(Od)}updateAttrs(){let e=rw(this,pO,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),s={spellcheck:"false",autocorrect:"off",autocapitalize:"off",translate:"no",contenteditable:this.state.facet(Xp)?"true":"false",class:"cm-content",style:`${Dt.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(s["aria-readonly"]="true"),rw(this,Fb,s);let o=this.observer.ignore(()=>{let l=kT(this.contentDOM,this.contentAttrs,s),a=kT(this.dom,this.editorAttrs,e);return l||a});return this.editorAttrs=e,this.contentAttrs=s,o}showAnnouncements(e){let s=!0;for(let o of e)for(let l of o.effects)if(l.is(oe.announce)){s&&(this.announceDOM.textContent=""),s=!1;let a=this.announceDOM.appendChild(document.createElement("div"));a.textContent=l.value}}mountStyles(){this.styleModules=this.state.facet(Da);let e=this.state.facet(oe.cspNonce);gc.mount(this.root,this.styleModules.concat(r1).reverse(),e?{nonce:e}:void 0)}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(e){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),e){if(this.measureRequests.indexOf(e)>-1)return;if(e.key!=null){for(let s=0;s<this.measureRequests.length;s++)if(this.measureRequests[s].key===e.key){this.measureRequests[s]=e;return}}this.measureRequests.push(e)}}plugin(e){let s=this.pluginMap.get(e);return(s===void 0||s&&s.spec!=e)&&this.pluginMap.set(e,s=this.plugins.find(o=>o.spec==e)||null),s&&s.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(e){return this.readMeasured(),this.viewState.elementAtHeight(e)}lineBlockAtHeight(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,s,o){return l_(this,e,VC(this,e,s,o))}moveByGroup(e,s){return l_(this,e,VC(this,e,s,o=>kD(this,e.head,o)))}visualLineSide(e,s){let o=this.bidiSpans(e),l=this.textDirectionAt(e.from),a=o[s?o.length-1:0];return xt.cursor(a.side(s,l)+e.from,a.forward(!s,l)?1:-1)}moveToLineBoundary(e,s,o=!0){return wD(this,e,s,o)}moveVertically(e,s,o){return l_(this,e,OD(this,e,s,o))}domAtPos(e){return this.docView.domAtPos(e)}posAtDOM(e,s=0){return this.docView.posFromDOM(e,s)}posAtCoords(e,s=!0){return this.readMeasured(),bO(this,e,s)}coordsAtPos(e,s=1){this.readMeasured();let o=this.docView.coordsAt(e,s);if(!o||o.left==o.right)return o;let l=this.state.doc.lineAt(e),a=this.bidiSpans(l),h=a[Rn.find(a,e-l.from,-1,s)];return Mb(o,h.dir==ti.LTR==s>0)}coordsForChar(e){return this.readMeasured(),this.docView.coordsForChar(e)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(e){return!this.state.facet(dO)||e<this.viewport.from||e>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(e))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>$1)return oO(e.length);let s=this.textDirectionAt(e.from),o;for(let a of this.bidiCache)if(a.from==e.from&&a.dir==s&&(a.fresh||sO(a.isolates,o=xC(this,e))))return a.order;o||(o=xC(this,e));let l=aD(e.text,s,o);return this.bidiCache.push(new bp(e.from,e.to,s,o,!0,l)),l}get hasFocus(){var e;return(this.dom.ownerDocument.hasFocus()||Dt.safari&&((e=this.inputState)===null||e===void 0?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{G0(this.contentDOM),this.docView.updateSelection()})}setRoot(e){this._root!=e&&(this._root=e,this.observer.setWindow((e.nodeType==9?e:e.ownerDocument).defaultView||window),this.mountStyles())}destroy(){for(let e of this.plugins)e.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(e,s={}){return yd.of(new hc(typeof e=="number"?xt.cursor(e):e,s.y,s.x,s.yMargin,s.xMargin))}scrollSnapshot(){let{scrollTop:e,scrollLeft:s}=this.scrollDOM,o=this.viewState.scrollAnchorAt(e);return yd.of(new hc(xt.cursor(o.from),"start","start",o.top-e,s,!0))}static domEventHandlers(e){return Jo.define(()=>({}),{eventHandlers:e})}static domEventObservers(e){return Jo.define(()=>({}),{eventObservers:e})}static theme(e,s){let o=gc.newName(),l=[Od.of(o),Da.of(BT(`.${o}`,e))];return s&&s.dark&&l.push(DT.of(!0)),l}static baseTheme(e){return A0.lowest(Da.of(BT("."+PT,e,NO)))}static findFromDOM(e){var s;let o=e.querySelector(".cm-content"),l=o&&Me.get(o)||Me.get(e);return((s=l==null?void 0:l.rootView)===null||s===void 0?void 0:s.view)||null}}oe.styleModule=Da;oe.inputHandler=hO;oe.focusChangeEffect=uO;oe.perLineTextDirection=dO;oe.exceptionSink=aO;oe.updateListener=LT;oe.editable=Xp;oe.mouseSelectionStyle=cO;oe.dragMovesSelection=lO;oe.clickAddsSelectionRange=rO;oe.decorations=Ch;oe.outerDecorations=fO;oe.atomicRanges=Ub;oe.bidiIsolatedRanges=gO;oe.scrollMargins=mO;oe.darkTheme=DT;oe.cspNonce=Xt.define({combine:n=>n.length?n[0]:""});oe.contentAttributes=Fb;oe.editorAttributes=pO;oe.lineWrapping=oe.contentAttributes.of({class:"cm-lineWrapping"});oe.announce=Ze.define();const $1=4096,nw={};class bp{constructor(e,s,o,l,a,h){this.from=e,this.to=s,this.dir=o,this.isolates=l,this.fresh=a,this.order=h}static update(e,s){if(s.empty&&!e.some(a=>a.fresh))return e;let o=[],l=e.length?e[e.length-1].dir:ti.LTR;for(let a=Math.max(0,e.length-10);a<e.length;a++){let h=e[a];h.dir==l&&!s.touchesRange(h.from,h.to)&&o.push(new bp(s.mapPos(h.from,1),s.mapPos(h.to,-1),h.dir,h.isolates,!1,h.order))}return o}}function rw(n,e,s){for(let o=n.state.facet(e),l=o.length-1;l>=0;l--){let a=o[l],h=typeof a=="function"?a(n):a;h&&wT(h,s)}return s}const _1=!Dt.ios,lw={".cm-line":{"& ::selection":{backgroundColor:"transparent !important"},"&::selection":{backgroundColor:"transparent !important"}}};_1&&(lw[".cm-line"].caretColor="transparent !important",lw[".cm-content"]={caretColor:"transparent !important"});class Gr extends fc{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}}Gr.prototype.elementClass="";Gr.prototype.toDOM=void 0;Gr.prototype.mapMode=ts.TrackBefore;Gr.prototype.startSide=Gr.prototype.endSide=-1;Gr.prototype.point=!0;const h_=Xt.define(),ep=Xt.define(),FT=Xt.define({combine:n=>n.some(e=>e)});function T1(n){let e=[b1];return n&&n.fixed===!1&&e.push(FT.of(!0)),e}const b1=Jo.fromClass(class{constructor(n){this.view=n,this.prevViewport=n.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.gutters=n.state.facet(ep).map(e=>new aw(n,e));for(let e of this.gutters)this.dom.appendChild(e.dom);this.fixed=!n.state.facet(FT),this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),n.scrollDOM.insertBefore(this.dom,n.contentDOM)}update(n){if(this.updateGutters(n)){let e=this.prevViewport,s=n.view.viewport,o=Math.min(e.to,s.to)-Math.max(e.from,s.from);this.syncGutters(o<(s.to-s.from)*.8)}n.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight+"px"),this.view.state.facet(FT)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=n.view.viewport}syncGutters(n){let e=this.dom.nextSibling;n&&this.dom.remove();let s=pe.iter(this.view.state.facet(h_),this.view.viewport.from),o=[],l=this.gutters.map(a=>new E1(a,this.view.viewport,-this.view.documentPadding.top));for(let a of this.view.viewportLineBlocks)if(o.length&&(o=[]),Array.isArray(a.type)){let h=!0;for(let d of a.type)if(d.type==Ns.Text&&h){UT(s,o,d.from);for(let p of l)p.line(this.view,d,o);h=!1}else if(d.widget)for(let p of l)p.widget(this.view,d)}else if(a.type==Ns.Text){UT(s,o,a.from);for(let h of l)h.line(this.view,a,o)}else if(a.widget)for(let h of l)h.widget(this.view,a);for(let a of l)a.finish();n&&this.view.scrollDOM.insertBefore(this.dom,e)}updateGutters(n){let e=n.startState.facet(ep),s=n.state.facet(ep),o=n.docChanged||n.heightChanged||n.viewportChanged||!pe.eq(n.startState.facet(h_),n.state.facet(h_),n.view.viewport.from,n.view.viewport.to);if(e==s)for(let l of this.gutters)l.update(n)&&(o=!0);else{o=!0;let l=[];for(let a of s){let h=e.indexOf(a);h<0?l.push(new aw(this.view,a)):(this.gutters[h].update(n),l.push(this.gutters[h]))}for(let a of this.gutters)a.dom.remove(),l.indexOf(a)<0&&a.destroy();for(let a of l)this.dom.appendChild(a.dom);this.gutters=l}return o}destroy(){for(let n of this.gutters)n.destroy();this.dom.remove()}},{provide:n=>oe.scrollMargins.of(e=>{let s=e.plugin(n);return!s||s.gutters.length==0||!s.fixed?null:e.textDirection==ti.LTR?{left:s.dom.offsetWidth*e.scaleX}:{right:s.dom.offsetWidth*e.scaleX}})});function cw(n){return Array.isArray(n)?n:[n]}function UT(n,e,s){for(;n.value&&n.from<=s;)n.from==s&&e.push(n.value),n.next()}class E1{constructor(e,s,o){this.gutter=e,this.height=o,this.i=0,this.cursor=pe.iter(e.markers,s.from)}addElement(e,s,o){let{gutter:l}=this,a=(s.top-this.height)/e.scaleY,h=s.height/e.scaleY;if(this.i==l.elements.length){let d=new MO(e,h,a,o);l.elements.push(d),l.dom.appendChild(d.dom)}else l.elements[this.i].update(e,h,a,o);this.height=s.bottom,this.i++}line(e,s,o){let l=[];UT(this.cursor,l,s.from),o.length&&(l=l.concat(o));let a=this.gutter.config.lineMarker(e,s,l);a&&l.unshift(a);let h=this.gutter;l.length==0&&!h.config.renderEmptyElements||this.addElement(e,s,l)}widget(e,s){let o=this.gutter.config.widgetMarker(e,s.widget,s);o&&this.addElement(e,s,[o])}finish(){let e=this.gutter;for(;e.elements.length>this.i;){let s=e.elements.pop();e.dom.removeChild(s.dom),s.destroy()}}}class aw{constructor(e,s){this.view=e,this.config=s,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let o in s.domEventHandlers)this.dom.addEventListener(o,l=>{let a=l.target,h;if(a!=this.dom&&this.dom.contains(a)){for(;a.parentNode!=this.dom;)a=a.parentNode;let p=a.getBoundingClientRect();h=(p.top+p.bottom)/2}else h=l.clientY;let d=e.lineBlockAtHeight(h-e.documentTop);s.domEventHandlers[o](e,d,l)&&l.preventDefault()});this.markers=cw(s.markers(e)),s.initialSpacer&&(this.spacer=new MO(e,0,0,[s.initialSpacer(e)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(e){let s=this.markers;if(this.markers=cw(this.config.markers(e.view)),this.spacer&&this.config.updateSpacer){let l=this.config.updateSpacer(this.spacer.markers[0],e);l!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[l])}let o=e.view.viewport;return!pe.eq(this.markers,s,o.from,o.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(e):!1)}destroy(){for(let e of this.elements)e.destroy()}}class MO{constructor(e,s,o,l){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(e,s,o,l)}update(e,s,o,l){this.height!=s&&(this.height=s,this.dom.style.height=s+"px"),this.above!=o&&(this.dom.style.marginTop=(this.above=o)?o+"px":""),v1(this.markers,l)||this.setMarkers(e,l)}setMarkers(e,s){let o="cm-gutterElement",l=this.dom.firstChild;for(let a=0,h=0;;){let d=h,p=a<s.length?s[a++]:null,g=!1;if(p){let m=p.elementClass;m&&(o+=" "+m);for(let T=h;T<this.markers.length;T++)if(this.markers[T].compare(p)){d=T,g=!0;break}}else d=this.markers.length;for(;h<d;){let m=this.markers[h++];if(m.toDOM){m.destroy(l);let T=l.nextSibling;l.remove(),l=T}}if(!p)break;p.toDOM&&(g?l=l.nextSibling:this.dom.insertBefore(p.toDOM(e),l)),g&&h++}this.dom.className=o,this.markers=s}destroy(){this.setMarkers(null,[])}}function v1(n,e){if(n.length!=e.length)return!1;for(let s=0;s<n.length;s++)if(!n[s].compare(e[s]))return!1;return!0}const y1=Xt.define(),ec=Xt.define({combine(n){return Hx(n,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(e,s){let o=Object.assign({},e);for(let l in s){let a=o[l],h=s[l];o[l]=a?(d,p,g)=>a(d,p,g)||h(d,p,g):h}return o}})}});class u_ extends Gr{constructor(e){super(),this.number=e}eq(e){return this.number==e.number}toDOM(){return document.createTextNode(this.number)}}function d_(n,e){return n.state.facet(ec).formatNumber(e,n.state)}const I1=ep.compute([ec],n=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(e){return e.state.facet(y1)},lineMarker(e,s,o){return o.some(l=>l.toDOM)?null:new u_(d_(e,e.state.doc.lineAt(s.from).number))},widgetMarker:()=>null,lineMarkerChange:e=>e.startState.facet(ec)!=e.state.facet(ec),initialSpacer(e){return new u_(d_(e,hw(e.state.doc.lines)))},updateSpacer(e,s){let o=d_(s.view,hw(s.view.state.doc.lines));return o==e.number?e:new u_(o)},domEventHandlers:n.facet(ec).domEventHandlers}));function S1(n={}){return[ec.of(n),T1(),I1]}function hw(n){let e=9;for(;e<n;)e=e*10+9;return e}const C1=1024;let w1=0;class p_{constructor(e,s){this.from=e,this.to=s}}let Be=class{constructor(e={}){this.id=w1++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=Eo.match(e)),s=>{let o=e(s);return o===void 0?null:[this,o]}}};Be.closedBy=new Be({deserialize:n=>n.split(" ")});Be.openedBy=new Be({deserialize:n=>n.split(" ")});Be.group=new Be({deserialize:n=>n.split(" ")});Be.isolate=new Be({deserialize:n=>{if(n&&n!="rtl"&&n!="ltr"&&n!="auto")throw new RangeError("Invalid value for isolate: "+n);return n||"auto"}});Be.contextHash=new Be({perNode:!0});Be.lookAhead=new Be({perNode:!0});Be.mounted=new Be({perNode:!0});let Ep=class{constructor(e,s,o){this.tree=e,this.overlay=s,this.parser=o}static get(e){return e&&e.props&&e.props[Be.mounted.id]}};const k1=Object.create(null);let Eo=class xO{constructor(e,s,o,l=0){this.name=e,this.props=s,this.id=o,this.flags=l}static define(e){let s=e.props&&e.props.length?Object.create(null):k1,o=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),l=new xO(e.name||"",s,e.id,o);if(e.props){for(let a of e.props)if(Array.isArray(a)||(a=a(l)),a){if(a[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");s[a[0].id]=a[1]}}return l}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let s=this.prop(Be.group);return s?s.indexOf(e)>-1:!1}return this.id==e}static match(e){let s=Object.create(null);for(let o in e)for(let l of o.split(" "))s[l]=e[o];return o=>{for(let l=o.prop(Be.group),a=-1;a<(l?l.length:0);a++){let h=s[a<0?o.name:l[a]];if(h)return h}}}};Eo.none=new Eo("",Object.create(null),0,8);const Ad=new WeakMap,uw=new WeakMap;var ci;(function(n){n[n.ExcludeBuffers=1]="ExcludeBuffers",n[n.IncludeAnonymous=2]="IncludeAnonymous",n[n.IgnoreMounts=4]="IgnoreMounts",n[n.IgnoreOverlays=8]="IgnoreOverlays"})(ci||(ci={}));let ss=class HT{constructor(e,s,o,l,a){if(this.type=e,this.children=s,this.positions=o,this.length=l,this.props=null,a&&a.length){this.props=Object.create(null);for(let[h,d]of a)this.props[typeof h=="number"?h:h.id]=d}}toString(){let e=Ep.get(this);if(e&&!e.overlay)return e.tree.toString();let s="";for(let o of this.children){let l=o.toString();l&&(s&&(s+=","),s+=l)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(s.length?"("+s+")":""):s}cursor(e=0){return new WT(this.topNode,e)}cursorAt(e,s=0,o=0){let l=Ad.get(this)||this.topNode,a=new WT(l);return a.moveTo(e,s),Ad.set(this,a._tree),a}get topNode(){return new Hn(this,0,0,null)}resolve(e,s=0){let o=wh(Ad.get(this)||this.topNode,e,s,!1);return Ad.set(this,o),o}resolveInner(e,s=0){let o=wh(uw.get(this)||this.topNode,e,s,!0);return uw.set(this,o),o}resolveStack(e,s=0){return N1(this,e,s)}iterate(e){let{enter:s,leave:o,from:l=0,to:a=this.length}=e,h=e.mode||0,d=(h&ci.IncludeAnonymous)>0;for(let p=this.cursor(h|ci.IncludeAnonymous);;){let g=!1;if(p.from<=a&&p.to>=l&&(!d&&p.type.isAnonymous||s(p)!==!1)){if(p.firstChild())continue;g=!0}for(;g&&o&&(d||!p.type.isAnonymous)&&o(p),!p.nextSibling();){if(!p.parent())return;g=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let s in this.props)e.push([+s,this.props[s]]);return e}balance(e={}){return this.children.length<=8?this:Gb(Eo.none,this.children,this.positions,0,this.children.length,0,this.length,(s,o,l)=>new HT(this.type,s,o,l,this.propValues),e.makeTree||((s,o,l)=>new HT(Eo.none,s,o,l)))}static build(e){return L1(e)}};ss.empty=new ss(Eo.none,[],[],0);let O1=class DO{constructor(e,s){this.buffer=e,this.index=s}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new DO(this.buffer,this.index)}},_c=class PO{constructor(e,s,o){this.buffer=e,this.length=s,this.set=o}get type(){return Eo.none}toString(){let e=[];for(let s=0;s<this.buffer.length;)e.push(this.childString(s)),s=this.buffer[s+3];return e.join(",")}childString(e){let s=this.buffer[e],o=this.buffer[e+3],l=this.set.types[s],a=l.name;if(/\W/.test(a)&&!l.isError&&(a=JSON.stringify(a)),e+=4,o==e)return a;let h=[];for(;e<o;)h.push(this.childString(e)),e=this.buffer[e+3];return a+"("+h.join(",")+")"}findChild(e,s,o,l,a){let{buffer:h}=this,d=-1;for(let p=e;p!=s&&!(BO(a,l,h[p+1],h[p+2])&&(d=p,o>0));p=h[p+3]);return d}slice(e,s,o){let l=this.buffer,a=new Uint16Array(s-e),h=0;for(let d=e,p=0;d<s;){a[p++]=l[d++],a[p++]=l[d++]-o;let g=a[p++]=l[d++]-o;a[p++]=l[d++]-e,h=Math.max(h,g)}return new PO(a,h,this.set)}};function BO(n,e,s,o){switch(n){case-2:return s<e;case-1:return o>=e&&s<e;case 0:return s<e&&o>e;case 1:return s<=e&&o>e;case 2:return o>e;case 4:return!0}}function wh(n,e,s,o){for(var l;n.from==n.to||(s<1?n.from>=e:n.from>e)||(s>-1?n.to<=e:n.to<e);){let h=!o&&n instanceof Hn&&n.index<0?null:n.parent;if(!h)return n;n=h}let a=o?0:ci.IgnoreOverlays;if(o)for(let h=n,d=h.parent;d;h=d,d=h.parent)h instanceof Hn&&h.index<0&&((l=d.enter(e,s,a))===null||l===void 0?void 0:l.from)!=h.from&&(n=d);for(;;){let h=n.enter(e,s,a);if(!h)return n;n=h}}let FO=class{cursor(e=0){return new WT(this,e)}getChild(e,s=null,o=null){let l=dw(this,e,s,o);return l.length?l[0]:null}getChildren(e,s=null,o=null){return dw(this,e,s,o)}resolve(e,s=0){return wh(this,e,s,!1)}resolveInner(e,s=0){return wh(this,e,s,!0)}matchContext(e){return VT(this,e)}enterUnfinishedNodesBefore(e){let s=this.childBefore(e),o=this;for(;s;){let l=s.lastChild;if(!l||l.to!=s.to)break;l.type.isError&&l.from==l.to?(o=s,s=l.prevSibling):s=l}return o}get node(){return this}get next(){return this.parent}},Hn=class ip extends FO{constructor(e,s,o,l){super(),this._tree=e,this.from=s,this.index=o,this._parent=l}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,s,o,l,a=0){for(let h=this;;){for(let{children:d,positions:p}=h._tree,g=s>0?d.length:-1;e!=g;e+=s){let m=d[e],T=p[e]+h.from;if(BO(l,o,T,T+m.length)){if(m instanceof _c){if(a&ci.ExcludeBuffers)continue;let b=m.findChild(0,m.buffer.length,s,o-T,l);if(b>-1)return new GT(new A1(h,m,e,T),null,b)}else if(a&ci.IncludeAnonymous||!m.type.isAnonymous||Vb(m)){let b;if(!(a&ci.IgnoreMounts)&&(b=Ep.get(m))&&!b.overlay)return new ip(b.tree,T,e,h);let y=new ip(m,T,e,h);return a&ci.IncludeAnonymous||!y.type.isAnonymous?y:y.nextChild(s<0?m.children.length-1:0,s,o,l)}}}if(a&ci.IncludeAnonymous||!h.type.isAnonymous||(h.index>=0?e=h.index+s:e=s<0?-1:h._parent._tree.children.length,h=h._parent,!h))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(e,s,o=0){let l;if(!(o&ci.IgnoreOverlays)&&(l=Ep.get(this._tree))&&l.overlay){let a=e-this.from;for(let{from:h,to:d}of l.overlay)if((s>0?h<=a:h<a)&&(s<0?d>=a:d>a))return new ip(l.tree,l.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,s,o)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}};function dw(n,e,s,o){let l=n.cursor(),a=[];if(!l.firstChild())return a;if(s!=null){for(let h=!1;!h;)if(h=l.type.is(s),!l.nextSibling())return a}for(;;){if(o!=null&&l.type.is(o))return a;if(l.type.is(e)&&a.push(l.node),!l.nextSibling())return o==null?a:[]}}function VT(n,e,s=e.length-1){for(let o=n.parent;s>=0;o=o.parent){if(!o)return!1;if(!o.type.isAnonymous){if(e[s]&&e[s]!=o.name)return!1;s--}}return!0}let A1=class{constructor(e,s,o,l){this.parent=e,this.buffer=s,this.index=o,this.start=l}},GT=class Fa extends FO{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,s,o){super(),this.context=e,this._parent=s,this.index=o,this.type=e.buffer.set.types[e.buffer.buffer[o]]}child(e,s,o){let{buffer:l}=this.context,a=l.findChild(this.index+4,l.buffer[this.index+3],e,s-this.context.start,o);return a<0?null:new Fa(this.context,this,a)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,s,o=0){if(o&ci.ExcludeBuffers)return null;let{buffer:l}=this.context,a=l.findChild(this.index+4,l.buffer[this.index+3],s>0?1:-1,e-this.context.start,s);return a<0?null:new Fa(this.context,this,a)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,s=e.buffer[this.index+3];return s<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new Fa(this.context,this._parent,s):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,s=this._parent?this._parent.index+4:0;return this.index==s?this.externalSibling(-1):new Fa(this.context,this._parent,e.findChild(s,this.index,-1,0,4))}get tree(){return null}toTree(){let e=[],s=[],{buffer:o}=this.context,l=this.index+4,a=o.buffer[this.index+3];if(a>l){let h=o.buffer[this.index+1];e.push(o.slice(l,a,h)),s.push(0)}return new ss(this.type,e,s,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}};function UO(n){if(!n.length)return null;let e=0,s=n[0];for(let a=1;a<n.length;a++){let h=n[a];(h.from>s.from||h.to<s.to)&&(s=h,e=a)}let o=s instanceof Hn&&s.index<0?null:s.parent,l=n.slice();return o?l[e]=o:l.splice(e,1),new R1(l,s)}let R1=class{constructor(e,s){this.heads=e,this.node=s}get next(){return UO(this.heads)}};function N1(n,e,s){let o=n.resolveInner(e,s),l=null;for(let a=o instanceof Hn?o:o.context.parent;a;a=a.parent)if(a.index<0){let h=a.parent;(l||(l=[o])).push(h.resolve(e,s)),a=h}else{let h=Ep.get(a.tree);if(h&&h.overlay&&h.overlay[0].from<=e&&h.overlay[h.overlay.length-1].to>=e){let d=new Hn(h.tree,h.overlay[0].from+a.from,-1,a);(l||(l=[o])).push(wh(d,e,s,!1))}}return l?UO(l):o}let WT=class{get name(){return this.type.name}constructor(e,s=0){if(this.mode=s,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof Hn)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let o=e._parent;o;o=o._parent)this.stack.unshift(o.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return e?(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0):!1}yieldBuf(e,s){this.index=e;let{start:o,buffer:l}=this.buffer;return this.type=s||l.set.types[l.buffer[e]],this.from=o+l.buffer[e+1],this.to=o+l.buffer[e+2],!0}yield(e){return e?e instanceof Hn?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,s,o){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,s,o,this.mode));let{buffer:l}=this.buffer,a=l.findChild(this.index+4,l.buffer[this.index+3],e,s-this.buffer.start,o);return a<0?!1:(this.stack.push(this.index),this.yieldBuf(a))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,s,o=this.mode){return this.buffer?o&ci.ExcludeBuffers?!1:this.enterChild(1,e,s):this.yield(this._tree.enter(e,s,o))}parent(){if(!this.buffer)return this.yieldNode(this.mode&ci.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&ci.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode)):!1;let{buffer:s}=this.buffer,o=this.stack.length-1;if(e<0){let l=o<0?0:this.stack[o]+4;if(this.index!=l)return this.yieldBuf(s.findChild(l,this.index,-1,0,4))}else{let l=s.buffer[this.index+3];if(l<(o<0?s.buffer.length:s.buffer[this.stack[o]+3]))return this.yieldBuf(l)}return o<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let s,o,{buffer:l}=this;if(l){if(e>0){if(this.index<l.buffer.buffer.length)return!1}else for(let a=0;a<this.index;a++)if(l.buffer.buffer[a+3]<this.index)return!1;({index:s,parent:o}=l)}else({index:s,_parent:o}=this._tree);for(;o;{index:s,_parent:o}=o)if(s>-1)for(let a=s+e,h=e<0?-1:o._tree.children.length;a!=h;a+=e){let d=o._tree.children[a];if(this.mode&ci.IncludeAnonymous||d instanceof _c||!d.type.isAnonymous||Vb(d))return!1}return!0}move(e,s){if(s&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,s=0){for(;(this.from==this.to||(s<1?this.from>=e:this.from>e)||(s>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,s););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,s=null,o=0;if(e&&e.context==this.buffer)t:for(let l=this.index,a=this.stack.length;a>=0;){for(let h=e;h;h=h._parent)if(h.index==l){if(l==this.index)return h;s=h,o=a+1;break t}l=this.stack[--a]}for(let l=o;l<this.stack.length;l++)s=new GT(this.buffer,s,this.stack[l]);return this.bufferNode=new GT(this.buffer,s,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,s){for(let o=0;;){let l=!1;if(this.type.isAnonymous||e(this)!==!1){if(this.firstChild()){o++;continue}this.type.isAnonymous||(l=!0)}for(;l&&s&&s(this),l=this.type.isAnonymous,!this.nextSibling();){if(!o)return;this.parent(),o--,l=!0}}}matchContext(e){if(!this.buffer)return VT(this.node,e);let{buffer:s}=this.buffer,{types:o}=s.set;for(let l=e.length-1,a=this.stack.length-1;l>=0;a--){if(a<0)return VT(this.node,e,l);let h=o[s.buffer[this.stack[a]]];if(!h.isAnonymous){if(e[l]&&e[l]!=h.name)return!1;l--}}return!0}};function Vb(n){return n.children.some(e=>e instanceof _c||!e.type.isAnonymous||Vb(e))}function L1(n){var e;let{buffer:s,nodeSet:o,maxBufferLength:l=C1,reused:a=[],minRepeatType:h=o.types.length}=n,d=Array.isArray(s)?new O1(s,s.length):s,p=o.types,g=0,m=0;function T(Y,V,H,Tt,$t,lt){let{id:ot,start:ct,end:gt,size:vt}=d,it=m;for(;vt<0;)if(d.next(),vt==-1){let Lt=a[ot];H.push(Lt),Tt.push(ct-Y);return}else if(vt==-3){g=ot;return}else if(vt==-4){m=ot;return}else throw new RangeError(`Unrecognized record size: ${vt}`);let Ft=p[ot],Rt,Nt,me=ct-Y;if(gt-ct<=l&&(Nt=A(d.pos-V,$t))){let Lt=new Uint16Array(Nt.size-Nt.skip),Gt=d.pos-Nt.size,Ht=Lt.length;for(;d.pos>Gt;)Ht=F(Nt.start,Lt,Ht);Rt=new _c(Lt,gt-Nt.start,o),me=Nt.start-Y}else{let Lt=d.pos-vt;d.next();let Gt=[],Ht=[],fe=ot>=h?ot:-1,ut=0,be=gt;for(;d.pos>Lt;)fe>=0&&d.id==fe&&d.size>=0?(d.end<=be-l&&(C(Gt,Ht,ct,ut,d.end,be,fe,it),ut=Gt.length,be=d.end),d.next()):lt>2500?b(ct,Lt,Gt,Ht):T(ct,Lt,Gt,Ht,fe,lt+1);if(fe>=0&&ut>0&&ut<Gt.length&&C(Gt,Ht,ct,ut,ct,be,fe,it),Gt.reverse(),Ht.reverse(),fe>-1&&ut>0){let _e=y(Ft);Rt=Gb(Ft,Gt,Ht,0,Gt.length,0,gt-ct,_e,_e)}else Rt=L(Ft,Gt,Ht,gt-ct,it-gt)}H.push(Rt),Tt.push(me)}function b(Y,V,H,Tt){let $t=[],lt=0,ot=-1;for(;d.pos>V;){let{id:ct,start:gt,end:vt,size:it}=d;if(it>4)d.next();else{if(ot>-1&&gt<ot)break;ot<0&&(ot=vt-l),$t.push(ct,gt,vt),lt++,d.next()}}if(lt){let ct=new Uint16Array(lt*4),gt=$t[$t.length-2];for(let vt=$t.length-3,it=0;vt>=0;vt-=3)ct[it++]=$t[vt],ct[it++]=$t[vt+1]-gt,ct[it++]=$t[vt+2]-gt,ct[it++]=it;H.push(new _c(ct,$t[2]-gt,o)),Tt.push(gt-Y)}}function y(Y){return(V,H,Tt)=>{let $t=0,lt=V.length-1,ot,ct;if(lt>=0&&(ot=V[lt])instanceof ss){if(!lt&&ot.type==Y&&ot.length==Tt)return ot;(ct=ot.prop(Be.lookAhead))&&($t=H[lt]+ot.length+ct)}return L(Y,V,H,Tt,$t)}}function C(Y,V,H,Tt,$t,lt,ot,ct){let gt=[],vt=[];for(;Y.length>Tt;)gt.push(Y.pop()),vt.push(V.pop()+H-$t);Y.push(L(o.types[ot],gt,vt,lt-$t,ct-lt)),V.push($t-H)}function L(Y,V,H,Tt,$t=0,lt){if(g){let ot=[Be.contextHash,g];lt=lt?[ot].concat(lt):[ot]}if($t>25){let ot=[Be.lookAhead,$t];lt=lt?[ot].concat(lt):[ot]}return new ss(Y,V,H,Tt,lt)}function A(Y,V){let H=d.fork(),Tt=0,$t=0,lt=0,ot=H.end-l,ct={size:0,start:0,skip:0};t:for(let gt=H.pos-Y;H.pos>gt;){let vt=H.size;if(H.id==V&&vt>=0){ct.size=Tt,ct.start=$t,ct.skip=lt,lt+=4,Tt+=4,H.next();continue}let it=H.pos-vt;if(vt<0||it<gt||H.start<ot)break;let Ft=H.id>=h?4:0,Rt=H.start;for(H.next();H.pos>it;){if(H.size<0)if(H.size==-3)Ft+=4;else break t;else H.id>=h&&(Ft+=4);H.next()}$t=Rt,Tt+=vt,lt+=Ft}return(V<0||Tt==Y)&&(ct.size=Tt,ct.start=$t,ct.skip=lt),ct.size>4?ct:void 0}function F(Y,V,H){let{id:Tt,start:$t,end:lt,size:ot}=d;if(d.next(),ot>=0&&Tt<h){let ct=H;if(ot>4){let gt=d.pos-(ot-4);for(;d.pos>gt;)H=F(Y,V,H)}V[--H]=ct,V[--H]=lt-Y,V[--H]=$t-Y,V[--H]=Tt}else ot==-3?g=Tt:ot==-4&&(m=Tt);return H}let z=[],X=[];for(;d.pos>0;)T(n.start||0,n.bufferStart||0,z,X,-1,0);let K=(e=n.length)!==null&&e!==void 0?e:z.length?X[0]+z[0].length:0;return new ss(p[n.topID],z.reverse(),X.reverse(),K)}const pw=new WeakMap;function sp(n,e){if(!n.isAnonymous||e instanceof _c||e.type!=n)return 1;let s=pw.get(e);if(s==null){s=1;for(let o of e.children){if(o.type!=n||!(o instanceof ss)){s=1;break}s+=sp(n,o)}pw.set(e,s)}return s}function Gb(n,e,s,o,l,a,h,d,p){let g=0;for(let C=o;C<l;C++)g+=sp(n,e[C]);let m=Math.ceil(g*1.5/8),T=[],b=[];function y(C,L,A,F,z){for(let X=A;X<F;){let K=X,Y=L[X],V=sp(n,C[X]);for(X++;X<F;X++){let H=sp(n,C[X]);if(V+H>=m)break;V+=H}if(X==K+1){if(V>m){let H=C[K];y(H.children,H.positions,0,H.children.length,L[K]+z);continue}T.push(C[K])}else{let H=L[X-1]+C[X-1].length-Y;T.push(Gb(n,C,L,K,X,Y,H,null,p))}b.push(Y+z-a)}}return y(e,s,o,l,0),(d||p)(T,b,h)}class Fr{constructor(e,s,o,l,a=!1,h=!1){this.from=e,this.to=s,this.tree=o,this.offset=l,this.open=(a?1:0)|(h?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(e,s=[],o=!1){let l=[new Fr(0,e.length,e,0,!1,o)];for(let a of s)a.to>e.length&&l.push(a);return l}static applyChanges(e,s,o=128){if(!s.length)return e;let l=[],a=1,h=e.length?e[0]:null;for(let d=0,p=0,g=0;;d++){let m=d<s.length?s[d]:null,T=m?m.fromA:1e9;if(T-p>=o)for(;h&&h.from<T;){let b=h;if(p>=b.from||T<=b.to||g){let y=Math.max(b.from,p)-g,C=Math.min(b.to,T)-g;b=y>=C?null:new Fr(y,C,b.tree,b.offset+g,d>0,!!m)}if(b&&l.push(b),h.to>T)break;h=a<e.length?e[a++]:null}if(!m)break;p=m.toA,g=m.toA-m.toB}return l}}class M1{startParse(e,s,o){return typeof e=="string"&&(e=new x1(e)),o=o?o.length?o.map(l=>new p_(l.from,l.to)):[new p_(0,0)]:[new p_(0,e.length)],this.createParse(e,s||[],o)}parse(e,s,o){let l=this.startParse(e,s,o);for(;;){let a=l.advance();if(a)return a}}}class x1{constructor(e){this.string=e}get length(){return this.string.length}chunk(e){return this.string.slice(e)}get lineChunks(){return!1}read(e,s){return this.string.slice(e,s)}}new Be({perNode:!0});const D1=1024;let P1=0;class Ue{constructor(e={}){this.id=P1++,this.perNode=!!e.perNode,this.deserialize=e.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(e){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof e!="function"&&(e=qo.match(e)),s=>{let o=e(s);return o===void 0?null:[this,o]}}}Ue.closedBy=new Ue({deserialize:n=>n.split(" ")});Ue.openedBy=new Ue({deserialize:n=>n.split(" ")});Ue.group=new Ue({deserialize:n=>n.split(" ")});Ue.isolate=new Ue({deserialize:n=>{if(n&&n!="rtl"&&n!="ltr"&&n!="auto")throw new RangeError("Invalid value for isolate: "+n);return n||"auto"}});Ue.contextHash=new Ue({perNode:!0});Ue.lookAhead=new Ue({perNode:!0});Ue.mounted=new Ue({perNode:!0});class vp{constructor(e,s,o){this.tree=e,this.overlay=s,this.parser=o}static get(e){return e&&e.props&&e.props[Ue.mounted.id]}}const B1=Object.create(null);class qo{constructor(e,s,o,l=0){this.name=e,this.props=s,this.id=o,this.flags=l}static define(e){let s=e.props&&e.props.length?Object.create(null):B1,o=(e.top?1:0)|(e.skipped?2:0)|(e.error?4:0)|(e.name==null?8:0),l=new qo(e.name||"",s,e.id,o);if(e.props){for(let a of e.props)if(Array.isArray(a)||(a=a(l)),a){if(a[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");s[a[0].id]=a[1]}}return l}prop(e){return this.props[e.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(e){if(typeof e=="string"){if(this.name==e)return!0;let s=this.prop(Ue.group);return s?s.indexOf(e)>-1:!1}return this.id==e}static match(e){let s=Object.create(null);for(let o in e)for(let l of o.split(" "))s[l]=e[o];return o=>{for(let l=o.prop(Ue.group),a=-1;a<(l?l.length:0);a++){let h=s[a<0?o.name:l[a]];if(h)return h}}}}qo.none=new qo("",Object.create(null),0,8);const Rd=new WeakMap,fw=new WeakMap;var pi;(function(n){n[n.ExcludeBuffers=1]="ExcludeBuffers",n[n.IncludeAnonymous=2]="IncludeAnonymous",n[n.IgnoreMounts=4]="IgnoreMounts",n[n.IgnoreOverlays=8]="IgnoreOverlays"})(pi||(pi={}));class mo{constructor(e,s,o,l,a){if(this.type=e,this.children=s,this.positions=o,this.length=l,this.props=null,a&&a.length){this.props=Object.create(null);for(let[h,d]of a)this.props[typeof h=="number"?h:h.id]=d}}toString(){let e=vp.get(this);if(e&&!e.overlay)return e.tree.toString();let s="";for(let o of this.children){let l=o.toString();l&&(s&&(s+=","),s+=l)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(s.length?"("+s+")":""):s}cursor(e=0){return new XT(this.topNode,e)}cursorAt(e,s=0,o=0){let l=Rd.get(this)||this.topNode,a=new XT(l);return a.moveTo(e,s),Rd.set(this,a._tree),a}get topNode(){return new gs(this,0,0,null)}resolve(e,s=0){let o=kh(Rd.get(this)||this.topNode,e,s,!1);return Rd.set(this,o),o}resolveInner(e,s=0){let o=kh(fw.get(this)||this.topNode,e,s,!0);return fw.set(this,o),o}resolveStack(e,s=0){return H1(this,e,s)}iterate(e){let{enter:s,leave:o,from:l=0,to:a=this.length}=e,h=e.mode||0,d=(h&pi.IncludeAnonymous)>0;for(let p=this.cursor(h|pi.IncludeAnonymous);;){let g=!1;if(p.from<=a&&p.to>=l&&(!d&&p.type.isAnonymous||s(p)!==!1)){if(p.firstChild())continue;g=!0}for(;g&&o&&(d||!p.type.isAnonymous)&&o(p),!p.nextSibling();){if(!p.parent())return;g=!0}}}prop(e){return e.perNode?this.props?this.props[e.id]:void 0:this.type.prop(e)}get propValues(){let e=[];if(this.props)for(let s in this.props)e.push([+s,this.props[s]]);return e}balance(e={}){return this.children.length<=8?this:Xb(qo.none,this.children,this.positions,0,this.children.length,0,this.length,(s,o,l)=>new mo(this.type,s,o,l,this.propValues),e.makeTree||((s,o,l)=>new mo(qo.none,s,o,l)))}static build(e){return V1(e)}}mo.empty=new mo(qo.none,[],[],0);class Wb{constructor(e,s){this.buffer=e,this.index=s}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new Wb(this.buffer,this.index)}}class Vn{constructor(e,s,o){this.buffer=e,this.length=s,this.set=o}get type(){return qo.none}toString(){let e=[];for(let s=0;s<this.buffer.length;)e.push(this.childString(s)),s=this.buffer[s+3];return e.join(",")}childString(e){let s=this.buffer[e],o=this.buffer[e+3],l=this.set.types[s],a=l.name;if(/\W/.test(a)&&!l.isError&&(a=JSON.stringify(a)),e+=4,o==e)return a;let h=[];for(;e<o;)h.push(this.childString(e)),e=this.buffer[e+3];return a+"("+h.join(",")+")"}findChild(e,s,o,l,a){let{buffer:h}=this,d=-1;for(let p=e;p!=s&&!(HO(a,l,h[p+1],h[p+2])&&(d=p,o>0));p=h[p+3]);return d}slice(e,s,o){let l=this.buffer,a=new Uint16Array(s-e),h=0;for(let d=e,p=0;d<s;){a[p++]=l[d++],a[p++]=l[d++]-o;let g=a[p++]=l[d++]-o;a[p++]=l[d++]-e,h=Math.max(h,g)}return new Vn(a,h,this.set)}}function HO(n,e,s,o){switch(n){case-2:return s<e;case-1:return o>=e&&s<e;case 0:return s<e&&o>e;case 1:return s<=e&&o>e;case 2:return o>e;case 4:return!0}}function kh(n,e,s,o){for(var l;n.from==n.to||(s<1?n.from>=e:n.from>e)||(s>-1?n.to<=e:n.to<e);){let h=!o&&n instanceof gs&&n.index<0?null:n.parent;if(!h)return n;n=h}let a=o?0:pi.IgnoreOverlays;if(o)for(let h=n,d=h.parent;d;h=d,d=h.parent)h instanceof gs&&h.index<0&&((l=d.enter(e,s,a))===null||l===void 0?void 0:l.from)!=h.from&&(n=d);for(;;){let h=n.enter(e,s,a);if(!h)return n;n=h}}class VO{cursor(e=0){return new XT(this,e)}getChild(e,s=null,o=null){let l=gw(this,e,s,o);return l.length?l[0]:null}getChildren(e,s=null,o=null){return gw(this,e,s,o)}resolve(e,s=0){return kh(this,e,s,!1)}resolveInner(e,s=0){return kh(this,e,s,!0)}matchContext(e){return zT(this,e)}enterUnfinishedNodesBefore(e){let s=this.childBefore(e),o=this;for(;s;){let l=s.lastChild;if(!l||l.to!=s.to)break;l.type.isError&&l.from==l.to?(o=s,s=l.prevSibling):s=l}return o}get node(){return this}get next(){return this.parent}}class gs extends VO{constructor(e,s,o,l){super(),this._tree=e,this.from=s,this.index=o,this._parent=l}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(e,s,o,l,a=0){for(let h=this;;){for(let{children:d,positions:p}=h._tree,g=s>0?d.length:-1;e!=g;e+=s){let m=d[e],T=p[e]+h.from;if(HO(l,o,T,T+m.length)){if(m instanceof Vn){if(a&pi.ExcludeBuffers)continue;let b=m.findChild(0,m.buffer.length,s,o-T,l);if(b>-1)return new Nn(new F1(h,m,e,T),null,b)}else if(a&pi.IncludeAnonymous||!m.type.isAnonymous||zb(m)){let b;if(!(a&pi.IgnoreMounts)&&(b=vp.get(m))&&!b.overlay)return new gs(b.tree,T,e,h);let y=new gs(m,T,e,h);return a&pi.IncludeAnonymous||!y.type.isAnonymous?y:y.nextChild(s<0?m.children.length-1:0,s,o,l)}}}if(a&pi.IncludeAnonymous||!h.type.isAnonymous||(h.index>=0?e=h.index+s:e=s<0?-1:h._parent._tree.children.length,h=h._parent,!h))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(e){return this.nextChild(0,1,e,2)}childBefore(e){return this.nextChild(this._tree.children.length-1,-1,e,-2)}enter(e,s,o=0){let l;if(!(o&pi.IgnoreOverlays)&&(l=vp.get(this._tree))&&l.overlay){let a=e-this.from;for(let{from:h,to:d}of l.overlay)if((s>0?h<=a:h<a)&&(s<0?d>=a:d>a))return new gs(l.tree,l.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,e,s,o)}nextSignificantParent(){let e=this;for(;e.type.isAnonymous&&e._parent;)e=e._parent;return e}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function gw(n,e,s,o){let l=n.cursor(),a=[];if(!l.firstChild())return a;if(s!=null){for(let h=!1;!h;)if(h=l.type.is(s),!l.nextSibling())return a}for(;;){if(o!=null&&l.type.is(o))return a;if(l.type.is(e)&&a.push(l.node),!l.nextSibling())return o==null?a:[]}}function zT(n,e,s=e.length-1){for(let o=n.parent;s>=0;o=o.parent){if(!o)return!1;if(!o.type.isAnonymous){if(e[s]&&e[s]!=o.name)return!1;s--}}return!0}class F1{constructor(e,s,o,l){this.parent=e,this.buffer=s,this.index=o,this.start=l}}class Nn extends VO{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(e,s,o){super(),this.context=e,this._parent=s,this.index=o,this.type=e.buffer.set.types[e.buffer.buffer[o]]}child(e,s,o){let{buffer:l}=this.context,a=l.findChild(this.index+4,l.buffer[this.index+3],e,s-this.context.start,o);return a<0?null:new Nn(this.context,this,a)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(e){return this.child(1,e,2)}childBefore(e){return this.child(-1,e,-2)}enter(e,s,o=0){if(o&pi.ExcludeBuffers)return null;let{buffer:l}=this.context,a=l.findChild(this.index+4,l.buffer[this.index+3],s>0?1:-1,e-this.context.start,s);return a<0?null:new Nn(this.context,this,a)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(e){return this._parent?null:this.context.parent.nextChild(this.context.index+e,e,0,4)}get nextSibling(){let{buffer:e}=this.context,s=e.buffer[this.index+3];return s<(this._parent?e.buffer[this._parent.index+3]:e.buffer.length)?new Nn(this.context,this._parent,s):this.externalSibling(1)}get prevSibling(){let{buffer:e}=this.context,s=this._parent?this._parent.index+4:0;return this.index==s?this.externalSibling(-1):new Nn(this.context,this._parent,e.findChild(s,this.index,-1,0,4))}get tree(){return null}toTree(){let e=[],s=[],{buffer:o}=this.context,l=this.index+4,a=o.buffer[this.index+3];if(a>l){let h=o.buffer[this.index+1];e.push(o.slice(l,a,h)),s.push(0)}return new mo(this.type,e,s,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function GO(n){if(!n.length)return null;let e=0,s=n[0];for(let a=1;a<n.length;a++){let h=n[a];(h.from>s.from||h.to<s.to)&&(s=h,e=a)}let o=s instanceof gs&&s.index<0?null:s.parent,l=n.slice();return o?l[e]=o:l.splice(e,1),new U1(l,s)}class U1{constructor(e,s){this.heads=e,this.node=s}get next(){return GO(this.heads)}}function H1(n,e,s){let o=n.resolveInner(e,s),l=null;for(let a=o instanceof gs?o:o.context.parent;a;a=a.parent)if(a.index<0){let h=a.parent;(l||(l=[o])).push(h.resolve(e,s)),a=h}else{let h=vp.get(a.tree);if(h&&h.overlay&&h.overlay[0].from<=e&&h.overlay[h.overlay.length-1].to>=e){let d=new gs(h.tree,h.overlay[0].from+a.from,-1,a);(l||(l=[o])).push(kh(d,e,s,!1))}}return l?GO(l):o}class XT{get name(){return this.type.name}constructor(e,s=0){if(this.mode=s,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,e instanceof gs)this.yieldNode(e);else{this._tree=e.context.parent,this.buffer=e.context;for(let o=e._parent;o;o=o._parent)this.stack.unshift(o.index);this.bufferNode=e,this.yieldBuf(e.index)}}yieldNode(e){return e?(this._tree=e,this.type=e.type,this.from=e.from,this.to=e.to,!0):!1}yieldBuf(e,s){this.index=e;let{start:o,buffer:l}=this.buffer;return this.type=s||l.set.types[l.buffer[e]],this.from=o+l.buffer[e+1],this.to=o+l.buffer[e+2],!0}yield(e){return e?e instanceof gs?(this.buffer=null,this.yieldNode(e)):(this.buffer=e.context,this.yieldBuf(e.index,e.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(e,s,o){if(!this.buffer)return this.yield(this._tree.nextChild(e<0?this._tree._tree.children.length-1:0,e,s,o,this.mode));let{buffer:l}=this.buffer,a=l.findChild(this.index+4,l.buffer[this.index+3],e,s-this.buffer.start,o);return a<0?!1:(this.stack.push(this.index),this.yieldBuf(a))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(e){return this.enterChild(1,e,2)}childBefore(e){return this.enterChild(-1,e,-2)}enter(e,s,o=this.mode){return this.buffer?o&pi.ExcludeBuffers?!1:this.enterChild(1,e,s):this.yield(this._tree.enter(e,s,o))}parent(){if(!this.buffer)return this.yieldNode(this.mode&pi.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let e=this.mode&pi.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(e)}sibling(e){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+e,e,0,4,this.mode)):!1;let{buffer:s}=this.buffer,o=this.stack.length-1;if(e<0){let l=o<0?0:this.stack[o]+4;if(this.index!=l)return this.yieldBuf(s.findChild(l,this.index,-1,0,4))}else{let l=s.buffer[this.index+3];if(l<(o<0?s.buffer.length:s.buffer[this.stack[o]+3]))return this.yieldBuf(l)}return o<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+e,e,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(e){let s,o,{buffer:l}=this;if(l){if(e>0){if(this.index<l.buffer.buffer.length)return!1}else for(let a=0;a<this.index;a++)if(l.buffer.buffer[a+3]<this.index)return!1;({index:s,parent:o}=l)}else({index:s,_parent:o}=this._tree);for(;o;{index:s,_parent:o}=o)if(s>-1)for(let a=s+e,h=e<0?-1:o._tree.children.length;a!=h;a+=e){let d=o._tree.children[a];if(this.mode&pi.IncludeAnonymous||d instanceof Vn||!d.type.isAnonymous||zb(d))return!1}return!0}move(e,s){if(s&&this.enterChild(e,0,4))return!0;for(;;){if(this.sibling(e))return!0;if(this.atLastNode(e)||!this.parent())return!1}}next(e=!0){return this.move(1,e)}prev(e=!0){return this.move(-1,e)}moveTo(e,s=0){for(;(this.from==this.to||(s<1?this.from>=e:this.from>e)||(s>-1?this.to<=e:this.to<e))&&this.parent(););for(;this.enterChild(1,e,s););return this}get node(){if(!this.buffer)return this._tree;let e=this.bufferNode,s=null,o=0;if(e&&e.context==this.buffer)t:for(let l=this.index,a=this.stack.length;a>=0;){for(let h=e;h;h=h._parent)if(h.index==l){if(l==this.index)return h;s=h,o=a+1;break t}l=this.stack[--a]}for(let l=o;l<this.stack.length;l++)s=new Nn(this.buffer,s,this.stack[l]);return this.bufferNode=new Nn(this.buffer,s,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(e,s){for(let o=0;;){let l=!1;if(this.type.isAnonymous||e(this)!==!1){if(this.firstChild()){o++;continue}this.type.isAnonymous||(l=!0)}for(;l&&s&&s(this),l=this.type.isAnonymous,!this.nextSibling();){if(!o)return;this.parent(),o--,l=!0}}}matchContext(e){if(!this.buffer)return zT(this.node,e);let{buffer:s}=this.buffer,{types:o}=s.set;for(let l=e.length-1,a=this.stack.length-1;l>=0;a--){if(a<0)return zT(this.node,e,l);let h=o[s.buffer[this.stack[a]]];if(!h.isAnonymous){if(e[l]&&e[l]!=h.name)return!1;l--}}return!0}}function zb(n){return n.children.some(e=>e instanceof Vn||!e.type.isAnonymous||zb(e))}function V1(n){var e;let{buffer:s,nodeSet:o,maxBufferLength:l=D1,reused:a=[],minRepeatType:h=o.types.length}=n,d=Array.isArray(s)?new Wb(s,s.length):s,p=o.types,g=0,m=0;function T(Y,V,H,Tt,$t,lt){let{id:ot,start:ct,end:gt,size:vt}=d,it=m;for(;vt<0;)if(d.next(),vt==-1){let Lt=a[ot];H.push(Lt),Tt.push(ct-Y);return}else if(vt==-3){g=ot;return}else if(vt==-4){m=ot;return}else throw new RangeError(`Unrecognized record size: ${vt}`);let Ft=p[ot],Rt,Nt,me=ct-Y;if(gt-ct<=l&&(Nt=A(d.pos-V,$t))){let Lt=new Uint16Array(Nt.size-Nt.skip),Gt=d.pos-Nt.size,Ht=Lt.length;for(;d.pos>Gt;)Ht=F(Nt.start,Lt,Ht);Rt=new Vn(Lt,gt-Nt.start,o),me=Nt.start-Y}else{let Lt=d.pos-vt;d.next();let Gt=[],Ht=[],fe=ot>=h?ot:-1,ut=0,be=gt;for(;d.pos>Lt;)fe>=0&&d.id==fe&&d.size>=0?(d.end<=be-l&&(C(Gt,Ht,ct,ut,d.end,be,fe,it),ut=Gt.length,be=d.end),d.next()):lt>2500?b(ct,Lt,Gt,Ht):T(ct,Lt,Gt,Ht,fe,lt+1);if(fe>=0&&ut>0&&ut<Gt.length&&C(Gt,Ht,ct,ut,ct,be,fe,it),Gt.reverse(),Ht.reverse(),fe>-1&&ut>0){let _e=y(Ft);Rt=Xb(Ft,Gt,Ht,0,Gt.length,0,gt-ct,_e,_e)}else Rt=L(Ft,Gt,Ht,gt-ct,it-gt)}H.push(Rt),Tt.push(me)}function b(Y,V,H,Tt){let $t=[],lt=0,ot=-1;for(;d.pos>V;){let{id:ct,start:gt,end:vt,size:it}=d;if(it>4)d.next();else{if(ot>-1&&gt<ot)break;ot<0&&(ot=vt-l),$t.push(ct,gt,vt),lt++,d.next()}}if(lt){let ct=new Uint16Array(lt*4),gt=$t[$t.length-2];for(let vt=$t.length-3,it=0;vt>=0;vt-=3)ct[it++]=$t[vt],ct[it++]=$t[vt+1]-gt,ct[it++]=$t[vt+2]-gt,ct[it++]=it;H.push(new Vn(ct,$t[2]-gt,o)),Tt.push(gt-Y)}}function y(Y){return(V,H,Tt)=>{let $t=0,lt=V.length-1,ot,ct;if(lt>=0&&(ot=V[lt])instanceof mo){if(!lt&&ot.type==Y&&ot.length==Tt)return ot;(ct=ot.prop(Ue.lookAhead))&&($t=H[lt]+ot.length+ct)}return L(Y,V,H,Tt,$t)}}function C(Y,V,H,Tt,$t,lt,ot,ct){let gt=[],vt=[];for(;Y.length>Tt;)gt.push(Y.pop()),vt.push(V.pop()+H-$t);Y.push(L(o.types[ot],gt,vt,lt-$t,ct-lt)),V.push($t-H)}function L(Y,V,H,Tt,$t=0,lt){if(g){let ot=[Ue.contextHash,g];lt=lt?[ot].concat(lt):[ot]}if($t>25){let ot=[Ue.lookAhead,$t];lt=lt?[ot].concat(lt):[ot]}return new mo(Y,V,H,Tt,lt)}function A(Y,V){let H=d.fork(),Tt=0,$t=0,lt=0,ot=H.end-l,ct={size:0,start:0,skip:0};t:for(let gt=H.pos-Y;H.pos>gt;){let vt=H.size;if(H.id==V&&vt>=0){ct.size=Tt,ct.start=$t,ct.skip=lt,lt+=4,Tt+=4,H.next();continue}let it=H.pos-vt;if(vt<0||it<gt||H.start<ot)break;let Ft=H.id>=h?4:0,Rt=H.start;for(H.next();H.pos>it;){if(H.size<0)if(H.size==-3)Ft+=4;else break t;else H.id>=h&&(Ft+=4);H.next()}$t=Rt,Tt+=vt,lt+=Ft}return(V<0||Tt==Y)&&(ct.size=Tt,ct.start=$t,ct.skip=lt),ct.size>4?ct:void 0}function F(Y,V,H){let{id:Tt,start:$t,end:lt,size:ot}=d;if(d.next(),ot>=0&&Tt<h){let ct=H;if(ot>4){let gt=d.pos-(ot-4);for(;d.pos>gt;)H=F(Y,V,H)}V[--H]=ct,V[--H]=lt-Y,V[--H]=$t-Y,V[--H]=Tt}else ot==-3?g=Tt:ot==-4&&(m=Tt);return H}let z=[],X=[];for(;d.pos>0;)T(n.start||0,n.bufferStart||0,z,X,-1,0);let K=(e=n.length)!==null&&e!==void 0?e:z.length?X[0]+z[0].length:0;return new mo(p[n.topID],z.reverse(),X.reverse(),K)}const mw=new WeakMap;function op(n,e){if(!n.isAnonymous||e instanceof Vn||e.type!=n)return 1;let s=mw.get(e);if(s==null){s=1;for(let o of e.children){if(o.type!=n||!(o instanceof mo)){s=1;break}s+=op(n,o)}mw.set(e,s)}return s}function Xb(n,e,s,o,l,a,h,d,p){let g=0;for(let C=o;C<l;C++)g+=op(n,e[C]);let m=Math.ceil(g*1.5/8),T=[],b=[];function y(C,L,A,F,z){for(let X=A;X<F;){let K=X,Y=L[X],V=op(n,C[X]);for(X++;X<F;X++){let H=op(n,C[X]);if(V+H>=m)break;V+=H}if(X==K+1){if(V>m){let H=C[K];y(H.children,H.positions,0,H.children.length,L[K]+z);continue}T.push(C[K])}else{let H=L[X-1]+C[X-1].length-Y;T.push(Xb(n,C,L,K,X,Y,H,null,p))}b.push(Y+z-a)}}return y(e,s,o,l,0),(d||p)(T,b,h)}new Ue({perNode:!0});let G1=0;class ho{constructor(e,s,o){this.set=e,this.base=s,this.modified=o,this.id=G1++}static define(e){if(e!=null&&e.base)throw new Error("Can not derive from a modified tag");let s=new ho([],null,[]);if(s.set.push(s),e)for(let o of e.set)s.set.push(o);return s}static defineModifier(){let e=new yp;return s=>s.modified.indexOf(e)>-1?s:yp.get(s.base||s,s.modified.concat(e).sort((o,l)=>o.id-l.id))}}let W1=0;class yp{constructor(){this.instances=[],this.id=W1++}static get(e,s){if(!s.length)return e;let o=s[0].instances.find(d=>d.base==e&&z1(s,d.modified));if(o)return o;let l=[],a=new ho(l,e,s);for(let d of s)d.instances.push(a);let h=X1(s);for(let d of e.set)if(!d.modified.length)for(let p of h)l.push(yp.get(d,p));return a}}function z1(n,e){return n.length==e.length&&n.every((s,o)=>s==e[o])}function X1(n){let e=[[]];for(let s=0;s<n.length;s++)for(let o=0,l=e.length;o<l;o++)e.push(e[o].concat(n[s]));return e.sort((s,o)=>o.length-s.length)}function Y1(n){let e=Object.create(null);for(let s in n){let o=n[s];Array.isArray(o)||(o=[o]);for(let l of s.split(" "))if(l){let a=[],h=2,d=l;for(let T=0;;){if(d=="..."&&T>0&&T+3==l.length){h=1;break}let b=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(d);if(!b)throw new RangeError("Invalid path: "+l);if(a.push(b[0]=="*"?"":b[0][0]=='"'?JSON.parse(b[0]):b[0]),T+=b[0].length,T==l.length)break;let y=l[T++];if(T==l.length&&y=="!"){h=0;break}if(y!="/")throw new RangeError("Invalid path: "+l);d=l.slice(T)}let p=a.length-1,g=a[p];if(!g)throw new RangeError("Invalid path: "+l);let m=new Ip(o,h,p>0?a.slice(0,p):null);e[g]=m.sort(e[g])}}return WO.add(e)}const WO=new Ue;class Ip{constructor(e,s,o,l){this.tags=e,this.mode=s,this.context=o,this.next=l}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(e){return!e||e.depth<this.depth?(this.next=e,this):(e.next=this.sort(e.next),e)}get depth(){return this.context?this.context.length:0}}Ip.empty=new Ip([],2,null);function zO(n,e){let s=Object.create(null);for(let a of n)if(!Array.isArray(a.tag))s[a.tag.id]=a.class;else for(let h of a.tag)s[h.id]=a.class;let{scope:o,all:l=null}=e||{};return{style:a=>{let h=l;for(let d of a)for(let p of d.set){let g=s[p.id];if(g){h=h?h+" "+g:g;break}}return h},scope:o}}function K1(n,e){let s=null;for(let o of n){let l=o.style(e);l&&(s=s?s+" "+l:l)}return s}function j1(n,e,s,o=0,l=n.length){let a=new J1(o,Array.isArray(e)?e:[e],s);a.highlightRange(n.cursor(),o,l,"",a.highlighters),a.flush(l)}class J1{constructor(e,s,o){this.at=e,this.highlighters=s,this.span=o,this.class=""}startSpan(e,s){s!=this.class&&(this.flush(e),e>this.at&&(this.at=e),this.class=s)}flush(e){e>this.at&&this.class&&this.span(this.at,e,this.class)}highlightRange(e,s,o,l,a){let{type:h,from:d,to:p}=e;if(d>=o||p<=s)return;h.isTop&&(a=this.highlighters.filter(y=>!y.scope||y.scope(h)));let g=l,m=q1(e)||Ip.empty,T=K1(a,m.tags);if(T&&(g&&(g+=" "),g+=T,m.mode==1&&(l+=(l?" ":"")+T)),this.startSpan(Math.max(s,d),g),m.opaque)return;let b=e.tree&&e.tree.prop(Ue.mounted);if(b&&b.overlay){let y=e.node.enter(b.overlay[0].from+d,1),C=this.highlighters.filter(A=>!A.scope||A.scope(b.tree.type)),L=e.firstChild();for(let A=0,F=d;;A++){let z=A<b.overlay.length?b.overlay[A]:null,X=z?z.from+d:p,K=Math.max(s,F),Y=Math.min(o,X);if(K<Y&&L)for(;e.from<Y&&(this.highlightRange(e,K,Y,l,a),this.startSpan(Math.min(Y,e.to),g),!(e.to>=X||!e.nextSibling())););if(!z||X>o)break;F=z.to+d,F>s&&(this.highlightRange(y.cursor(),Math.max(s,z.from+d),Math.min(o,F),"",C),this.startSpan(Math.min(o,F),g))}L&&e.parent()}else if(e.firstChild()){b&&(l="");do if(!(e.to<=s)){if(e.from>=o)break;this.highlightRange(e,s,o,l,a),this.startSpan(Math.min(o,e.to),g)}while(e.nextSibling());e.parent()}}}function q1(n){let e=n.type.prop(WO);for(;e&&e.context&&!n.matchContext(e.context);)e=e.next;return e||null}const Et=ho.define,Nd=Et(),kn=Et(),$w=Et(kn),_w=Et(kn),On=Et(),Ld=Et(On),f_=Et(On),co=Et(),Ar=Et(co),ro=Et(),lo=Et(),YT=Et(),Oa=Et(YT),Md=Et(),ft={comment:Nd,lineComment:Et(Nd),blockComment:Et(Nd),docComment:Et(Nd),name:kn,variableName:Et(kn),typeName:$w,tagName:Et($w),propertyName:_w,attributeName:Et(_w),className:Et(kn),labelName:Et(kn),namespace:Et(kn),macroName:Et(kn),literal:On,string:Ld,docString:Et(Ld),character:Et(Ld),attributeValue:Et(Ld),number:f_,integer:Et(f_),float:Et(f_),bool:Et(On),regexp:Et(On),escape:Et(On),color:Et(On),url:Et(On),keyword:ro,self:Et(ro),null:Et(ro),atom:Et(ro),unit:Et(ro),modifier:Et(ro),operatorKeyword:Et(ro),controlKeyword:Et(ro),definitionKeyword:Et(ro),moduleKeyword:Et(ro),operator:lo,derefOperator:Et(lo),arithmeticOperator:Et(lo),logicOperator:Et(lo),bitwiseOperator:Et(lo),compareOperator:Et(lo),updateOperator:Et(lo),definitionOperator:Et(lo),typeOperator:Et(lo),controlOperator:Et(lo),punctuation:YT,separator:Et(YT),bracket:Oa,angleBracket:Et(Oa),squareBracket:Et(Oa),paren:Et(Oa),brace:Et(Oa),content:co,heading:Ar,heading1:Et(Ar),heading2:Et(Ar),heading3:Et(Ar),heading4:Et(Ar),heading5:Et(Ar),heading6:Et(Ar),contentSeparator:Et(co),list:Et(co),quote:Et(co),emphasis:Et(co),strong:Et(co),link:Et(co),monospace:Et(co),strikethrough:Et(co),inserted:Et(),deleted:Et(),changed:Et(),invalid:Et(),meta:Md,documentMeta:Et(Md),annotation:Et(Md),processingInstruction:Et(Md),definition:ho.defineModifier(),constant:ho.defineModifier(),function:ho.defineModifier(),standard:ho.defineModifier(),local:ho.defineModifier(),special:ho.defineModifier()};zO([{tag:ft.link,class:"tok-link"},{tag:ft.heading,class:"tok-heading"},{tag:ft.emphasis,class:"tok-emphasis"},{tag:ft.strong,class:"tok-strong"},{tag:ft.keyword,class:"tok-keyword"},{tag:ft.atom,class:"tok-atom"},{tag:ft.bool,class:"tok-bool"},{tag:ft.url,class:"tok-url"},{tag:ft.labelName,class:"tok-labelName"},{tag:ft.inserted,class:"tok-inserted"},{tag:ft.deleted,class:"tok-deleted"},{tag:ft.literal,class:"tok-literal"},{tag:ft.string,class:"tok-string"},{tag:ft.number,class:"tok-number"},{tag:[ft.regexp,ft.escape,ft.special(ft.string)],class:"tok-string2"},{tag:ft.variableName,class:"tok-variableName"},{tag:ft.local(ft.variableName),class:"tok-variableName tok-local"},{tag:ft.definition(ft.variableName),class:"tok-variableName tok-definition"},{tag:ft.special(ft.variableName),class:"tok-variableName2"},{tag:ft.definition(ft.propertyName),class:"tok-propertyName tok-definition"},{tag:ft.typeName,class:"tok-typeName"},{tag:ft.namespace,class:"tok-namespace"},{tag:ft.className,class:"tok-className"},{tag:ft.macroName,class:"tok-macroName"},{tag:ft.propertyName,class:"tok-propertyName"},{tag:ft.operator,class:"tok-operator"},{tag:ft.comment,class:"tok-comment"},{tag:ft.meta,class:"tok-meta"},{tag:ft.invalid,class:"tok-invalid"},{tag:ft.punctuation,class:"tok-punctuation"}]);const KT="",Tw=typeof Symbol>"u"?"__"+KT:Symbol.for(KT),jT=typeof Symbol>"u"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),bw=typeof globalThis<"u"?globalThis:typeof window<"u"?window:{};class Ew{constructor(e,s){this.rules=[];let{finish:o}=s||{};function l(h){return/^@/.test(h)?[h]:h.split(/,\s*/)}function a(h,d,p,g){let m=[],T=/^@(\w+)\b/.exec(h[0]),b=T&&T[1]=="keyframes";if(T&&d==null)return p.push(h[0]+";");for(let y in d){let C=d[y];if(/&/.test(y))a(y.split(/,\s*/).map(L=>h.map(A=>L.replace(/&/,A))).reduce((L,A)=>L.concat(A)),C,p);else if(C&&typeof C=="object"){if(!T)throw new RangeError("The value of a property ("+y+") should be a primitive value.");a(l(y),C,m,b)}else C!=null&&m.push(y.replace(/_.*/,"").replace(/[A-Z]/g,L=>"-"+L.toLowerCase())+": "+C+";")}(m.length||b)&&p.push((o&&!T&&!g?h.map(o):h).join(", ")+" {"+m.join(" ")+"}")}for(let h in e)a(l(h),e[h],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let e=bw[Tw]||1;return bw[Tw]=e+1,KT+e.toString(36)}static mount(e,s,o){let l=e[jT],a=o&&o.nonce;l?a&&l.setNonce(a):l=new Z1(e,a),l.mount(Array.isArray(s)?s:[s])}}let vw=new Map;class Z1{constructor(e,s){let o=e.ownerDocument||e,l=o.defaultView;if(!e.head&&e.adoptedStyleSheets&&l.CSSStyleSheet){let a=vw.get(o);if(a)return e.adoptedStyleSheets=[a.sheet,...e.adoptedStyleSheets],e[jT]=a;this.sheet=new l.CSSStyleSheet,e.adoptedStyleSheets=[this.sheet,...e.adoptedStyleSheets],vw.set(o,this)}else{this.styleTag=o.createElement("style"),s&&this.styleTag.setAttribute("nonce",s);let a=e.head||e;a.insertBefore(this.styleTag,a.firstChild)}this.modules=[],e[jT]=this}mount(e){let s=this.sheet,o=0,l=0;for(let a=0;a<e.length;a++){let h=e[a],d=this.modules.indexOf(h);if(d<l&&d>-1&&(this.modules.splice(d,1),l--,d=-1),d==-1){if(this.modules.splice(l++,0,h),s)for(let p=0;p<h.rules.length;p++)s.insertRule(h.rules[p],o++)}else{for(;l<d;)o+=this.modules[l++].rules.length;o+=h.rules.length,l++}}if(!s){let a="";for(let h=0;h<this.modules.length;h++)a+=this.modules[h].getRules()+`
`;this.styleTag.textContent=a}}setNonce(e){this.styleTag&&this.styleTag.getAttribute("nonce")!=e&&this.styleTag.setAttribute("nonce",e)}}var g_;const Ua=new Be,Q1=new Be;class go{constructor(e,s,o=[],l=""){this.data=e,this.name=l,$e.prototype.hasOwnProperty("tree")||Object.defineProperty($e.prototype,"tree",{get(){return Oh(this)}}),this.parser=s,this.extension=[bc.of(this),$e.languageData.of((a,h,d)=>{let p=yw(a,h,d),g=p.type.prop(Ua);if(!g)return[];let m=a.facet(g),T=p.type.prop(Q1);if(T){let b=p.resolve(h-p.from,d);for(let y of T)if(y.test(b,a)){let C=a.facet(y.facet);return y.type=="replace"?C:C.concat(m)}}return m})].concat(o)}isActiveAt(e,s,o=-1){return yw(e,s,o).type.prop(Ua)==this.data}findRegions(e){let s=e.facet(bc);if((s==null?void 0:s.data)==this.data)return[{from:0,to:e.doc.length}];if(!s||!s.allowsNesting)return[];let o=[],l=(a,h)=>{if(a.prop(Ua)==this.data){o.push({from:h,to:h+a.length});return}let d=a.prop(Be.mounted);if(d){if(d.tree.prop(Ua)==this.data){if(d.overlay)for(let p of d.overlay)o.push({from:p.from+h,to:p.to+h});else o.push({from:h,to:h+a.length});return}else if(d.overlay){let p=o.length;if(l(d.tree,d.overlay[0].from+h),o.length>p)return}}for(let p=0;p<a.children.length;p++){let g=a.children[p];g instanceof ss&&l(g,a.positions[p]+h)}};return l(Oh(e),0),o}get allowsNesting(){return!0}}go.setState=Ze.define();function yw(n,e,s){let o=n.facet(bc),l=Oh(n).topNode;if(!o||o.allowsNesting)for(let a=l;a;a=a.enter(e,s,ci.ExcludeBuffers))a.type.isTop&&(l=a);return l}function Oh(n){let e=n.field(go.state,!1);return e?e.tree:ss.empty}class tP{constructor(e){this.doc=e,this.cursorPos=0,this.string="",this.cursor=e.iter()}get length(){return this.doc.length}syncTo(e){return this.string=this.cursor.next(e-this.cursorPos).value,this.cursorPos=e+this.string.length,this.cursorPos-this.string.length}chunk(e){return this.syncTo(e),this.string}get lineChunks(){return!0}read(e,s){let o=this.cursorPos-this.string.length;return e<o||s>=this.cursorPos?this.doc.sliceString(e,s):this.string.slice(e-o,s-o)}}let Aa=null;class Sp{constructor(e,s,o=[],l,a,h,d,p){this.parser=e,this.state=s,this.fragments=o,this.tree=l,this.treeLen=a,this.viewport=h,this.skipped=d,this.scheduleOn=p,this.parse=null,this.tempSkipped=[]}static create(e,s,o){return new Sp(e,s,[],ss.empty,0,o,[],null)}startParse(){return this.parser.startParse(new tP(this.state.doc),this.fragments)}work(e,s){return s!=null&&s>=this.state.doc.length&&(s=void 0),this.tree!=ss.empty&&this.isDone(s??this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var o;if(typeof e=="number"){let l=Date.now()+e;e=()=>Date.now()>l}for(this.parse||(this.parse=this.startParse()),s!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>s)&&s<this.state.doc.length&&this.parse.stopAt(s);;){let l=this.parse.advance();if(l)if(this.fragments=this.withoutTempSkipped(Fr.addTree(l,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(o=this.parse.stoppedAt)!==null&&o!==void 0?o:this.state.doc.length,this.tree=l,this.parse=null,this.treeLen<(s??this.state.doc.length))this.parse=this.startParse();else return!0;if(e())return!1}})}takeTree(){let e,s;this.parse&&(e=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>e)&&this.parse.stopAt(e),this.withContext(()=>{for(;!(s=this.parse.advance()););}),this.treeLen=e,this.tree=s,this.fragments=this.withoutTempSkipped(Fr.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(e){let s=Aa;Aa=this;try{return e()}finally{Aa=s}}withoutTempSkipped(e){for(let s;s=this.tempSkipped.pop();)e=Iw(e,s.from,s.to);return e}changes(e,s){let{fragments:o,tree:l,treeLen:a,viewport:h,skipped:d}=this;if(this.takeTree(),!e.empty){let p=[];if(e.iterChangedRanges((g,m,T,b)=>p.push({fromA:g,toA:m,fromB:T,toB:b})),o=Fr.applyChanges(o,p),l=ss.empty,a=0,h={from:e.mapPos(h.from,-1),to:e.mapPos(h.to,1)},this.skipped.length){d=[];for(let g of this.skipped){let m=e.mapPos(g.from,1),T=e.mapPos(g.to,-1);m<T&&d.push({from:m,to:T})}}}return new Sp(this.parser,s,o,l,a,h,d,this.scheduleOn)}updateViewport(e){if(this.viewport.from==e.from&&this.viewport.to==e.to)return!1;this.viewport=e;let s=this.skipped.length;for(let o=0;o<this.skipped.length;o++){let{from:l,to:a}=this.skipped[o];l<e.to&&a>e.from&&(this.fragments=Iw(this.fragments,l,a),this.skipped.splice(o--,1))}return this.skipped.length>=s?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(e,s){this.skipped.push({from:e,to:s})}static getSkippingParser(e){return new class extends M1{createParse(s,o,l){let a=l[0].from,h=l[l.length-1].to;return{parsedPos:a,advance(){let p=Aa;if(p){for(let g of l)p.tempSkipped.push(g);e&&(p.scheduleOn=p.scheduleOn?Promise.all([p.scheduleOn,e]):e)}return this.parsedPos=h,new ss(Eo.none,[],[],h-a)},stoppedAt:null,stopAt(){}}}}}isDone(e){e=Math.min(e,this.state.doc.length);let s=this.fragments;return this.treeLen>=e&&s.length&&s[0].from==0&&s[0].to>=e}static get(){return Aa}}function Iw(n,e,s){return Fr.applyChanges(n,[{fromA:e,toA:s,fromB:e,toB:s}])}class Tc{constructor(e){this.context=e,this.tree=e.tree}apply(e){if(!e.docChanged&&this.tree==this.context.tree)return this;let s=this.context.changes(e.changes,e.state),o=this.context.treeLen==e.startState.doc.length?void 0:Math.max(e.changes.mapPos(this.context.treeLen),s.viewport.to);return s.work(20,o)||s.takeTree(),new Tc(s)}static init(e){let s=Math.min(3e3,e.doc.length),o=Sp.create(e.facet(bc).parser,e,{from:0,to:s});return o.work(20,s)||o.takeTree(),new Tc(o)}}go.state=Yn.define({create:Tc.init,update(n,e){for(let s of e.effects)if(s.is(go.setState))return s.value;return e.startState.facet(bc)!=e.state.facet(bc)?Tc.init(e.state):n.apply(e)}});let XO=n=>{let e=setTimeout(()=>n(),500);return()=>clearTimeout(e)};typeof requestIdleCallback<"u"&&(XO=n=>{let e=-1,s=setTimeout(()=>{e=requestIdleCallback(n,{timeout:500-100})},100);return()=>e<0?clearTimeout(s):cancelIdleCallback(e)});const m_=typeof navigator<"u"&&(!((g_=navigator.scheduling)===null||g_===void 0)&&g_.isInputPending)?()=>navigator.scheduling.isInputPending():null,eP=Jo.fromClass(class{constructor(e){this.view=e,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(e){let s=this.view.state.field(go.state).context;(s.updateViewport(e.view.viewport)||this.view.viewport.to>s.treeLen)&&this.scheduleWork(),(e.docChanged||e.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(s)}scheduleWork(){if(this.working)return;let{state:e}=this.view,s=e.field(go.state);(s.tree!=s.context.tree||!s.context.isDone(e.doc.length))&&(this.working=XO(this.work))}work(e){this.working=null;let s=Date.now();if(this.chunkEnd<s&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=s+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:o,viewport:{to:l}}=this.view,a=o.field(go.state);if(a.tree==a.context.tree&&a.context.isDone(l+1e5))return;let h=Date.now()+Math.min(this.chunkBudget,100,e&&!m_?Math.max(25,e.timeRemaining()-5):1e9),d=a.context.treeLen<l&&o.doc.length>l+1e3,p=a.context.work(()=>m_&&m_()||Date.now()>h,l+(d?0:1e5));this.chunkBudget-=Date.now()-s,(p||this.chunkBudget<=0)&&(a.context.takeTree(),this.view.dispatch({effects:go.setState.of(new Tc(a.context))})),this.chunkBudget>0&&!(p&&!d)&&this.scheduleWork(),this.checkAsyncSchedule(a.context)}checkAsyncSchedule(e){e.scheduleOn&&(this.workScheduled++,e.scheduleOn.then(()=>this.scheduleWork()).catch(s=>Pn(this.view.state,s)).then(()=>this.workScheduled--),e.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),bc=Xt.define({combine(n){return n.length?n[0]:null},enables:n=>[go.state,eP,oe.contentAttributes.compute([n],e=>{let s=e.facet(n);return s&&s.name?{"data-language":s.name}:{}})]});class Yp{constructor(e,s){this.specs=e;let o;function l(d){let p=Ew.newName();return(o||(o=Object.create(null)))["."+p]=d,p}const a=typeof s.all=="string"?s.all:s.all?l(s.all):void 0,h=s.scope;this.scope=h instanceof go?d=>d.prop(Ua)==h.data:h?d=>d==h:void 0,this.style=zO(e.map(d=>({tag:d.tag,class:d.class||l(Object.assign({},d,{tag:null}))})),{all:a}).style,this.module=o?new Ew(o):null,this.themeType=s.themeType}static define(e,s){return new Yp(e,s||{})}}const JT=Xt.define(),YO=Xt.define({combine(n){return n.length?[n[0]]:null}});function $_(n){let e=n.facet(JT);return e.length?e:n.facet(YO)}function iP(n,e){let s=[oP],o;return n instanceof Yp&&(n.module&&s.push(oe.styleModule.of(n.module)),o=n.themeType),e!=null&&e.fallback?s.push(YO.of(n)):o?s.push(JT.computeN([oe.darkTheme],l=>l.facet(oe.darkTheme)==(o=="dark")?[n]:[])):s.push(JT.of(n)),s}class sP{constructor(e){this.markCache=Object.create(null),this.tree=Oh(e.state),this.decorations=this.buildDeco(e,$_(e.state)),this.decoratedTo=e.viewport.to}update(e){let s=Oh(e.state),o=$_(e.state),l=o!=$_(e.startState),{viewport:a}=e.view,h=e.changes.mapPos(this.decoratedTo,1);s.length<a.to&&!l&&s.type==this.tree.type&&h>=a.to?(this.decorations=this.decorations.map(e.changes),this.decoratedTo=h):(s!=this.tree||e.viewportChanged||l)&&(this.tree=s,this.decorations=this.buildDeco(e.view,o),this.decoratedTo=a.to)}buildDeco(e,s){if(!s||!this.tree.length)return _i.none;let o=new vh;for(let{from:l,to:a}of e.visibleRanges)j1(this.tree,s,(h,d,p)=>{o.add(h,d,this.markCache[p]||(this.markCache[p]=_i.mark({class:p})))},l,a);return o.finish()}}const oP=A0.high(Jo.fromClass(sP,{decorations:n=>n.decorations})),nP=Object.create(null),Sw=[Eo.none],Cw=[],ww=Object.create(null),rP=Object.create(null);for(let[n,e]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])rP[n]=lP(nP,e);function __(n,e){Cw.indexOf(n)>-1||(Cw.push(n),console.warn(e))}function lP(n,e){let s=[];for(let d of e.split(" ")){let p=[];for(let g of d.split(".")){let m=n[g]||ft[g];m?typeof m=="function"?p.length?p=p.map(m):__(g,`Modifier ${g} used at start of tag`):p.length?__(g,`Tag ${g} used as modifier`):p=Array.isArray(m)?m:[m]:__(g,`Unknown highlighting tag ${g}`)}for(let g of p)s.push(g)}if(!s.length)return 0;let o=e.replace(/ /g,"_"),l=o+" "+s.map(d=>d.id),a=ww[l];if(a)return a.id;let h=ww[l]=Eo.define({id:Sw.length,name:o,props:[Y1({[o]:s})]});return Sw.push(h),h.id}ti.RTL,ti.LTR;const cP="#e5c07b",kw="#e06c75",aP="#56b6c2",hP="#ffffff",np="#abb2bf",qT="#7d8799",uP="#61afef",dP="#98c379",Ow="#d19a66",pP="#c678dd",fP="#21252b",Aw="#2c313a",Rw="#282c34",T_="#353a42",gP="#3E4451",Nw="#528bff",mP=oe.theme({"&":{color:np,backgroundColor:Rw},".cm-content":{caretColor:Nw},".cm-cursor, .cm-dropCursor":{borderLeftColor:Nw},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:gP},".cm-panels":{backgroundColor:fP,color:np},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:"#6699ff0b"},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847"},".cm-gutters":{backgroundColor:Rw,color:qT,border:"none"},".cm-activeLineGutter":{backgroundColor:Aw},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:T_},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:T_,borderBottomColor:T_},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:Aw,color:np}}},{dark:!0}),$P=Yp.define([{tag:ft.keyword,color:pP},{tag:[ft.name,ft.deleted,ft.character,ft.propertyName,ft.macroName],color:kw},{tag:[ft.function(ft.variableName),ft.labelName],color:uP},{tag:[ft.color,ft.constant(ft.name),ft.standard(ft.name)],color:Ow},{tag:[ft.definition(ft.name),ft.separator],color:np},{tag:[ft.typeName,ft.className,ft.number,ft.changed,ft.annotation,ft.modifier,ft.self,ft.namespace],color:cP},{tag:[ft.operator,ft.operatorKeyword,ft.url,ft.escape,ft.regexp,ft.link,ft.special(ft.string)],color:aP},{tag:[ft.meta,ft.comment],color:qT},{tag:ft.strong,fontWeight:"bold"},{tag:ft.emphasis,fontStyle:"italic"},{tag:ft.strikethrough,textDecoration:"line-through"},{tag:ft.link,color:qT,textDecoration:"underline"},{tag:ft.heading,fontWeight:"bold",color:kw},{tag:[ft.atom,ft.bool,ft.special(ft.variableName)],color:Ow},{tag:[ft.processingInstruction,ft.string,ft.inserted],color:dP},{tag:ft.invalid,color:hP}]),_P=[mP,iP($P)],TP=oe.baseTheme({".active":{backgroundColor:"yellow",color:"black"}});let ZT=Yn.define({create(){return pe.of([],!0)},update(n,e){for(let s of e.effects)if(s.is(QT))return s.value;return n}});const bP=Jo.fromClass(class{constructor(n){this.decorations=n.state.field(ZT)}update(n){this.decorations=n.view.state.field(ZT)}},{decorations:n=>n.decorations});function EP(){return[TP,ZT,bP]}const QT=Ze.define();function Lw(n,e){if(e>0&&e<=n.state.doc.lines){let s=n.state.doc.line(e).from;n.dispatch({effects:QT.of(pe.of([_i.line({class:"active"}).range(s)],!0))})}else n.dispatch({effects:QT.of(pe.of([],!0))})}const vP={__name:"BaseCodeMirrorEditor",props:{highlightedLine:Number},setup(n){let e=Ls(),s=Ls(),o=n;vb(()=>{let h=$e.create({doc:Xa.value,extensions:[_P,EP(),S1(),oe.editable.of(!1),$e.readOnly.of(!0),oe.theme({"&":{minHeight:"calc(100vh - 80px)",height:"100%",width:"100%"}})]});s.value=new oe({state:h,parent:e.value}),Lw(s.value,o.highlightedLine)}),Ha(Xa,()=>{s.value.dispatch({changes:{from:0,to:s.value.state.doc.length,insert:Xa.value}}),a()});const a=()=>{Lw(s.value,o.highlightedLine)};return Ha(()=>o.highlightedLine,a),(h,d)=>(Zt(),se("div",{id:"assemblerEditor",ref_key:"codemirrorTextarea",ref:e},null,512))}},KO=Lh(vP,[["__scopeId","data-v-4df2b784"]]),yP={class:"container-fluid"},IP={class:"row"},SP={class:"col-8 p-0"},CP={class:"col-4 p-0"},Mw={__name:"BlocksamblerCodingView",setup(n){let e=Ls({toolbox:ex,collapse:!0,comments:!0,disable:!0,maxBlocks:1/0,trashcan:!0,horizontalLayout:!1,toolboxPosition:"start",css:!0,rtl:!1,scrollbars:!1,sounds:!0,oneBasedIndex:!0});return(s,o)=>(Zt(),se("div",yP,[_t("div",IP,[_t("div",SP,[Ae(Sx,{options:Xo(e)},null,8,["options"])]),_t("div",CP,[Ae(KO,{highlightedLine:0})])])]))}},wP=["id"],kP={class:"modal-dialog"},OP={class:"modal-content"},AP=_t("div",{class:"modal-header"},[_t("h4",null,"Console Output"),_t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),RP={class:"modal-body"},NP={class:"form-control",id:"output",rows:"10",wrap:"off",readonly:""},LP=_t("div",{class:"modal-footer"},[_t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Close ")],-1),MP={__name:"DebuggerConsoleModal",props:{id:String},setup(n){let e=n;const s=Ls(ki.output);return(o,l)=>(Zt(),se("div",{id:Xo(e).id,class:"modal",tabindex:"-1"},[_t("div",kP,[_t("div",OP,[AP,_t("div",RP,[_t("textarea",NP,ds(s.value.join(`
`)),1)]),LP])])],8,wP))}},xP={class:"btn btn-secondary position-relative me-2"},DP={key:0,class:"position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger"},xd={__name:"BaseButton",props:{iconName:String,notificationCount:Number},setup(n){let e=n;return(s,o)=>(Zt(),se("button",xP,[Ae(_0,{name:Xo(e).iconName},null,8,["name"]),uL(s.$slots,"default"),n.notificationCount>0?(Zt(),se("span",DP,ds(Xo(e).notificationCount),1)):za("",!0)]))}},PP={class:"py-3 m-0 navbar sticky-top background-white",style:{"background-color":"white"}},BP={__name:"DebuggerControlPanel",props:{consoleModalId:String},setup(n){const e=bo(ki.output),s=n,o=Nh(()=>`#${s.consoleModalId}`),l=()=>{console.log("start parsing...");let d=v0.parseCode(Xa.value);console.log("load program to memory..."),ki.loadProgramm(d),console.log("assemble & load finished")},a=()=>{ki.executeNextInstruction()},h=()=>{for(console.log("reset registers"),ki.resetRegisters(),console.log("reset memory"),ki.resetMemory(),console.log("reset output");ki.output.length>0;)ki.output.pop()};return(d,p)=>(Zt(),se("div",PP,[_t("div",null,[Ae(xd,{onClick:l,"icon-name":"play-circle"},{default:La(()=>[tc(" Assemble & Load to Memory ")]),_:1}),Ae(xd,{onClick:a,"icon-name":"arrow-right-square"},{default:La(()=>[tc(" Execute & Fetch Next ")]),_:1}),Ae(xd,{onClick:h,"icon-name":"reply"},{default:La(()=>[tc(" Reset ")]),_:1}),Ae(xd,{"icon-name":"terminal","notification-count":e.length,"data-bs-toggle":"modal","data-bs-target":o.value},{default:La(()=>[tc(" Output Console ")]),_:1},8,["notification-count","data-bs-target"])])]))}},FP={class:"card"},UP=_t("div",{class:"card-header"},[_t("h4",null,"Machine Instructions")],-1),HP={class:"card-body"},VP={key:0,class:"table"},GP=_t("thead",null,[_t("tr",null,[_t("th",{scope:"col",style:{width:"10%"}},"PC"),_t("th",{scope:"col",style:{width:"15%"}},"Address"),_t("th",{scope:"col",style:{width:"30%"}},"Machine Code"),_t("th",{scope:"col",style:{width:"45%"}},"Source")])],-1),WP={key:0,xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",class:"bi bi-arrow-right-square",viewBox:"0 0 16 16"},zP=_t("path",{"fill-rule":"evenodd",d:"M15 2a1 1 0 0 0-1-1H2a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V2zM0 2a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V2zm4.5 5.5a.5.5 0 0 0 0 1h5.793l-2.147 2.146a.5.5 0 0 0 .708.708l3-3a.5.5 0 0 0 0-.708l-3-3a.5.5 0 1 0-.708.708L10.293 7.5H4.5z"},null,-1),XP=[zP],YP={key:1},KP={__name:"DebuggerOpCodeList",setup(n){const e=Nh(()=>ki.memory.slice(0,ki.loadedProgramSize).map((o,l)=>{let a=v0.instructionFactory.createFromOpCode(o.toBitString());return{address:l,inst:a}}));return(s,o)=>(Zt(),se("div",FP,[UP,_t("div",HP,[e.value.length!=0?(Zt(),se("table",VP,[GP,_t("tbody",null,[(Zt(!0),se(ri,null,Fp(e.value,l=>(Zt(),se("tr",null,[_t("td",null,[l.address==Xo(ki).registers.pc.toUnsignedIntValue()?(Zt(),se("svg",WP,XP)):za("",!0)]),_t("td",null,"0x"+ds(Xo(xn)(l.address.toString(16),4)),1),_t("td",null,[_t("pre",null,ds(l.inst.toMachineCode()),1)]),_t("td",null,ds(l.inst.toString()),1)]))),256))])])):za("",!0),e.value.length==0?(Zt(),se("span",YP," No machine instructions loaded yet! ")):za("",!0)])]))}},jP={class:"card"},JP=_t("div",{class:"card-header"},[_t("h4",null,"Registers")],-1),qP={class:"card-body"},ZP={class:"table"},QP=_t("thead",null,[_t("tr",null,[_t("th",{scope:"col",style:{width:"15%"}},"Name"),_t("th",{scope:"col",style:{width:"85%"}},"Value")])],-1),tB={__name:"DebuggerRegisterSpy",setup(n){const e=bo(ki.registers);return(s,o)=>(Zt(),se("div",jP,[JP,_t("div",qP,[_t("table",ZP,[QP,_t("tbody",null,[(Zt(!0),se(ri,null,Fp(e,(l,a)=>(Zt(),se("tr",null,[_t("td",null,ds(a),1),_t("td",null,[_t("pre",null,ds(l.toBitString())+" ("+ds(l)+")",1)])]))),256))])])])]))}},eB={class:"card"},iB=_t("div",{class:"card-header"},[_t("h4",null,"Memory")],-1),sB={class:"card-body overflow-auto"},oB={class:"table"},nB=_t("thead",null,[_t("tr",null,[_t("th",{scope:"col",style:{width:"50%"}},"Address"),_t("th",{scope:"col",style:{width:"50%"}},"Value")])],-1),rB={__name:"DebuggerMemorySpy",setup(n){const e=Ls(9),s=Ls(0),o=Nh(()=>ki.getMemoryFragment(s.value*e.value,s.value*e.value+e.value));return(l,a)=>(Zt(),se("div",eB,[iB,_t("div",sB,[_t("table",oB,[nB,_t("tbody",null,[(Zt(!0),se(ri,null,Fp(o.value,h=>(Zt(),se("tr",{key:h.address},[_t("td",null,"0x"+ds(Xo(xn)(h.address.toString(16),4)),1),_t("td",null,[_t("pre",null,ds(h.word.toBitString())+" ("+ds(h.word)+")",1)])]))),128))])])])]))}},lB={class:"row my-3"},cB={class:"col-5"},aB={class:"col-7"},hB={__name:"DebuggerPanel",setup(n){const e=Ls("consoleOutput");return bo(ki.registers),(s,o)=>(Zt(),se(ri,null,[Ae(MP,{id:e.value},null,8,["id"]),Ae(BP,{consoleModalId:e.value},null,8,["consoleModalId"]),Ae(KP),_t("div",lB,[_t("div",cB,[Ae(tB)]),_t("div",aB,[Ae(rB)])])],64))}},uB={class:"container-fluid"},dB={class:"row"},pB={class:"col-8 px-3"},fB={class:"col-4 p-0"},gB={__name:"BlocksamblerDebugView",setup(n){return(e,s)=>(Zt(),se("div",uB,[_t("div",dB,[_t("div",pB,[Ae(hB)]),_t("div",fB,[Ae(KO,{highlightedLine:0})])])]))}};const mB={},$B=n=>(Kk("data-v-e6033ac7"),n=n(),jk(),n),_B={class:"container my-5"},TB=$B(()=>_t("div",{class:"card"},[_t("div",{class:"card-header"},"404 Page Not Found"),_t("div",{class:"card-body"},[_t("p",null," Oops! It looks like you've ventured into uncharted territory. The page you were looking for seems to have gone on an adventure of its own and couldn't be found. Don't worry; it happens to the best of us. ")])],-1)),bB=[TB];function EB(n,e){return Zt(),se("div",_B,bB)}const vB=Lh(mB,[["render",EB],["__scopeId","data-v-e6033ac7"]]),yB={},IB={class:"container"},SB=ML('<div class="card my-5"><div class="card-header"><h4>Settings</h4></div><div class="card-body"><form><div class="row mb-3"><label for="inputEmail3" class="col-sm-2 col-form-label">Email</label><div class="col-sm-10"><input type="email" class="form-control" id="inputEmail3"></div></div><div class="row mb-3"><label for="inputPassword3" class="col-sm-2 col-form-label">Password</label><div class="col-sm-10"><input type="password" class="form-control" id="inputPassword3"></div></div><fieldset class="row mb-3"><legend class="col-form-label col-sm-2 pt-0">Radios</legend><div class="col-sm-10"><div class="form-check"><input class="form-check-input" type="radio" name="gridRadios" id="gridRadios1" value="option1" checked><label class="form-check-label" for="gridRadios1"> First radio </label></div><div class="form-check"><input class="form-check-input" type="radio" name="gridRadios" id="gridRadios2" value="option2"><label class="form-check-label" for="gridRadios2"> Second radio </label></div><div class="form-check disabled"><input class="form-check-input" type="radio" name="gridRadios" id="gridRadios3" value="option3" disabled><label class="form-check-label" for="gridRadios3"> Third disabled radio </label></div></div></fieldset><div class="row mb-3"><div class="col-sm-10 offset-sm-2"><div class="form-check"><input class="form-check-input" type="checkbox" id="gridCheck1"><label class="form-check-label" for="gridCheck1"> Example checkbox </label></div></div></div><button type="submit" class="btn btn-primary">Sign in</button></form></div></div>',1),CB=[SB];function wB(n,e){return Zt(),se("div",IB,CB)}const kB=Lh(yB,[["render",wB]]),OB={__name:"App",setup(n){const e={"/":Mw,"/editor":Mw,"/debugger":gB,"/settings":kB},s=Ls(window.location.hash);window.addEventListener("hashchange",()=>{s.value=window.location.hash});const o=Nh(()=>e[s.value.slice(1)||"/"]||vB);return(l,a)=>(Zt(),se(ri,null,[Ae(tx),(Zt(),Sb(YN(o.value)))],64))}};var Ri="top",os="bottom",ns="right",Ni="left",Kp="auto",Rc=[Ri,os,ns,Ni],Wr="start",Ec="end",jO="clippingParents",Yb="viewport",Jl="popper",JO="reference",tb=Rc.reduce(function(n,e){return n.concat([e+"-"+Wr,e+"-"+Ec])},[]),Kb=[].concat(Rc,[Kp]).reduce(function(n,e){return n.concat([e,e+"-"+Wr,e+"-"+Ec])},[]),qO="beforeRead",ZO="read",QO="afterRead",tA="beforeMain",eA="main",iA="afterMain",sA="beforeWrite",oA="write",nA="afterWrite",rA=[qO,ZO,QO,tA,eA,iA,sA,oA,nA];function vo(n){return n?(n.nodeName||"").toLowerCase():null}function rs(n){if(n==null)return window;if(n.toString()!=="[object Window]"){var e=n.ownerDocument;return e&&e.defaultView||window}return n}function zr(n){var e=rs(n).Element;return n instanceof e||n instanceof Element}function ms(n){var e=rs(n).HTMLElement;return n instanceof e||n instanceof HTMLElement}function jb(n){if(typeof ShadowRoot>"u")return!1;var e=rs(n).ShadowRoot;return n instanceof e||n instanceof ShadowRoot}function AB(n){var e=n.state;Object.keys(e.elements).forEach(function(s){var o=e.styles[s]||{},l=e.attributes[s]||{},a=e.elements[s];!ms(a)||!vo(a)||(Object.assign(a.style,o),Object.keys(l).forEach(function(h){var d=l[h];d===!1?a.removeAttribute(h):a.setAttribute(h,d===!0?"":d)}))})}function RB(n){var e=n.state,s={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,s.popper),e.styles=s,e.elements.arrow&&Object.assign(e.elements.arrow.style,s.arrow),function(){Object.keys(e.elements).forEach(function(o){var l=e.elements[o],a=e.attributes[o]||{},h=Object.keys(e.styles.hasOwnProperty(o)?e.styles[o]:s[o]),d=h.reduce(function(p,g){return p[g]="",p},{});!ms(l)||!vo(l)||(Object.assign(l.style,d),Object.keys(a).forEach(function(p){l.removeAttribute(p)}))})}}const Jb={name:"applyStyles",enabled:!0,phase:"write",fn:AB,effect:RB,requires:["computeStyles"]};function $o(n){return n.split("-")[0]}var Ur=Math.max,Cp=Math.min,vc=Math.round;function eb(){var n=navigator.userAgentData;return n!=null&&n.brands&&Array.isArray(n.brands)?n.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function lA(){return!/^((?!chrome|android).)*safari/i.test(eb())}function yc(n,e,s){e===void 0&&(e=!1),s===void 0&&(s=!1);var o=n.getBoundingClientRect(),l=1,a=1;e&&ms(n)&&(l=n.offsetWidth>0&&vc(o.width)/n.offsetWidth||1,a=n.offsetHeight>0&&vc(o.height)/n.offsetHeight||1);var h=zr(n)?rs(n):window,d=h.visualViewport,p=!lA()&&s,g=(o.left+(p&&d?d.offsetLeft:0))/l,m=(o.top+(p&&d?d.offsetTop:0))/a,T=o.width/l,b=o.height/a;return{width:T,height:b,top:m,right:g+T,bottom:m+b,left:g,x:g,y:m}}function qb(n){var e=yc(n),s=n.offsetWidth,o=n.offsetHeight;return Math.abs(e.width-s)<=1&&(s=e.width),Math.abs(e.height-o)<=1&&(o=e.height),{x:n.offsetLeft,y:n.offsetTop,width:s,height:o}}function cA(n,e){var s=e.getRootNode&&e.getRootNode();if(n.contains(e))return!0;if(s&&jb(s)){var o=e;do{if(o&&n.isSameNode(o))return!0;o=o.parentNode||o.host}while(o)}return!1}function Zo(n){return rs(n).getComputedStyle(n)}function NB(n){return["table","td","th"].indexOf(vo(n))>=0}function Kn(n){return((zr(n)?n.ownerDocument:n.document)||window.document).documentElement}function jp(n){return vo(n)==="html"?n:n.assignedSlot||n.parentNode||(jb(n)?n.host:null)||Kn(n)}function xw(n){return!ms(n)||Zo(n).position==="fixed"?null:n.offsetParent}function LB(n){var e=/firefox/i.test(eb()),s=/Trident/i.test(eb());if(s&&ms(n)){var o=Zo(n);if(o.position==="fixed")return null}var l=jp(n);for(jb(l)&&(l=l.host);ms(l)&&["html","body"].indexOf(vo(l))<0;){var a=Zo(l);if(a.transform!=="none"||a.perspective!=="none"||a.contain==="paint"||["transform","perspective"].indexOf(a.willChange)!==-1||e&&a.willChange==="filter"||e&&a.filter&&a.filter!=="none")return l;l=l.parentNode}return null}function Dh(n){for(var e=rs(n),s=xw(n);s&&NB(s)&&Zo(s).position==="static";)s=xw(s);return s&&(vo(s)==="html"||vo(s)==="body"&&Zo(s).position==="static")?e:s||LB(n)||e}function Zb(n){return["top","bottom"].indexOf(n)>=0?"x":"y"}function qa(n,e,s){return Ur(n,Cp(e,s))}function MB(n,e,s){var o=qa(n,e,s);return o>s?s:o}function aA(){return{top:0,right:0,bottom:0,left:0}}function hA(n){return Object.assign({},aA(),n)}function uA(n,e){return e.reduce(function(s,o){return s[o]=n,s},{})}var xB=function(e,s){return e=typeof e=="function"?e(Object.assign({},s.rects,{placement:s.placement})):e,hA(typeof e!="number"?e:uA(e,Rc))};function DB(n){var e,s=n.state,o=n.name,l=n.options,a=s.elements.arrow,h=s.modifiersData.popperOffsets,d=$o(s.placement),p=Zb(d),g=[Ni,ns].indexOf(d)>=0,m=g?"height":"width";if(!(!a||!h)){var T=xB(l.padding,s),b=qb(a),y=p==="y"?Ri:Ni,C=p==="y"?os:ns,L=s.rects.reference[m]+s.rects.reference[p]-h[p]-s.rects.popper[m],A=h[p]-s.rects.reference[p],F=Dh(a),z=F?p==="y"?F.clientHeight||0:F.clientWidth||0:0,X=L/2-A/2,K=T[y],Y=z-b[m]-T[C],V=z/2-b[m]/2+X,H=qa(K,V,Y),Tt=p;s.modifiersData[o]=(e={},e[Tt]=H,e.centerOffset=H-V,e)}}function PB(n){var e=n.state,s=n.options,o=s.element,l=o===void 0?"[data-popper-arrow]":o;l!=null&&(typeof l=="string"&&(l=e.elements.popper.querySelector(l),!l)||cA(e.elements.popper,l)&&(e.elements.arrow=l))}const dA={name:"arrow",enabled:!0,phase:"main",fn:DB,effect:PB,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Ic(n){return n.split("-")[1]}var BB={top:"auto",right:"auto",bottom:"auto",left:"auto"};function FB(n,e){var s=n.x,o=n.y,l=e.devicePixelRatio||1;return{x:vc(s*l)/l||0,y:vc(o*l)/l||0}}function Dw(n){var e,s=n.popper,o=n.popperRect,l=n.placement,a=n.variation,h=n.offsets,d=n.position,p=n.gpuAcceleration,g=n.adaptive,m=n.roundOffsets,T=n.isFixed,b=h.x,y=b===void 0?0:b,C=h.y,L=C===void 0?0:C,A=typeof m=="function"?m({x:y,y:L}):{x:y,y:L};y=A.x,L=A.y;var F=h.hasOwnProperty("x"),z=h.hasOwnProperty("y"),X=Ni,K=Ri,Y=window;if(g){var V=Dh(s),H="clientHeight",Tt="clientWidth";if(V===rs(s)&&(V=Kn(s),Zo(V).position!=="static"&&d==="absolute"&&(H="scrollHeight",Tt="scrollWidth")),V=V,l===Ri||(l===Ni||l===ns)&&a===Ec){K=os;var $t=T&&V===Y&&Y.visualViewport?Y.visualViewport.height:V[H];L-=$t-o.height,L*=p?1:-1}if(l===Ni||(l===Ri||l===os)&&a===Ec){X=ns;var lt=T&&V===Y&&Y.visualViewport?Y.visualViewport.width:V[Tt];y-=lt-o.width,y*=p?1:-1}}var ot=Object.assign({position:d},g&&BB),ct=m===!0?FB({x:y,y:L},rs(s)):{x:y,y:L};if(y=ct.x,L=ct.y,p){var gt;return Object.assign({},ot,(gt={},gt[K]=z?"0":"",gt[X]=F?"0":"",gt.transform=(Y.devicePixelRatio||1)<=1?"translate("+y+"px, "+L+"px)":"translate3d("+y+"px, "+L+"px, 0)",gt))}return Object.assign({},ot,(e={},e[K]=z?L+"px":"",e[X]=F?y+"px":"",e.transform="",e))}function UB(n){var e=n.state,s=n.options,o=s.gpuAcceleration,l=o===void 0?!0:o,a=s.adaptive,h=a===void 0?!0:a,d=s.roundOffsets,p=d===void 0?!0:d,g={placement:$o(e.placement),variation:Ic(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:l,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,Dw(Object.assign({},g,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:h,roundOffsets:p})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,Dw(Object.assign({},g,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:p})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const Qb={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:UB,data:{}};var Dd={passive:!0};function HB(n){var e=n.state,s=n.instance,o=n.options,l=o.scroll,a=l===void 0?!0:l,h=o.resize,d=h===void 0?!0:h,p=rs(e.elements.popper),g=[].concat(e.scrollParents.reference,e.scrollParents.popper);return a&&g.forEach(function(m){m.addEventListener("scroll",s.update,Dd)}),d&&p.addEventListener("resize",s.update,Dd),function(){a&&g.forEach(function(m){m.removeEventListener("scroll",s.update,Dd)}),d&&p.removeEventListener("resize",s.update,Dd)}}const tE={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:HB,data:{}};var VB={left:"right",right:"left",bottom:"top",top:"bottom"};function rp(n){return n.replace(/left|right|bottom|top/g,function(e){return VB[e]})}var GB={start:"end",end:"start"};function Pw(n){return n.replace(/start|end/g,function(e){return GB[e]})}function eE(n){var e=rs(n),s=e.pageXOffset,o=e.pageYOffset;return{scrollLeft:s,scrollTop:o}}function iE(n){return yc(Kn(n)).left+eE(n).scrollLeft}function WB(n,e){var s=rs(n),o=Kn(n),l=s.visualViewport,a=o.clientWidth,h=o.clientHeight,d=0,p=0;if(l){a=l.width,h=l.height;var g=lA();(g||!g&&e==="fixed")&&(d=l.offsetLeft,p=l.offsetTop)}return{width:a,height:h,x:d+iE(n),y:p}}function zB(n){var e,s=Kn(n),o=eE(n),l=(e=n.ownerDocument)==null?void 0:e.body,a=Ur(s.scrollWidth,s.clientWidth,l?l.scrollWidth:0,l?l.clientWidth:0),h=Ur(s.scrollHeight,s.clientHeight,l?l.scrollHeight:0,l?l.clientHeight:0),d=-o.scrollLeft+iE(n),p=-o.scrollTop;return Zo(l||s).direction==="rtl"&&(d+=Ur(s.clientWidth,l?l.clientWidth:0)-a),{width:a,height:h,x:d,y:p}}function sE(n){var e=Zo(n),s=e.overflow,o=e.overflowX,l=e.overflowY;return/auto|scroll|overlay|hidden/.test(s+l+o)}function pA(n){return["html","body","#document"].indexOf(vo(n))>=0?n.ownerDocument.body:ms(n)&&sE(n)?n:pA(jp(n))}function Za(n,e){var s;e===void 0&&(e=[]);var o=pA(n),l=o===((s=n.ownerDocument)==null?void 0:s.body),a=rs(o),h=l?[a].concat(a.visualViewport||[],sE(o)?o:[]):o,d=e.concat(h);return l?d:d.concat(Za(jp(h)))}function ib(n){return Object.assign({},n,{left:n.x,top:n.y,right:n.x+n.width,bottom:n.y+n.height})}function XB(n,e){var s=yc(n,!1,e==="fixed");return s.top=s.top+n.clientTop,s.left=s.left+n.clientLeft,s.bottom=s.top+n.clientHeight,s.right=s.left+n.clientWidth,s.width=n.clientWidth,s.height=n.clientHeight,s.x=s.left,s.y=s.top,s}function Bw(n,e,s){return e===Yb?ib(WB(n,s)):zr(e)?XB(e,s):ib(zB(Kn(n)))}function YB(n){var e=Za(jp(n)),s=["absolute","fixed"].indexOf(Zo(n).position)>=0,o=s&&ms(n)?Dh(n):n;return zr(o)?e.filter(function(l){return zr(l)&&cA(l,o)&&vo(l)!=="body"}):[]}function KB(n,e,s,o){var l=e==="clippingParents"?YB(n):[].concat(e),a=[].concat(l,[s]),h=a[0],d=a.reduce(function(p,g){var m=Bw(n,g,o);return p.top=Ur(m.top,p.top),p.right=Cp(m.right,p.right),p.bottom=Cp(m.bottom,p.bottom),p.left=Ur(m.left,p.left),p},Bw(n,h,o));return d.width=d.right-d.left,d.height=d.bottom-d.top,d.x=d.left,d.y=d.top,d}function fA(n){var e=n.reference,s=n.element,o=n.placement,l=o?$o(o):null,a=o?Ic(o):null,h=e.x+e.width/2-s.width/2,d=e.y+e.height/2-s.height/2,p;switch(l){case Ri:p={x:h,y:e.y-s.height};break;case os:p={x:h,y:e.y+e.height};break;case ns:p={x:e.x+e.width,y:d};break;case Ni:p={x:e.x-s.width,y:d};break;default:p={x:e.x,y:e.y}}var g=l?Zb(l):null;if(g!=null){var m=g==="y"?"height":"width";switch(a){case Wr:p[g]=p[g]-(e[m]/2-s[m]/2);break;case Ec:p[g]=p[g]+(e[m]/2-s[m]/2);break}}return p}function Sc(n,e){e===void 0&&(e={});var s=e,o=s.placement,l=o===void 0?n.placement:o,a=s.strategy,h=a===void 0?n.strategy:a,d=s.boundary,p=d===void 0?jO:d,g=s.rootBoundary,m=g===void 0?Yb:g,T=s.elementContext,b=T===void 0?Jl:T,y=s.altBoundary,C=y===void 0?!1:y,L=s.padding,A=L===void 0?0:L,F=hA(typeof A!="number"?A:uA(A,Rc)),z=b===Jl?JO:Jl,X=n.rects.popper,K=n.elements[C?z:b],Y=KB(zr(K)?K:K.contextElement||Kn(n.elements.popper),p,m,h),V=yc(n.elements.reference),H=fA({reference:V,element:X,strategy:"absolute",placement:l}),Tt=ib(Object.assign({},X,H)),$t=b===Jl?Tt:V,lt={top:Y.top-$t.top+F.top,bottom:$t.bottom-Y.bottom+F.bottom,left:Y.left-$t.left+F.left,right:$t.right-Y.right+F.right},ot=n.modifiersData.offset;if(b===Jl&&ot){var ct=ot[l];Object.keys(lt).forEach(function(gt){var vt=[ns,os].indexOf(gt)>=0?1:-1,it=[Ri,os].indexOf(gt)>=0?"y":"x";lt[gt]+=ct[it]*vt})}return lt}function jB(n,e){e===void 0&&(e={});var s=e,o=s.placement,l=s.boundary,a=s.rootBoundary,h=s.padding,d=s.flipVariations,p=s.allowedAutoPlacements,g=p===void 0?Kb:p,m=Ic(o),T=m?d?tb:tb.filter(function(C){return Ic(C)===m}):Rc,b=T.filter(function(C){return g.indexOf(C)>=0});b.length===0&&(b=T);var y=b.reduce(function(C,L){return C[L]=Sc(n,{placement:L,boundary:l,rootBoundary:a,padding:h})[$o(L)],C},{});return Object.keys(y).sort(function(C,L){return y[C]-y[L]})}function JB(n){if($o(n)===Kp)return[];var e=rp(n);return[Pw(n),e,Pw(e)]}function qB(n){var e=n.state,s=n.options,o=n.name;if(!e.modifiersData[o]._skip){for(var l=s.mainAxis,a=l===void 0?!0:l,h=s.altAxis,d=h===void 0?!0:h,p=s.fallbackPlacements,g=s.padding,m=s.boundary,T=s.rootBoundary,b=s.altBoundary,y=s.flipVariations,C=y===void 0?!0:y,L=s.allowedAutoPlacements,A=e.options.placement,F=$o(A),z=F===A,X=p||(z||!C?[rp(A)]:JB(A)),K=[A].concat(X).reduce(function(ut,be){return ut.concat($o(be)===Kp?jB(e,{placement:be,boundary:m,rootBoundary:T,padding:g,flipVariations:C,allowedAutoPlacements:L}):be)},[]),Y=e.rects.reference,V=e.rects.popper,H=new Map,Tt=!0,$t=K[0],lt=0;lt<K.length;lt++){var ot=K[lt],ct=$o(ot),gt=Ic(ot)===Wr,vt=[Ri,os].indexOf(ct)>=0,it=vt?"width":"height",Ft=Sc(e,{placement:ot,boundary:m,rootBoundary:T,altBoundary:b,padding:g}),Rt=vt?gt?ns:Ni:gt?os:Ri;Y[it]>V[it]&&(Rt=rp(Rt));var Nt=rp(Rt),me=[];if(a&&me.push(Ft[ct]<=0),d&&me.push(Ft[Rt]<=0,Ft[Nt]<=0),me.every(function(ut){return ut})){$t=ot,Tt=!1;break}H.set(ot,me)}if(Tt)for(var Lt=C?3:1,Gt=function(be){var _e=K.find(function(xe){var Ee=H.get(xe);if(Ee)return Ee.slice(0,be).every(function(ai){return ai})});if(_e)return $t=_e,"break"},Ht=Lt;Ht>0;Ht--){var fe=Gt(Ht);if(fe==="break")break}e.placement!==$t&&(e.modifiersData[o]._skip=!0,e.placement=$t,e.reset=!0)}}const gA={name:"flip",enabled:!0,phase:"main",fn:qB,requiresIfExists:["offset"],data:{_skip:!1}};function Fw(n,e,s){return s===void 0&&(s={x:0,y:0}),{top:n.top-e.height-s.y,right:n.right-e.width+s.x,bottom:n.bottom-e.height+s.y,left:n.left-e.width-s.x}}function Uw(n){return[Ri,ns,os,Ni].some(function(e){return n[e]>=0})}function ZB(n){var e=n.state,s=n.name,o=e.rects.reference,l=e.rects.popper,a=e.modifiersData.preventOverflow,h=Sc(e,{elementContext:"reference"}),d=Sc(e,{altBoundary:!0}),p=Fw(h,o),g=Fw(d,l,a),m=Uw(p),T=Uw(g);e.modifiersData[s]={referenceClippingOffsets:p,popperEscapeOffsets:g,isReferenceHidden:m,hasPopperEscaped:T},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":m,"data-popper-escaped":T})}const mA={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:ZB};function QB(n,e,s){var o=$o(n),l=[Ni,Ri].indexOf(o)>=0?-1:1,a=typeof s=="function"?s(Object.assign({},e,{placement:n})):s,h=a[0],d=a[1];return h=h||0,d=(d||0)*l,[Ni,ns].indexOf(o)>=0?{x:d,y:h}:{x:h,y:d}}function tF(n){var e=n.state,s=n.options,o=n.name,l=s.offset,a=l===void 0?[0,0]:l,h=Kb.reduce(function(m,T){return m[T]=QB(T,e.rects,a),m},{}),d=h[e.placement],p=d.x,g=d.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=p,e.modifiersData.popperOffsets.y+=g),e.modifiersData[o]=h}const $A={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:tF};function eF(n){var e=n.state,s=n.name;e.modifiersData[s]=fA({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})}const oE={name:"popperOffsets",enabled:!0,phase:"read",fn:eF,data:{}};function iF(n){return n==="x"?"y":"x"}function sF(n){var e=n.state,s=n.options,o=n.name,l=s.mainAxis,a=l===void 0?!0:l,h=s.altAxis,d=h===void 0?!1:h,p=s.boundary,g=s.rootBoundary,m=s.altBoundary,T=s.padding,b=s.tether,y=b===void 0?!0:b,C=s.tetherOffset,L=C===void 0?0:C,A=Sc(e,{boundary:p,rootBoundary:g,padding:T,altBoundary:m}),F=$o(e.placement),z=Ic(e.placement),X=!z,K=Zb(F),Y=iF(K),V=e.modifiersData.popperOffsets,H=e.rects.reference,Tt=e.rects.popper,$t=typeof L=="function"?L(Object.assign({},e.rects,{placement:e.placement})):L,lt=typeof $t=="number"?{mainAxis:$t,altAxis:$t}:Object.assign({mainAxis:0,altAxis:0},$t),ot=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,ct={x:0,y:0};if(V){if(a){var gt,vt=K==="y"?Ri:Ni,it=K==="y"?os:ns,Ft=K==="y"?"height":"width",Rt=V[K],Nt=Rt+A[vt],me=Rt-A[it],Lt=y?-Tt[Ft]/2:0,Gt=z===Wr?H[Ft]:Tt[Ft],Ht=z===Wr?-Tt[Ft]:-H[Ft],fe=e.elements.arrow,ut=y&&fe?qb(fe):{width:0,height:0},be=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:aA(),_e=be[vt],xe=be[it],Ee=qa(0,H[Ft],ut[Ft]),ai=X?H[Ft]/2-Lt-Ee-_e-lt.mainAxis:Gt-Ee-_e-lt.mainAxis,Ke=X?-H[Ft]/2+Lt+Ee+xe+lt.mainAxis:Ht+Ee+xe+lt.mainAxis,hi=e.elements.arrow&&Dh(e.elements.arrow),yt=hi?K==="y"?hi.clientTop||0:hi.clientLeft||0:0,w=(gt=ot==null?void 0:ot[K])!=null?gt:0,N=Rt+ai-w-yt,G=Rt+Ke-w,q=qa(y?Cp(Nt,N):Nt,Rt,y?Ur(me,G):me);V[K]=q,ct[K]=q-Rt}if(d){var Z,st=K==="x"?Ri:Ni,ht=K==="x"?os:ns,et=V[Y],dt=Y==="y"?"height":"width",j=et+A[st],R=et-A[ht],J=[Ri,Ni].indexOf(F)!==-1,kt=(Z=ot==null?void 0:ot[Y])!=null?Z:0,mt=J?j:et-H[dt]-Tt[dt]-kt+lt.altAxis,Vt=J?et+H[dt]+Tt[dt]-kt-lt.altAxis:R,Ct=y&&J?MB(mt,et,Vt):qa(y?mt:j,et,y?Vt:R);V[Y]=Ct,ct[Y]=Ct-et}e.modifiersData[o]=ct}}const _A={name:"preventOverflow",enabled:!0,phase:"main",fn:sF,requiresIfExists:["offset"]};function oF(n){return{scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}}function nF(n){return n===rs(n)||!ms(n)?eE(n):oF(n)}function rF(n){var e=n.getBoundingClientRect(),s=vc(e.width)/n.offsetWidth||1,o=vc(e.height)/n.offsetHeight||1;return s!==1||o!==1}function lF(n,e,s){s===void 0&&(s=!1);var o=ms(e),l=ms(e)&&rF(e),a=Kn(e),h=yc(n,l,s),d={scrollLeft:0,scrollTop:0},p={x:0,y:0};return(o||!o&&!s)&&((vo(e)!=="body"||sE(a))&&(d=nF(e)),ms(e)?(p=yc(e,!0),p.x+=e.clientLeft,p.y+=e.clientTop):a&&(p.x=iE(a))),{x:h.left+d.scrollLeft-p.x,y:h.top+d.scrollTop-p.y,width:h.width,height:h.height}}function cF(n){var e=new Map,s=new Set,o=[];n.forEach(function(a){e.set(a.name,a)});function l(a){s.add(a.name);var h=[].concat(a.requires||[],a.requiresIfExists||[]);h.forEach(function(d){if(!s.has(d)){var p=e.get(d);p&&l(p)}}),o.push(a)}return n.forEach(function(a){s.has(a.name)||l(a)}),o}function aF(n){var e=cF(n);return rA.reduce(function(s,o){return s.concat(e.filter(function(l){return l.phase===o}))},[])}function hF(n){var e;return function(){return e||(e=new Promise(function(s){Promise.resolve().then(function(){e=void 0,s(n())})})),e}}function uF(n){var e=n.reduce(function(s,o){var l=s[o.name];return s[o.name]=l?Object.assign({},l,o,{options:Object.assign({},l.options,o.options),data:Object.assign({},l.data,o.data)}):o,s},{});return Object.keys(e).map(function(s){return e[s]})}var Hw={placement:"bottom",modifiers:[],strategy:"absolute"};function Vw(){for(var n=arguments.length,e=new Array(n),s=0;s<n;s++)e[s]=arguments[s];return!e.some(function(o){return!(o&&typeof o.getBoundingClientRect=="function")})}function Jp(n){n===void 0&&(n={});var e=n,s=e.defaultModifiers,o=s===void 0?[]:s,l=e.defaultOptions,a=l===void 0?Hw:l;return function(d,p,g){g===void 0&&(g=a);var m={placement:"bottom",orderedModifiers:[],options:Object.assign({},Hw,a),modifiersData:{},elements:{reference:d,popper:p},attributes:{},styles:{}},T=[],b=!1,y={state:m,setOptions:function(F){var z=typeof F=="function"?F(m.options):F;L(),m.options=Object.assign({},a,m.options,z),m.scrollParents={reference:zr(d)?Za(d):d.contextElement?Za(d.contextElement):[],popper:Za(p)};var X=aF(uF([].concat(o,m.options.modifiers)));return m.orderedModifiers=X.filter(function(K){return K.enabled}),C(),y.update()},forceUpdate:function(){if(!b){var F=m.elements,z=F.reference,X=F.popper;if(Vw(z,X)){m.rects={reference:lF(z,Dh(X),m.options.strategy==="fixed"),popper:qb(X)},m.reset=!1,m.placement=m.options.placement,m.orderedModifiers.forEach(function(lt){return m.modifiersData[lt.name]=Object.assign({},lt.data)});for(var K=0;K<m.orderedModifiers.length;K++){if(m.reset===!0){m.reset=!1,K=-1;continue}var Y=m.orderedModifiers[K],V=Y.fn,H=Y.options,Tt=H===void 0?{}:H,$t=Y.name;typeof V=="function"&&(m=V({state:m,options:Tt,name:$t,instance:y})||m)}}}},update:hF(function(){return new Promise(function(A){y.forceUpdate(),A(m)})}),destroy:function(){L(),b=!0}};if(!Vw(d,p))return y;y.setOptions(g).then(function(A){!b&&g.onFirstUpdate&&g.onFirstUpdate(A)});function C(){m.orderedModifiers.forEach(function(A){var F=A.name,z=A.options,X=z===void 0?{}:z,K=A.effect;if(typeof K=="function"){var Y=K({state:m,name:F,instance:y,options:X}),V=function(){};T.push(Y||V)}})}function L(){T.forEach(function(A){return A()}),T=[]}return y}}var dF=Jp(),pF=[tE,oE,Qb,Jb],fF=Jp({defaultModifiers:pF}),gF=[tE,oE,Qb,Jb,$A,gA,_A,dA,mA],nE=Jp({defaultModifiers:gF});const TA=Object.freeze(Object.defineProperty({__proto__:null,afterMain:iA,afterRead:QO,afterWrite:nA,applyStyles:Jb,arrow:dA,auto:Kp,basePlacements:Rc,beforeMain:tA,beforeRead:qO,beforeWrite:sA,bottom:os,clippingParents:jO,computeStyles:Qb,createPopper:nE,createPopperBase:dF,createPopperLite:fF,detectOverflow:Sc,end:Ec,eventListeners:tE,flip:gA,hide:mA,left:Ni,main:eA,modifierPhases:rA,offset:$A,placements:Kb,popper:Jl,popperGenerator:Jp,popperOffsets:oE,preventOverflow:_A,read:ZO,reference:JO,right:ns,start:Wr,top:Ri,variationPlacements:tb,viewport:Yb,write:oA},Symbol.toStringTag,{value:"Module"}));/*!
  * Bootstrap v5.3.2 (https://getbootstrap.com/)
  * Copyright 2011-2023 The Bootstrap Authors (https://github.com/twbs/bootstrap/graphs/contributors)
  * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
  */const In=new Map,b_={set(n,e,s){In.has(n)||In.set(n,new Map);const o=In.get(n);if(!o.has(e)&&o.size!==0){console.error(`Bootstrap doesn't allow more than one instance per element. Bound instance: ${Array.from(o.keys())[0]}.`);return}o.set(e,s)},get(n,e){return In.has(n)&&In.get(n).get(e)||null},remove(n,e){if(!In.has(n))return;const s=In.get(n);s.delete(e),s.size===0&&In.delete(n)}},mF=1e6,$F=1e3,sb="transitionend",bA=n=>(n&&window.CSS&&window.CSS.escape&&(n=n.replace(/#([^\s"#']+)/g,(e,s)=>`#${CSS.escape(s)}`)),n),_F=n=>n==null?`${n}`:Object.prototype.toString.call(n).match(/\s([a-z]+)/i)[1].toLowerCase(),TF=n=>{do n+=Math.floor(Math.random()*mF);while(document.getElementById(n));return n},bF=n=>{if(!n)return 0;let{transitionDuration:e,transitionDelay:s}=window.getComputedStyle(n);const o=Number.parseFloat(e),l=Number.parseFloat(s);return!o&&!l?0:(e=e.split(",")[0],s=s.split(",")[0],(Number.parseFloat(e)+Number.parseFloat(s))*$F)},EA=n=>{n.dispatchEvent(new Event(sb))},Wo=n=>!n||typeof n!="object"?!1:(typeof n.jquery<"u"&&(n=n[0]),typeof n.nodeType<"u"),Gn=n=>Wo(n)?n.jquery?n[0]:n:typeof n=="string"&&n.length>0?document.querySelector(bA(n)):null,Nc=n=>{if(!Wo(n)||n.getClientRects().length===0)return!1;const e=getComputedStyle(n).getPropertyValue("visibility")==="visible",s=n.closest("details:not([open])");if(!s)return e;if(s!==n){const o=n.closest("summary");if(o&&o.parentNode!==s||o===null)return!1}return e},Wn=n=>!n||n.nodeType!==Node.ELEMENT_NODE||n.classList.contains("disabled")?!0:typeof n.disabled<"u"?n.disabled:n.hasAttribute("disabled")&&n.getAttribute("disabled")!=="false",vA=n=>{if(!document.documentElement.attachShadow)return null;if(typeof n.getRootNode=="function"){const e=n.getRootNode();return e instanceof ShadowRoot?e:null}return n instanceof ShadowRoot?n:n.parentNode?vA(n.parentNode):null},wp=()=>{},Ph=n=>{n.offsetHeight},yA=()=>window.jQuery&&!document.body.hasAttribute("data-bs-no-jquery")?window.jQuery:null,E_=[],EF=n=>{document.readyState==="loading"?(E_.length||document.addEventListener("DOMContentLoaded",()=>{for(const e of E_)e()}),E_.push(n)):n()},$s=()=>document.documentElement.dir==="rtl",Ts=n=>{EF(()=>{const e=yA();if(e){const s=n.NAME,o=e.fn[s];e.fn[s]=n.jQueryInterface,e.fn[s].Constructor=n,e.fn[s].noConflict=()=>(e.fn[s]=o,n.jQueryInterface)}})},Ui=(n,e=[],s=n)=>typeof n=="function"?n(...e):s,IA=(n,e,s=!0)=>{if(!s){Ui(n);return}const o=5,l=bF(e)+o;let a=!1;const h=({target:d})=>{d===e&&(a=!0,e.removeEventListener(sb,h),Ui(n))};e.addEventListener(sb,h),setTimeout(()=>{a||EA(e)},l)},rE=(n,e,s,o)=>{const l=n.length;let a=n.indexOf(e);return a===-1?!s&&o?n[l-1]:n[0]:(a+=s?1:-1,o&&(a=(a+l)%l),n[Math.max(0,Math.min(a,l-1))])},vF=/[^.]*(?=\..*)\.|.*/,yF=/\..*/,IF=/::\d+$/,v_={};let Gw=1;const SA={mouseenter:"mouseover",mouseleave:"mouseout"},SF=new Set(["click","dblclick","mouseup","mousedown","contextmenu","mousewheel","DOMMouseScroll","mouseover","mouseout","mousemove","selectstart","selectend","keydown","keypress","keyup","orientationchange","touchstart","touchmove","touchend","touchcancel","pointerdown","pointermove","pointerup","pointerleave","pointercancel","gesturestart","gesturechange","gestureend","focus","blur","change","reset","select","submit","focusin","focusout","load","unload","beforeunload","resize","move","DOMContentLoaded","readystatechange","error","abort","scroll"]);function CA(n,e){return e&&`${e}::${Gw++}`||n.uidEvent||Gw++}function wA(n){const e=CA(n);return n.uidEvent=e,v_[e]=v_[e]||{},v_[e]}function CF(n,e){return function s(o){return lE(o,{delegateTarget:n}),s.oneOff&&at.off(n,o.type,e),e.apply(n,[o])}}function wF(n,e,s){return function o(l){const a=n.querySelectorAll(e);for(let{target:h}=l;h&&h!==this;h=h.parentNode)for(const d of a)if(d===h)return lE(l,{delegateTarget:h}),o.oneOff&&at.off(n,l.type,e,s),s.apply(h,[l])}}function kA(n,e,s=null){return Object.values(n).find(o=>o.callable===e&&o.delegationSelector===s)}function OA(n,e,s){const o=typeof e=="string",l=o?s:e||s;let a=AA(n);return SF.has(a)||(a=n),[o,l,a]}function Ww(n,e,s,o,l){if(typeof e!="string"||!n)return;let[a,h,d]=OA(e,s,o);e in SA&&(h=(C=>function(L){if(!L.relatedTarget||L.relatedTarget!==L.delegateTarget&&!L.delegateTarget.contains(L.relatedTarget))return C.call(this,L)})(h));const p=wA(n),g=p[d]||(p[d]={}),m=kA(g,h,a?s:null);if(m){m.oneOff=m.oneOff&&l;return}const T=CA(h,e.replace(vF,"")),b=a?wF(n,s,h):CF(n,h);b.delegationSelector=a?s:null,b.callable=h,b.oneOff=l,b.uidEvent=T,g[T]=b,n.addEventListener(d,b,a)}function ob(n,e,s,o,l){const a=kA(e[s],o,l);a&&(n.removeEventListener(s,a,!!l),delete e[s][a.uidEvent])}function kF(n,e,s,o){const l=e[s]||{};for(const[a,h]of Object.entries(l))a.includes(o)&&ob(n,e,s,h.callable,h.delegationSelector)}function AA(n){return n=n.replace(yF,""),SA[n]||n}const at={on(n,e,s,o){Ww(n,e,s,o,!1)},one(n,e,s,o){Ww(n,e,s,o,!0)},off(n,e,s,o){if(typeof e!="string"||!n)return;const[l,a,h]=OA(e,s,o),d=h!==e,p=wA(n),g=p[h]||{},m=e.startsWith(".");if(typeof a<"u"){if(!Object.keys(g).length)return;ob(n,p,h,a,l?s:null);return}if(m)for(const T of Object.keys(p))kF(n,p,T,e.slice(1));for(const[T,b]of Object.entries(g)){const y=T.replace(IF,"");(!d||e.includes(y))&&ob(n,p,h,b.callable,b.delegationSelector)}},trigger(n,e,s){if(typeof e!="string"||!n)return null;const o=yA(),l=AA(e),a=e!==l;let h=null,d=!0,p=!0,g=!1;a&&o&&(h=o.Event(e,s),o(n).trigger(h),d=!h.isPropagationStopped(),p=!h.isImmediatePropagationStopped(),g=h.isDefaultPrevented());const m=lE(new Event(e,{bubbles:d,cancelable:!0}),s);return g&&m.preventDefault(),p&&n.dispatchEvent(m),m.defaultPrevented&&h&&h.preventDefault(),m}};function lE(n,e={}){for(const[s,o]of Object.entries(e))try{n[s]=o}catch{Object.defineProperty(n,s,{configurable:!0,get(){return o}})}return n}function zw(n){if(n==="true")return!0;if(n==="false")return!1;if(n===Number(n).toString())return Number(n);if(n===""||n==="null")return null;if(typeof n!="string")return n;try{return JSON.parse(decodeURIComponent(n))}catch{return n}}function y_(n){return n.replace(/[A-Z]/g,e=>`-${e.toLowerCase()}`)}const zo={setDataAttribute(n,e,s){n.setAttribute(`data-bs-${y_(e)}`,s)},removeDataAttribute(n,e){n.removeAttribute(`data-bs-${y_(e)}`)},getDataAttributes(n){if(!n)return{};const e={},s=Object.keys(n.dataset).filter(o=>o.startsWith("bs")&&!o.startsWith("bsConfig"));for(const o of s){let l=o.replace(/^bs/,"");l=l.charAt(0).toLowerCase()+l.slice(1,l.length),e[l]=zw(n.dataset[o])}return e},getDataAttribute(n,e){return zw(n.getAttribute(`data-bs-${y_(e)}`))}};class Bh{static get Default(){return{}}static get DefaultType(){return{}}static get NAME(){throw new Error('You have to implement the static method "NAME", for each component!')}_getConfig(e){return e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e}_mergeConfigObj(e,s){const o=Wo(s)?zo.getDataAttribute(s,"config"):{};return{...this.constructor.Default,...typeof o=="object"?o:{},...Wo(s)?zo.getDataAttributes(s):{},...typeof e=="object"?e:{}}}_typeCheckConfig(e,s=this.constructor.DefaultType){for(const[o,l]of Object.entries(s)){const a=e[o],h=Wo(a)?"element":_F(a);if(!new RegExp(l).test(h))throw new TypeError(`${this.constructor.NAME.toUpperCase()}: Option "${o}" provided type "${h}" but expected type "${l}".`)}}}const OF="5.3.2";class Ds extends Bh{constructor(e,s){super(),e=Gn(e),e&&(this._element=e,this._config=this._getConfig(s),b_.set(this._element,this.constructor.DATA_KEY,this))}dispose(){b_.remove(this._element,this.constructor.DATA_KEY),at.off(this._element,this.constructor.EVENT_KEY);for(const e of Object.getOwnPropertyNames(this))this[e]=null}_queueCallback(e,s,o=!0){IA(e,s,o)}_getConfig(e){return e=this._mergeConfigObj(e,this._element),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}static getInstance(e){return b_.get(Gn(e),this.DATA_KEY)}static getOrCreateInstance(e,s={}){return this.getInstance(e)||new this(e,typeof s=="object"?s:null)}static get VERSION(){return OF}static get DATA_KEY(){return`bs.${this.NAME}`}static get EVENT_KEY(){return`.${this.DATA_KEY}`}static eventName(e){return`${e}${this.EVENT_KEY}`}}const I_=n=>{let e=n.getAttribute("data-bs-target");if(!e||e==="#"){let s=n.getAttribute("href");if(!s||!s.includes("#")&&!s.startsWith("."))return null;s.includes("#")&&!s.startsWith("#")&&(s=`#${s.split("#")[1]}`),e=s&&s!=="#"?bA(s.trim()):null}return e},Bt={find(n,e=document.documentElement){return[].concat(...Element.prototype.querySelectorAll.call(e,n))},findOne(n,e=document.documentElement){return Element.prototype.querySelector.call(e,n)},children(n,e){return[].concat(...n.children).filter(s=>s.matches(e))},parents(n,e){const s=[];let o=n.parentNode.closest(e);for(;o;)s.push(o),o=o.parentNode.closest(e);return s},prev(n,e){let s=n.previousElementSibling;for(;s;){if(s.matches(e))return[s];s=s.previousElementSibling}return[]},next(n,e){let s=n.nextElementSibling;for(;s;){if(s.matches(e))return[s];s=s.nextElementSibling}return[]},focusableChildren(n){const e=["a","button","input","textarea","select","details","[tabindex]",'[contenteditable="true"]'].map(s=>`${s}:not([tabindex^="-"])`).join(",");return this.find(e,n).filter(s=>!Wn(s)&&Nc(s))},getSelectorFromElement(n){const e=I_(n);return e&&Bt.findOne(e)?e:null},getElementFromSelector(n){const e=I_(n);return e?Bt.findOne(e):null},getMultipleElementsFromSelector(n){const e=I_(n);return e?Bt.find(e):[]}},qp=(n,e="hide")=>{const s=`click.dismiss${n.EVENT_KEY}`,o=n.NAME;at.on(document,s,`[data-bs-dismiss="${o}"]`,function(l){if(["A","AREA"].includes(this.tagName)&&l.preventDefault(),Wn(this))return;const a=Bt.getElementFromSelector(this)||this.closest(`.${o}`);n.getOrCreateInstance(a)[e]()})},AF="alert",RF="bs.alert",RA=`.${RF}`,NF=`close${RA}`,LF=`closed${RA}`,MF="fade",xF="show";class Zp extends Ds{static get NAME(){return AF}close(){if(at.trigger(this._element,NF).defaultPrevented)return;this._element.classList.remove(xF);const s=this._element.classList.contains(MF);this._queueCallback(()=>this._destroyElement(),this._element,s)}_destroyElement(){this._element.remove(),at.trigger(this._element,LF),this.dispose()}static jQueryInterface(e){return this.each(function(){const s=Zp.getOrCreateInstance(this);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}qp(Zp,"close");Ts(Zp);const DF="button",PF="bs.button",BF=`.${PF}`,FF=".data-api",UF="active",Xw='[data-bs-toggle="button"]',HF=`click${BF}${FF}`;class Qp extends Ds{static get NAME(){return DF}toggle(){this._element.setAttribute("aria-pressed",this._element.classList.toggle(UF))}static jQueryInterface(e){return this.each(function(){const s=Qp.getOrCreateInstance(this);e==="toggle"&&s[e]()})}}at.on(document,HF,Xw,n=>{n.preventDefault();const e=n.target.closest(Xw);Qp.getOrCreateInstance(e).toggle()});Ts(Qp);const VF="swipe",Lc=".bs.swipe",GF=`touchstart${Lc}`,WF=`touchmove${Lc}`,zF=`touchend${Lc}`,XF=`pointerdown${Lc}`,YF=`pointerup${Lc}`,KF="touch",jF="pen",JF="pointer-event",qF=40,ZF={endCallback:null,leftCallback:null,rightCallback:null},QF={endCallback:"(function|null)",leftCallback:"(function|null)",rightCallback:"(function|null)"};class kp extends Bh{constructor(e,s){super(),this._element=e,!(!e||!kp.isSupported())&&(this._config=this._getConfig(s),this._deltaX=0,this._supportPointerEvents=!!window.PointerEvent,this._initEvents())}static get Default(){return ZF}static get DefaultType(){return QF}static get NAME(){return VF}dispose(){at.off(this._element,Lc)}_start(e){if(!this._supportPointerEvents){this._deltaX=e.touches[0].clientX;return}this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX)}_end(e){this._eventIsPointerPenTouch(e)&&(this._deltaX=e.clientX-this._deltaX),this._handleSwipe(),Ui(this._config.endCallback)}_move(e){this._deltaX=e.touches&&e.touches.length>1?0:e.touches[0].clientX-this._deltaX}_handleSwipe(){const e=Math.abs(this._deltaX);if(e<=qF)return;const s=e/this._deltaX;this._deltaX=0,s&&Ui(s>0?this._config.rightCallback:this._config.leftCallback)}_initEvents(){this._supportPointerEvents?(at.on(this._element,XF,e=>this._start(e)),at.on(this._element,YF,e=>this._end(e)),this._element.classList.add(JF)):(at.on(this._element,GF,e=>this._start(e)),at.on(this._element,WF,e=>this._move(e)),at.on(this._element,zF,e=>this._end(e)))}_eventIsPointerPenTouch(e){return this._supportPointerEvents&&(e.pointerType===jF||e.pointerType===KF)}static isSupported(){return"ontouchstart"in document.documentElement||navigator.maxTouchPoints>0}}const tU="carousel",eU="bs.carousel",jn=`.${eU}`,NA=".data-api",iU="ArrowLeft",sU="ArrowRight",oU=500,Ra="next",Kl="prev",ql="left",lp="right",nU=`slide${jn}`,S_=`slid${jn}`,rU=`keydown${jn}`,lU=`mouseenter${jn}`,cU=`mouseleave${jn}`,aU=`dragstart${jn}`,hU=`load${jn}${NA}`,uU=`click${jn}${NA}`,LA="carousel",Pd="active",dU="slide",pU="carousel-item-end",fU="carousel-item-start",gU="carousel-item-next",mU="carousel-item-prev",MA=".active",xA=".carousel-item",$U=MA+xA,_U=".carousel-item img",TU=".carousel-indicators",bU="[data-bs-slide], [data-bs-slide-to]",EU='[data-bs-ride="carousel"]',vU={[iU]:lp,[sU]:ql},yU={interval:5e3,keyboard:!0,pause:"hover",ride:!1,touch:!0,wrap:!0},IU={interval:"(number|boolean)",keyboard:"boolean",pause:"(string|boolean)",ride:"(boolean|string)",touch:"boolean",wrap:"boolean"};class Fh extends Ds{constructor(e,s){super(e,s),this._interval=null,this._activeElement=null,this._isSliding=!1,this.touchTimeout=null,this._swipeHelper=null,this._indicatorsElement=Bt.findOne(TU,this._element),this._addEventListeners(),this._config.ride===LA&&this.cycle()}static get Default(){return yU}static get DefaultType(){return IU}static get NAME(){return tU}next(){this._slide(Ra)}nextWhenVisible(){!document.hidden&&Nc(this._element)&&this.next()}prev(){this._slide(Kl)}pause(){this._isSliding&&EA(this._element),this._clearInterval()}cycle(){this._clearInterval(),this._updateInterval(),this._interval=setInterval(()=>this.nextWhenVisible(),this._config.interval)}_maybeEnableCycle(){if(this._config.ride){if(this._isSliding){at.one(this._element,S_,()=>this.cycle());return}this.cycle()}}to(e){const s=this._getItems();if(e>s.length-1||e<0)return;if(this._isSliding){at.one(this._element,S_,()=>this.to(e));return}const o=this._getItemIndex(this._getActive());if(o===e)return;const l=e>o?Ra:Kl;this._slide(l,s[e])}dispose(){this._swipeHelper&&this._swipeHelper.dispose(),super.dispose()}_configAfterMerge(e){return e.defaultInterval=e.interval,e}_addEventListeners(){this._config.keyboard&&at.on(this._element,rU,e=>this._keydown(e)),this._config.pause==="hover"&&(at.on(this._element,lU,()=>this.pause()),at.on(this._element,cU,()=>this._maybeEnableCycle())),this._config.touch&&kp.isSupported()&&this._addTouchEventListeners()}_addTouchEventListeners(){for(const o of Bt.find(_U,this._element))at.on(o,aU,l=>l.preventDefault());const s={leftCallback:()=>this._slide(this._directionToOrder(ql)),rightCallback:()=>this._slide(this._directionToOrder(lp)),endCallback:()=>{this._config.pause==="hover"&&(this.pause(),this.touchTimeout&&clearTimeout(this.touchTimeout),this.touchTimeout=setTimeout(()=>this._maybeEnableCycle(),oU+this._config.interval))}};this._swipeHelper=new kp(this._element,s)}_keydown(e){if(/input|textarea/i.test(e.target.tagName))return;const s=vU[e.key];s&&(e.preventDefault(),this._slide(this._directionToOrder(s)))}_getItemIndex(e){return this._getItems().indexOf(e)}_setActiveIndicatorElement(e){if(!this._indicatorsElement)return;const s=Bt.findOne(MA,this._indicatorsElement);s.classList.remove(Pd),s.removeAttribute("aria-current");const o=Bt.findOne(`[data-bs-slide-to="${e}"]`,this._indicatorsElement);o&&(o.classList.add(Pd),o.setAttribute("aria-current","true"))}_updateInterval(){const e=this._activeElement||this._getActive();if(!e)return;const s=Number.parseInt(e.getAttribute("data-bs-interval"),10);this._config.interval=s||this._config.defaultInterval}_slide(e,s=null){if(this._isSliding)return;const o=this._getActive(),l=e===Ra,a=s||rE(this._getItems(),o,l,this._config.wrap);if(a===o)return;const h=this._getItemIndex(a),d=y=>at.trigger(this._element,y,{relatedTarget:a,direction:this._orderToDirection(e),from:this._getItemIndex(o),to:h});if(d(nU).defaultPrevented||!o||!a)return;const g=!!this._interval;this.pause(),this._isSliding=!0,this._setActiveIndicatorElement(h),this._activeElement=a;const m=l?fU:pU,T=l?gU:mU;a.classList.add(T),Ph(a),o.classList.add(m),a.classList.add(m);const b=()=>{a.classList.remove(m,T),a.classList.add(Pd),o.classList.remove(Pd,T,m),this._isSliding=!1,d(S_)};this._queueCallback(b,o,this._isAnimated()),g&&this.cycle()}_isAnimated(){return this._element.classList.contains(dU)}_getActive(){return Bt.findOne($U,this._element)}_getItems(){return Bt.find(xA,this._element)}_clearInterval(){this._interval&&(clearInterval(this._interval),this._interval=null)}_directionToOrder(e){return $s()?e===ql?Kl:Ra:e===ql?Ra:Kl}_orderToDirection(e){return $s()?e===Kl?ql:lp:e===Kl?lp:ql}static jQueryInterface(e){return this.each(function(){const s=Fh.getOrCreateInstance(this,e);if(typeof e=="number"){s.to(e);return}if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}at.on(document,uU,bU,function(n){const e=Bt.getElementFromSelector(this);if(!e||!e.classList.contains(LA))return;n.preventDefault();const s=Fh.getOrCreateInstance(e),o=this.getAttribute("data-bs-slide-to");if(o){s.to(o),s._maybeEnableCycle();return}if(zo.getDataAttribute(this,"slide")==="next"){s.next(),s._maybeEnableCycle();return}s.prev(),s._maybeEnableCycle()});at.on(window,hU,()=>{const n=Bt.find(EU);for(const e of n)Fh.getOrCreateInstance(e)});Ts(Fh);const SU="collapse",CU="bs.collapse",Uh=`.${CU}`,wU=".data-api",kU=`show${Uh}`,OU=`shown${Uh}`,AU=`hide${Uh}`,RU=`hidden${Uh}`,NU=`click${Uh}${wU}`,C_="show",ic="collapse",Bd="collapsing",LU="collapsed",MU=`:scope .${ic} .${ic}`,xU="collapse-horizontal",DU="width",PU="height",BU=".collapse.show, .collapse.collapsing",nb='[data-bs-toggle="collapse"]',FU={parent:null,toggle:!0},UU={parent:"(null|element)",toggle:"boolean"};class Ah extends Ds{constructor(e,s){super(e,s),this._isTransitioning=!1,this._triggerArray=[];const o=Bt.find(nb);for(const l of o){const a=Bt.getSelectorFromElement(l),h=Bt.find(a).filter(d=>d===this._element);a!==null&&h.length&&this._triggerArray.push(l)}this._initializeChildren(),this._config.parent||this._addAriaAndCollapsedClass(this._triggerArray,this._isShown()),this._config.toggle&&this.toggle()}static get Default(){return FU}static get DefaultType(){return UU}static get NAME(){return SU}toggle(){this._isShown()?this.hide():this.show()}show(){if(this._isTransitioning||this._isShown())return;let e=[];if(this._config.parent&&(e=this._getFirstLevelChildren(BU).filter(d=>d!==this._element).map(d=>Ah.getOrCreateInstance(d,{toggle:!1}))),e.length&&e[0]._isTransitioning||at.trigger(this._element,kU).defaultPrevented)return;for(const d of e)d.hide();const o=this._getDimension();this._element.classList.remove(ic),this._element.classList.add(Bd),this._element.style[o]=0,this._addAriaAndCollapsedClass(this._triggerArray,!0),this._isTransitioning=!0;const l=()=>{this._isTransitioning=!1,this._element.classList.remove(Bd),this._element.classList.add(ic,C_),this._element.style[o]="",at.trigger(this._element,OU)},h=`scroll${o[0].toUpperCase()+o.slice(1)}`;this._queueCallback(l,this._element,!0),this._element.style[o]=`${this._element[h]}px`}hide(){if(this._isTransitioning||!this._isShown()||at.trigger(this._element,AU).defaultPrevented)return;const s=this._getDimension();this._element.style[s]=`${this._element.getBoundingClientRect()[s]}px`,Ph(this._element),this._element.classList.add(Bd),this._element.classList.remove(ic,C_);for(const l of this._triggerArray){const a=Bt.getElementFromSelector(l);a&&!this._isShown(a)&&this._addAriaAndCollapsedClass([l],!1)}this._isTransitioning=!0;const o=()=>{this._isTransitioning=!1,this._element.classList.remove(Bd),this._element.classList.add(ic),at.trigger(this._element,RU)};this._element.style[s]="",this._queueCallback(o,this._element,!0)}_isShown(e=this._element){return e.classList.contains(C_)}_configAfterMerge(e){return e.toggle=!!e.toggle,e.parent=Gn(e.parent),e}_getDimension(){return this._element.classList.contains(xU)?DU:PU}_initializeChildren(){if(!this._config.parent)return;const e=this._getFirstLevelChildren(nb);for(const s of e){const o=Bt.getElementFromSelector(s);o&&this._addAriaAndCollapsedClass([s],this._isShown(o))}}_getFirstLevelChildren(e){const s=Bt.find(MU,this._config.parent);return Bt.find(e,this._config.parent).filter(o=>!s.includes(o))}_addAriaAndCollapsedClass(e,s){if(e.length)for(const o of e)o.classList.toggle(LU,!s),o.setAttribute("aria-expanded",s)}static jQueryInterface(e){const s={};return typeof e=="string"&&/show|hide/.test(e)&&(s.toggle=!1),this.each(function(){const o=Ah.getOrCreateInstance(this,s);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e]()}})}}at.on(document,NU,nb,function(n){(n.target.tagName==="A"||n.delegateTarget&&n.delegateTarget.tagName==="A")&&n.preventDefault();for(const e of Bt.getMultipleElementsFromSelector(this))Ah.getOrCreateInstance(e,{toggle:!1}).toggle()});Ts(Ah);const Yw="dropdown",HU="bs.dropdown",Kr=`.${HU}`,cE=".data-api",VU="Escape",Kw="Tab",GU="ArrowUp",jw="ArrowDown",WU=2,zU=`hide${Kr}`,XU=`hidden${Kr}`,YU=`show${Kr}`,KU=`shown${Kr}`,DA=`click${Kr}${cE}`,PA=`keydown${Kr}${cE}`,jU=`keyup${Kr}${cE}`,Zl="show",JU="dropup",qU="dropend",ZU="dropstart",QU="dropup-center",tH="dropdown-center",xr='[data-bs-toggle="dropdown"]:not(.disabled):not(:disabled)',eH=`${xr}.${Zl}`,cp=".dropdown-menu",iH=".navbar",sH=".navbar-nav",oH=".dropdown-menu .dropdown-item:not(.disabled):not(:disabled)",nH=$s()?"top-end":"top-start",rH=$s()?"top-start":"top-end",lH=$s()?"bottom-end":"bottom-start",cH=$s()?"bottom-start":"bottom-end",aH=$s()?"left-start":"right-start",hH=$s()?"right-start":"left-start",uH="top",dH="bottom",pH={autoClose:!0,boundary:"clippingParents",display:"dynamic",offset:[0,2],popperConfig:null,reference:"toggle"},fH={autoClose:"(boolean|string)",boundary:"(string|element)",display:"string",offset:"(array|string|function)",popperConfig:"(null|object|function)",reference:"(string|element|object)"};class _o extends Ds{constructor(e,s){super(e,s),this._popper=null,this._parent=this._element.parentNode,this._menu=Bt.next(this._element,cp)[0]||Bt.prev(this._element,cp)[0]||Bt.findOne(cp,this._parent),this._inNavbar=this._detectNavbar()}static get Default(){return pH}static get DefaultType(){return fH}static get NAME(){return Yw}toggle(){return this._isShown()?this.hide():this.show()}show(){if(Wn(this._element)||this._isShown())return;const e={relatedTarget:this._element};if(!at.trigger(this._element,YU,e).defaultPrevented){if(this._createPopper(),"ontouchstart"in document.documentElement&&!this._parent.closest(sH))for(const o of[].concat(...document.body.children))at.on(o,"mouseover",wp);this._element.focus(),this._element.setAttribute("aria-expanded",!0),this._menu.classList.add(Zl),this._element.classList.add(Zl),at.trigger(this._element,KU,e)}}hide(){if(Wn(this._element)||!this._isShown())return;const e={relatedTarget:this._element};this._completeHide(e)}dispose(){this._popper&&this._popper.destroy(),super.dispose()}update(){this._inNavbar=this._detectNavbar(),this._popper&&this._popper.update()}_completeHide(e){if(!at.trigger(this._element,zU,e).defaultPrevented){if("ontouchstart"in document.documentElement)for(const o of[].concat(...document.body.children))at.off(o,"mouseover",wp);this._popper&&this._popper.destroy(),this._menu.classList.remove(Zl),this._element.classList.remove(Zl),this._element.setAttribute("aria-expanded","false"),zo.removeDataAttribute(this._menu,"popper"),at.trigger(this._element,XU,e)}}_getConfig(e){if(e=super._getConfig(e),typeof e.reference=="object"&&!Wo(e.reference)&&typeof e.reference.getBoundingClientRect!="function")throw new TypeError(`${Yw.toUpperCase()}: Option "reference" provided type "object" without a required "getBoundingClientRect" method.`);return e}_createPopper(){if(typeof TA>"u")throw new TypeError("Bootstrap's dropdowns require Popper (https://popper.js.org)");let e=this._element;this._config.reference==="parent"?e=this._parent:Wo(this._config.reference)?e=Gn(this._config.reference):typeof this._config.reference=="object"&&(e=this._config.reference);const s=this._getPopperConfig();this._popper=nE(e,this._menu,s)}_isShown(){return this._menu.classList.contains(Zl)}_getPlacement(){const e=this._parent;if(e.classList.contains(qU))return aH;if(e.classList.contains(ZU))return hH;if(e.classList.contains(QU))return uH;if(e.classList.contains(tH))return dH;const s=getComputedStyle(this._menu).getPropertyValue("--bs-position").trim()==="end";return e.classList.contains(JU)?s?rH:nH:s?cH:lH}_detectNavbar(){return this._element.closest(iH)!==null}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(s=>Number.parseInt(s,10)):typeof e=="function"?s=>e(s,this._element):e}_getPopperConfig(){const e={placement:this._getPlacement(),modifiers:[{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"offset",options:{offset:this._getOffset()}}]};return(this._inNavbar||this._config.display==="static")&&(zo.setDataAttribute(this._menu,"popper","static"),e.modifiers=[{name:"applyStyles",enabled:!1}]),{...e,...Ui(this._config.popperConfig,[e])}}_selectMenuItem({key:e,target:s}){const o=Bt.find(oH,this._menu).filter(l=>Nc(l));o.length&&rE(o,s,e===jw,!o.includes(s)).focus()}static jQueryInterface(e){return this.each(function(){const s=_o.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}static clearMenus(e){if(e.button===WU||e.type==="keyup"&&e.key!==Kw)return;const s=Bt.find(eH);for(const o of s){const l=_o.getInstance(o);if(!l||l._config.autoClose===!1)continue;const a=e.composedPath(),h=a.includes(l._menu);if(a.includes(l._element)||l._config.autoClose==="inside"&&!h||l._config.autoClose==="outside"&&h||l._menu.contains(e.target)&&(e.type==="keyup"&&e.key===Kw||/input|select|option|textarea|form/i.test(e.target.tagName)))continue;const d={relatedTarget:l._element};e.type==="click"&&(d.clickEvent=e),l._completeHide(d)}}static dataApiKeydownHandler(e){const s=/input|textarea/i.test(e.target.tagName),o=e.key===VU,l=[GU,jw].includes(e.key);if(!l&&!o||s&&!o)return;e.preventDefault();const a=this.matches(xr)?this:Bt.prev(this,xr)[0]||Bt.next(this,xr)[0]||Bt.findOne(xr,e.delegateTarget.parentNode),h=_o.getOrCreateInstance(a);if(l){e.stopPropagation(),h.show(),h._selectMenuItem(e);return}h._isShown()&&(e.stopPropagation(),h.hide(),a.focus())}}at.on(document,PA,xr,_o.dataApiKeydownHandler);at.on(document,PA,cp,_o.dataApiKeydownHandler);at.on(document,DA,_o.clearMenus);at.on(document,jU,_o.clearMenus);at.on(document,DA,xr,function(n){n.preventDefault(),_o.getOrCreateInstance(this).toggle()});Ts(_o);const BA="backdrop",gH="fade",Jw="show",qw=`mousedown.bs.${BA}`,mH={className:"modal-backdrop",clickCallback:null,isAnimated:!1,isVisible:!0,rootElement:"body"},$H={className:"string",clickCallback:"(function|null)",isAnimated:"boolean",isVisible:"boolean",rootElement:"(element|string)"};class FA extends Bh{constructor(e){super(),this._config=this._getConfig(e),this._isAppended=!1,this._element=null}static get Default(){return mH}static get DefaultType(){return $H}static get NAME(){return BA}show(e){if(!this._config.isVisible){Ui(e);return}this._append();const s=this._getElement();this._config.isAnimated&&Ph(s),s.classList.add(Jw),this._emulateAnimation(()=>{Ui(e)})}hide(e){if(!this._config.isVisible){Ui(e);return}this._getElement().classList.remove(Jw),this._emulateAnimation(()=>{this.dispose(),Ui(e)})}dispose(){this._isAppended&&(at.off(this._element,qw),this._element.remove(),this._isAppended=!1)}_getElement(){if(!this._element){const e=document.createElement("div");e.className=this._config.className,this._config.isAnimated&&e.classList.add(gH),this._element=e}return this._element}_configAfterMerge(e){return e.rootElement=Gn(e.rootElement),e}_append(){if(this._isAppended)return;const e=this._getElement();this._config.rootElement.append(e),at.on(e,qw,()=>{Ui(this._config.clickCallback)}),this._isAppended=!0}_emulateAnimation(e){IA(e,this._getElement(),this._config.isAnimated)}}const _H="focustrap",TH="bs.focustrap",Op=`.${TH}`,bH=`focusin${Op}`,EH=`keydown.tab${Op}`,vH="Tab",yH="forward",Zw="backward",IH={autofocus:!0,trapElement:null},SH={autofocus:"boolean",trapElement:"element"};class UA extends Bh{constructor(e){super(),this._config=this._getConfig(e),this._isActive=!1,this._lastTabNavDirection=null}static get Default(){return IH}static get DefaultType(){return SH}static get NAME(){return _H}activate(){this._isActive||(this._config.autofocus&&this._config.trapElement.focus(),at.off(document,Op),at.on(document,bH,e=>this._handleFocusin(e)),at.on(document,EH,e=>this._handleKeydown(e)),this._isActive=!0)}deactivate(){this._isActive&&(this._isActive=!1,at.off(document,Op))}_handleFocusin(e){const{trapElement:s}=this._config;if(e.target===document||e.target===s||s.contains(e.target))return;const o=Bt.focusableChildren(s);o.length===0?s.focus():this._lastTabNavDirection===Zw?o[o.length-1].focus():o[0].focus()}_handleKeydown(e){e.key===vH&&(this._lastTabNavDirection=e.shiftKey?Zw:yH)}}const Qw=".fixed-top, .fixed-bottom, .is-fixed, .sticky-top",tk=".sticky-top",Fd="padding-right",ek="margin-right";class rb{constructor(){this._element=document.body}getWidth(){const e=document.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}hide(){const e=this.getWidth();this._disableOverFlow(),this._setElementAttributes(this._element,Fd,s=>s+e),this._setElementAttributes(Qw,Fd,s=>s+e),this._setElementAttributes(tk,ek,s=>s-e)}reset(){this._resetElementAttributes(this._element,"overflow"),this._resetElementAttributes(this._element,Fd),this._resetElementAttributes(Qw,Fd),this._resetElementAttributes(tk,ek)}isOverflowing(){return this.getWidth()>0}_disableOverFlow(){this._saveInitialAttribute(this._element,"overflow"),this._element.style.overflow="hidden"}_setElementAttributes(e,s,o){const l=this.getWidth(),a=h=>{if(h!==this._element&&window.innerWidth>h.clientWidth+l)return;this._saveInitialAttribute(h,s);const d=window.getComputedStyle(h).getPropertyValue(s);h.style.setProperty(s,`${o(Number.parseFloat(d))}px`)};this._applyManipulationCallback(e,a)}_saveInitialAttribute(e,s){const o=e.style.getPropertyValue(s);o&&zo.setDataAttribute(e,s,o)}_resetElementAttributes(e,s){const o=l=>{const a=zo.getDataAttribute(l,s);if(a===null){l.style.removeProperty(s);return}zo.removeDataAttribute(l,s),l.style.setProperty(s,a)};this._applyManipulationCallback(e,o)}_applyManipulationCallback(e,s){if(Wo(e)){s(e);return}for(const o of Bt.find(e,this._element))s(o)}}const CH="modal",wH="bs.modal",_s=`.${wH}`,kH=".data-api",OH="Escape",AH=`hide${_s}`,RH=`hidePrevented${_s}`,HA=`hidden${_s}`,VA=`show${_s}`,NH=`shown${_s}`,LH=`resize${_s}`,MH=`click.dismiss${_s}`,xH=`mousedown.dismiss${_s}`,DH=`keydown.dismiss${_s}`,PH=`click${_s}${kH}`,ik="modal-open",BH="fade",sk="show",w_="modal-static",FH=".modal.show",UH=".modal-dialog",HH=".modal-body",VH='[data-bs-toggle="modal"]',GH={backdrop:!0,focus:!0,keyboard:!0},WH={backdrop:"(boolean|string)",focus:"boolean",keyboard:"boolean"};class Cc extends Ds{constructor(e,s){super(e,s),this._dialog=Bt.findOne(UH,this._element),this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._isShown=!1,this._isTransitioning=!1,this._scrollBar=new rb,this._addEventListeners()}static get Default(){return GH}static get DefaultType(){return WH}static get NAME(){return CH}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){this._isShown||this._isTransitioning||at.trigger(this._element,VA,{relatedTarget:e}).defaultPrevented||(this._isShown=!0,this._isTransitioning=!0,this._scrollBar.hide(),document.body.classList.add(ik),this._adjustDialog(),this._backdrop.show(()=>this._showElement(e)))}hide(){!this._isShown||this._isTransitioning||at.trigger(this._element,AH).defaultPrevented||(this._isShown=!1,this._isTransitioning=!0,this._focustrap.deactivate(),this._element.classList.remove(sk),this._queueCallback(()=>this._hideModal(),this._element,this._isAnimated()))}dispose(){at.off(window,_s),at.off(this._dialog,_s),this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}handleUpdate(){this._adjustDialog()}_initializeBackDrop(){return new FA({isVisible:!!this._config.backdrop,isAnimated:this._isAnimated()})}_initializeFocusTrap(){return new UA({trapElement:this._element})}_showElement(e){document.body.contains(this._element)||document.body.append(this._element),this._element.style.display="block",this._element.removeAttribute("aria-hidden"),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.scrollTop=0;const s=Bt.findOne(HH,this._dialog);s&&(s.scrollTop=0),Ph(this._element),this._element.classList.add(sk);const o=()=>{this._config.focus&&this._focustrap.activate(),this._isTransitioning=!1,at.trigger(this._element,NH,{relatedTarget:e})};this._queueCallback(o,this._dialog,this._isAnimated())}_addEventListeners(){at.on(this._element,DH,e=>{if(e.key===OH){if(this._config.keyboard){this.hide();return}this._triggerBackdropTransition()}}),at.on(window,LH,()=>{this._isShown&&!this._isTransitioning&&this._adjustDialog()}),at.on(this._element,xH,e=>{at.one(this._element,MH,s=>{if(!(this._element!==e.target||this._element!==s.target)){if(this._config.backdrop==="static"){this._triggerBackdropTransition();return}this._config.backdrop&&this.hide()}})})}_hideModal(){this._element.style.display="none",this._element.setAttribute("aria-hidden",!0),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._isTransitioning=!1,this._backdrop.hide(()=>{document.body.classList.remove(ik),this._resetAdjustments(),this._scrollBar.reset(),at.trigger(this._element,HA)})}_isAnimated(){return this._element.classList.contains(BH)}_triggerBackdropTransition(){if(at.trigger(this._element,RH).defaultPrevented)return;const s=this._element.scrollHeight>document.documentElement.clientHeight,o=this._element.style.overflowY;o==="hidden"||this._element.classList.contains(w_)||(s||(this._element.style.overflowY="hidden"),this._element.classList.add(w_),this._queueCallback(()=>{this._element.classList.remove(w_),this._queueCallback(()=>{this._element.style.overflowY=o},this._dialog)},this._dialog),this._element.focus())}_adjustDialog(){const e=this._element.scrollHeight>document.documentElement.clientHeight,s=this._scrollBar.getWidth(),o=s>0;if(o&&!e){const l=$s()?"paddingLeft":"paddingRight";this._element.style[l]=`${s}px`}if(!o&&e){const l=$s()?"paddingRight":"paddingLeft";this._element.style[l]=`${s}px`}}_resetAdjustments(){this._element.style.paddingLeft="",this._element.style.paddingRight=""}static jQueryInterface(e,s){return this.each(function(){const o=Cc.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof o[e]>"u")throw new TypeError(`No method named "${e}"`);o[e](s)}})}}at.on(document,PH,VH,function(n){const e=Bt.getElementFromSelector(this);["A","AREA"].includes(this.tagName)&&n.preventDefault(),at.one(e,VA,l=>{l.defaultPrevented||at.one(e,HA,()=>{Nc(this)&&this.focus()})});const s=Bt.findOne(FH);s&&Cc.getInstance(s).hide(),Cc.getOrCreateInstance(e).toggle(this)});qp(Cc);Ts(Cc);const zH="offcanvas",XH="bs.offcanvas",en=`.${XH}`,GA=".data-api",YH=`load${en}${GA}`,KH="Escape",ok="show",nk="showing",rk="hiding",jH="offcanvas-backdrop",WA=".offcanvas.show",JH=`show${en}`,qH=`shown${en}`,ZH=`hide${en}`,lk=`hidePrevented${en}`,zA=`hidden${en}`,QH=`resize${en}`,tV=`click${en}${GA}`,eV=`keydown.dismiss${en}`,iV='[data-bs-toggle="offcanvas"]',sV={backdrop:!0,keyboard:!0,scroll:!1},oV={backdrop:"(boolean|string)",keyboard:"boolean",scroll:"boolean"};class zn extends Ds{constructor(e,s){super(e,s),this._isShown=!1,this._backdrop=this._initializeBackDrop(),this._focustrap=this._initializeFocusTrap(),this._addEventListeners()}static get Default(){return sV}static get DefaultType(){return oV}static get NAME(){return zH}toggle(e){return this._isShown?this.hide():this.show(e)}show(e){if(this._isShown||at.trigger(this._element,JH,{relatedTarget:e}).defaultPrevented)return;this._isShown=!0,this._backdrop.show(),this._config.scroll||new rb().hide(),this._element.setAttribute("aria-modal",!0),this._element.setAttribute("role","dialog"),this._element.classList.add(nk);const o=()=>{(!this._config.scroll||this._config.backdrop)&&this._focustrap.activate(),this._element.classList.add(ok),this._element.classList.remove(nk),at.trigger(this._element,qH,{relatedTarget:e})};this._queueCallback(o,this._element,!0)}hide(){if(!this._isShown||at.trigger(this._element,ZH).defaultPrevented)return;this._focustrap.deactivate(),this._element.blur(),this._isShown=!1,this._element.classList.add(rk),this._backdrop.hide();const s=()=>{this._element.classList.remove(ok,rk),this._element.removeAttribute("aria-modal"),this._element.removeAttribute("role"),this._config.scroll||new rb().reset(),at.trigger(this._element,zA)};this._queueCallback(s,this._element,!0)}dispose(){this._backdrop.dispose(),this._focustrap.deactivate(),super.dispose()}_initializeBackDrop(){const e=()=>{if(this._config.backdrop==="static"){at.trigger(this._element,lk);return}this.hide()},s=!!this._config.backdrop;return new FA({className:jH,isVisible:s,isAnimated:!0,rootElement:this._element.parentNode,clickCallback:s?e:null})}_initializeFocusTrap(){return new UA({trapElement:this._element})}_addEventListeners(){at.on(this._element,eV,e=>{if(e.key===KH){if(this._config.keyboard){this.hide();return}at.trigger(this._element,lk)}})}static jQueryInterface(e){return this.each(function(){const s=zn.getOrCreateInstance(this,e);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}at.on(document,tV,iV,function(n){const e=Bt.getElementFromSelector(this);if(["A","AREA"].includes(this.tagName)&&n.preventDefault(),Wn(this))return;at.one(e,zA,()=>{Nc(this)&&this.focus()});const s=Bt.findOne(WA);s&&s!==e&&zn.getInstance(s).hide(),zn.getOrCreateInstance(e).toggle(this)});at.on(window,YH,()=>{for(const n of Bt.find(WA))zn.getOrCreateInstance(n).show()});at.on(window,QH,()=>{for(const n of Bt.find("[aria-modal][class*=show][class*=offcanvas-]"))getComputedStyle(n).position!=="fixed"&&zn.getOrCreateInstance(n).hide()});qp(zn);Ts(zn);const nV=/^aria-[\w-]*$/i,XA={"*":["class","dir","id","lang","role",nV],a:["target","href","title","rel"],area:[],b:[],br:[],col:[],code:[],div:[],em:[],hr:[],h1:[],h2:[],h3:[],h4:[],h5:[],h6:[],i:[],img:["src","srcset","alt","title","width","height"],li:[],ol:[],p:[],pre:[],s:[],small:[],span:[],sub:[],sup:[],strong:[],u:[],ul:[]},rV=new Set(["background","cite","href","itemtype","longdesc","poster","src","xlink:href"]),lV=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:/?#]*(?:[/?#]|$))/i,cV=(n,e)=>{const s=n.nodeName.toLowerCase();return e.includes(s)?rV.has(s)?!!lV.test(n.nodeValue):!0:e.filter(o=>o instanceof RegExp).some(o=>o.test(s))};function aV(n,e,s){if(!n.length)return n;if(s&&typeof s=="function")return s(n);const l=new window.DOMParser().parseFromString(n,"text/html"),a=[].concat(...l.body.querySelectorAll("*"));for(const h of a){const d=h.nodeName.toLowerCase();if(!Object.keys(e).includes(d)){h.remove();continue}const p=[].concat(...h.attributes),g=[].concat(e["*"]||[],e[d]||[]);for(const m of p)cV(m,g)||h.removeAttribute(m.nodeName)}return l.body.innerHTML}const hV="TemplateFactory",uV={allowList:XA,content:{},extraClass:"",html:!1,sanitize:!0,sanitizeFn:null,template:"<div></div>"},dV={allowList:"object",content:"object",extraClass:"(string|function)",html:"boolean",sanitize:"boolean",sanitizeFn:"(null|function)",template:"string"},pV={entry:"(string|element|function|null)",selector:"(string|element)"};class fV extends Bh{constructor(e){super(),this._config=this._getConfig(e)}static get Default(){return uV}static get DefaultType(){return dV}static get NAME(){return hV}getContent(){return Object.values(this._config.content).map(e=>this._resolvePossibleFunction(e)).filter(Boolean)}hasContent(){return this.getContent().length>0}changeContent(e){return this._checkContent(e),this._config.content={...this._config.content,...e},this}toHtml(){const e=document.createElement("div");e.innerHTML=this._maybeSanitize(this._config.template);for(const[l,a]of Object.entries(this._config.content))this._setContent(e,a,l);const s=e.children[0],o=this._resolvePossibleFunction(this._config.extraClass);return o&&s.classList.add(...o.split(" ")),s}_typeCheckConfig(e){super._typeCheckConfig(e),this._checkContent(e.content)}_checkContent(e){for(const[s,o]of Object.entries(e))super._typeCheckConfig({selector:s,entry:o},pV)}_setContent(e,s,o){const l=Bt.findOne(o,e);if(l){if(s=this._resolvePossibleFunction(s),!s){l.remove();return}if(Wo(s)){this._putElementInTemplate(Gn(s),l);return}if(this._config.html){l.innerHTML=this._maybeSanitize(s);return}l.textContent=s}}_maybeSanitize(e){return this._config.sanitize?aV(e,this._config.allowList,this._config.sanitizeFn):e}_resolvePossibleFunction(e){return Ui(e,[this])}_putElementInTemplate(e,s){if(this._config.html){s.innerHTML="",s.append(e);return}s.textContent=e.textContent}}const gV="tooltip",mV=new Set(["sanitize","allowList","sanitizeFn"]),k_="fade",$V="modal",Ud="show",_V=".tooltip-inner",ck=`.${$V}`,ak="hide.bs.modal",Na="hover",O_="focus",TV="click",bV="manual",EV="hide",vV="hidden",yV="show",IV="shown",SV="inserted",CV="click",wV="focusin",kV="focusout",OV="mouseenter",AV="mouseleave",RV={AUTO:"auto",TOP:"top",RIGHT:$s()?"left":"right",BOTTOM:"bottom",LEFT:$s()?"right":"left"},NV={allowList:XA,animation:!0,boundary:"clippingParents",container:!1,customClass:"",delay:0,fallbackPlacements:["top","right","bottom","left"],html:!1,offset:[0,6],placement:"top",popperConfig:null,sanitize:!0,sanitizeFn:null,selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',title:"",trigger:"hover focus"},LV={allowList:"object",animation:"boolean",boundary:"(string|element)",container:"(string|element|boolean)",customClass:"(string|function)",delay:"(number|object)",fallbackPlacements:"array",html:"boolean",offset:"(array|string|function)",placement:"(string|function)",popperConfig:"(null|object|function)",sanitize:"boolean",sanitizeFn:"(null|function)",selector:"(string|boolean)",template:"string",title:"(string|element|function)",trigger:"string"};class Mc extends Ds{constructor(e,s){if(typeof TA>"u")throw new TypeError("Bootstrap's tooltips require Popper (https://popper.js.org)");super(e,s),this._isEnabled=!0,this._timeout=0,this._isHovered=null,this._activeTrigger={},this._popper=null,this._templateFactory=null,this._newContent=null,this.tip=null,this._setListeners(),this._config.selector||this._fixTitle()}static get Default(){return NV}static get DefaultType(){return LV}static get NAME(){return gV}enable(){this._isEnabled=!0}disable(){this._isEnabled=!1}toggleEnabled(){this._isEnabled=!this._isEnabled}toggle(){if(this._isEnabled){if(this._activeTrigger.click=!this._activeTrigger.click,this._isShown()){this._leave();return}this._enter()}}dispose(){clearTimeout(this._timeout),at.off(this._element.closest(ck),ak,this._hideModalHandler),this._element.getAttribute("data-bs-original-title")&&this._element.setAttribute("title",this._element.getAttribute("data-bs-original-title")),this._disposePopper(),super.dispose()}show(){if(this._element.style.display==="none")throw new Error("Please use show on visible elements");if(!(this._isWithContent()&&this._isEnabled))return;const e=at.trigger(this._element,this.constructor.eventName(yV)),o=(vA(this._element)||this._element.ownerDocument.documentElement).contains(this._element);if(e.defaultPrevented||!o)return;this._disposePopper();const l=this._getTipElement();this._element.setAttribute("aria-describedby",l.getAttribute("id"));const{container:a}=this._config;if(this._element.ownerDocument.documentElement.contains(this.tip)||(a.append(l),at.trigger(this._element,this.constructor.eventName(SV))),this._popper=this._createPopper(l),l.classList.add(Ud),"ontouchstart"in document.documentElement)for(const d of[].concat(...document.body.children))at.on(d,"mouseover",wp);const h=()=>{at.trigger(this._element,this.constructor.eventName(IV)),this._isHovered===!1&&this._leave(),this._isHovered=!1};this._queueCallback(h,this.tip,this._isAnimated())}hide(){if(!this._isShown()||at.trigger(this._element,this.constructor.eventName(EV)).defaultPrevented)return;if(this._getTipElement().classList.remove(Ud),"ontouchstart"in document.documentElement)for(const l of[].concat(...document.body.children))at.off(l,"mouseover",wp);this._activeTrigger[TV]=!1,this._activeTrigger[O_]=!1,this._activeTrigger[Na]=!1,this._isHovered=null;const o=()=>{this._isWithActiveTrigger()||(this._isHovered||this._disposePopper(),this._element.removeAttribute("aria-describedby"),at.trigger(this._element,this.constructor.eventName(vV)))};this._queueCallback(o,this.tip,this._isAnimated())}update(){this._popper&&this._popper.update()}_isWithContent(){return!!this._getTitle()}_getTipElement(){return this.tip||(this.tip=this._createTipElement(this._newContent||this._getContentForTemplate())),this.tip}_createTipElement(e){const s=this._getTemplateFactory(e).toHtml();if(!s)return null;s.classList.remove(k_,Ud),s.classList.add(`bs-${this.constructor.NAME}-auto`);const o=TF(this.constructor.NAME).toString();return s.setAttribute("id",o),this._isAnimated()&&s.classList.add(k_),s}setContent(e){this._newContent=e,this._isShown()&&(this._disposePopper(),this.show())}_getTemplateFactory(e){return this._templateFactory?this._templateFactory.changeContent(e):this._templateFactory=new fV({...this._config,content:e,extraClass:this._resolvePossibleFunction(this._config.customClass)}),this._templateFactory}_getContentForTemplate(){return{[_V]:this._getTitle()}}_getTitle(){return this._resolvePossibleFunction(this._config.title)||this._element.getAttribute("data-bs-original-title")}_initializeOnDelegatedTarget(e){return this.constructor.getOrCreateInstance(e.delegateTarget,this._getDelegateConfig())}_isAnimated(){return this._config.animation||this.tip&&this.tip.classList.contains(k_)}_isShown(){return this.tip&&this.tip.classList.contains(Ud)}_createPopper(e){const s=Ui(this._config.placement,[this,e,this._element]),o=RV[s.toUpperCase()];return nE(this._element,e,this._getPopperConfig(o))}_getOffset(){const{offset:e}=this._config;return typeof e=="string"?e.split(",").map(s=>Number.parseInt(s,10)):typeof e=="function"?s=>e(s,this._element):e}_resolvePossibleFunction(e){return Ui(e,[this._element])}_getPopperConfig(e){const s={placement:e,modifiers:[{name:"flip",options:{fallbackPlacements:this._config.fallbackPlacements}},{name:"offset",options:{offset:this._getOffset()}},{name:"preventOverflow",options:{boundary:this._config.boundary}},{name:"arrow",options:{element:`.${this.constructor.NAME}-arrow`}},{name:"preSetPlacement",enabled:!0,phase:"beforeMain",fn:o=>{this._getTipElement().setAttribute("data-popper-placement",o.state.placement)}}]};return{...s,...Ui(this._config.popperConfig,[s])}}_setListeners(){const e=this._config.trigger.split(" ");for(const s of e)if(s==="click")at.on(this._element,this.constructor.eventName(CV),this._config.selector,o=>{this._initializeOnDelegatedTarget(o).toggle()});else if(s!==bV){const o=s===Na?this.constructor.eventName(OV):this.constructor.eventName(wV),l=s===Na?this.constructor.eventName(AV):this.constructor.eventName(kV);at.on(this._element,o,this._config.selector,a=>{const h=this._initializeOnDelegatedTarget(a);h._activeTrigger[a.type==="focusin"?O_:Na]=!0,h._enter()}),at.on(this._element,l,this._config.selector,a=>{const h=this._initializeOnDelegatedTarget(a);h._activeTrigger[a.type==="focusout"?O_:Na]=h._element.contains(a.relatedTarget),h._leave()})}this._hideModalHandler=()=>{this._element&&this.hide()},at.on(this._element.closest(ck),ak,this._hideModalHandler)}_fixTitle(){const e=this._element.getAttribute("title");e&&(!this._element.getAttribute("aria-label")&&!this._element.textContent.trim()&&this._element.setAttribute("aria-label",e),this._element.setAttribute("data-bs-original-title",e),this._element.removeAttribute("title"))}_enter(){if(this._isShown()||this._isHovered){this._isHovered=!0;return}this._isHovered=!0,this._setTimeout(()=>{this._isHovered&&this.show()},this._config.delay.show)}_leave(){this._isWithActiveTrigger()||(this._isHovered=!1,this._setTimeout(()=>{this._isHovered||this.hide()},this._config.delay.hide))}_setTimeout(e,s){clearTimeout(this._timeout),this._timeout=setTimeout(e,s)}_isWithActiveTrigger(){return Object.values(this._activeTrigger).includes(!0)}_getConfig(e){const s=zo.getDataAttributes(this._element);for(const o of Object.keys(s))mV.has(o)&&delete s[o];return e={...s,...typeof e=="object"&&e?e:{}},e=this._mergeConfigObj(e),e=this._configAfterMerge(e),this._typeCheckConfig(e),e}_configAfterMerge(e){return e.container=e.container===!1?document.body:Gn(e.container),typeof e.delay=="number"&&(e.delay={show:e.delay,hide:e.delay}),typeof e.title=="number"&&(e.title=e.title.toString()),typeof e.content=="number"&&(e.content=e.content.toString()),e}_getDelegateConfig(){const e={};for(const[s,o]of Object.entries(this._config))this.constructor.Default[s]!==o&&(e[s]=o);return e.selector=!1,e.trigger="manual",e}_disposePopper(){this._popper&&(this._popper.destroy(),this._popper=null),this.tip&&(this.tip.remove(),this.tip=null)}static jQueryInterface(e){return this.each(function(){const s=Mc.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}}Ts(Mc);const MV="popover",xV=".popover-header",DV=".popover-body",PV={...Mc.Default,content:"",offset:[0,8],placement:"right",template:'<div class="popover" role="tooltip"><div class="popover-arrow"></div><h3 class="popover-header"></h3><div class="popover-body"></div></div>',trigger:"click"},BV={...Mc.DefaultType,content:"(null|string|element|function)"};class aE extends Mc{static get Default(){return PV}static get DefaultType(){return BV}static get NAME(){return MV}_isWithContent(){return this._getTitle()||this._getContent()}_getContentForTemplate(){return{[xV]:this._getTitle(),[DV]:this._getContent()}}_getContent(){return this._resolvePossibleFunction(this._config.content)}static jQueryInterface(e){return this.each(function(){const s=aE.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e]()}})}}Ts(aE);const FV="scrollspy",UV="bs.scrollspy",hE=`.${UV}`,HV=".data-api",VV=`activate${hE}`,hk=`click${hE}`,GV=`load${hE}${HV}`,WV="dropdown-item",jl="active",zV='[data-bs-spy="scroll"]',A_="[href]",XV=".nav, .list-group",uk=".nav-link",YV=".nav-item",KV=".list-group-item",jV=`${uk}, ${YV} > ${uk}, ${KV}`,JV=".dropdown",qV=".dropdown-toggle",ZV={offset:null,rootMargin:"0px 0px -25%",smoothScroll:!1,target:null,threshold:[.1,.5,1]},QV={offset:"(number|null)",rootMargin:"string",smoothScroll:"boolean",target:"element",threshold:"array"};class tf extends Ds{constructor(e,s){super(e,s),this._targetLinks=new Map,this._observableSections=new Map,this._rootElement=getComputedStyle(this._element).overflowY==="visible"?null:this._element,this._activeTarget=null,this._observer=null,this._previousScrollData={visibleEntryTop:0,parentScrollTop:0},this.refresh()}static get Default(){return ZV}static get DefaultType(){return QV}static get NAME(){return FV}refresh(){this._initializeTargetsAndObservables(),this._maybeEnableSmoothScroll(),this._observer?this._observer.disconnect():this._observer=this._getNewObserver();for(const e of this._observableSections.values())this._observer.observe(e)}dispose(){this._observer.disconnect(),super.dispose()}_configAfterMerge(e){return e.target=Gn(e.target)||document.body,e.rootMargin=e.offset?`${e.offset}px 0px -30%`:e.rootMargin,typeof e.threshold=="string"&&(e.threshold=e.threshold.split(",").map(s=>Number.parseFloat(s))),e}_maybeEnableSmoothScroll(){this._config.smoothScroll&&(at.off(this._config.target,hk),at.on(this._config.target,hk,A_,e=>{const s=this._observableSections.get(e.target.hash);if(s){e.preventDefault();const o=this._rootElement||window,l=s.offsetTop-this._element.offsetTop;if(o.scrollTo){o.scrollTo({top:l,behavior:"smooth"});return}o.scrollTop=l}}))}_getNewObserver(){const e={root:this._rootElement,threshold:this._config.threshold,rootMargin:this._config.rootMargin};return new IntersectionObserver(s=>this._observerCallback(s),e)}_observerCallback(e){const s=h=>this._targetLinks.get(`#${h.target.id}`),o=h=>{this._previousScrollData.visibleEntryTop=h.target.offsetTop,this._process(s(h))},l=(this._rootElement||document.documentElement).scrollTop,a=l>=this._previousScrollData.parentScrollTop;this._previousScrollData.parentScrollTop=l;for(const h of e){if(!h.isIntersecting){this._activeTarget=null,this._clearActiveClass(s(h));continue}const d=h.target.offsetTop>=this._previousScrollData.visibleEntryTop;if(a&&d){if(o(h),!l)return;continue}!a&&!d&&o(h)}}_initializeTargetsAndObservables(){this._targetLinks=new Map,this._observableSections=new Map;const e=Bt.find(A_,this._config.target);for(const s of e){if(!s.hash||Wn(s))continue;const o=Bt.findOne(decodeURI(s.hash),this._element);Nc(o)&&(this._targetLinks.set(decodeURI(s.hash),s),this._observableSections.set(s.hash,o))}}_process(e){this._activeTarget!==e&&(this._clearActiveClass(this._config.target),this._activeTarget=e,e.classList.add(jl),this._activateParents(e),at.trigger(this._element,VV,{relatedTarget:e}))}_activateParents(e){if(e.classList.contains(WV)){Bt.findOne(qV,e.closest(JV)).classList.add(jl);return}for(const s of Bt.parents(e,XV))for(const o of Bt.prev(s,jV))o.classList.add(jl)}_clearActiveClass(e){e.classList.remove(jl);const s=Bt.find(`${A_}.${jl}`,e);for(const o of s)o.classList.remove(jl)}static jQueryInterface(e){return this.each(function(){const s=tf.getOrCreateInstance(this,e);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}at.on(window,GV,()=>{for(const n of Bt.find(zV))tf.getOrCreateInstance(n)});Ts(tf);const t2="tab",e2="bs.tab",jr=`.${e2}`,i2=`hide${jr}`,s2=`hidden${jr}`,o2=`show${jr}`,n2=`shown${jr}`,r2=`click${jr}`,l2=`keydown${jr}`,c2=`load${jr}`,a2="ArrowLeft",dk="ArrowRight",h2="ArrowUp",pk="ArrowDown",R_="Home",fk="End",Dr="active",gk="fade",N_="show",u2="dropdown",YA=".dropdown-toggle",d2=".dropdown-menu",L_=`:not(${YA})`,p2='.list-group, .nav, [role="tablist"]',f2=".nav-item, .list-group-item",g2=`.nav-link${L_}, .list-group-item${L_}, [role="tab"]${L_}`,KA='[data-bs-toggle="tab"], [data-bs-toggle="pill"], [data-bs-toggle="list"]',M_=`${g2}, ${KA}`,m2=`.${Dr}[data-bs-toggle="tab"], .${Dr}[data-bs-toggle="pill"], .${Dr}[data-bs-toggle="list"]`;class wc extends Ds{constructor(e){super(e),this._parent=this._element.closest(p2),this._parent&&(this._setInitialAttributes(this._parent,this._getChildren()),at.on(this._element,l2,s=>this._keydown(s)))}static get NAME(){return t2}show(){const e=this._element;if(this._elemIsActive(e))return;const s=this._getActiveElem(),o=s?at.trigger(s,i2,{relatedTarget:e}):null;at.trigger(e,o2,{relatedTarget:s}).defaultPrevented||o&&o.defaultPrevented||(this._deactivate(s,e),this._activate(e,s))}_activate(e,s){if(!e)return;e.classList.add(Dr),this._activate(Bt.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.add(N_);return}e.removeAttribute("tabindex"),e.setAttribute("aria-selected",!0),this._toggleDropDown(e,!0),at.trigger(e,n2,{relatedTarget:s})};this._queueCallback(o,e,e.classList.contains(gk))}_deactivate(e,s){if(!e)return;e.classList.remove(Dr),e.blur(),this._deactivate(Bt.getElementFromSelector(e));const o=()=>{if(e.getAttribute("role")!=="tab"){e.classList.remove(N_);return}e.setAttribute("aria-selected",!1),e.setAttribute("tabindex","-1"),this._toggleDropDown(e,!1),at.trigger(e,s2,{relatedTarget:s})};this._queueCallback(o,e,e.classList.contains(gk))}_keydown(e){if(![a2,dk,h2,pk,R_,fk].includes(e.key))return;e.stopPropagation(),e.preventDefault();const s=this._getChildren().filter(l=>!Wn(l));let o;if([R_,fk].includes(e.key))o=s[e.key===R_?0:s.length-1];else{const l=[dk,pk].includes(e.key);o=rE(s,e.target,l,!0)}o&&(o.focus({preventScroll:!0}),wc.getOrCreateInstance(o).show())}_getChildren(){return Bt.find(M_,this._parent)}_getActiveElem(){return this._getChildren().find(e=>this._elemIsActive(e))||null}_setInitialAttributes(e,s){this._setAttributeIfNotExists(e,"role","tablist");for(const o of s)this._setInitialAttributesOnChild(o)}_setInitialAttributesOnChild(e){e=this._getInnerElement(e);const s=this._elemIsActive(e),o=this._getOuterElement(e);e.setAttribute("aria-selected",s),o!==e&&this._setAttributeIfNotExists(o,"role","presentation"),s||e.setAttribute("tabindex","-1"),this._setAttributeIfNotExists(e,"role","tab"),this._setInitialAttributesOnTargetPanel(e)}_setInitialAttributesOnTargetPanel(e){const s=Bt.getElementFromSelector(e);s&&(this._setAttributeIfNotExists(s,"role","tabpanel"),e.id&&this._setAttributeIfNotExists(s,"aria-labelledby",`${e.id}`))}_toggleDropDown(e,s){const o=this._getOuterElement(e);if(!o.classList.contains(u2))return;const l=(a,h)=>{const d=Bt.findOne(a,o);d&&d.classList.toggle(h,s)};l(YA,Dr),l(d2,N_),o.setAttribute("aria-expanded",s)}_setAttributeIfNotExists(e,s,o){e.hasAttribute(s)||e.setAttribute(s,o)}_elemIsActive(e){return e.classList.contains(Dr)}_getInnerElement(e){return e.matches(M_)?e:Bt.findOne(M_,e)}_getOuterElement(e){return e.closest(f2)||e}static jQueryInterface(e){return this.each(function(){const s=wc.getOrCreateInstance(this);if(typeof e=="string"){if(s[e]===void 0||e.startsWith("_")||e==="constructor")throw new TypeError(`No method named "${e}"`);s[e]()}})}}at.on(document,r2,KA,function(n){["A","AREA"].includes(this.tagName)&&n.preventDefault(),!Wn(this)&&wc.getOrCreateInstance(this).show()});at.on(window,c2,()=>{for(const n of Bt.find(m2))wc.getOrCreateInstance(n)});Ts(wc);const $2="toast",_2="bs.toast",Jn=`.${_2}`,T2=`mouseover${Jn}`,b2=`mouseout${Jn}`,E2=`focusin${Jn}`,v2=`focusout${Jn}`,y2=`hide${Jn}`,I2=`hidden${Jn}`,S2=`show${Jn}`,C2=`shown${Jn}`,w2="fade",mk="hide",Hd="show",Vd="showing",k2={animation:"boolean",autohide:"boolean",delay:"number"},O2={animation:!0,autohide:!0,delay:5e3};class ef extends Ds{constructor(e,s){super(e,s),this._timeout=null,this._hasMouseInteraction=!1,this._hasKeyboardInteraction=!1,this._setListeners()}static get Default(){return O2}static get DefaultType(){return k2}static get NAME(){return $2}show(){if(at.trigger(this._element,S2).defaultPrevented)return;this._clearTimeout(),this._config.animation&&this._element.classList.add(w2);const s=()=>{this._element.classList.remove(Vd),at.trigger(this._element,C2),this._maybeScheduleHide()};this._element.classList.remove(mk),Ph(this._element),this._element.classList.add(Hd,Vd),this._queueCallback(s,this._element,this._config.animation)}hide(){if(!this.isShown()||at.trigger(this._element,y2).defaultPrevented)return;const s=()=>{this._element.classList.add(mk),this._element.classList.remove(Vd,Hd),at.trigger(this._element,I2)};this._element.classList.add(Vd),this._queueCallback(s,this._element,this._config.animation)}dispose(){this._clearTimeout(),this.isShown()&&this._element.classList.remove(Hd),super.dispose()}isShown(){return this._element.classList.contains(Hd)}_maybeScheduleHide(){this._config.autohide&&(this._hasMouseInteraction||this._hasKeyboardInteraction||(this._timeout=setTimeout(()=>{this.hide()},this._config.delay)))}_onInteraction(e,s){switch(e.type){case"mouseover":case"mouseout":{this._hasMouseInteraction=s;break}case"focusin":case"focusout":{this._hasKeyboardInteraction=s;break}}if(s){this._clearTimeout();return}const o=e.relatedTarget;this._element===o||this._element.contains(o)||this._maybeScheduleHide()}_setListeners(){at.on(this._element,T2,e=>this._onInteraction(e,!0)),at.on(this._element,b2,e=>this._onInteraction(e,!1)),at.on(this._element,E2,e=>this._onInteraction(e,!0)),at.on(this._element,v2,e=>this._onInteraction(e,!1))}_clearTimeout(){clearTimeout(this._timeout),this._timeout=null}static jQueryInterface(e){return this.each(function(){const s=ef.getOrCreateInstance(this,e);if(typeof e=="string"){if(typeof s[e]>"u")throw new TypeError(`No method named "${e}"`);s[e](this)}})}}qp(ef);Ts(ef);gM(OB).mount("#app");
